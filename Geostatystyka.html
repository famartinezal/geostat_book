<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Geostatystyka</title>
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
  <meta name="description" content="Geostatystyka">
  <meta name="generator" content="bookdown <!--bookdown:version--> and GitBook 2.6.7">

<meta name="author" content="Jakub Nowosad">

<meta name="date" content="2016-03-04">

  <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>

  <meta name="HandheldFriendly" content="true">
  <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<!--bookdown:link_prev-->
<!--bookdown:link_next-->

<link href="book_assets/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<script src="book_assets/gitbook-2.6.7/js/app.js"></script>
<script src="book_assets/gitbook-2.6.7/js/lunr.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="book_assets/gitbook-2.6.7/js/jquery.highlight.js"></script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>


<!--bookdown:title:start-->
<div id="header">
<h1 class="title">Geostatystyka</h1>
<h4 class="author"><em>Jakub Nowosad</em></h4>
<h4 class="date"><em>2016-03-04</em></h4>
</div>
<!--bookdown:title:end-->

<!--bookdown:toc:start-->
  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">
<!--bookdown:toc2:start-->
<ul>
<li><a href="#dzien-dobry"><span class="toc-section-number">1</span> Dzień dobry</a></li>
<li><a href="#intro"><span class="toc-section-number">2</span> Wprowadzenie</a><ul>
<li><a href="#suwalski-park-krajobrazowy"><span class="toc-section-number">2.1</span> Suwalski Park Krajobrazowy</a></li>
<li><a href="#r-a-dane-przestrzenne"><span class="toc-section-number">2.2</span> R a dane przestrzenne</a><ul>
<li><a href="#pakiety"><span class="toc-section-number">2.2.1</span> Pakiety</a></li>
<li><a href="#reprezentacja-danych-nieprzestrzennych"><span class="toc-section-number">2.2.2</span> Reprezentacja danych nieprzestrzennych</a></li>
<li><a href="#reprezentacja-danych-przestrzennych"><span class="toc-section-number">2.2.3</span> Reprezentacja danych przestrzennych</a></li>
<li><a href="#gdalogr"><span class="toc-section-number">2.2.4</span> GDAL/OGR</a></li>
<li><a href="#proj.4"><span class="toc-section-number">2.2.5</span> PROJ.4</a></li>
<li><a href="#epsg"><span class="toc-section-number">2.2.6</span> EPSG</a></li>
<li><a href="#ukad-geograficzny"><span class="toc-section-number">2.2.7</span> Układ geograficzny</a></li>
</ul></li>
<li><a href="#import-danych"><span class="toc-section-number">2.3</span> Import danych</a><ul>
<li><a href="#dane-punktowe-format-csv"><span class="toc-section-number">2.3.1</span> Dane punktowe (format csv)</a></li>
<li><a href="#dane-poligonowe-formaty-gisowe"><span class="toc-section-number">2.3.2</span> Dane poligonowe (formaty gisowe)</a></li>
<li><a href="#rastry"><span class="toc-section-number">2.3.3</span> Rastry</a></li>
</ul></li>
<li><a href="#eksport-danych"><span class="toc-section-number">2.4</span> Eksport danych</a><ul>
<li><a href="#zapisywanie-danych-wektorowych"><span class="toc-section-number">2.4.1</span> Zapisywanie danych wektorowych</a></li>
<li><a href="#zapisywanie-danych-rastrowych"><span class="toc-section-number">2.4.2</span> Zapisywanie danych rastrowych</a></li>
</ul></li>
<li><a href="#wizualizacja-danych-2d"><span class="toc-section-number">2.5</span> Wizualizacja danych 2D</a><ul>
<li><a href="#dane-punktowe"><span class="toc-section-number">2.5.1</span> Dane punktowe</a></li>
<li><a href="#dane-punktowe-1"><span class="toc-section-number">2.5.2</span> Dane punktowe</a></li>
<li><a href="#dane-punktowe---kategorie"><span class="toc-section-number">2.5.3</span> Dane punktowe - kategorie</a></li>
<li><a href="#rastry-1"><span class="toc-section-number">2.5.4</span> Rastry</a></li>
</ul></li>
<li><a href="#tworzenie-siatek"><span class="toc-section-number">2.6</span> Tworzenie siatek</a><ul>
<li><a href="#siatki-regularne"><span class="toc-section-number">2.6.1</span> Siatki regularne</a></li>
<li><a href="#siatki-regularne-1"><span class="toc-section-number">2.6.2</span> Siatki regularne</a></li>
<li><a href="#siatki-nieregularne"><span class="toc-section-number">2.6.3</span> Siatki nieregularne</a></li>
<li><a href="#siatki-nieregularne-1"><span class="toc-section-number">2.6.4</span> Siatki nieregularne</a></li>
</ul></li>
</ul></li>
<li><a href="#eksploracyjna-analiza-danych"><span class="toc-section-number">3</span> Eksploracyjna analiza danych</a><ul>
<li><a href="#eksploracyjna-analiza-danych-cel"><span class="toc-section-number">3.1</span> Eksploracyjna analiza danych | Cel</a></li>
<li><a href="#dane-wolin"><span class="toc-section-number">3.2</span> Dane Wolin</a><ul>
<li><a href="#dane-wolin-1"><span class="toc-section-number">3.2.1</span> Dane Wolin</a></li>
</ul></li>
<li><a href="#statystyki-opisowe"><span class="toc-section-number">3.3</span> Statystyki opisowe</a><ul>
<li><a href="#statystyki-opisowe-1"><span class="toc-section-number">3.3.1</span> Statystyki opisowe</a></li>
<li><a href="#statystyki-opisowe-srednia-i-mediana"><span class="toc-section-number">3.3.2</span> Statystyki opisowe | średnia i mediana</a></li>
<li><a href="#statystyki-opisowe-srednia-i-mediana-1"><span class="toc-section-number">3.3.3</span> Statystyki opisowe | średnia i mediana</a></li>
<li><a href="#statystyki-opisowe-minimum-i-maksimum"><span class="toc-section-number">3.3.4</span> Statystyki opisowe | minimum i maksimum</a></li>
<li><a href="#statystyki-opisowe-ochylenie-standardowe"><span class="toc-section-number">3.3.5</span> Statystyki opisowe | ochylenie standardowe</a></li>
</ul></li>
<li><a href="#wykresy"><span class="toc-section-number">3.4</span> Wykresy</a><ul>
<li><a href="#histogram"><span class="toc-section-number">3.4.1</span> Histogram</a></li>
<li><a href="#estymator-jadrowy-gestosci-ang.-kernel-density-estimation"><span class="toc-section-number">3.4.2</span> Estymator jądrowy gęstości (ang. <em>kernel density estimation</em>)</a></li>
<li><a href="#wykresy-kwantyl-kwantyl-ang.quantile-quantile"><span class="toc-section-number">3.4.3</span> Wykresy kwantyl-kwantyl (ang.<em>quantile-quantile</em>)</a></li>
<li><a href="#wykresy-kwantyl-kwantyl-ang.-quantile-quantile"><span class="toc-section-number">3.4.4</span> Wykresy kwantyl-kwantyl (ang. <em>quantile-quantile</em>)</a></li>
<li><a href="#dystrybuanta-cdf"><span class="toc-section-number">3.4.5</span> Dystrybuanta (CDF)</a></li>
</ul></li>
<li><a href="#porownanie-zmiennych"><span class="toc-section-number">3.5</span> Porównanie zmiennych</a><ul>
<li><a href="#kowariancja"><span class="toc-section-number">3.5.1</span> Kowariancja</a></li>
<li><a href="#wspoczynnik-korelacji"><span class="toc-section-number">3.5.2</span> Współczynnik korelacji</a></li>
<li><a href="#wykresy-pudekowe"><span class="toc-section-number">3.5.3</span> Wykresy pudełkowe</a></li>
<li><a href="#testowanie-istotnosci-roznic-sredniej-pomiedzy-grupami"><span class="toc-section-number">3.5.4</span> Testowanie istotności różnić średniej pomiędzy grupami</a></li>
<li><a href="#testowanie-istotnosci-roznic-sredniej-pomiedzy-grupami-1"><span class="toc-section-number">3.5.5</span> Testowanie istotności różnić średniej pomiędzy grupami</a></li>
</ul></li>
<li><a href="#transformacje-danych"><span class="toc-section-number">3.6</span> Transformacje danych</a><ul>
<li><a href="#transformacje-danych-1"><span class="toc-section-number">3.6.1</span> Transformacje danych</a></li>
<li><a href="#transformacja-danych-logarytmizacja"><span class="toc-section-number">3.6.2</span> Transformacja danych | Logarytmizacja</a></li>
<li><a href="#transformacja-danych-pierwiastkowanie"><span class="toc-section-number">3.6.3</span> Transformacja danych | Pierwiastkowanie</a></li>
<li><a href="#transformacja-danych-rodzina-transformacji-boxa-coxa"><span class="toc-section-number">3.6.4</span> Transformacja danych | Rodzina transformacji Boxa Coxa</a></li>
</ul></li>
<li><a href="#mapy"><span class="toc-section-number">3.7</span> Mapy</a><ul>
<li><a href="#podstawowe-terminy-kontekst-przestrzenny"><span class="toc-section-number">3.7.1</span> Podstawowe terminy | Kontekst przestrzenny</a></li>
<li><a href="#mapy-punktowe-cel"><span class="toc-section-number">3.7.2</span> Mapy punktowe | Cel</a></li>
<li><a href="#typ-probowania"><span class="toc-section-number">3.7.3</span> Typ próbowania</a></li>
<li><a href="#typ-probowania-regularny"><span class="toc-section-number">3.7.4</span> Typ próbowania | Regularny</a></li>
<li><a href="#typ-probowania-losowy"><span class="toc-section-number">3.7.5</span> Typ próbowania | Losowy</a></li>
<li><a href="#typ-probowania-losowy-stratyfikowany"><span class="toc-section-number">3.7.6</span> Typ próbowania | Losowy stratyfikowany</a></li>
<li><a href="#typ-probowania-preferencyjny-i"><span class="toc-section-number">3.7.7</span> Typ próbowania | Preferencyjny I</a></li>
<li><a href="#typ-probowania-liniowy"><span class="toc-section-number">3.7.8</span> Typ próbowania | Liniowy</a></li>
<li><a href="#mapy-punktowe-i-dane-lokalnie-odstajace"><span class="toc-section-number">3.7.9</span> Mapy punktowe i dane lokalnie odstające</a></li>
</ul></li>
<li><a href="#rozgrupowanie-danych"><span class="toc-section-number">3.8</span> Rozgrupowanie danych</a><ul>
<li><a href="#rozgrupowanie-danych-1"><span class="toc-section-number">3.8.1</span> Rozgrupowanie danych</a></li>
<li><a href="#rozgrupowanie-danych-2"><span class="toc-section-number">3.8.2</span> Rozgrupowanie danych</a></li>
<li><a href="#rozgrupowanie-komorkowe-i-ang.-cell-declustering"><span class="toc-section-number">3.8.3</span> Rozgrupowanie komórkowe I | (ang. <em>cell declustering</em>)</a></li>
<li><a href="#rozgrupowanie-komorkowe-i-ang.-cell-declustering-1"><span class="toc-section-number">3.8.4</span> Rozgrupowanie komórkowe I | (ang. <em>cell declustering</em>)</a></li>
<li><a href="#rozgrupowanie-komorkowe-ii-ang.-cell-declustering"><span class="toc-section-number">3.8.5</span> Rozgrupowanie komórkowe II | (ang. <em>cell declustering</em>)</a></li>
<li><a href="#rozgrupowanie-poligonowe-ang.-polygon-declustering"><span class="toc-section-number">3.8.6</span> Rozgrupowanie poligonowe | (ang. <em>polygon declustering</em>)</a></li>
<li><a href="#rozgrupowanie-poligonowe-ang.-polygon-declustering-1"><span class="toc-section-number">3.8.7</span> Rozgrupowanie poligonowe | (ang. <em>polygon declustering</em>)</a></li>
</ul></li>
</ul></li>
<li><a href="#eksploracyjna-analiza-danych---geostatystyka"><span class="toc-section-number">4</span> Eksploracyjna analiza danych - geostatystyka</a><ul>
<li><a href="#interpolacja"><span class="toc-section-number">4.1</span> Interpolacja</a><ul>
<li><a href="#modele-deterministyczne"><span class="toc-section-number">4.1.1</span> Modele deterministyczne</a></li>
<li><a href="#modele-deterministyczne-1"><span class="toc-section-number">4.1.2</span> Modele deterministyczne</a></li>
<li><a href="#modele-deterministyczne-funkcje-wielomianowe"><span class="toc-section-number">4.1.3</span> Modele deterministyczne | Funkcje wielomianowe</a></li>
<li><a href="#modele-deterministyczne-funkcje-sklejane"><span class="toc-section-number">4.1.4</span> Modele deterministyczne | Funkcje sklejane</a></li>
<li><a href="#modele-deterministyczne-triangulacje-thiessen"><span class="toc-section-number">4.1.5</span> Modele deterministyczne | Triangulacje (Thiessen)</a></li>
<li><a href="#modele-deterministyczne-idw"><span class="toc-section-number">4.1.6</span> Modele deterministyczne | IDW</a></li>
<li><a href="#modele-deterministyczne-porownanie"><span class="toc-section-number">4.1.7</span> Modele deterministyczne | Porównanie</a></li>
<li><a href="#modele-statystyczne"><span class="toc-section-number">4.1.8</span> Modele statystyczne</a></li>
</ul></li>
<li><a href="#geostatystyka---prolog"><span class="toc-section-number">4.2</span> Geostatystyka - prolog</a><ul>
<li><a href="#geostatystyka"><span class="toc-section-number">4.2.1</span> Geostatystyka</a></li>
<li><a href="#geostatystyka-funkcje"><span class="toc-section-number">4.2.2</span> Geostatystyka | Funkcje</a></li>
<li><a href="#geostatystyczna-analiza-danych"><span class="toc-section-number">4.2.3</span> Geostatystyczna analiza danych</a></li>
<li><a href="#geostatystyka-dane-wejsciowe"><span class="toc-section-number">4.2.4</span> Geostatystyka | Dane wejściowe</a></li>
<li><a href="#geostatystyka-podstawowe-etapy"><span class="toc-section-number">4.2.5</span> Geostatystyka | Podstawowe etapy</a></li>
</ul></li>
<li><a href="#przestrzenna-kowariancja-korelacja-i-semiwariancja"><span class="toc-section-number">4.3</span> Przestrzenna kowariancja, korelacja i semiwariancja</a><ul>
<li><a href="#przestrzenna-kowariancja-korelacja-i-semiwariancja-zaozenia"><span class="toc-section-number">4.3.1</span> Przestrzenna kowariancja, korelacja i semiwariancja | Założenia</a></li>
<li><a href="#przestrzenna-kowariancja-korelacja-i-semiwariancja-1"><span class="toc-section-number">4.3.2</span> Przestrzenna kowariancja, korelacja i semiwariancja</a></li>
<li><a href="#przestrzenna-kowariancja-korelacja-i-semiwariancja-2"><span class="toc-section-number">4.3.3</span> Przestrzenna kowariancja, korelacja i semiwariancja</a></li>
<li><a href="#wykres-rozrzutu-z-przesunieciem"><span class="toc-section-number">4.3.4</span> Wykres rozrzutu z przesunięciem</a></li>
<li><a href="#autokowariancja"><span class="toc-section-number">4.3.5</span> Autokowariancja</a></li>
<li><a href="#autokorelacja"><span class="toc-section-number">4.3.6</span> Autokorelacja</a></li>
<li><a href="#semiwariancja"><span class="toc-section-number">4.3.7</span> Semiwariancja</a></li>
<li><a href="#okreslenie-wystepowania-autokorelacji-przestrzennej-chmura-semiwariogramu"><span class="toc-section-number">4.3.8</span> Określenie występowania autokorelacji przestrzennej | Chmura semiwariogramu</a></li>
<li><a href="#semiwariancja-przykadowe-obliczenia"><span class="toc-section-number">4.3.9</span> Semiwariancja | Przykładowe obliczenia</a></li>
<li><a href="#okreslenie-wystepowania-autokorelacji-przestrzennej-chmura-semiwariogramu-1"><span class="toc-section-number">4.3.10</span> Określenie występowania autokorelacji przestrzennej | Chmura semiwariogramu</a></li>
<li><a href="#okreslenie-wystepowania-autokorelacji-przestrzennej-chmura-semiwariogramu-2"><span class="toc-section-number">4.3.11</span> Określenie występowania autokorelacji przestrzennej | Chmura semiwariogramu</a></li>
<li><a href="#semiwariogram-charakterystyka-struktury-przestrzennej"><span class="toc-section-number">4.3.12</span> Semiwariogram | Charakterystyka struktury przestrzennej</a></li>
<li><a href="#semiwariogram"><span class="toc-section-number">4.3.13</span> Semiwariogram</a></li>
<li><a href="#semiwariogram-rules-of-thumb"><span class="toc-section-number">4.3.14</span> Semiwariogram | Rules of thumb</a></li>
<li><a href="#semiwariogram-obliczenia-pomocnicze"><span class="toc-section-number">4.3.15</span> Semiwariogram | Obliczenia pomocnicze</a></li>
<li><a href="#semiwariogram-maksymalny-zasieg-semiwariogramu-ang.-cutoff-distance"><span class="toc-section-number">4.3.16</span> Semiwariogram | Maksymalny zasięg semiwariogramu (ang. <em>Cutoff distance</em>)</a></li>
<li><a href="#semiwariogram-odlegosc-miedzy-przedziaami-ang-interval-width"><span class="toc-section-number">4.3.17</span> Semiwariogram | Odległość między przedziałami (ang, <em>Interval width </em>)</a></li>
</ul></li>
<li><a href="#anizotropia"><span class="toc-section-number">4.4</span> Anizotropia</a><ul>
<li><a href="#anizotropia-struktury-przestrzennej"><span class="toc-section-number">4.4.1</span> Anizotropia struktury przestrzennej</a></li>
<li><a href="#mapa-semiwariogramu"><span class="toc-section-number">4.4.2</span> Mapa semiwariogramu</a></li>
<li><a href="#mapa-semiwariogramu-3d"><span class="toc-section-number">4.4.3</span> Mapa semiwariogramu | 3D</a></li>
<li><a href="#semiwariogramy-kierunkowe-kierunki"><span class="toc-section-number">4.4.4</span> Semiwariogramy kierunkowe | Kierunki</a></li>
<li><a href="#semiwariogramy-kierunkowe-kierunki-1"><span class="toc-section-number">4.4.5</span> Semiwariogramy kierunkowe | Kierunki</a></li>
</ul></li>
<li><a href="#krossemiwariogramy"><span class="toc-section-number">4.5</span> Krossemiwariogramy</a><ul>
<li><a href="#krossemiwariogramy-1"><span class="toc-section-number">4.5.1</span> Krossemiwariogramy</a></li>
<li><a href="#krossemiwariogramy-2"><span class="toc-section-number">4.5.2</span> Krossemiwariogramy</a></li>
</ul></li>
</ul></li>
<li><a href="#modelowanie-matematycznie-autokorelacji-przestrzennej"><span class="toc-section-number">5</span> Modelowanie matematycznie autokorelacji przestrzennej</a><ul>
<li><a href="#modelowanie-matematycznie-autokorelacji-przestrzennej-1"><span class="toc-section-number">5.0.1</span> Modelowanie matematycznie autokorelacji przestrzennej</a></li>
<li><a href="#modele-podstawowe"><span class="toc-section-number">5.1</span> Modele podstawowe</a><ul>
<li><a href="#modele-podstawowe-1"><span class="toc-section-number">5.1.1</span> Modele podstawowe</a></li>
</ul></li>
<li><a href="#metody-modelowania"><span class="toc-section-number">5.2</span> Metody modelowania</a><ul>
<li><a href="#metody-modelowania-1"><span class="toc-section-number">5.2.1</span> Metody modelowania</a></li>
<li><a href="#metody-modelowania-2"><span class="toc-section-number">5.2.2</span> Metody modelowania</a></li>
<li><a href="#metody-modelowania-liniowy-model-regionalizacji"><span class="toc-section-number">5.2.3</span> Metody modelowania | Liniowy model regionalizacji</a></li>
</ul></li>
<li><a href="#modelowanie-semiwariogramu"><span class="toc-section-number">5.3</span> Modelowanie semiwariogramu</a><ul>
<li><a href="#modelowanie-semiwariogramu-funkcja-fit.variogram"><span class="toc-section-number">5.3.1</span> Modelowanie semiwariogramu | funkcja <em>fit.variogram</em></a></li>
</ul></li>
<li><a href="#modelowanie-izotropowe"><span class="toc-section-number">5.4</span> Modelowanie izotropowe</a><ul>
<li><a href="#modelowanie-izotropowe-modelowanie-wizualne"><span class="toc-section-number">5.4.1</span> Modelowanie izotropowe | Modelowanie “wizualne”</a></li>
<li><a href="#modelowanie-izotropowe-model-nuggetowy"><span class="toc-section-number">5.4.2</span> Modelowanie izotropowe | Model nuggetowy</a></li>
<li><a href="#modelowanie-izotropowe-model-sferyczny"><span class="toc-section-number">5.4.3</span> Modelowanie izotropowe | Model sferyczny</a></li>
<li><a href="#modelowanie-izotropowe-model-gaussowski"><span class="toc-section-number">5.4.4</span> Modelowanie izotropowe | Model Gaussowski</a></li>
<li><a href="#modelowanie-izotropowe-model-potegowy"><span class="toc-section-number">5.4.5</span> Modelowanie izotropowe | Model potęgowy</a></li>
<li><a href="#modelowanie-izotropowe-model-wykadniczy"><span class="toc-section-number">5.4.6</span> Modelowanie izotropowe | Model wykładniczy</a></li>
<li><a href="#modelowanie-izotropowe-modele-zozone-i"><span class="toc-section-number">5.4.7</span> Modelowanie izotropowe | Modele złożone I</a></li>
<li><a href="#modelowanie-izotropowe-modele-zozone-ii"><span class="toc-section-number">5.4.8</span> Modelowanie izotropowe | Modele złożone II</a></li>
</ul></li>
<li><a href="#modelowanie-anizotropowe"><span class="toc-section-number">5.5</span> Modelowanie anizotropowe</a><ul>
<li><a href="#anizotropia-1"><span class="toc-section-number">5.5.1</span> Anizotropia</a></li>
</ul></li>
<li><a href="#modelowanie-krossemiwariogramow"><span class="toc-section-number">5.6</span> Modelowanie krossemiwariogramów</a><ul>
<li><a href="#modelowanie-krossemiwariogramow-fit.lmc"><span class="toc-section-number">5.6.1</span> Modelowanie krossemiwariogramów | <em>fit.lmc</em></a></li>
<li><a href="#modelowanie-krossemiwariogramow-1"><span class="toc-section-number">5.6.2</span> Modelowanie krossemiwariogramów</a></li>
</ul></li>
</ul></li>
<li><a href="#estymacje-jednozmienne"><span class="toc-section-number">6</span> Estymacje jednozmienne</a><ul>
<li><a href="#kriging"><span class="toc-section-number">6.1</span> Kriging</a><ul>
<li><a href="#kriging-interpolacja-geostatystyczna"><span class="toc-section-number">6.1.1</span> Kriging | Interpolacja geostatystyczna</a></li>
</ul></li>
<li><a href="#rodzaje-krigingu"><span class="toc-section-number">6.2</span> Rodzaje krigingu</a><ul>
<li><a href="#rodzaje-krigingu-1"><span class="toc-section-number">6.2.1</span> Rodzaje krigingu</a></li>
</ul></li>
<li><a href="#kriging-prosty-ang.-simple-kriging"><span class="toc-section-number">6.3</span> Kriging prosty (ang. <em>Simple kriging</em>)</a><ul>
<li><a href="#kriging-prosty-ang.-simple-kriging-1"><span class="toc-section-number">6.3.1</span> Kriging prosty (ang. <em>Simple kriging</em>)</a></li>
<li><a href="#kriging-prosty-ang.-simple-kriging-2"><span class="toc-section-number">6.3.2</span> Kriging prosty (ang. <em>Simple kriging</em>)</a></li>
</ul></li>
<li><a href="#kriging-zwyky-ang.-ordinary-kriging"><span class="toc-section-number">6.4</span> Kriging zwykły (ang. <em>Ordinary kriging</em>)</a><ul>
<li><a href="#kriging-zwyky-ang.-ordinary-kriging-1"><span class="toc-section-number">6.4.1</span> Kriging zwykły (ang. <em>Ordinary kriging</em>)</a></li>
<li><a href="#kriging-zwyky-ang.-ordinary-kriging-2"><span class="toc-section-number">6.4.2</span> Kriging zwykły (ang. <em>Ordinary kriging</em>)</a></li>
</ul></li>
<li><a href="#porownanie-wynikow-sk-ok-i-kzt"><span class="toc-section-number">6.5</span> Porównanie wyników SK, OK i KZT</a></li>
</ul></li>
<li><a href="#ocena-jakosci-estymacji-uwaga-pomieszany-me-z-reszta"><span class="toc-section-number">7</span> Ocena jakości estymacji [UWAGA POMIESZANY ME Z RESZTĄ!!]</a><ul>
<li><a href="#statystyki-jakosci-estymacji"><span class="toc-section-number">7.1</span> Statystyki jakości estymacji</a><ul>
<li><a href="#statystyki-jakosci-estymacji-1"><span class="toc-section-number">7.1.1</span> Statystyki jakości estymacji</a></li>
<li><a href="#statystyki-jakosci-estymacji-2"><span class="toc-section-number">7.1.2</span> Statystyki jakości estymacji</a></li>
<li><a href="#sredni-bad-estymacji"><span class="toc-section-number">7.1.3</span> Średni błąd estymacji</a></li>
<li><a href="#pierwiastek-sredniego-bedu-kwadratowego"><span class="toc-section-number">7.1.4</span> Pierwiastek średniego błędu kwadratowego</a></li>
<li><a href="#wspoczynnik-korelacji-1"><span class="toc-section-number">7.1.5</span> Współczynnik korelacji</a></li>
<li><a href="#statystyki-jakosci-estymacji-mapa"><span class="toc-section-number">7.1.6</span> Statystyki jakości estymacji | Mapa</a></li>
<li><a href="#statystyki-jakosci-estymacji-histogram"><span class="toc-section-number">7.1.7</span> Statystyki jakości estymacji | Histogram</a></li>
<li><a href="#statystyki-jakosci-estymacji-wykres-rozrzutu"><span class="toc-section-number">7.1.8</span> Statystyki jakości estymacji | Wykres rozrzutu</a></li>
</ul></li>
<li><a href="#walidacja-wynikow-estymacji"><span class="toc-section-number">7.2</span> Walidacja wyników estymacji</a><ul>
<li><a href="#walidacja-wynikow-estymacji-1"><span class="toc-section-number">7.2.1</span> Walidacja wyników estymacji</a></li>
<li><a href="#walidacja-podzbiorem"><span class="toc-section-number">7.2.2</span> Walidacja podzbiorem</a></li>
<li><a href="#walidacja-podzbiorem-1"><span class="toc-section-number">7.2.3</span> Walidacja podzbiorem</a></li>
<li><a href="#kroswalidacja"><span class="toc-section-number">7.2.4</span> Kroswalidacja</a></li>
<li><a href="#kroswalidacja-1"><span class="toc-section-number">7.2.5</span> Kroswalidacja</a></li>
</ul></li>
</ul></li>
<li><a href="#wykorzystanie-do-estymacji-danych-uzupeniajacych"><span class="toc-section-number">8</span> Wykorzystanie do estymacji danych uzupełniających</a><ul>
<li><a href="#kriging-stratyfikowany-ang.-kriging-within-strata"><span class="toc-section-number">8.1</span> Kriging stratyfikowany (ang. <em>Kriging within strata</em>)</a><ul>
<li><a href="#kriging-stratyfikowany-ang.-kriging-within-strata-1"><span class="toc-section-number">8.1.1</span> Kriging stratyfikowany (ang. <em>Kriging within strata</em>)</a></li>
<li><a href="#kriging-stratyfikowany-ang.-kriging-within-strata-2"><span class="toc-section-number">8.1.2</span> Kriging stratyfikowany (ang. <em>Kriging within strata</em>)</a></li>
</ul></li>
<li><a href="#prosty-kriging-ze-zmiennymi-srednimi-lokalnymi-lvm"><span class="toc-section-number">8.2</span> Prosty kriging ze zmiennymi średnimi lokalnymi (LVM)</a><ul>
<li><a href="#prosty-kriging-ze-zmiennymi-srednimi-lokalnymi-lvm-1"><span class="toc-section-number">8.2.1</span> Prosty kriging ze zmiennymi średnimi lokalnymi (LVM)</a></li>
<li><a href="#prosty-kriging-ze-zmiennymi-srednimi-lokalnymi-lvm-2"><span class="toc-section-number">8.2.2</span> Prosty kriging ze zmiennymi średnimi lokalnymi (LVM)</a></li>
</ul></li>
<li><a href="#kriging-uniwersalny-ang.-universal-kriging"><span class="toc-section-number">8.3</span> Kriging uniwersalny (ang. <em>Universal kriging</em>)</a><ul>
<li><a href="#kriging-uniwersalny-ang.-universal-kriging-1"><span class="toc-section-number">8.3.1</span> Kriging uniwersalny (ang. <em>Universal kriging</em>)</a></li>
<li><a href="#kriging-uniwersalny-ang.-universal-kriging-2"><span class="toc-section-number">8.3.2</span> Kriging uniwersalny (ang. <em>Universal kriging</em>)</a></li>
</ul></li>
</ul></li>
<li><a href="#estymacja-lokalnego-rozkadu-prawdopodobienstwa"><span class="toc-section-number">9</span> Estymacja lokalnego rozkładu prawdopodobieństwa</a><ul>
<li><a href="#kriging-danych-kodowanych-ang.-indicator-kriging-wprowadzenie"><span class="toc-section-number">9.1</span> Kriging danych kodowanych (ang. <em>Indicator kriging</em>) | Wprowadzenie</a><ul>
<li><a href="#kriging-danych-kodowanych-ang.-indicator-kriging"><span class="toc-section-number">9.1.1</span> Kriging danych kodowanych (ang. <em>Indicator kriging</em>)</a></li>
<li><a href="#kriging-danych-kodowanych-ang.-indicator-kriging-1"><span class="toc-section-number">9.1.2</span> Kriging danych kodowanych (ang. <em>Indicator kriging</em>)</a></li>
<li><a href="#kriging-danych-kodowanych-ang.-indicator-kriging-wady-i-zalety"><span class="toc-section-number">9.1.3</span> Kriging danych kodowanych (ang. <em>Indicator kriging</em>)| Wady i zalety</a></li>
</ul></li>
<li><a href="#kriging-danych-kodowanych-ang.-indicator-kriging-przykady"><span class="toc-section-number">9.2</span> Kriging danych kodowanych (ang. <em>Indicator kriging</em>) | Przykłady</a><ul>
<li><a href="#binaryzacja-danych"><span class="toc-section-number">9.2.1</span> Binaryzacja danych</a></li>
<li><a href="#eksploracja-danych"><span class="toc-section-number">9.2.2</span> Eksploracja danych</a></li>
<li><a href="#kriging-danych-kodowanych-ang.-indicator-kriging-semiwariogram"><span class="toc-section-number">9.2.3</span> Kriging danych kodowanych (ang. <em>Indicator kriging</em>) | Semiwariogram</a></li>
<li><a href="#kriging-danych-kodowanych-ang.-indicator-kriging-modelowanie"><span class="toc-section-number">9.2.4</span> Kriging danych kodowanych (ang. <em>Indicator kriging</em>) | Modelowanie</a></li>
<li><a href="#kriging-danych-kodowanych-ang.-indicator-kriging-interpolacja"><span class="toc-section-number">9.2.5</span> Kriging danych kodowanych (ang. <em>Indicator kriging</em>) | Interpolacja</a></li>
<li><a href="#kriging-danych-kodowanych-ang.-indicator-kriging-2"><span class="toc-section-number">9.2.6</span> Kriging danych kodowanych (ang. <em>Indicator kriging</em>)</a></li>
</ul></li>
</ul></li>
<li><a href="#symulacje"><span class="toc-section-number">10</span> Symulacje</a><ul>
<li><a href="#symulacje-geostatystyczne"><span class="toc-section-number">10.1</span> Symulacje geostatystyczne</a><ul>
<li><a href="#symulacje-geostatystyczne-1"><span class="toc-section-number">10.1.1</span> Symulacje geostatystyczne</a></li>
<li><a href="#symulacje-geostatystyczne-cel"><span class="toc-section-number">10.1.2</span> Symulacje geostatystyczne | Cel</a></li>
</ul></li>
<li><a href="#typy-symulacji"><span class="toc-section-number">10.2</span> Typy symulacji</a><ul>
<li><a href="#typy-symulacji-1"><span class="toc-section-number">10.2.1</span> Typy symulacji</a></li>
</ul></li>
<li><a href="#symulacje-bezwarunkowe"><span class="toc-section-number">10.3</span> Symulacje bezwarunkowe</a></li>
<li><a href="#symulacje-warunkowe"><span class="toc-section-number">10.4</span> Symulacje warunkowe</a><ul>
<li><a href="#sekwencyjna-symulacja-gaussowska-ang.-sequential-gaussian-simulation"><span class="toc-section-number">10.4.1</span> Sekwencyjna symulacja gaussowska (ang. <em>Sequential Gaussian simulation</em>)</a></li>
<li><a href="#sekwencyjna-symulacja-gaussowska-ang.-sequential-gaussian-simulation-1"><span class="toc-section-number">10.4.2</span> Sekwencyjna symulacja gaussowska (ang. <em>Sequential Gaussian simulation</em>)</a></li>
<li><a href="#sekwencyjna-symulacja-gaussowska-ang.-sequential-gaussian-simulation-2"><span class="toc-section-number">10.4.3</span> Sekwencyjna symulacja gaussowska (ang. <em>Sequential Gaussian simulation</em>)</a></li>
</ul></li>
<li><a href="#sekwencyjna-symulacja-danych-kodowanych-ang.-sequential-indicator-simulation"><span class="toc-section-number">10.5</span> Sekwencyjna symulacja danych kodowanych (ang. <em>Sequential indicator simulation</em>)</a><ul>
<li><a href="#sekwencyjna-symulacja-danych-kodowanych-ang.-sequential-indicator-simulation-1"><span class="toc-section-number">10.5.1</span> Sekwencyjna symulacja danych kodowanych (ang. <em>Sequential indicator simulation</em>)</a></li>
</ul></li>
</ul></li>
<li><a href="#bibliografia"><span class="toc-section-number">11</span> Bibliografia</a><ul>
<li><a href="#zroda-wiedzy"><span class="toc-section-number">11.0.1</span> Źródła wiedzy</a></li>
</ul></li>
</ul>
<!--bookdown:toc2:end-->
      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Geostatystyka</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<!--bookdown:toc:end-->
<!--bookdown:body:start-->
<div id="dzien-dobry" class="section level1">
<h1><span class="header-section-number">1</span> Dzień dobry</h1>
<p>Kłaniam się.</p>
<iframe src="http://giphy.com/embed/cNb6ey1bD9uPC" width="480" height="360" frameBorder="0" class="giphy-embed" allowFullScreen>
</iframe>
<p>
<a href="http://giphy.com/gifs/george-costanza-dapper-cNb6ey1bD9uPC">via GIPHY</a>
</p>
<!--chapter:end:index.Rmd-->
</div>
<div id="intro" class="section level1">
<h1><span class="header-section-number">2</span> Wprowadzenie</h1>
<div id="suwalski-park-krajobrazowy" class="section level2">
<h2><span class="header-section-number">2.1</span> Suwalski Park Krajobrazowy</h2>
</div>
<div id="r-a-dane-przestrzenne" class="section level2">
<h2><span class="header-section-number">2.2</span> R a dane przestrzenne</h2>
<div id="pakiety" class="section level3">
<h3><span class="header-section-number">2.2.1</span> Pakiety</h3>
<ul>
<li>GIS - <strong>sp, rgdal, raster, rasterVis, rgeos, maptools, GeoXp, deldir, pgirmess</strong></li>
<li>Geostatystyka - <strong>gstat, geoR, geoRglm, fields, spBayes, RandomFields, vardiag</strong></li>
<li>Inne - <strong>ggplot2, corrplot, caret</strong></li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">install.packages</span>(<span class="kw">c</span>(<span class="st">&#39;sp&#39;</span>, <span class="st">&#39;rgdal&#39;</span>, <span class="st">&#39;raster&#39;</span>, <span class="st">&#39;rasterVis&#39;</span>, <span class="st">&#39;gstat&#39;</span>, <span class="st">&#39;ggplot2&#39;</span>, <span class="st">&#39;corrplot&#39;</span>, <span class="st">&#39;deldir&#39;</span>, <span class="st">&#39;fields&#39;</span>, <span class="st">&#39;geoR&#39;</span>, <span class="st">&#39;pgirmess&#39;</span>, <span class="st">&#39;caret&#39;</span>))</code></pre></div>
</div>
<div id="reprezentacja-danych-nieprzestrzennych" class="section level3">
<h3><span class="header-section-number">2.2.2</span> Reprezentacja danych nieprzestrzennych</h3>
<ul>
<li>Wektory (ang. <em>vector</em>):
<ul>
<li>liczbowe (ang. <em>integer</em>, <em>numeric</em>) - c(1, 2, 3) i c(1.21, 3.32, 4.43)</li>
<li>znakowe (ang. <em>character</em>) - c(‘jeden’, ‘dwa’, ‘trzy’)</li>
<li>logiczne (ang. <em>logical</em>) - c(TRUE, FALSE)</li>
<li>czynnikowe (ang. <em>factor</em>) - c(‘jeden’, ‘dwa’, ‘trzy’, ‘jeden’)</li>
</ul></li>
<li>Ramki danych (ang. <em>data.frame</em>) - to zbiór zmiennych (kolumn) oraz obserwacji (wierszy) zawierających różne typy danych</li>
<li>Macierze (ang. <em>matrix</em>)</li>
<li>Listy (ang. <em>list</em>)</li>
</ul>
</div>
<div id="reprezentacja-danych-przestrzennych" class="section level3">
<h3><span class="header-section-number">2.2.3</span> Reprezentacja danych przestrzennych</h3>
<ul>
<li>Obiekty klasy Spatial* - wszystkie z nich zawierają dwie dodatkowe informacje:
<ul>
<li>bounding box (bbox) - obwiednia - określa zasięg danych</li>
<li>CRS (proj4string) - układ współrzędnych</li>
</ul></li>
<li>Najczęściej stosowane obiekty klasy Spatial* to SpatialPointsDataFrame, SpatialPolygonsDataFrame oraz SpatialGridDataFrame</li>
<li>Obiekty klasy Raster, tj. RasterLayer, RasterStack, RasterBrick</li>
<li>Inne</li>
</ul>
</div>
<div id="gdalogr" class="section level3">
<h3><span class="header-section-number">2.2.4</span> GDAL/OGR</h3>
<ul>
<li><a href="http://www.gdal.org/" class="uri">http://www.gdal.org/</a></li>
<li>GDAL to biblioteka zawierająca funkcje służące do odczytywania i zapiswania danych w formatach rastrowych</li>
<li>OGR to bibioteka służąca to odczytywania i zapiswania danych w formatach wektorowych</li>
<li>Pakiet <strong>rgdal</strong> pozwala na wykorzystanie bibliotek GDAL/OGR w R</li>
</ul>
</div>
<div id="proj.4" class="section level3">
<h3><span class="header-section-number">2.2.5</span> PROJ.4</h3>
<ul>
<li>Dane przestrzenne powinny być zawsze powiązane z układem współrzednych</li>
<li>PROJ.4 - to biblioteka pozwalająca na identyfiację oraz konwersję pomiędzy różnymi układami współrzędnych <a href="http://www.spatialreference.org/" class="uri">http://www.spatialreference.org/</a></li>
</ul>
</div>
<div id="epsg" class="section level3">
<h3><span class="header-section-number">2.2.6</span> EPSG</h3>
<ul>
<li>Kod EPSG (ang. <em>European Petroleum Survey Group</em>) pozwala na łatwe identyfikowanie układów współrzędnych</li>
<li>Przykładowo, układ PL 1992 może być określony jako:</li>
</ul>
<p>“+proj=tmerc +lat_0=0 +lon_0=19 +k=0.9993 +x_0=500000 +y_0=-5300000 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs”</p>
<p>lub</p>
<p>“+init=epsg:2180”</p>
</div>
<div id="ukad-geograficzny" class="section level3">
<h3><span class="header-section-number">2.2.7</span> Układ geograficzny</h3>
<ul>
<li>Proporcje pomiędzy współrzedną X (długość) a Y (szerokość) nie są 1:1</li>
<li>Wielkość oczka siatki jest zmienna</li>
<li>Nie pozwala na proste określanie odległości czy powierzchni</li>
<li><p>Jednostka mapy jest abstrakcyjna</p></li>
<li><p>Do większości algorytmów w geostatystyce wykorzystywane są układy prostokątne płaskie</p></li>
</ul>
</div>
</div>
<div id="import-danych" class="section level2">
<h2><span class="header-section-number">2.3</span> Import danych</h2>
<div id="dane-punktowe-format-csv" class="section level3">
<h3><span class="header-section-number">2.3.1</span> Dane punktowe (format csv)</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&#39;sp&#39;</span>)
dane_punktowe &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&#39;dane/punkty.csv&#39;</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(dane_punktowe)</code></pre></div>
<pre><code>##       srtm clc     temp      ndvi      savi        x        y
## 1 184.4150   1 17.82931 0.5490699 0.3642284 752244.9 716188.1
## 2 220.3998   2 16.76045 0.6070772 0.3425520 751900.9 714991.4
## 3 242.2178   2 10.08023 0.5999830 0.3975228 750204.8 718884.6
## 4 204.4045   1 18.60791 0.7228759 0.4889487 753276.1 714766.4
## 5 202.6243   1 17.85643 0.4998576 0.3347926 753895.0 720630.3
## 6 196.3847   1 20.45337 0.5463166 0.3275971 754495.3 715109.0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">coordinates</span>(dane_punktowe) &lt;-<span class="st"> </span><span class="er">~</span>x+y
<span class="kw">summary</span>(dane_punktowe)</code></pre></div>
<pre><code>## Object of class SpatialPointsDataFrame
## Coordinates:
##        min      max
## x 745573.7 756977.8
## y 712659.1 721228.1
## Is projected: NA 
## proj4string : [NA]
## Number of points: 244
## Data attributes:
##       srtm            clc             temp             ndvi       
##  Min.   :145.0   Min.   :1.000   Min.   : 7.805   Min.   :0.1465  
##  1st Qu.:188.5   1st Qu.:1.000   1st Qu.:12.192   1st Qu.:0.4590  
##  Median :213.2   Median :1.000   Median :15.134   Median :0.5163  
##  Mean   :211.6   Mean   :1.418   Mean   :15.324   Mean   :0.5033  
##  3rd Qu.:236.7   3rd Qu.:2.000   3rd Qu.:17.343   3rd Qu.:0.5660  
##  Max.   :283.0   Max.   :4.000   Max.   :26.072   Max.   :0.7229  
##       savi        
##  Min.   :0.04552  
##  1st Qu.:0.29080  
##  Median :0.32742  
##  Mean   :0.32071  
##  3rd Qu.:0.36468  
##  Max.   :0.48895</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">proj4string</span>(dane_punktowe) &lt;-<span class="st"> &#39;+init=epsg:2180&#39;</span>
<span class="kw">summary</span>(dane_punktowe)</code></pre></div>
<pre><code>## Object of class SpatialPointsDataFrame
## Coordinates:
##        min      max
## x 745573.7 756977.8
## y 712659.1 721228.1
## Is projected: TRUE 
## proj4string :
## [+init=epsg:2180 +proj=tmerc +lat_0=0 +lon_0=19 +k=0.9993
## +x_0=500000 +y_0=-5300000 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0
## +units=m +no_defs]
## Number of points: 244
## Data attributes:
##       srtm            clc             temp             ndvi       
##  Min.   :145.0   Min.   :1.000   Min.   : 7.805   Min.   :0.1465  
##  1st Qu.:188.5   1st Qu.:1.000   1st Qu.:12.192   1st Qu.:0.4590  
##  Median :213.2   Median :1.000   Median :15.134   Median :0.5163  
##  Mean   :211.6   Mean   :1.418   Mean   :15.324   Mean   :0.5033  
##  3rd Qu.:236.7   3rd Qu.:2.000   3rd Qu.:17.343   3rd Qu.:0.5660  
##  Max.   :283.0   Max.   :4.000   Max.   :26.072   Max.   :0.7229  
##       savi        
##  Min.   :0.04552  
##  1st Qu.:0.29080  
##  Median :0.32742  
##  Mean   :0.32071  
##  3rd Qu.:0.36468  
##  Max.   :0.48895</code></pre>
<!--
### Usuwanie punktów zawierających braki wartości


```r
sp_na_omit <- function(x, margin=1) {
    if (!inherits(x, "SpatialPointsDataFrame") & !inherits(x, "SpatialPolygonsDataFrame")) 
        stop("MUST BE sp SpatialPointsDataFrame OR SpatialPolygonsDataFrame CLASS OBJECT") 
    na.index <- unique(as.data.frame(which(is.na(x@data),arr.ind=TRUE))[,margin])
    if(margin == 1) {  
        cat("DELETING ROWS: ", na.index, "\n") 
        return( x[-na.index,]  ) 
    }
    if(margin == 2) {  
        cat("DELETING COLUMNS: ", na.index, "\n") 
        return( x[,-na.index]  ) 
    }
}
# wolin_lato_los2 <- sp_na_omit(wolin_lato_los) 
# summary(wolin_lato_los2)
```
-->
</div>
<div id="dane-poligonowe-formaty-gisowe" class="section level3">
<h3><span class="header-section-number">2.3.2</span> Dane poligonowe (formaty gisowe)</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&#39;rgdal&#39;</span>)</code></pre></div>
<pre><code>## Loading required package: methods</code></pre>
<pre><code>## rgdal: version: 1.1-3, (SVN revision 594)
##  Geospatial Data Abstraction Library extensions to R successfully loaded
##  Loaded GDAL runtime: GDAL 1.11.2, released 2015/02/10
##  Path to GDAL shared files: /usr/share/gdal/1.11
##  Loaded PROJ.4 runtime: Rel. 4.8.0, 6 March 2012, [PJ_VERSION: 480]
##  Path to PROJ.4 shared files: (autodetected)
##  Linking to sp version: 1.2-1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">granica &lt;-<span class="st"> </span><span class="kw">readOGR</span>(<span class="dt">dsn=</span><span class="st">&#39;dane&#39;</span>, <span class="dt">layer=</span><span class="st">&#39;granica&#39;</span>, <span class="dt">verbose=</span><span class="ot">FALSE</span>)
<span class="kw">plot</span>(granica)</code></pre></div>
<p><img src="01-wprowadzenie_files/figure-html/unnamed-chunk-6-1.png" alt="" /><!-- --></p>
</div>
<div id="rastry" class="section level3">
<h3><span class="header-section-number">2.3.3</span> Rastry</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&#39;raster&#39;</span>)
siatka_raster &lt;-<span class="st"> </span><span class="kw">raster</span>(<span class="st">&quot;dane/siatka.tif&quot;</span>)
<span class="kw">plot</span>(siatka_raster)</code></pre></div>
<p><img src="01-wprowadzenie_files/figure-html/unnamed-chunk-7-1.png" alt="" /><!-- --></p>
</div>
</div>
<div id="eksport-danych" class="section level2">
<h2><span class="header-section-number">2.4</span> Eksport danych</h2>
<div id="zapisywanie-danych-wektorowych" class="section level3">
<h3><span class="header-section-number">2.4.1</span> Zapisywanie danych wektorowych</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&#39;rgdal&#39;</span>)
<span class="kw">writeOGR</span>(poligon, <span class="dt">dsn=</span><span class="st">&quot;nazwa_folderu&quot;</span>, <span class="dt">layer=</span><span class="st">&quot;nowy_poligon&quot;</span>, <span class="dt">driver=</span><span class="st">&quot;ESRI Shapefile&quot;</span>)</code></pre></div>
</div>
<div id="zapisywanie-danych-rastrowych" class="section level3">
<h3><span class="header-section-number">2.4.2</span> Zapisywanie danych rastrowych</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&#39;raster&#39;</span>)
<span class="kw">writeRaster</span>(siatka_raster, <span class="dt">filename=</span><span class="st">&quot;nazwa_folderu/nowy_raster.tif&quot;</span>)</code></pre></div>
</div>
</div>
<div id="wizualizacja-danych-2d" class="section level2">
<h2><span class="header-section-number">2.5</span> Wizualizacja danych 2D</h2>
<div id="dane-punktowe" class="section level3">
<h3><span class="header-section-number">2.5.1</span> Dane punktowe</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">spplot</span>(dane_punktowe, <span class="st">&quot;temp&quot;</span>)</code></pre></div>
<p><img src="01-wprowadzenie_files/figure-html/unnamed-chunk-8-1.png" alt="" /><!-- --></p>
</div>
<div id="dane-punktowe-1" class="section level3">
<h3><span class="header-section-number">2.5.2</span> Dane punktowe</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">spplot</span>(dane_punktowe, <span class="st">&quot;srtm&quot;</span>)</code></pre></div>
<p><img src="01-wprowadzenie_files/figure-html/unnamed-chunk-9-1.png" alt="" /><!-- --></p>
</div>
<div id="dane-punktowe---kategorie" class="section level3">
<h3><span class="header-section-number">2.5.3</span> Dane punktowe - kategorie</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dane_punktowe@data$clc &lt;-<span class="st"> </span><span class="kw">as.factor</span>(dane_punktowe@data$clc)
<span class="kw">spplot</span>(dane_punktowe, <span class="st">&quot;clc&quot;</span>)</code></pre></div>
<p><img src="01-wprowadzenie_files/figure-html/unnamed-chunk-10-1.png" alt="" /><!-- --></p>
</div>
<div id="rastry-1" class="section level3">
<h3><span class="header-section-number">2.5.4</span> Rastry</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&#39;raster&#39;</span>)
<span class="kw">library</span>(<span class="st">&#39;rasterVis&#39;</span>)
<span class="kw">levelplot</span>(siatka_raster, <span class="dt">margin=</span><span class="ot">FALSE</span>)</code></pre></div>
<p><img src="01-wprowadzenie_files/figure-html/unnamed-chunk-11-1.png" alt="" /><!-- --></p>
</div>
</div>
<div id="tworzenie-siatek" class="section level2">
<h2><span class="header-section-number">2.6</span> Tworzenie siatek</h2>
<div id="siatki-regularne" class="section level3">
<h3><span class="header-section-number">2.6.1</span> Siatki regularne</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">bbox</span>(dane_punktowe)</code></pre></div>
<pre><code>##        min      max
## x 745573.7 756977.8
## y 712659.1 721228.1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">extent</span>(dane_punktowe)</code></pre></div>
<pre><code>## class       : Extent 
## xmin        : 745573.7 
## xmax        : 756977.8 
## ymin        : 712659.1 
## ymax        : 721228.1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">siatka &lt;-<span class="st"> </span><span class="kw">expand.grid</span>(<span class="dt">x =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">745050</span>, <span class="dt">to =</span> <span class="dv">757050</span>, <span class="dt">by =</span> <span class="dv">500</span>),
                      <span class="dt">y =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">712650</span>, <span class="dt">to =</span> <span class="dv">721650</span>, <span class="dt">by =</span> <span class="dv">500</span>))
<span class="kw">coordinates</span>(siatka) &lt;-<span class="st"> </span><span class="er">~</span>x +<span class="st"> </span>y
<span class="kw">gridded</span>(siatka) &lt;-<span class="st"> </span><span class="ot">TRUE</span>
<span class="kw">proj4string</span>(siatka) &lt;-<span class="st"> </span><span class="kw">proj4string</span>(dane_punktowe)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">siatka &lt;-<span class="st"> </span><span class="kw">makegrid</span>(dane_punktowe, <span class="dt">cellsize=</span><span class="dv">500</span>)
<span class="kw">names</span>(siatka) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;x&#39;</span>, <span class="st">&#39;y&#39;</span>)
<span class="kw">coordinates</span>(siatka) &lt;-<span class="st"> </span><span class="er">~</span>x +<span class="st"> </span>y
<span class="kw">gridded</span>(siatka) &lt;-<span class="st"> </span><span class="ot">TRUE</span>
<span class="kw">proj4string</span>(siatka) &lt;-<span class="st"> </span><span class="kw">proj4string</span>(dane_punktowe)</code></pre></div>
</div>
<div id="siatki-regularne-1" class="section level3">
<h3><span class="header-section-number">2.6.2</span> Siatki regularne</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(siatka)
<span class="kw">plot</span>(dane_punktowe, <span class="dt">add=</span><span class="ot">TRUE</span>)</code></pre></div>
<p><img src="01-wprowadzenie_files/figure-html/unnamed-chunk-15-1.png" alt="" /><!-- --></p>
</div>
<div id="siatki-nieregularne" class="section level3">
<h3><span class="header-section-number">2.6.3</span> Siatki nieregularne</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&#39;raster&#39;</span>)
granica &lt;-<span class="st"> </span><span class="kw">readOGR</span>(<span class="dt">dsn=</span><span class="st">&#39;dane&#39;</span>, <span class="dt">layer=</span><span class="st">&#39;granica&#39;</span>)</code></pre></div>
<pre><code>## OGR data source with driver: ESRI Shapefile 
## Source: &quot;dane&quot;, layer: &quot;granica&quot;
## with 1 features
## It has 3 fields</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">siatka_n &lt;-<span class="st"> </span><span class="kw">raster</span>(<span class="kw">extent</span>(granica))
<span class="kw">res</span>(siatka_n) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">500</span>, <span class="dv">500</span>)
siatka_n[] &lt;-<span class="st"> </span><span class="dv">0</span>
<span class="kw">proj4string</span>(siatka_n) &lt;-<span class="st"> </span><span class="kw">proj4string</span>(granica)
siatka_n &lt;-<span class="st"> </span><span class="kw">mask</span>(siatka_n, granica)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">levelplot</span>(siatka_n, <span class="dt">margin=</span><span class="ot">FALSE</span>)</code></pre></div>
<p><img src="01-wprowadzenie_files/figure-html/unnamed-chunk-17-1.png" alt="" /><!-- --></p>
</div>
<div id="siatki-nieregularne-1" class="section level3">
<h3><span class="header-section-number">2.6.4</span> Siatki nieregularne</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">siatka_n &lt;-<span class="st"> </span><span class="kw">as</span>(siatka_n, <span class="st">&#39;SpatialPointsDataFrame&#39;</span>)
siatka_n &lt;-<span class="st"> </span>siatka_n[!<span class="kw">is.na</span>(siatka_n@data$layer), ]
<span class="kw">gridded</span>(siatka_n) &lt;-<span class="st"> </span><span class="ot">TRUE</span>
<span class="kw">plot</span>(siatka_n)</code></pre></div>
<p><img src="01-wprowadzenie_files/figure-html/unnamed-chunk-18-1.png" alt="" /><!-- --></p>
<!--chapter:end:01-wprowadzenie.Rmd-->
</div>
</div>
</div>
<div id="eksploracyjna-analiza-danych" class="section level1">
<h1><span class="header-section-number">3</span> Eksploracyjna analiza danych</h1>
<div id="eksploracyjna-analiza-danych-cel" class="section level2">
<h2><span class="header-section-number">3.1</span> Eksploracyjna analiza danych | Cel</h2>
<ul>
<li>Ogólna charakterystyka danych oraz badanego zjawiska</li>
<li>Określenie przestrzennego/czasowego typu próbkowania</li>
<li>Informacja o relacji pomiędzy lokalizacją obserwacji a czynnikami wpływającymi na zmienność przestrzenną cechy</li>
</ul>
</div>
<div id="dane-wolin" class="section level2">
<h2><span class="header-section-number">3.2</span> Dane Wolin</h2>
<div id="dane-wolin-1" class="section level3">
<h3><span class="header-section-number">3.2.1</span> Dane Wolin</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&#39;sp&#39;</span>)
<span class="kw">library</span>(<span class="st">&#39;rgdal&#39;</span>)
punkty &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&#39;dane/punkty.csv&#39;</span>)
<span class="kw">coordinates</span>(punkty) &lt;-<span class="st"> </span><span class="er">~</span>x+y

<span class="kw">proj4string</span>(punkty) &lt;-<span class="st"> &#39;+init=epsg:2180&#39;</span>
<span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">4</span>)))
<span class="kw">plot</span>(punkty)

<span class="kw">str</span>(punkty)</code></pre></div>
<pre><code>## Formal class &#39;SpatialPointsDataFrame&#39; [package &quot;sp&quot;] with 5 slots
##   ..@ data       :&#39;data.frame&#39;:  244 obs. of  5 variables:
##   .. ..$ srtm: num [1:244] 184 220 242 204 203 ...
##   .. ..$ clc : int [1:244] 1 2 2 1 1 1 2 2 4 4 ...
##   .. ..$ temp: num [1:244] 17.8 16.8 10.1 18.6 17.9 ...
##   .. ..$ ndvi: num [1:244] 0.549 0.607 0.6 0.723 0.5 ...
##   .. ..$ savi: num [1:244] 0.364 0.343 0.398 0.489 0.335 ...
##   ..@ coords.nrs : int [1:2] 6 7
##   ..@ coords     : num [1:244, 1:2] 752245 751901 750205 753276 753895 ...
##   .. ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. .. ..$ : chr [1:244] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...
##   .. .. ..$ : chr [1:2] &quot;x&quot; &quot;y&quot;
##   ..@ bbox       : num [1:2, 1:2] 745574 712659 756978 721228
##   .. ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. .. ..$ : chr [1:2] &quot;x&quot; &quot;y&quot;
##   .. .. ..$ : chr [1:2] &quot;min&quot; &quot;max&quot;
##   ..@ proj4string:Formal class &#39;CRS&#39; [package &quot;sp&quot;] with 1 slot
##   .. .. ..@ projargs: chr &quot;+init=epsg:2180 +proj=tmerc +lat_0=0 +lon_0=19 +k=0.9993 +x_0=500000 +y_0=-5300000 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m&quot;| __truncated__</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(punkty@data)</code></pre></div>
<pre><code>## &#39;data.frame&#39;:    244 obs. of  5 variables:
##  $ srtm: num  184 220 242 204 203 ...
##  $ clc : int  1 2 2 1 1 1 2 2 4 4 ...
##  $ temp: num  17.8 16.8 10.1 18.6 17.9 ...
##  $ ndvi: num  0.549 0.607 0.6 0.723 0.5 ...
##  $ savi: num  0.364 0.343 0.398 0.489 0.335 ...</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">granica &lt;-<span class="st"> </span><span class="kw">readOGR</span>(<span class="st">&#39;dane&#39;</span>, <span class="st">&#39;granica&#39;</span>)</code></pre></div>
<pre><code>## OGR data source with driver: ESRI Shapefile 
## Source: &quot;dane&quot;, layer: &quot;granica&quot;
## with 1 features
## It has 3 fields</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(granica, <span class="dt">add=</span><span class="ot">TRUE</span>)</code></pre></div>
<p><img src="02-eksp_analiza_danych_files/figure-html/unnamed-chunk-1-1.png" alt="" /><!-- --></p>
</div>
</div>
<div id="statystyki-opisowe" class="section level2">
<h2><span class="header-section-number">3.3</span> Statystyki opisowe</h2>
<div id="statystyki-opisowe-1" class="section level3">
<h3><span class="header-section-number">3.3.1</span> Statystyki opisowe</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(punkty@data)</code></pre></div>
<pre><code>##       srtm            clc             temp             ndvi       
##  Min.   :145.0   Min.   :1.000   Min.   : 7.805   Min.   :0.1465  
##  1st Qu.:188.5   1st Qu.:1.000   1st Qu.:12.192   1st Qu.:0.4590  
##  Median :213.2   Median :1.000   Median :15.134   Median :0.5163  
##  Mean   :211.6   Mean   :1.418   Mean   :15.324   Mean   :0.5033  
##  3rd Qu.:236.7   3rd Qu.:2.000   3rd Qu.:17.343   3rd Qu.:0.5660  
##  Max.   :283.0   Max.   :4.000   Max.   :26.072   Max.   :0.7229  
##       savi        
##  Min.   :0.04552  
##  1st Qu.:0.29080  
##  Median :0.32742  
##  Mean   :0.32071  
##  3rd Qu.:0.36468  
##  Max.   :0.48895</code></pre>
</div>
<div id="statystyki-opisowe-srednia-i-mediana" class="section level3">
<h3><span class="header-section-number">3.3.2</span> Statystyki opisowe | średnia i mediana</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">median</span>(punkty$temp, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## [1] 15.13433</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>(punkty$temp, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## [1] 15.32378</code></pre>
</div>
<div id="statystyki-opisowe-srednia-i-mediana-1" class="section level3">
<h3><span class="header-section-number">3.3.3</span> Statystyki opisowe | średnia i mediana</h3>
<ul>
<li>w wypadku symetrycznego rozkładu te dwie cechy są równe</li>
<li>średnia jest bardziej wrażliwa na wartości odstające</li>
<li>mediana jest lepszą miarą środka danych, jeżeli są one skośne</li>
</ul>
<p>Po co używać średniej?</p>
<ul>
<li>przydatniejsza w przypadku małych zbiorów danych</li>
<li>gdy rozkład danych jest symetryczny</li>
<li>(jednak) często warto podawać obie miary</li>
</ul>
</div>
<div id="statystyki-opisowe-minimum-i-maksimum" class="section level3">
<h3><span class="header-section-number">3.3.4</span> Statystyki opisowe | minimum i maksimum</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">min</span>(punkty$temp, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## [1] 7.804768</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">max</span>(punkty$temp, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## [1] 26.07235</code></pre>
</div>
<div id="statystyki-opisowe-ochylenie-standardowe" class="section level3">
<h3><span class="header-section-number">3.3.5</span> Statystyki opisowe | ochylenie standardowe</h3>
<div class="figure">
<img src="figs/sd.png" alt="" />

</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sd</span>(punkty$temp, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## [1] 3.883714</code></pre>
</div>
</div>
<div id="wykresy" class="section level2">
<h2><span class="header-section-number">3.4</span> Wykresy</h2>
<div id="histogram" class="section level3">
<h3><span class="header-section-number">3.4.1</span> Histogram</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&#39;ggplot2&#39;</span>)
<span class="kw">ggplot</span>(punkty@data, <span class="kw">aes</span>(temp)) +<span class="st"> </span><span class="kw">geom_histogram</span>()</code></pre></div>
<p><img src="02-eksp_analiza_danych_files/figure-html/unnamed-chunk-6-1.png" alt="" /><!-- --></p>
<ul>
<li>Stworzony przez Karla Pearsona</li>
<li>Jest graficzną reprezentacją rozkładu <br> danych</li>
<li>Wartości danych są łączone w przedziały (na osi poziomej) a na osi pionowej jest ukazana liczba punktów (obserwacji) w każdym przedziale</li>
<li>Różny dobór przedziałów może dawać inną informację</li>
<li>W pakiecie ggplot2, domyślnie przedział to zakres/30</li>
</ul>
</div>
<div id="estymator-jadrowy-gestosci-ang.-kernel-density-estimation" class="section level3">
<h3><span class="header-section-number">3.4.2</span> Estymator jądrowy gęstości (ang. <em>kernel density estimation</em>)</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(punkty@data, <span class="kw">aes</span>(temp)) +<span class="st"> </span><span class="kw">geom_density</span>()</code></pre></div>
<p><img src="02-eksp_analiza_danych_files/figure-html/unnamed-chunk-7-1.png" alt="" /><!-- --></p>
</div>
<div id="wykresy-kwantyl-kwantyl-ang.quantile-quantile" class="section level3">
<h3><span class="header-section-number">3.4.3</span> Wykresy kwantyl-kwantyl (ang.<em>quantile-quantile</em>)</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(punkty@data, <span class="kw">aes</span>(<span class="dt">sample=</span>temp)) +<span class="st"> </span><span class="kw">stat_qq</span>()</code></pre></div>
<p><img src="02-eksp_analiza_danych_files/figure-html/unnamed-chunk-8-1.png" alt="" /><!-- --></p>
</div>
<div id="wykresy-kwantyl-kwantyl-ang.-quantile-quantile" class="section level3">
<h3><span class="header-section-number">3.4.4</span> Wykresy kwantyl-kwantyl (ang. <em>quantile-quantile</em>)</h3>
<p><a href="http://stats.stackexchange.com/questions/101274/how-to-interpret-a-qq-plot" class="uri">http://stats.stackexchange.com/questions/101274/how-to-interpret-a-qq-plot</a> <img src="figs/qq.png" alt="http://stats.stackexchange.com/questions/101274/how-to-interpret-a-qq-plot" /></p>
<!--    
## [analiza typu rozkładu jednej zmiennej i porównanie rozkładów dwóch zmiennych (wykresy q-q i p-p)]
    


```r
df <- as.data.frame(qqplot(punkty$temp, punkty$X1999.09.13_NDVI, plot.it=FALSE))
ggplot(df) + geom_point(aes(x=x, y=y)) + xlab('TPZ') + ylab('NDVI')

ggplot(punkty@data) + geom_point(aes(x=temp, y=X1999.09.13_NDVI)) + xlab('TPZ') + ylab('NDVI')
```

-->
</div>
<div id="dystrybuanta-cdf" class="section level3">
<h3><span class="header-section-number">3.4.5</span> Dystrybuanta (CDF)</h3>
<ul>
<li>Dystrybuanta (ang. conditional density function - CDF) wyświetla prawdopodobieństwo, że wartość zmiennej przewidywanej jest mniejsza lub równa określonej wartości</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(punkty@data, <span class="kw">aes</span>(temp)) +<span class="st"> </span><span class="kw">stat_ecdf</span>()</code></pre></div>
<p><img src="02-eksp_analiza_danych_files/figure-html/unnamed-chunk-10-1.png" alt="" /><!-- --></p>
</div>
</div>
<div id="porownanie-zmiennych" class="section level2">
<h2><span class="header-section-number">3.5</span> Porównanie zmiennych</h2>
<div id="kowariancja" class="section level3">
<h3><span class="header-section-number">3.5.1</span> Kowariancja</h3>
<ul>
<li>Kowariancja jest nieunormowaną miarą zależności liniowej pomiędzy dwiema zmiennymi</li>
<li>Kowariancja dwóch zmiennych <span class="math inline">\(x\)</span> i <span class="math inline">\(y\)</span> pokazuje jak dwie zmienne są ze sobą liniowo powiązane</li>
<li>Dodatnia kowariancja wzkazuje na pozytywną relację liniową pomiędzy zmiennymi, podczas gdy ujemna kowariancja świadczy o odwrotnej sytuacji</li>
<li>Jeżeli zmienne nie są ze sobą liniowo powiązane, wartość kowariacji jest bliska zeru</li>
<li>Inaczej mówiąc, kowariancja stanowi miarę wspólnej zmienności dwóch zmiennych<br />
</li>
<li>Wielkość samej kowariancji uzależniona jest od przyjętej skali zmiennej (jednostki)</li>
<li>Inne wyniku uzyskamy (przy tej samej zależności pomiędzy parą zmiennych), gdy będziemy analizować wyniki np. wieku i dochodu w złotówkach a inne dla wieku i dochodu w dolarach</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cov</span>(punkty$temp, punkty$ndvi, <span class="dt">use=</span> <span class="st">&quot;complete.obs&quot;</span>)</code></pre></div>
<pre><code>## [1] 0.03160881</code></pre>
</div>
<div id="wspoczynnik-korelacji" class="section level3">
<h3><span class="header-section-number">3.5.2</span> Współczynnik korelacji</h3>
<ul>
<li>Wspołczynnik korelacji to unormowana miara zależności pomiędzy dwiema zmiennymi, przyjmująca wartości od -1 do 1</li>
<li>Współczynnik korelacji jest uzyskiwany poprzez podzielenie wartości kowariancji przez odchylenie standardowe wyników</li>
<li>Z racji unormowania nie jest ona uzależniona od jednostki</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(punkty@data, <span class="kw">aes</span>(temp, ndvi)) +<span class="st"> </span><span class="kw">geom_point</span>()</code></pre></div>
<p><img src="02-eksp_analiza_danych_files/figure-html/unnamed-chunk-12-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cor</span>(punkty$temp, punkty$ndvi, <span class="dt">use=</span>  <span class="st">&quot;complete.obs&quot;</span>)</code></pre></div>
<pre><code>## [1] 0.0852945</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cor.test</span>(punkty$temp, punkty$ndvi)</code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  punkty$temp and punkty$ndvi
## t = 1.3317, df = 242, p-value = 0.1842
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  -0.04072759  0.20864535
## sample estimates:
##       cor 
## 0.0852945</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cor</span>(punkty@data[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>:<span class="dv">5</span>)], <span class="dt">use=</span> <span class="st">&quot;complete.obs&quot;</span>)</code></pre></div>
<pre><code>##             srtm        temp      ndvi       savi
## srtm  1.00000000 -0.14468277 0.1054047 0.08462306
## temp -0.14468277  1.00000000 0.0852945 0.06513805
## ndvi  0.10540468  0.08529450 1.0000000 0.94461511
## savi  0.08462306  0.06513805 0.9446151 1.00000000</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&#39;corrplot&#39;</span>)
<span class="kw">corrplot</span>(<span class="kw">cor</span>(punkty@data[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>:<span class="dv">5</span>)], <span class="dt">use=</span> <span class="st">&quot;complete.obs&quot;</span>))</code></pre></div>
<p><img src="02-eksp_analiza_danych_files/figure-html/unnamed-chunk-15-1.png" alt="" /><!-- --></p>
</div>
<div id="wykresy-pudekowe" class="section level3">
<h3><span class="header-section-number">3.5.3</span> Wykresy pudełkowe</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">punkty$clc &lt;-<span class="st"> </span><span class="kw">as.factor</span>(punkty$clc)
<span class="kw">ggplot</span>(punkty@data, <span class="kw">aes</span>(clc, temp)) +<span class="st"> </span><span class="kw">geom_boxplot</span>()</code></pre></div>
<p><img src="02-eksp_analiza_danych_files/figure-html/unnamed-chunk-16-1.png" alt="" /><!-- --></p>
<ul>
<li>obrazuje pięc podstawowych <br> statystyk opisowych oraz wartości odstające</li>
<li>pudełko to zakres międzykwantylowy</li>
<li>linie oznaczają najbardziej ekstremalne wartości, ale nie odstające. Górna to 1,5*IQR ponad krawędź pudełka, dolna to 1,5*IQR poniżej wartości dolnej krawędzi pudełka</li>
<li>linia środkowa to mediana</li>
</ul>
<!--
1. Tereny komunikacyjne i porty
2. Zabudowa luźna, złożone systemy upraw i działek
3. Grunty orne, Łąki
4. Lasy liściaste,  Lasy iglaste, mieszane
5. Bagna, Torfowiska
6. Zbiorniki wodne
-->
</div>
<div id="testowanie-istotnosci-roznic-sredniej-pomiedzy-grupami" class="section level3">
<h3><span class="header-section-number">3.5.4</span> Testowanie istotności różnić średniej pomiędzy grupami</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">punkty$clc &lt;-<span class="st"> </span><span class="kw">as.factor</span>(punkty$clc)
aov_test &lt;-<span class="st"> </span><span class="kw">aov</span>(temp~clc, <span class="dt">data=</span>punkty)
<span class="kw">summary</span>(aov_test)</code></pre></div>
<pre><code>##              Df Sum Sq Mean Sq F value Pr(&gt;F)    
## clc           2   1098   549.1   51.55 &lt;2e-16 ***
## Residuals   241   2567    10.7                   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<div id="testowanie-istotnosci-roznic-sredniej-pomiedzy-grupami-1" class="section level3">
<h3><span class="header-section-number">3.5.5</span> Testowanie istotności różnić średniej pomiędzy grupami</h3>
<pre><code>## null device 
##           1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tukey &lt;-<span class="st"> </span><span class="kw">TukeyHSD</span>(aov_test, <span class="st">&quot;clc&quot;</span>)
<span class="kw">plot</span>(tukey, <span class="dt">las=</span><span class="dv">1</span>)</code></pre></div>
<p><img src="02-eksp_analiza_danych_files/figure-html/unnamed-chunk-19-1.png" alt="" /><!-- --></p>
</div>
</div>
<div id="transformacje-danych" class="section level2">
<h2><span class="header-section-number">3.6</span> Transformacje danych</h2>
<div id="transformacje-danych-1" class="section level3">
<h3><span class="header-section-number">3.6.1</span> Transformacje danych</h3>
<ul>
<li>Transformacja danych może mieć na celu ułatwienie porównywania różnych zmiennych, zniwelowanie skośności rozkładu lub też zmniejszenie wpływu danych odstających</li>
<li>Centrowanie i skalowanie (standaryzacja):
<ul>
<li>Centrowanie danych - wybierana jest przeciętna wartość predyktora, a następnie od wszystkich wartości predyktorów odejmowana jest wybrana wcześniej wartość</li>
<li>Skalowanie danych - dzielenie każdej wartości predyktora przez jego odchylenie standardowe</li>
<li>Wadą tego podjeścia jest główne zmniejszenie interpretowalności pojedynczych wartości</li>
</ul></li>
<li>Redukcja skośności:
<ul>
<li>Logarytmizacja</li>
<li>Pierwiastkowanie</li>
<li>Rodzina transformacji Boxa Coxa</li>
<li>Inne</li>
</ul></li>
</ul>
</div>
<div id="transformacja-danych-logarytmizacja" class="section level3">
<h3><span class="header-section-number">3.6.2</span> Transformacja danych | Logarytmizacja</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(punkty@data, <span class="kw">aes</span>(temp)) +<span class="st"> </span><span class="kw">geom_density</span>()</code></pre></div>
<p><img src="02-eksp_analiza_danych_files/figure-html/unnamed-chunk-20-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">punkty$log_tpz &lt;-<span class="st"> </span><span class="kw">log</span>(punkty$temp)
<span class="kw">ggplot</span>(punkty@data, <span class="kw">aes</span>(log_tpz)) +<span class="st"> </span><span class="kw">geom_density</span>()</code></pre></div>
<p><img src="02-eksp_analiza_danych_files/figure-html/unnamed-chunk-20-2.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">punkty$exp_tpz &lt;-<span class="st"> </span><span class="kw">exp</span>(punkty$log_tpz)
<span class="kw">ggplot</span>(punkty@data, <span class="kw">aes</span>(exp_tpz)) +<span class="st"> </span><span class="kw">geom_density</span>()</code></pre></div>
<p><img src="02-eksp_analiza_danych_files/figure-html/unnamed-chunk-20-3.png" alt="" /><!-- --></p>
</div>
<div id="transformacja-danych-pierwiastkowanie" class="section level3">
<h3><span class="header-section-number">3.6.3</span> Transformacja danych | Pierwiastkowanie</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(punkty@data, <span class="kw">aes</span>(temp)) +<span class="st"> </span><span class="kw">geom_density</span>()</code></pre></div>
<p><img src="02-eksp_analiza_danych_files/figure-html/unnamed-chunk-21-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">punkty$sqrt_tpz &lt;-<span class="st"> </span><span class="kw">sqrt</span>(punkty$temp)
<span class="kw">ggplot</span>(punkty@data, <span class="kw">aes</span>(sqrt_tpz)) +<span class="st"> </span><span class="kw">geom_density</span>()</code></pre></div>
<p><img src="02-eksp_analiza_danych_files/figure-html/unnamed-chunk-21-2.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">punkty$pow_tpz &lt;-<span class="st"> </span>punkty$sqrt_tpz^<span class="dv">2</span>
<span class="kw">ggplot</span>(punkty@data, <span class="kw">aes</span>(pow_tpz)) +<span class="st"> </span><span class="kw">geom_density</span>()</code></pre></div>
<p><img src="02-eksp_analiza_danych_files/figure-html/unnamed-chunk-21-3.png" alt="" /><!-- --></p>
</div>
<div id="transformacja-danych-rodzina-transformacji-boxa-coxa" class="section level3">
<h3><span class="header-section-number">3.6.4</span> Transformacja danych | Rodzina transformacji Boxa Coxa</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&#39;caret&#39;</span>)
<span class="kw">ggplot</span>(punkty@data, <span class="kw">aes</span>(temp)) +<span class="st"> </span><span class="kw">geom_density</span>()</code></pre></div>
<p><img src="02-eksp_analiza_danych_files/figure-html/unnamed-chunk-22-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">transformacja &lt;-<span class="st"> </span><span class="kw">BoxCoxTrans</span>(punkty$temp)
transformacja</code></pre></div>
<pre><code>## Box-Cox Transformation
## 
## 244 data points used to estimate Lambda
## 
## Input data summary:
##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   7.805  12.190  15.130  15.320  17.340  26.070 
## 
## Largest/Smallest: 3.34 
## Sample Skewness: 0.508 
## 
## Estimated Lambda: 0.1 
## With fudge factor, Lambda = 0 will be used for transformations</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">punkty$bc_tpz &lt;-<span class="st"> </span><span class="kw">predict</span>(transformacja, punkty$temp)
<span class="kw">ggplot</span>(punkty@data, <span class="kw">aes</span>(bc_tpz)) +<span class="st"> </span><span class="kw">geom_density</span>()</code></pre></div>
<p><img src="02-eksp_analiza_danych_files/figure-html/unnamed-chunk-22-2.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">invBoxCox &lt;-<span class="st"> </span>function(x, lambda) if (lambda ==<span class="st"> </span><span class="dv">0</span>) <span class="kw">exp</span>(x) else (lambda*x +<span class="st"> </span><span class="dv">1</span>)^(<span class="dv">1</span>/lambda) 
punkty$bc_tpz_inv &lt;-<span class="st"> </span><span class="kw">invBoxCox</span>(punkty$bc_tpz, <span class="dt">lambda=</span>-<span class="fl">0.3</span>)
<span class="kw">ggplot</span>(punkty@data, <span class="kw">aes</span>(bc_tpz_inv)) +<span class="st"> </span><span class="kw">geom_density</span>()</code></pre></div>
<p><img src="02-eksp_analiza_danych_files/figure-html/unnamed-chunk-22-3.png" alt="" /><!-- --></p>
</div>
</div>
<div id="mapy" class="section level2">
<h2><span class="header-section-number">3.7</span> Mapy</h2>
<div id="podstawowe-terminy-kontekst-przestrzenny" class="section level3">
<h3><span class="header-section-number">3.7.1</span> Podstawowe terminy | Kontekst przestrzenny</h3>
<ul>
<li>Populacja - cały obszar, dla którego chcemy określić wybrane właściwości</li>
<li>Próba - zbiór obserwacji, dla których mamy informacje. Inaczej, próba to podzbiór populacji. Zazwyczaj niemożliwe (lub bardzo kosztowne) jest zdobycie informacji o całej populacji. Z tego powodu bardzo cenne jest odpowiednie wykorzystanie informacji z próby.</li>
</ul>
</div>
<div id="mapy-punktowe-cel" class="section level3">
<h3><span class="header-section-number">3.7.2</span> Mapy punktowe | Cel</h3>
<ul>
<li>Sprawdzenie poprawności współrzędnych</li>
<li>Wgląd w typ próbkowania</li>
<li>Sprawdzenie poprawności danych - dane odstające lokalnie</li>
<li>Identyfikacja głównych cech struktury przestrzennej zjawiska (np. trend)</li>
</ul>
</div>
<div id="typ-probowania" class="section level3">
<h3><span class="header-section-number">3.7.3</span> Typ próbowania</h3>
<ul>
<li>Regularny</li>
<li>Losowy</li>
<li>Losowy stratyfikowany</li>
<li>Preferencyjny</li>
<li>Liniowy</li>
</ul>
</div>
<div id="typ-probowania-regularny" class="section level3">
<h3><span class="header-section-number">3.7.4</span> Typ próbowania | Regularny</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">225</span>)
regularny &lt;-<span class="st"> </span><span class="kw">spsample</span>(granica, <span class="dv">150</span>, <span class="dt">type =</span> <span class="st">&#39;regular&#39;</span>)
<span class="kw">plot</span>(regularny)</code></pre></div>
<p><img src="02-eksp_analiza_danych_files/figure-html/unnamed-chunk-23-1.png" alt="" /><!-- --></p>
<ul>
<li>Zmienna <em>offset</em></li>
</ul>
</div>
<div id="typ-probowania-losowy" class="section level3">
<h3><span class="header-section-number">3.7.5</span> Typ próbowania | Losowy</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">301</span>)
losowy &lt;-<span class="st"> </span><span class="kw">spsample</span>(granica, <span class="dv">150</span>, <span class="dt">type =</span> <span class="st">&#39;random&#39;</span>)
<span class="kw">plot</span>(losowy)</code></pre></div>
<p><img src="02-eksp_analiza_danych_files/figure-html/unnamed-chunk-24-1.png" alt="" /><!-- --></p>
<ul>
<li>Każda lokalizacja ma takie samo prawdopodobieństwo wystąpienia</li>
<li>Każdy punkt jest losowany niezależnie od pozostałych</li>
</ul>
</div>
<div id="typ-probowania-losowy-stratyfikowany" class="section level3">
<h3><span class="header-section-number">3.7.6</span> Typ próbowania | Losowy stratyfikowany</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">125</span>)
strat &lt;-<span class="st"> </span><span class="kw">spsample</span>(granica, <span class="dv">150</span>, <span class="dt">type =</span> <span class="st">&#39;stratified&#39;</span>)
<span class="kw">plot</span>(strat)</code></pre></div>
<p><img src="02-eksp_analiza_danych_files/figure-html/unnamed-chunk-25-1.png" alt="" /><!-- --></p>
</div>
<div id="typ-probowania-preferencyjny-i" class="section level3">
<h3><span class="header-section-number">3.7.7</span> Typ próbowania | Preferencyjny I</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">425</span>)
pref &lt;-<span class="st"> </span><span class="kw">spsample</span>(granica, <span class="dv">150</span>, <span class="dt">type =</span> <span class="st">&#39;clustered&#39;</span>, <span class="dt">nclusters=</span><span class="dv">80</span>)
<span class="kw">plot</span>(pref)</code></pre></div>
<p><img src="02-eksp_analiza_danych_files/figure-html/unnamed-chunk-26-1.png" alt="" /><!-- --></p>
</div>
<div id="typ-probowania-liniowy" class="section level3">
<h3><span class="header-section-number">3.7.8</span> Typ próbowania | Liniowy</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># library(&#39;rgdal&#39;)</span>
<span class="co"># linia &lt;- readOGR(&quot;data&quot;, &quot;linia&quot;, verbose=FALSE)</span>
<span class="co"># set.seed(224)</span>
<span class="co"># izoliniowy &lt;- spsample(linia, 150, type = &#39;regular&#39;)</span>
<span class="co"># plot(izoliniowy)</span></code></pre></div>
</div>
<div id="mapy-punktowe-i-dane-lokalnie-odstajace" class="section level3">
<h3><span class="header-section-number">3.7.9</span> Mapy punktowe i dane lokalnie odstające</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">4</span>)))
<span class="kw">library</span>(<span class="st">&#39;rgdal&#39;</span>)
granica &lt;-<span class="st"> </span><span class="kw">readOGR</span>(<span class="dt">dsn=</span><span class="st">&#39;dane&#39;</span>, <span class="dt">layer=</span><span class="st">&#39;granica&#39;</span>, <span class="dt">verbose=</span><span class="ot">FALSE</span>) 
<span class="kw">plot</span>(granica) 
<span class="kw">plot</span>(punkty, <span class="dt">add=</span><span class="ot">TRUE</span>) </code></pre></div>
<p><img src="02-eksp_analiza_danych_files/figure-html/unnamed-chunk-28-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&#39;sp&#39;</span>)
<span class="co"># select.spatial(punkty, digitize=FALSE, rownames=TRUE)</span>
<span class="kw">spplot</span>(punkty, <span class="st">&quot;temp&quot;</span>, <span class="dt">identify=</span><span class="ot">TRUE</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">spplot</span>(punkty, <span class="st">&quot;temp&quot;</span>, <span class="dt">sp.layout =</span> granica)</code></pre></div>
<p><img src="02-eksp_analiza_danych_files/figure-html/unnamed-chunk-29-1.png" alt="" /><!-- --></p>
</div>
</div>
<div id="rozgrupowanie-danych" class="section level2">
<h2><span class="header-section-number">3.8</span> Rozgrupowanie danych</h2>
<div id="rozgrupowanie-danych-1" class="section level3">
<h3><span class="header-section-number">3.8.1</span> Rozgrupowanie danych</h3>
<ul>
<li>Istnieje szereg metod rozgrupowywania danych, między innymi:
<ul>
<li>Rozgrupowywanie komórkowe</li>
<li>Rozgrupowywanie poligonowe</li>
</ul></li>
<li>Celem tych metod jest nadanie wag obserwacjom w celu zapewnienia reprezentatywności przestrzennej danych</li>
</ul>
</div>
<div id="rozgrupowanie-danych-2" class="section level3">
<h3><span class="header-section-number">3.8.2</span> Rozgrupowanie danych</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&#39;sp&#39;</span>)
punkty_pref &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&#39;dane/punkty_pref.csv&#39;</span>)
<span class="kw">coordinates</span>(punkty_pref) &lt;-<span class="st"> </span><span class="er">~</span>x+y
<span class="kw">proj4string</span>(punkty_pref) &lt;-<span class="st"> &#39;+init=epsg:2180&#39;</span>
<span class="kw">spplot</span>(punkty_pref, <span class="st">&quot;temp&quot;</span>)</code></pre></div>
<p><img src="02-eksp_analiza_danych_files/figure-html/unnamed-chunk-30-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(punkty_pref$temp)</code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   8.705  12.500  15.380  15.520  17.960  25.520</code></pre>
</div>
<div id="rozgrupowanie-komorkowe-i-ang.-cell-declustering" class="section level3">
<h3><span class="header-section-number">3.8.3</span> Rozgrupowanie komórkowe I | (ang. <em>cell declustering</em>)</h3>
<p><span class="math display">\[w&#39;_j=\frac{\frac{1}{n_i}}{\text{liczba komórek z danymi}} \cdot n\]</span> , gdzie <span class="math inline">\(n_i\)</span> to liczba obserwacji w komórce, a <span class="math inline">\(n\)</span> to łączna liczba obserwacji</p>
</div>
<div id="rozgrupowanie-komorkowe-i-ang.-cell-declustering-1" class="section level3">
<h3><span class="header-section-number">3.8.4</span> Rozgrupowanie komórkowe I | (ang. <em>cell declustering</em>)</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">punkty_pref &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&#39;dane/punkty_pref.csv&#39;</span>)
punkty_pref$id &lt;-<span class="st"> </span><span class="dv">1</span>:<span class="kw">nrow</span>(punkty_pref)
<span class="kw">coordinates</span>(punkty_pref) &lt;-<span class="st"> </span><span class="er">~</span>x+y
<span class="kw">proj4string</span>(punkty_pref) &lt;-<span class="st"> &#39;+init=epsg:2180&#39;</span>
<span class="kw">spplot</span>(punkty_pref, <span class="st">&quot;id&quot;</span>, <span class="dt">colorkey=</span><span class="ot">TRUE</span>)</code></pre></div>
<p><img src="02-eksp_analiza_danych_files/figure-html/unnamed-chunk-31-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&#39;rgdal&#39;</span>)
<span class="kw">library</span>(<span class="st">&quot;raster&quot;</span>)
<span class="kw">library</span>(<span class="st">&#39;rgeos&#39;</span>)
granica &lt;-<span class="st"> </span><span class="kw">readOGR</span>(<span class="dt">dsn =</span> <span class="st">&quot;dane&quot;</span>, <span class="dt">layer =</span> <span class="st">&quot;granica&quot;</span>, <span class="dt">verbose =</span> <span class="ot">FALSE</span>)
siatka_n &lt;-<span class="st"> </span><span class="kw">raster</span>(<span class="kw">extent</span>(granica))
<span class="co"># siatka_n &lt;- raster(xmn=450000, xmx=485000, ymn=5960000, ymx=5989000)</span>
<span class="kw">res</span>(siatka_n) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">500</span>, <span class="dv">500</span>)
siatka_n[] &lt;-<span class="st"> </span><span class="dv">0</span>
<span class="kw">proj4string</span>(siatka_n) &lt;-<span class="st"> </span><span class="kw">CRS</span>(<span class="kw">proj4string</span>(punkty_pref))
siatka_n &lt;-<span class="st"> </span><span class="kw">mask</span>(siatka_n, <span class="kw">gBuffer</span>(granica, <span class="dt">width =</span> <span class="dv">500</span>))
siatka_n &lt;-<span class="st"> </span><span class="kw">as</span>(siatka_n, <span class="st">&quot;SpatialPolygonsDataFrame&quot;</span>)
siatka_n &lt;-<span class="st"> </span>siatka_n[!<span class="kw">is.na</span>(siatka_n@data$layer), ]
<span class="kw">plot</span>(siatka_n)
<span class="kw">plot</span>(punkty_pref, <span class="dt">add=</span><span class="ot">TRUE</span>)</code></pre></div>
<p><img src="02-eksp_analiza_danych_files/figure-html/unnamed-chunk-31-2.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">punkty_pref$liczebnosc &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, <span class="kw">length</span>(punkty_pref))
siatka_nr &lt;-<span class="st"> </span><span class="kw">aggregate</span>(punkty_pref[<span class="st">&#39;liczebnosc&#39;</span>], <span class="dt">by =</span> siatka_n, <span class="dt">FUN =</span> length) 
<span class="kw">spplot</span>(siatka_nr, <span class="st">&quot;liczebnosc&quot;</span>)</code></pre></div>
<p><img src="02-eksp_analiza_danych_files/figure-html/unnamed-chunk-31-3.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">liczba &lt;-<span class="st"> </span><span class="kw">over</span>(punkty_pref, siatka_nr)
punkty_pref$waga &lt;-<span class="st"> </span>((<span class="dv">1</span>/liczba$liczebnosc)/<span class="kw">sum</span>(!<span class="kw">is.na</span>(siatka_nr$liczebnosc))) *<span class="st"> </span><span class="kw">length</span>(punkty_pref)

<span class="kw">spplot</span>(punkty_pref, <span class="st">&#39;waga&#39;</span>)</code></pre></div>
<p><img src="02-eksp_analiza_danych_files/figure-html/unnamed-chunk-31-4.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">srednia_arytmetyczna &lt;-<span class="st"> </span><span class="kw">mean</span>(punkty_pref$temp)
srednia_wazona_c1 &lt;-<span class="st"> </span><span class="kw">mean</span>(punkty_pref$temp *<span class="st"> </span>punkty_pref$waga, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)</code></pre></div>
</div>
<div id="rozgrupowanie-komorkowe-ii-ang.-cell-declustering" class="section level3">
<h3><span class="header-section-number">3.8.5</span> Rozgrupowanie komórkowe II | (ang. <em>cell declustering</em>)</h3>
<!--
- Przygotowanie danych
https://stat.ethz.ch/pipermail/r-sig-geo/2010-February/007710.html

When "interpolating" with nmax=1, you basically assign the value of the 
nearest observation to each grid cell, so, honoustly, it's hard to call 
this interpolation, it is rather something of a discretized Thiessen 
polygon.
-->
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&#39;gstat&#39;</span>)
punkty_pref &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&#39;dane/punkty_pref.csv&#39;</span>)
punkty_pref$id &lt;-<span class="st"> </span><span class="dv">1</span>:<span class="kw">nrow</span>(punkty_pref)
<span class="kw">coordinates</span>(punkty_pref) &lt;-<span class="st"> </span><span class="er">~</span>x+y
<span class="kw">proj4string</span>(punkty_pref) &lt;-<span class="st"> &#39;+init=epsg:2180&#39;</span>
<span class="kw">spplot</span>(punkty_pref, <span class="st">&quot;id&quot;</span>, <span class="dt">colorkey=</span><span class="ot">TRUE</span>)</code></pre></div>
<p><img src="02-eksp_analiza_danych_files/figure-html/unnamed-chunk-32-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&#39;raster&#39;</span>)
granica &lt;-<span class="st"> </span><span class="kw">readOGR</span>(<span class="dt">dsn=</span><span class="st">&#39;dane&#39;</span>, <span class="dt">layer=</span><span class="st">&#39;granica&#39;</span>, <span class="dt">verbose=</span><span class="ot">FALSE</span>)
siatka_n &lt;-<span class="st"> </span><span class="kw">raster</span>(<span class="kw">extent</span>(granica))
<span class="kw">res</span>(siatka_n) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">500</span>, <span class="dv">500</span>)
siatka_n[] &lt;-<span class="st"> </span><span class="dv">0</span>
<span class="kw">proj4string</span>(siatka_n) &lt;-<span class="st"> </span><span class="kw">CRS</span>(<span class="kw">proj4string</span>(punkty_pref))
siatka_n &lt;-<span class="st"> </span><span class="kw">mask</span>(siatka_n, granica)
siatka_n &lt;-<span class="st"> </span><span class="kw">as</span>(siatka_n, <span class="st">&#39;SpatialPointsDataFrame&#39;</span>)
siatka_n &lt;-<span class="st"> </span>siatka_n[!<span class="kw">is.na</span>(siatka_n@data$layer), ]
<span class="kw">gridded</span>(siatka_n) &lt;-<span class="st"> </span><span class="ot">TRUE</span>
<span class="kw">plot</span>(siatka_n)</code></pre></div>
<p><img src="02-eksp_analiza_danych_files/figure-html/unnamed-chunk-32-2.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">out &lt;-<span class="st">  </span><span class="kw">krige</span>(id~<span class="dv">1</span>, punkty_pref, siatka_n, <span class="dt">nmax=</span><span class="dv">1</span>)</code></pre></div>
<pre><code>## [inverse distance weighted interpolation]</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">spplot</span>(out, <span class="st">&quot;var1.pred&quot;</span>)</code></pre></div>
<p><img src="02-eksp_analiza_danych_files/figure-html/unnamed-chunk-33-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">table</span>(out[[<span class="dv">1</span>]]))
df$waga &lt;-<span class="st"> </span>df$Freq/<span class="kw">sum</span>(df$Freq)
punkty_pref &lt;-<span class="st"> </span><span class="kw">merge</span>(punkty_pref, df, <span class="dt">by.x=</span><span class="st">&quot;id&quot;</span>, <span class="dt">by.y=</span><span class="st">&quot;Var1&quot;</span>)
<span class="kw">summary</span>(punkty_pref$waga)</code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA&#39;s 
## 0.00389 0.00389 0.00389 0.00552 0.00778 0.01556      61</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">spplot</span>(out, <span class="st">&quot;var1.pred&quot;</span>, <span class="dt">sp.layout=</span><span class="kw">list</span>(<span class="st">&quot;sp.points&quot;</span>, punkty_pref))</code></pre></div>
<p><img src="02-eksp_analiza_danych_files/figure-html/unnamed-chunk-33-2.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">spplot</span>(punkty_pref[<span class="st">&quot;waga&quot;</span>])</code></pre></div>
<p><img src="02-eksp_analiza_danych_files/figure-html/unnamed-chunk-33-3.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">srednia_arytmetyczna &lt;-<span class="st"> </span><span class="kw">mean</span>(punkty_pref$temp)
srednia_wazona_c2 &lt;-<span class="st"> </span><span class="kw">sum</span>(punkty_pref$temp *<span class="st"> </span>punkty_pref$waga, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)</code></pre></div>
</div>
<div id="rozgrupowanie-poligonowe-ang.-polygon-declustering" class="section level3">
<h3><span class="header-section-number">3.8.6</span> Rozgrupowanie poligonowe | (ang. <em>polygon declustering</em>)</h3>
<p><span class="math display">\[w&#39;_j=\frac{area_j}{\sum_{j=1}^{n}area_j} \cdot n\]</span> , gdzie <span class="math inline">\(area_j\)</span> powierzchnia dla wybranej obserwacji, a <span class="math inline">\(n\)</span> to łączna liczba obserwacji</p>
</div>
<div id="rozgrupowanie-poligonowe-ang.-polygon-declustering-1" class="section level3">
<h3><span class="header-section-number">3.8.7</span> Rozgrupowanie poligonowe | (ang. <em>polygon declustering</em>)</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">punkty_pref &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&#39;dane/punkty_pref.csv&#39;</span>)
punkty_pref$id &lt;-<span class="st"> </span><span class="dv">1</span>:<span class="kw">nrow</span>(punkty_pref)
<span class="kw">coordinates</span>(punkty_pref) &lt;-<span class="st"> </span><span class="er">~</span>x+y
<span class="kw">proj4string</span>(punkty_pref) &lt;-<span class="st"> &#39;+init=epsg:2180&#39;</span>
<span class="kw">spplot</span>(punkty_pref, <span class="st">&quot;id&quot;</span>, <span class="dt">colorkey=</span><span class="ot">TRUE</span>)</code></pre></div>
<p><img src="02-eksp_analiza_danych_files/figure-html/unnamed-chunk-34-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&#39;dismo&#39;</span>)
v &lt;-<span class="st"> </span><span class="kw">voronoi</span>(punkty_pref)
<span class="kw">plot</span>(punkty_pref, <span class="dt">cex=</span><span class="fl">0.2</span>, <span class="dt">col=</span><span class="st">&#39;red&#39;</span>)
<span class="kw">plot</span>(v, <span class="dt">add=</span><span class="ot">TRUE</span>)</code></pre></div>
<p><img src="02-eksp_analiza_danych_files/figure-html/unnamed-chunk-34-2.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&#39;rgeos&#39;</span>)
v_intersect &lt;-<span class="kw">intersect</span>(granica, v)
<span class="kw">plot</span>(punkty_pref, <span class="dt">cex=</span><span class="fl">0.2</span>, <span class="dt">col=</span><span class="st">&#39;red&#39;</span>)
<span class="kw">plot</span>(v_intersect, <span class="dt">add=</span><span class="ot">TRUE</span>)</code></pre></div>
<p><img src="02-eksp_analiza_danych_files/figure-html/unnamed-chunk-34-3.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">v_intersect$pow &lt;-<span class="st"> </span><span class="kw">area</span>(v_intersect)
v_intersect$waga &lt;-<span class="st"> </span>v_intersect$pow/<span class="kw">sum</span>(v_intersect$pow) *<span class="st"> </span><span class="kw">length</span>(punkty_pref)

punkty_pref &lt;-<span class="st"> </span><span class="kw">merge</span>(punkty_pref, v_intersect[<span class="kw">c</span>(<span class="st">&#39;id&#39;</span>, <span class="st">&#39;waga&#39;</span>)], <span class="dt">by=</span><span class="st">&#39;id&#39;</span>)
<span class="kw">spplot</span>(punkty_pref, <span class="st">&#39;waga&#39;</span>)</code></pre></div>
<p><img src="02-eksp_analiza_danych_files/figure-html/unnamed-chunk-34-4.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">srednia_arytmetyczna &lt;-<span class="st"> </span><span class="kw">mean</span>(punkty_pref$temp, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)
srednia_wazona_p &lt;-<span class="st"> </span><span class="kw">mean</span>(punkty_pref$temp*punkty_pref$waga, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Średnia arytmetyczna</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Populacja</td>
<td align="right">15.59128</td>
</tr>
<tr class="even">
<td align="left">Próba</td>
<td align="right">15.52427</td>
</tr>
<tr class="odd">
<td align="left">Rozgrupowanie komórkowe I</td>
<td align="right">17.53834</td>
</tr>
<tr class="even">
<td align="left">Rozgrupowanie komórkowe II</td>
<td align="right">15.32633</td>
</tr>
<tr class="odd">
<td align="left">Rozgrupowanie poligonowe</td>
<td align="right">18.33385</td>
</tr>
</tbody>
</table>
<!--
polygon declustering - http://gis.stackexchange.com/questions/122376/cell-declustering-using-open-source-software
cell declustering - https://stat.ethz.ch/pipermail/r-sig-geo/2010-February/007710.html
http://gaa.org.au/pdf/DeclusterDebias-CCG.pdf
-->
<!--chapter:end:02-eksp_analiza_danych.Rmd-->
</div>
</div>
</div>
<div id="eksploracyjna-analiza-danych---geostatystyka" class="section level1">
<h1><span class="header-section-number">4</span> Eksploracyjna analiza danych - geostatystyka</h1>
<div id="interpolacja" class="section level2">
<h2><span class="header-section-number">4.1</span> Interpolacja</h2>
<div id="modele-deterministyczne" class="section level3">
<h3><span class="header-section-number">4.1.1</span> Modele deterministyczne</h3>
<ul>
<li>Parametry tych modeli są zazwyczaj ustalane w oparciu o funkcję odległości lub powierzchni. Brakuje również szacunków na temat oceny błędu modelu. Np:
<ul>
<li>Funkcje wielomianowe</li>
<li>Funkcje sklejane (ang. <em>splines</em>)</li>
<li>Triangulacje</li>
<li>IDW (ang. <em>Inverse Distance Weighted</em>)</li>
</ul></li>
</ul>
<p><a href="http://neondataskills.org/Data-Workshops/ESA15-Going-On-The-Grid-Spatial-Interpolation-Basics/" class="uri">http://neondataskills.org/Data-Workshops/ESA15-Going-On-The-Grid-Spatial-Interpolation-Basics/</a></p>
</div>
<div id="modele-deterministyczne-1" class="section level3">
<h3><span class="header-section-number">4.1.2</span> Modele deterministyczne</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&#39;fields&#39;</span>)</code></pre></div>
<pre><code>## Loading required package: methods</code></pre>
<pre><code>## Loading required package: spam</code></pre>
<pre><code>## Loading required package: grid</code></pre>
<pre><code>## Spam version 1.3-0 (2015-10-24) is loaded.
## Type &#39;help( Spam)&#39; or &#39;demo( spam)&#39; for a short introduction 
## and overview of this package.
## Help for individual functions is also obtained by adding the
## suffix &#39;.spam&#39; to the function name, e.g. &#39;help( chol.spam)&#39;.</code></pre>
<pre><code>## 
## Attaching package: &#39;spam&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     backsolve, forwardsolve</code></pre>
<pre><code>## Loading required package: maps</code></pre>
<pre><code>## 
##  # maps v3.1: updated &#39;world&#39;: all lakes moved to separate new #
##  # &#39;lakes&#39; database. Type &#39;?world&#39; or &#39;news(package=&quot;maps&quot;)&#39;.  #</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&#39;sp&#39;</span>)
<span class="kw">library</span>(<span class="st">&#39;raster&#39;</span>)
<span class="kw">library</span>(<span class="st">&#39;gstat&#39;</span>)
<span class="kw">library</span>(<span class="st">&#39;rgdal&#39;</span>)</code></pre></div>
<pre><code>## rgdal: version: 1.1-3, (SVN revision 594)
##  Geospatial Data Abstraction Library extensions to R successfully loaded
##  Loaded GDAL runtime: GDAL 1.11.2, released 2015/02/10
##  Path to GDAL shared files: /usr/share/gdal/1.11
##  Loaded PROJ.4 runtime: Rel. 4.8.0, 6 March 2012, [PJ_VERSION: 480]
##  Path to PROJ.4 shared files: (autodetected)
##  Linking to sp version: 1.2-1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">punkty &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&#39;dane/punkty.csv&#39;</span>)
<span class="kw">coordinates</span>(punkty) &lt;-<span class="st"> </span><span class="er">~</span>x+y
<span class="kw">proj4string</span>(punkty) &lt;-<span class="st"> &#39;+init=epsg:2180&#39;</span>
ras &lt;-<span class="st"> </span><span class="kw">raster</span>(<span class="st">&#39;dane/siatka.tif&#39;</span>)
<span class="kw">crs</span>(ras) &lt;-<span class="st"> </span><span class="kw">proj4string</span>(punkty)
grid &lt;-<span class="st"> </span><span class="kw">as</span>(ras, <span class="st">&quot;SpatialGridDataFrame&quot;</span>)
granica &lt;-<span class="st"> </span><span class="kw">readOGR</span>(<span class="st">&quot;dane&quot;</span>, <span class="st">&quot;granica&quot;</span>)</code></pre></div>
<pre><code>## OGR data source with driver: ESRI Shapefile 
## Source: &quot;dane&quot;, layer: &quot;granica&quot;
## with 1 features
## It has 3 fields</code></pre>
</div>
<div id="modele-deterministyczne-funkcje-wielomianowe" class="section level3">
<h3><span class="header-section-number">4.1.3</span> Modele deterministyczne | Funkcje wielomianowe</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">wielomian_1 &lt;-<span class="st"> </span><span class="kw">gstat</span>(<span class="dt">formula=</span>temp~<span class="dv">1</span>, <span class="dt">data=</span>punkty, <span class="dt">degree=</span><span class="dv">1</span>)
wielomian_1_pred &lt;-<span class="st"> </span><span class="kw">predict</span>(wielomian_1, <span class="dt">newdata=</span>grid)</code></pre></div>
<pre><code>## [ordinary or weighted least squares prediction]</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">spplot</span>(wielomian_1_pred[<span class="dv">1</span>], <span class="dt">contour=</span><span class="ot">TRUE</span>,<span class="dt">main=</span><span class="st">&quot;Powierzchnia trendu - wielomian pierwszego stopnia&quot;</span>)</code></pre></div>
<p><img src="03-eksp_przestrzenna_files/figure-html/unnamed-chunk-2-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">wielomian_2 &lt;-<span class="st"> </span><span class="kw">gstat</span>(<span class="dt">formula=</span>temp~<span class="dv">1</span>, <span class="dt">data=</span>punkty, <span class="dt">degree=</span><span class="dv">2</span>)
wielomian_2_pred &lt;-<span class="st"> </span><span class="kw">predict</span>(wielomian_2, <span class="dt">newdata=</span>grid)</code></pre></div>
<pre><code>## [ordinary or weighted least squares prediction]</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">spplot</span>(wielomian_2_pred[<span class="dv">1</span>], <span class="dt">contour=</span><span class="ot">TRUE</span>,<span class="dt">main=</span><span class="st">&quot;Powierzchnia trendu - wielomian drugiego stopnia&quot;</span>)</code></pre></div>
<p><img src="03-eksp_przestrzenna_files/figure-html/unnamed-chunk-2-2.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">wielomian_3 &lt;-<span class="st"> </span><span class="kw">gstat</span>(<span class="dt">formula=</span>temp~<span class="dv">1</span>, <span class="dt">data=</span>punkty, <span class="dt">degree=</span><span class="dv">3</span>)
wielomian_3_pred &lt;-<span class="st"> </span><span class="kw">predict</span>(wielomian_3, <span class="dt">newdata=</span>grid)</code></pre></div>
<pre><code>## [ordinary or weighted least squares prediction]</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">spplot</span>(wielomian_3_pred[<span class="dv">1</span>], <span class="dt">contour=</span><span class="ot">TRUE</span>,<span class="dt">main=</span><span class="st">&quot;Powierzchnia trendu - wielomian trzeciego stopnia&quot;</span>)</code></pre></div>
<p><img src="03-eksp_przestrzenna_files/figure-html/unnamed-chunk-2-3.png" alt="" /><!-- --></p>
<!--
library('rasterVis')
xx <- as(wielomian_1_pred[1], "SpatialPointsDataFrame")
raster <- raster(extent(wielomian_1_pred))
res(raster) <- c(100, 100)
raster <- rasterize(x=xx, y=raster)
plot3D(raster[[1]])
-->
</div>
<div id="modele-deterministyczne-funkcje-sklejane" class="section level3">
<h3><span class="header-section-number">4.1.4</span> Modele deterministyczne | Funkcje sklejane</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tps &lt;-<span class="st"> </span><span class="kw">Tps</span>(<span class="kw">coordinates</span>(punkty), punkty@data$temp)
spline &lt;-<span class="st"> </span><span class="kw">interpolate</span>(ras, tps)
spline &lt;-<span class="st"> </span><span class="kw">mask</span>(spline, ras)
<span class="kw">spplot</span>(spline, <span class="dt">contour=</span><span class="ot">TRUE</span> , <span class="dt">main=</span><span class="st">&quot;Funkcje sklejane&quot;</span>)</code></pre></div>
<p><img src="03-eksp_przestrzenna_files/figure-html/unnamed-chunk-3-1.png" alt="" /><!-- --></p>
</div>
<div id="modele-deterministyczne-triangulacje-thiessen" class="section level3">
<h3><span class="header-section-number">4.1.5</span> Modele deterministyczne | Triangulacje (Thiessen)</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&#39;dismo&#39;</span>)
voronoi_interp &lt;-<span class="st"> </span><span class="kw">voronoi</span>(punkty)</code></pre></div>
<pre><code>## Loading required namespace: deldir</code></pre>
<pre><code>## 
##      PLEASE NOTE:  The components &quot;delsgs&quot; and &quot;summary&quot; of the
##  object returned by deldir() are now DATA FRAMES rather than
##  matrices (as they were prior to release 0.0-18).
##  See help(&quot;deldir&quot;).
##  
##      PLEASE NOTE: The process that deldir() uses for determining
##  duplicated points has changed from that used in version
##  0.0-9 of this package (and previously). See help(&quot;deldir&quot;).</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">voronoi_interp &lt;-<span class="st"> </span><span class="kw">intersect</span>(granica, voronoi_interp)</code></pre></div>
<pre><code>## Loading required namespace: rgeos</code></pre>
<pre><code>## Warning in intersect(granica, voronoi_interp): non identical CRS</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">spplot</span>(voronoi_interp, <span class="st">&quot;temp&quot;</span>, <span class="dt">contour=</span><span class="ot">TRUE</span>, <span class="dt">main=</span><span class="st">&quot;Poligony Voronoi&#39;a&quot;</span>)</code></pre></div>
<p><img src="03-eksp_przestrzenna_files/figure-html/unnamed-chunk-4-1.png" alt="" /><!-- --></p>
</div>
<div id="modele-deterministyczne-idw" class="section level3">
<h3><span class="header-section-number">4.1.6</span> Modele deterministyczne | IDW</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">idw_wolin &lt;-<span class="st"> </span><span class="kw">idw</span>(temp~<span class="dv">1</span>, punkty, grid, <span class="dt">idp=</span><span class="dv">2</span>)</code></pre></div>
<pre><code>## [inverse distance weighted interpolation]</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">spplot</span>(idw_wolin, <span class="st">&#39;var1.pred&#39;</span>, <span class="dt">contour=</span><span class="ot">TRUE</span>, <span class="dt">main=</span><span class="st">&quot;IDW&quot;</span>)</code></pre></div>
<p><img src="03-eksp_przestrzenna_files/figure-html/unnamed-chunk-5-1.png" alt="" /><!-- --></p>
<!--
dodaj wykresy idw
https://rpubs.com/DonalOLeary/80504
-->
</div>
<div id="modele-deterministyczne-porownanie" class="section level3">
<h3><span class="header-section-number">4.1.7</span> Modele deterministyczne | Porównanie</h3>
<p><img src="03-eksp_przestrzenna_files/figure-html/unnamed-chunk-6-1.png" alt="" /><!-- --></p>
</div>
<div id="modele-statystyczne" class="section level3">
<h3><span class="header-section-number">4.1.8</span> Modele statystyczne</h3>
<ul>
<li>Parametry modeli są określane w oparciu o teorię prawdopodobieństwa. Dodatkowo wynik estymacji zawiera oszacowanie błędu. Np.:
<ul>
<li>Kriging</li>
<li>Modele regresyjne</li>
<li>Modele bayesowe</li>
<li>Modele hybrydowe</li>
</ul></li>
</ul>
<!--
http://www.inside-r.org/packages/cran/raster/docs/interpolate
![](fig_skrypt/m_feat.png)
-->
</div>
</div>
<div id="geostatystyka---prolog" class="section level2">
<h2><span class="header-section-number">4.2</span> Geostatystyka - prolog</h2>
<div id="geostatystyka" class="section level3">
<h3><span class="header-section-number">4.2.1</span> Geostatystyka</h3>
<ul>
<li>Zbiór narzędzi statystycznych uwzględniających w analizie danych ich przestrzenną i czasową lokalizację, a opartych o teorię funkcji losowych.</li>
</ul>
<!--
### Geostatystyka a klasyczna statystyka
- Isnieje informacja o lokalizacji obserwacji
-->
</div>
<div id="geostatystyka-funkcje" class="section level3">
<h3><span class="header-section-number">4.2.2</span> Geostatystyka | Funkcje</h3>
<ul>
<li>Identyfikacja i modelowanie struktury przestrzennej/czasowej zjawiska</li>
<li>Estymacja - szacowanie wartości badanej zmiennej w nieopróbowanym miejscu i/lub momencie czasu</li>
<li>Symulacja - generowanie alternatywnych obrazów, które honorują wyniki pomiarów i strukturę przestrzenną/czasową zjawiska</li>
<li>Optymalizacja próbkowania/sieci pomiarowej</li>
</ul>
</div>
<div id="geostatystyczna-analiza-danych" class="section level3">
<h3><span class="header-section-number">4.2.3</span> Geostatystyczna analiza danych</h3>
<div class="figure">
<img src="figs/diag.png" alt="" />

</div>
</div>
<div id="geostatystyka-dane-wejsciowe" class="section level3">
<h3><span class="header-section-number">4.2.4</span> Geostatystyka | Dane wejściowe</h3>
<ol style="list-style-type: decimal">
<li>Wystarczająca duża liczba punktów (minimalnie &gt;30, ale zazwyczaj więcej niż 100/150)</li>
<li>Są reprezentatywne</li>
<li>Są niezależne</li>
<li>Były stworzone używając stałej metodyki</li>
<li>Są wystarczająco dokładne</li>
</ol>
<!--
### Geostatystyka | Cele
- Charakterystyka struktury przestrzennej badanego zjawiska
- Uwzględnienie przestrzennych relacji między zmiennymi
- Interpolacja wartości
- Wizualizacja
- Określenie niepewności danych
- Stwierdzenie niepewności estymacji
-->
</div>
<div id="geostatystyka-podstawowe-etapy" class="section level3">
<h3><span class="header-section-number">4.2.5</span> Geostatystyka | Podstawowe etapy</h3>
<ol style="list-style-type: decimal">
<li>Zaprojektowanie sposobu (typu) próbkowania oraz organizacji zadań</li>
<li>Zebranie danych, analiza labolatoryjna</li>
<li>Wstepna eksploracja danych, ocena ich jakości</li>
<li>Modelowanie semiwariogramów na podstawie dostępnych danych</li>
<li>Estymacja badanej cechy</li>
<li>Porównanie i ocena modeli</li>
<li>Stworzenie wynikowego produktu i jego dystrybucja</li>
</ol>
</div>
</div>
<div id="przestrzenna-kowariancja-korelacja-i-semiwariancja" class="section level2">
<h2><span class="header-section-number">4.3</span> Przestrzenna kowariancja, korelacja i semiwariancja</h2>
<div id="przestrzenna-kowariancja-korelacja-i-semiwariancja-zaozenia" class="section level3">
<h3><span class="header-section-number">4.3.1</span> Przestrzenna kowariancja, korelacja i semiwariancja | Założenia</h3>
<ol style="list-style-type: decimal">
<li>Przestrzennej ciągłości - przestrzenna korelacja między zmienny w dwóch lokalizacjach zależy tylko od ich odległości (oraz czasem kierunku), lecz nie od tego gdzie są one położone</li>
<li>Stacjonarności - średnia i wariancja są stałe na całym badanym obszarze</li>
</ol>
</div>
<div id="przestrzenna-kowariancja-korelacja-i-semiwariancja-1" class="section level3">
<h3><span class="header-section-number">4.3.2</span> Przestrzenna kowariancja, korelacja i semiwariancja</h3>
<ul>
<li><span class="math inline">\(u\)</span> - wektor współrzędnych</li>
<li><span class="math inline">\(z(u)\)</span> - badana zmienna jako funkcja położenia - inaczej określany jako ogon (ang. <em>tail</em>)</li>
<li><span class="math inline">\(h\)</span> - lag - odstęp pomiędzy dwoma lokalizacjami</li>
<li><span class="math inline">\(z(u+h)\)</span> - wartość badanej zmiennej odległej o odstęp <span class="math inline">\(h\)</span> - inaczej określany jako głowa (ang. <em>head</em>)</li>
</ul>
</div>
<div id="przestrzenna-kowariancja-korelacja-i-semiwariancja-2" class="section level3">
<h3><span class="header-section-number">4.3.3</span> Przestrzenna kowariancja, korelacja i semiwariancja</h3>
<ul>
<li>Kowariancja i korelacja to miary podobieństwa pomiędzy dwoma zmiennymi</li>
<li>Przenosząc to na aspekt przestrzenny, badamy jedną zmienną ale pomiędzy dwoma punktami odległymi od siebie o pewien dystans (okreslany jako lag)</li>
<li>W efekcie otrzymujemy miarę podobieństwa pomiędzy wartością głowy i ogona</li>
<li>Trzecią miarę charakteryzującą relację między obserwacjami odległymi o kolejne odstępy jest semiwariancja</li>
<li>Z praktycznego punktu widzenia, semiwariogram jest preferowaną miarą relacji przestrzennej, ponieważ wykazuje tendencję do lepszego wygładzania danych niż funkcja kowariancji</li>
<li>Dodatkowo, semiwariogram jest mniej wymagający obliczeniowo</li>
<li>Jednocześnie, dla potrzeb interpretacji relacji kowarancja i korelacja przestrzenna nadaje się nie gorzej niż semiwariancja</li>
</ul>
<p><img src="03-eksp_przestrzenna_files/figure-html/z_przs0-1.png" alt="" /><!-- --></p>
</div>
<div id="wykres-rozrzutu-z-przesunieciem" class="section level3">
<h3><span class="header-section-number">4.3.4</span> Wykres rozrzutu z przesunięciem</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hscat</span>(temp~<span class="dv">1</span>, punkty, <span class="dt">breaks=</span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">4000</span>, <span class="dt">by=</span><span class="dv">500</span>))</code></pre></div>
<p><img src="03-eksp_przestrzenna_files/figure-html/z_przs-1.png" alt="" /><!-- --></p>
</div>
<div id="autokowariancja" class="section level3">
<h3><span class="header-section-number">4.3.5</span> Autokowariancja</h3>
<ul>
<li>Autokowariancja pokazuje jak mocno są ze sobą powiązane przestrzennie wartości pary obserwacji odległych od siebie o kolejne przedziały</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">kowario &lt;-<span class="st"> </span><span class="kw">variogram</span>(temp~<span class="dv">1</span>, punkty, <span class="dt">covariogram =</span> <span class="ot">TRUE</span>)
<span class="kw">plot</span>(kowario)</code></pre></div>
<p><img src="03-eksp_przestrzenna_files/figure-html/unnamed-chunk-7-1.png" alt="" /><!-- --></p>
</div>
<div id="autokorelacja" class="section level3">
<h3><span class="header-section-number">4.3.6</span> Autokorelacja</h3>
<ul>
<li>Autokorelogram jest wykresem pokazującym jedną z miar autokorelacji (np. I Morana lub C Geary’ego) w stosunku do odległości</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&#39;pgirmess&#39;</span>)
<span class="kw">library</span>(<span class="st">&#39;ggplot2&#39;</span>)
wsp &lt;-<span class="st"> </span><span class="kw">coordinates</span>(punkty)
kor &lt;-<span class="st"> </span><span class="kw">correlog</span>(wsp, punkty$temp)
kor &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(kor)
<span class="kw">ggplot</span>(kor, <span class="kw">aes</span>(dist.class, coef)) +<span class="st"> </span><span class="kw">geom_smooth</span>(<span class="dt">linetype=</span><span class="dv">0</span>) +<span class="st"> </span><span class="kw">geom_line</span>() +<span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">size=</span><span class="dv">5</span>)</code></pre></div>
<p><img src="03-eksp_przestrzenna_files/figure-html/unnamed-chunk-8-1.png" alt="" /><!-- --></p>
</div>
<div id="semiwariancja" class="section level3">
<h3><span class="header-section-number">4.3.7</span> Semiwariancja</h3>
<ul>
<li>Zmienność przestrzenna może być określona za pomocą semiwariancji. Jest to połowa średniej kwadratu różnicy pomiędzy wartościami badanej zmiennej w dwóch lokalizacjach odległych o wektor <span class="math inline">\(h\)</span> <span class="math display">\[ \gamma(h) = \frac{1}{2}E[(z(s) - z(s+h))^2] \]</span></li>
</ul>
</div>
<div id="okreslenie-wystepowania-autokorelacji-przestrzennej-chmura-semiwariogramu" class="section level3">
<h3><span class="header-section-number">4.3.8</span> Określenie występowania autokorelacji przestrzennej | Chmura semiwariogramu</h3>
<ul>
<li>Jeżeli w badanej próbie mamy <span class="math inline">\(n\)</span> obserwacji oznacza to, że możemy zaobserwować <span class="math inline">\(\frac{1}{2}n(n-1)\)</span> par obserwacji</li>
<li>Każda para obserwacji daje nam informacje o semiwariancji występującej wraz z odległością</li>
<li>Semiwariancję można zaprezentować na wykresie zwanym chumrą semiwariogramu</li>
</ul>
</div>
<div id="semiwariancja-przykadowe-obliczenia" class="section level3">
<h3><span class="header-section-number">4.3.9</span> Semiwariancja | Przykładowe obliczenia</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">odl &lt;-<span class="st"> </span><span class="kw">dist</span>(<span class="kw">coordinates</span>(punkty)[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), ])
gamma &lt;-<span class="st"> </span><span class="fl">0.5</span> *<span class="st"> </span>(punkty$temp[<span class="dv">1</span>] -<span class="st"> </span>punkty$temp[<span class="dv">2</span>])^<span class="dv">2</span>
gamma</code></pre></div>
<pre><code>## [1] 0.5712228</code></pre>
</div>
<div id="okreslenie-wystepowania-autokorelacji-przestrzennej-chmura-semiwariogramu-1" class="section level3">
<h3><span class="header-section-number">4.3.10</span> Określenie występowania autokorelacji przestrzennej | Chmura semiwariogramu</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&#39;gstat&#39;</span>)
vario_cloud &lt;-<span class="st"> </span><span class="kw">variogram</span>(temp~<span class="dv">1</span>, punkty, <span class="dt">cloud=</span><span class="ot">TRUE</span>)
<span class="kw">plot</span>(vario_cloud) </code></pre></div>
<p><img src="03-eksp_przestrzenna_files/figure-html/unnamed-chunk-10-1.png" alt="" /><!-- --></p>
</div>
<div id="okreslenie-wystepowania-autokorelacji-przestrzennej-chmura-semiwariogramu-2" class="section level3">
<h3><span class="header-section-number">4.3.11</span> Określenie występowania autokorelacji przestrzennej | Chmura semiwariogramu</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vario_cloud_sel &lt;-<span class="st"> </span><span class="kw">plot</span>(<span class="kw">variogram</span>(temp~<span class="dv">1</span>, punkty, <span class="dt">cloud=</span><span class="ot">TRUE</span>), <span class="dt">digitize=</span><span class="ot">TRUE</span>)
<span class="kw">plot</span>(vario_cloud_sel, punkty) </code></pre></div>
</div>
<div id="semiwariogram-charakterystyka-struktury-przestrzennej" class="section level3">
<h3><span class="header-section-number">4.3.12</span> Semiwariogram | Charakterystyka struktury przestrzennej</h3>
<ul>
<li>Semiwariogram to wykres pokazujący relację pomiędzy odległością a semiwariancją</li>
<li>Jest to uśrednieniem semiwariancji dla kolejnych odstępów (lagów)</li>
<li>W oparciu o semiwariogram empiryczny możemy następnie dopasować do niego model/e</li>
</ul>
<p><span class="math display">\[ \hat{\gamma}(h) = \frac{1}{2N(h)}\sum_{i=1}^{N(h)}(z(s_i) - z(s_i+h))^2 \]</span></p>
<p>gdzie <span class="math inline">\(N(h)\)</span> oznacza liczbę par punktów w odstępie <span class="math inline">\(h\)</span></p>
</div>
<div id="semiwariogram" class="section level3">
<h3><span class="header-section-number">4.3.13</span> Semiwariogram</h3>
<ul>
<li>Nugget - efekt nuggetowy - pozwala na określenie błędu w danych wejściowych oraz zmienności na dystansie krótszym niż pierwszy odstęp</li>
<li>Sill - semiwariancja progowa - oznacza wariancję badanej zmiennej</li>
<li>Range - zasięg - to odległość do której istnieje przestrzenna korelacja</li>
</ul>
</div>
<div id="semiwariogram-rules-of-thumb" class="section level3">
<h3><span class="header-section-number">4.3.14</span> Semiwariogram | Rules of thumb</h3>
<ul>
<li>W każdym odstępie powinno się znaleźć co najmniej 30 par punktów</li>
<li>Maksymalny zasięg semiwariogramu (ang. <em>cutoff distance</em>) to 1/2 pierwiastka z badanej powierzchni (inne źródła mówią o połowie z przekątnej badanego obszaru/jednej trzeciej)</li>
<li>Liczba odstępów powinna nie być mniejsza niż 10</li>
<li>Optymalnie maksymalny zasięg semiwariogramu powinien być dłuższy o 10-15% od zasięgu zjawiska</li>
<li>Optymalnie odstępy powinny być jak najbliżej siebie i jednocześnie nie być chaotyczne</li>
<li>Warto metodą prób i błędów określić optymalne parametry semiwariogramu</li>
<li>Należy określić czy zjawisko wykazuje anizotropię przestrzenną</li>
</ul>
</div>
<div id="semiwariogram-obliczenia-pomocnicze" class="section level3">
<h3><span class="header-section-number">4.3.15</span> Semiwariogram | Obliczenia pomocnicze</h3>
<ul>
<li>Liczba par obserwacji</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="fl">0.5</span>*<span class="kw">length</span>(punkty)*(<span class="kw">length</span>(punkty)-<span class="dv">1</span>)</code></pre></div>
<pre><code>## [1] 29646</code></pre>
<ul>
<li>Połowa pierwiastka powierzchni</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pow &lt;-<span class="st"> </span><span class="kw">area</span>(granica)
<span class="kw">as.vector</span>(<span class="fl">0.5</span>*<span class="kw">sqrt</span>(pow))</code></pre></div>
<pre><code>## [1] 3980.472</code></pre>
<p><!--
- Połowa przekątnej obszaru
Twierdzenie Pitagorasa

$$x^2 + y^2 = z^2$$


```r
wierz <- as.vector(extent(poligon))
kraw_x <- wierz[2] - wierz[1]
kraw_y <- wierz[4] - wierz[3]
z_kwadrat <- kraw_x^2 + kraw_y^2
0.5*sqrt(z_kwadrat)
```

--> - Powierzchnia zajmowana przez jedną próbkę</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pow_pr &lt;-<span class="st"> </span><span class="kw">area</span>(granica)/<span class="kw">length</span>(punkty)
pow_pr</code></pre></div>
<pre><code>##        0 
## 259740.3</code></pre>
<ul>
<li>Średnia odległość między punktami</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sqrt</span>(pow_pr)</code></pre></div>
<pre><code>##        0 
## 509.6473</code></pre>
</div>
<div id="semiwariogram-maksymalny-zasieg-semiwariogramu-ang.-cutoff-distance" class="section level3">
<h3><span class="header-section-number">4.3.16</span> Semiwariogram | Maksymalny zasięg semiwariogramu (ang. <em>Cutoff distance</em>)</h3>
<ul>
<li>Maksymalny zasięg semiwariogramu (ang. <em>Cutoff distance</em>) jest domyślnie wyliczany w pakiecie <strong>gstat</strong> jako 1/3 z najdłuższej przekątnej badanego obszaru</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vario_par &lt;-<span class="st"> </span><span class="kw">variogram</span>(temp~<span class="dv">1</span>, punkty)
vario_par</code></pre></div>
<pre><code>##      np      dist     gamma dir.hor dir.ver   id
## 1   106  216.1844  1.430239       0       0 var1
## 2   297  480.4988  2.917001       0       0 var1
## 3   483  809.9846  3.928418       0       0 var1
## 4   675 1120.7278  5.042605       0       0 var1
## 5   763 1435.6421  6.476427       0       0 var1
## 6   939 1751.4373  7.497110       0       0 var1
## 7  1038 2060.9052  8.419728       0       0 var1
## 8  1173 2375.2790  9.523110       0       0 var1
## 9  1284 2698.7080  9.853235       0       0 var1
## 10 1336 3010.7474 10.612134       0       0 var1
## 11 1346 3328.7317 10.364951       0       0 var1
## 12 1380 3647.2702 10.789531       0       0 var1
## 13 1426 3963.2623 12.021108       0       0 var1
## 14 1299 4280.0420 12.515079       0       0 var1
## 15 1431 4599.6926 14.808762       0       0 var1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(vario_par, <span class="dt">plot.numbers=</span><span class="ot">TRUE</span>)</code></pre></div>
<p><img src="03-eksp_przestrzenna_files/figure-html/unnamed-chunk-16-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vario_par &lt;-<span class="st"> </span><span class="kw">variogram</span>(temp~<span class="dv">1</span>, punkty, <span class="dt">cutoff =</span> <span class="dv">4000</span>)
<span class="kw">plot</span>(vario_par)</code></pre></div>
<p><img src="03-eksp_przestrzenna_files/figure-html/unnamed-chunk-16-2.png" alt="" /><!-- --></p>
</div>
<div id="semiwariogram-odlegosc-miedzy-przedziaami-ang-interval-width" class="section level3">
<h3><span class="header-section-number">4.3.17</span> Semiwariogram | Odległość między przedziałami (ang, <em>Interval width </em>)</h3>
<ul>
<li>Domyślnie to maksymalny zasięg semiwariogramu podzielony przez 15 dahe odległość między przedziałami (ang, <em>Interval width </em>)</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vario_par &lt;-<span class="st"> </span><span class="kw">variogram</span>(temp~<span class="dv">1</span>, punkty, <span class="dt">cutoff =</span> <span class="dv">1000</span>, <span class="dt">width =</span> <span class="dv">250</span>)
<span class="kw">plot</span>(vario_par)</code></pre></div>
<p><img src="03-eksp_przestrzenna_files/figure-html/unnamed-chunk-17-1.png" alt="" /><!-- --></p>
<!--
## Wpływa danych odstających

Tak jak inne statystyki typu wariancji, wartości kowariancji i semiwariogramu są bardzo czułe na występowanie danych ekstremalnych – potencjalnie błędnych. Stosuje się trzy sposoby aby ten problem rozwiązać:
Transformację matematyczną danych (logarytmowanie, pierwiastkowanie itp.) , aby zredukować skośność ich histogramu,
Usuwanie par danych, które zaburzają wartość semiwariancji dla określonych odstępów h. Procedura ta zwana jest czyszczeniem wykresu rozrzutu z przesunięciem („h-scattergram cleansing”).
Używanie innych statystyk h-scattergramu, które są mniej czułe na występowanie danych ekstremalnych.
### Rodogram/madogram


```r
# library('SpatialExtremes')
# n.site <- 15
# locations <- matrix(runif(2*n.site, 0, 10), ncol = 2)
# colnames(locations) <- c("lon", "lat")
# 
# ##Simulate a max-stable process - with unit Frechet margins
# data <- rmaxstab(40, locations, cov.mod = "whitmat", nugget = 0, range = 1,
#                  smooth = 2)
# 
# ##Compute the madogram
# madogram(data, locations)
# data2 <- matrix(c(punkty$temp, punkty$X2002.08.20_NDVI), nrow=2)
# locations2 <- coordinates(punkty)
# colnames(locations2) <- c("lon", "lat")
# madogram(data2, locations2)
```

-->
</div>
</div>
<div id="anizotropia" class="section level2">
<h2><span class="header-section-number">4.4</span> Anizotropia</h2>
<div id="anizotropia-struktury-przestrzennej" class="section level3">
<h3><span class="header-section-number">4.4.1</span> Anizotropia struktury przestrzennej</h3>
<ul>
<li>W wielu rzeczywistych sytuacjach, wartość cechy zależy nie tylko od odległości, ale także od kierunku</li>
</ul>
</div>
<div id="mapa-semiwariogramu" class="section level3">
<h3><span class="header-section-number">4.4.2</span> Mapa semiwariogramu</h3>
<ul>
<li>Mapa semiwariogramu (powierzchnia semiwariogramu) służy do określenia czy struktura przestrzenna zjawiska posiada anizotropię, a jeżeli tak to w jakim kierunku</li>
<li>Na podstawie mapy semiwariogramu identyfikuje się parametry potrzebne do zbudowania semiwariogramów kierunkowych</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vario_map &lt;-<span class="st"> </span><span class="kw">variogram</span>(temp~<span class="dv">1</span>, punkty, <span class="dt">cutoff=</span><span class="dv">4000</span>, <span class="dt">width=</span><span class="dv">400</span>, <span class="dt">map=</span><span class="ot">TRUE</span>)
<span class="kw">plot</span>(vario_map, <span class="dt">threshold=</span><span class="dv">30</span>) <span class="co"># co najmniej 30 par punktów</span></code></pre></div>
<p><img src="03-eksp_przestrzenna_files/figure-html/unnamed-chunk-19-1.png" alt="" /><!-- --></p>
</div>
<div id="mapa-semiwariogramu-3d" class="section level3">
<h3><span class="header-section-number">4.4.3</span> Mapa semiwariogramu | 3D</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&#39;rasterVis&#39;</span>)
<span class="kw">plot3D</span>(<span class="kw">raster</span>(vario_map$map), <span class="dt">col=</span>rainbow)</code></pre></div>
</div>
<div id="semiwariogramy-kierunkowe-kierunki" class="section level3">
<h3><span class="header-section-number">4.4.4</span> Semiwariogramy kierunkowe | Kierunki</h3>
<ul>
<li>W przypadku, gdy zjawisko wykazuje anizotropię przestrzenną, możliwe jest stworzenie semiwariogramów dla różnych wybranych kierunków</li>
<li>Przykładowo, dla argumentu <em>alpha = c(0, 45, 90, 135)</em> cztery główne kierunki to 0, 45, 90 i 135 stopni. Oznacza to, że dla kierunku 45 stopni brane pod uwagę będą wszystkie pary punktów pomiędzy 22,5 a 67,5 stopnia.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vario_kier &lt;-<span class="st"> </span><span class="kw">variogram</span>(temp~<span class="dv">1</span>, punkty, <span class="dt">alpha =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">45</span>, <span class="dv">90</span>, <span class="dv">135</span>))
<span class="kw">plot</span>(vario_kier)</code></pre></div>
<p><img src="03-eksp_przestrzenna_files/figure-html/unnamed-chunk-20-1.png" alt="" /><!-- --></p>
</div>
<div id="semiwariogramy-kierunkowe-kierunki-1" class="section level3">
<h3><span class="header-section-number">4.4.5</span> Semiwariogramy kierunkowe | Kierunki</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vario_kier &lt;-<span class="st"> </span><span class="kw">variogram</span>(temp~<span class="dv">1</span>, punkty, <span class="dt">alpha =</span> <span class="kw">c</span>(<span class="dv">60</span>, <span class="dv">105</span>, <span class="dv">150</span>, <span class="dv">195</span>))
<span class="kw">plot</span>(vario_kier)</code></pre></div>
<p><img src="03-eksp_przestrzenna_files/figure-html/unnamed-chunk-21-1.png" alt="" /><!-- --></p>
<!--
Kroskowariogramy
Kroskorelogramy
-->
</div>
</div>
<div id="krossemiwariogramy" class="section level2">
<h2><span class="header-section-number">4.5</span> Krossemiwariogramy</h2>
<div id="krossemiwariogramy-1" class="section level3">
<h3><span class="header-section-number">4.5.1</span> Krossemiwariogramy</h3>
<ul>
<li>Krossemiwariogram jest to wariancja różnicy pomiędzy dwiema zmiennymi w dwóch lokalizacjach</li>
<li>Wyliczając Krossemiwariogram otrzymujemy empiryczne semiwatiogramy dla dwóch badanych zmiennych oraz kroswariogram dla kombinacji dwóch zmiennych</li>
<li>Krossemiwariogram znajduje swoje zastosowanie w technice zwanej kokrigingiem</li>
</ul>
</div>
<div id="krossemiwariogramy-2" class="section level3">
<h3><span class="header-section-number">4.5.2</span> Krossemiwariogramy</h3>
<p>toDo <!--


```r
library('sp')
punkty <- read.csv('dane/punkty.csv')
coordinates(punkty) <- ~x+y
proj4string(punkty) <- '+init=epsg:2180'

punkty_255 <- punkty[!is.na(punkty$X1999.09.13_TPZ), ]
punkty_750 <- punkty

library('gstat')
g <- gstat(NULL, id="TPZ1999", form = X1999.09.13_TPZ~1, data = punkty_255)
g <- gstat(g, id="TPZ2000", form = temp~1, data = punkty_750)
g
plot(variogram(g))
```

### Krossemiwariogramy


```r
# plot(variogram(g, map=TRUE, cutoff=12000, width=800))
plot(variogram(g, alpha = c(60, 105, 150, 195)))
```

--></p>
<!--chapter:end:03-eksp_przestrzenna.Rmd-->
</div>
</div>
</div>
<div id="modelowanie-matematycznie-autokorelacji-przestrzennej" class="section level1">
<h1><span class="header-section-number">5</span> Modelowanie matematycznie autokorelacji przestrzennej</h1>
<div id="modelowanie-matematycznie-autokorelacji-przestrzennej-1" class="section level3">
<h3><span class="header-section-number">5.0.1</span> Modelowanie matematycznie autokorelacji przestrzennej</h3>
<ul>
<li>Semiwariogram empiryczny jest:
<ul>
<li>Nieciągły - wartości semiwariancji są średnimi przedziałowymi</li>
<li>Chaotyczny - badana próba jest jedynie przybliżeniem rzeczywistości, dodatkowo obciążonym błędami</li>
</ul></li>
<li>Estymacje i symulacje przestrzenne wymagają modelu struktury przestrzennej analizowanej cechy, a nie tylko wartości empirycznych (wyliczonych z danych)</li>
<li>Dodatkowo, matematycznie modelowanie wygładza chaotyczne fluktuacje danych empirycznych</li>
</ul>
</div>
<div id="modele-podstawowe" class="section level2">
<h2><span class="header-section-number">5.1</span> Modele podstawowe</h2>
<div id="modele-podstawowe-1" class="section level3">
<h3><span class="header-section-number">5.1.1</span> Modele podstawowe</h3>
<ul>
<li>Nuggetowy (ang. <em>Nugget effect model</em>)</li>
<li>Sferyczny (ang. <em>Spherical model</em>)</li>
<li>Gaussowski (ang. <em>Gaussian model</em>)</li>
<li>Potęgowy (ang. <em>Power model</em>)</li>
<li>Wykładniczy (ang. <em>Exponential model</em>)</li>
<li>Inne</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&#39;gstat&#39;</span>)
<span class="kw">vgm</span>()</code></pre></div>
<pre><code>##    short                                      long
## 1    Nug                              Nug (nugget)
## 2    Exp                         Exp (exponential)
## 3    Sph                           Sph (spherical)
## 4    Gau                            Gau (gaussian)
## 5    Exc               Exclass (Exponential class)
## 6    Mat                              Mat (Matern)
## 7    Ste Mat (Matern, M. Stein&#39;s parameterization)
## 8    Cir                            Cir (circular)
## 9    Lin                              Lin (linear)
## 10   Bes                              Bes (bessel)
## 11   Pen                      Pen (pentaspherical)
## 12   Per                            Per (periodic)
## 13   Wav                                Wav (wave)
## 14   Hol                                Hol (hole)
## 15   Log                         Log (logarithmic)
## 16   Pow                               Pow (power)
## 17   Spl                              Spl (spline)
## 18   Leg                            Leg (Legendre)
## 19   Err                   Err (Measurement error)
## 20   Int                           Int (Intercept)</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">show.vgms</span>()</code></pre></div>
<p><img src="04-modelowanie_files/figure-html/unnamed-chunk-2-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">show.vgms</span>(<span class="dt">models=</span><span class="kw">c</span>(<span class="st">&quot;Nug&quot;</span>, <span class="st">&quot;Sph&quot;</span>, <span class="st">&quot;Gau&quot;</span>, <span class="st">&quot;Pow&quot;</span>, <span class="st">&quot;Exp&quot;</span>), <span class="dt">range=</span><span class="fl">1.4</span>, <span class="dt">max=</span><span class="fl">2.5</span>)</code></pre></div>
<p><img src="04-modelowanie_files/figure-html/unnamed-chunk-3-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">show.vgms</span>(<span class="dt">models=</span><span class="kw">c</span>(<span class="st">&quot;Nug&quot;</span>, <span class="st">&quot;Sph&quot;</span>, <span class="st">&quot;Gau&quot;</span>, <span class="st">&quot;Pow&quot;</span>, <span class="st">&quot;Exp&quot;</span>), <span class="dt">range=</span><span class="fl">1.4</span>, <span class="dt">max=</span><span class="fl">2.5</span>, <span class="dt">as.groups =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p><img src="04-modelowanie_files/figure-html/unnamed-chunk-4-1.png" alt="" /><!-- --></p>
</div>
</div>
<div id="metody-modelowania" class="section level2">
<h2><span class="header-section-number">5.2</span> Metody modelowania</h2>
<div id="metody-modelowania-1" class="section level3">
<h3><span class="header-section-number">5.2.1</span> Metody modelowania</h3>
<ul>
<li>Ustawianie “ręczne” parametrów modelu, np. funkcja <em>vgm</em> z pakietu <strong>gstat</strong></li>
<li>Ustawianie “wizualne” parametrów modelu, np. funkcja <em>eyefit</em> z pakietu <strong>geoR</strong></li>
<li>Automatyczny wybór parametrów na podstawie różnych kryterów statystycznych, np. funkcja <em>fit.variogram</em> z pakietu <strong>gstat</strong>, <em>variofit</em> z pakietu <strong>geoR</strong>, <em>autofitVariogram</em> z pakietu <strong>automap</strong></li>
</ul>
</div>
<div id="metody-modelowania-2" class="section level3">
<h3><span class="header-section-number">5.2.2</span> Metody modelowania</h3>
<ul>
<li>Odpowiednie określenie modelu matematycznego często nie jest proste</li>
<li>Automatyczne metody nie zawsze są w stanie dać lepszy wynik od modelowania “ręcznego”</li>
<li>Najlepiej, gdy wybór modelu oparty jest o wiedzę na temat zakładanego procesu przestrzennego</li>
</ul>
</div>
<div id="metody-modelowania-liniowy-model-regionalizacji" class="section level3">
<h3><span class="header-section-number">5.2.3</span> Metody modelowania | Liniowy model regionalizacji</h3>
<ul>
<li>W przypadku, gdy analizowane zjawisko jest złożone, odwzorowanie kształtu semiwariogramu empirycznego wymaga połączenia dwóch lub większej liczby modeli podstawowych</li>
<li>W takiej sytuacji konieczne jest spełnienie dwóch warunków:
<ul>
<li>Wszystkie zastosowane modele muszą być dopuszczalne (<em>vgm()</em>)</li>
<li>Wariancja progowa każdego podstawowego modelu musi być dodatnia</li>
</ul></li>
</ul>
</div>
</div>
<div id="modelowanie-semiwariogramu" class="section level2">
<h2><span class="header-section-number">5.3</span> Modelowanie semiwariogramu</h2>
<div id="modelowanie-semiwariogramu-funkcja-fit.variogram" class="section level3">
<h3><span class="header-section-number">5.3.1</span> Modelowanie semiwariogramu | funkcja <em>fit.variogram</em></h3>
<ul>
<li>Funkcja <em>fit.variogram</em> dopasowuje zasięg oraz semiwariancję progową w oparciu o ustalone “ręcznie” parametry modelu</li>
</ul>
<!--
 Modelowanie semiwariogramu



-->
</div>
</div>
<div id="modelowanie-izotropowe" class="section level2">
<h2><span class="header-section-number">5.4</span> Modelowanie izotropowe</h2>
<div id="modelowanie-izotropowe-modelowanie-wizualne" class="section level3">
<h3><span class="header-section-number">5.4.1</span> Modelowanie izotropowe | Modelowanie “wizualne”</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&#39;geoR&#39;</span>)
v_eye &lt;-<span class="st"> </span><span class="kw">eyefit</span>(<span class="kw">variog</span>(<span class="kw">as.geodata</span>(punkty, <span class="st">&quot;temp&quot;</span>)))
ve_fit &lt;-<span class="st"> </span><span class="kw">as.vgm.variomodel</span>(v_eye[[<span class="dv">1</span>]])</code></pre></div>
</div>
<div id="modelowanie-izotropowe-model-nuggetowy" class="section level3">
<h3><span class="header-section-number">5.4.2</span> Modelowanie izotropowe | Model nuggetowy</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&#39;raster&#39;</span>)
<span class="kw">library</span>(<span class="st">&#39;gstat&#39;</span>)
vario &lt;-<span class="st"> </span><span class="kw">variogram</span>(temp~<span class="dv">1</span>, punkty)
<span class="kw">plot</span>(vario)</code></pre></div>
<p><img src="04-modelowanie_files/figure-html/unnamed-chunk-5-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model_nug &lt;-<span class="st"> </span><span class="kw">vgm</span>(<span class="dv">10</span>, <span class="dt">model =</span> <span class="st">&#39;Nug&#39;</span>)
model_nug</code></pre></div>
<pre><code>##   model psill range
## 1   Nug    10     0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(vario, <span class="dt">model=</span>model_nug)</code></pre></div>
<p><img src="04-modelowanie_files/figure-html/unnamed-chunk-5-2.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fitted_nug &lt;-<span class="st"> </span><span class="kw">fit.variogram</span>(vario, model_nug)
fitted_nug</code></pre></div>
<pre><code>##   model    psill range
## 1   Nug 4.452686     0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(vario, <span class="dt">model=</span>fitted_nug)</code></pre></div>
<p><img src="04-modelowanie_files/figure-html/unnamed-chunk-5-3.png" alt="" /><!-- --></p>
</div>
<div id="modelowanie-izotropowe-model-sferyczny" class="section level3">
<h3><span class="header-section-number">5.4.3</span> Modelowanie izotropowe | Model sferyczny</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vario &lt;-<span class="st"> </span><span class="kw">variogram</span>(temp~<span class="dv">1</span>, punkty)
<span class="kw">plot</span>(vario)</code></pre></div>
<p><img src="04-modelowanie_files/figure-html/unnamed-chunk-6-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model_sph &lt;-<span class="st"> </span><span class="kw">vgm</span>(<span class="dt">psill=</span><span class="dv">10</span>, <span class="dt">model =</span> <span class="st">&#39;Sph&#39;</span>, <span class="dt">range=</span><span class="dv">3000</span>)
model_sph</code></pre></div>
<pre><code>##   model psill range
## 1   Sph    10  3000</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(vario, <span class="dt">model=</span>model_sph)</code></pre></div>
<p><img src="04-modelowanie_files/figure-html/unnamed-chunk-6-2.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fitted_sph &lt;-<span class="st"> </span><span class="kw">fit.variogram</span>(vario, model_sph)
fitted_sph</code></pre></div>
<pre><code>##   model    psill    range
## 1   Sph 11.62526 3656.101</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(vario, <span class="dt">model=</span>fitted_sph)</code></pre></div>
<p><img src="04-modelowanie_files/figure-html/unnamed-chunk-6-3.png" alt="" /><!-- --></p>
</div>
<div id="modelowanie-izotropowe-model-gaussowski" class="section level3">
<h3><span class="header-section-number">5.4.4</span> Modelowanie izotropowe | Model Gaussowski</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vario &lt;-<span class="st"> </span><span class="kw">variogram</span>(temp~<span class="dv">1</span>, punkty)
<span class="kw">plot</span>(vario)</code></pre></div>
<p><img src="04-modelowanie_files/figure-html/unnamed-chunk-7-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model_gau &lt;-<span class="st"> </span><span class="kw">vgm</span>(<span class="dt">psill=</span><span class="dv">15</span>, <span class="dt">model =</span> <span class="st">&#39;Gau&#39;</span>, <span class="dt">range=</span><span class="dv">3000</span>)
model_gau</code></pre></div>
<pre><code>##   model psill range
## 1   Gau    15  3000</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(vario, <span class="dt">model=</span>model_gau)</code></pre></div>
<p><img src="04-modelowanie_files/figure-html/unnamed-chunk-7-2.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fitted_gau &lt;-<span class="st"> </span><span class="kw">fit.variogram</span>(vario, model_gau)
fitted_gau</code></pre></div>
<pre><code>##   model    psill    range
## 1   Gau 8.474184 806.0176</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(vario, <span class="dt">model=</span>fitted_gau)</code></pre></div>
<p><img src="04-modelowanie_files/figure-html/unnamed-chunk-7-3.png" alt="" /><!-- --></p>
</div>
<div id="modelowanie-izotropowe-model-potegowy" class="section level3">
<h3><span class="header-section-number">5.4.5</span> Modelowanie izotropowe | Model potęgowy</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vario &lt;-<span class="st"> </span><span class="kw">variogram</span>(temp~<span class="dv">1</span>, punkty)
<span class="kw">plot</span>(vario)</code></pre></div>
<p><img src="04-modelowanie_files/figure-html/unnamed-chunk-8-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model_pow &lt;-<span class="st"> </span><span class="kw">vgm</span>(<span class="dt">psill=</span><span class="dv">1</span>, <span class="dt">model =</span> <span class="st">&#39;Pow&#39;</span>, <span class="dt">range=</span><span class="fl">0.30</span>)
model_pow</code></pre></div>
<pre><code>##   model psill range
## 1   Pow     1   0.3</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(vario, <span class="dt">model=</span>model_pow)</code></pre></div>
<p><img src="04-modelowanie_files/figure-html/unnamed-chunk-8-2.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fitted_pow &lt;-<span class="st"> </span><span class="kw">fit.variogram</span>(vario, model_pow)
fitted_pow</code></pre></div>
<pre><code>##   model      psill     range
## 1   Pow 0.03578134 0.7082075</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(vario, <span class="dt">model=</span>fitted_pow)</code></pre></div>
<p><img src="04-modelowanie_files/figure-html/unnamed-chunk-8-3.png" alt="" /><!-- --></p>
</div>
<div id="modelowanie-izotropowe-model-wykadniczy" class="section level3">
<h3><span class="header-section-number">5.4.6</span> Modelowanie izotropowe | Model wykładniczy</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vario &lt;-<span class="st"> </span><span class="kw">variogram</span>(temp~<span class="dv">1</span>, punkty)
<span class="kw">plot</span>(vario)</code></pre></div>
<p><img src="04-modelowanie_files/figure-html/unnamed-chunk-9-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model_exp &lt;-<span class="st"> </span><span class="kw">vgm</span>(<span class="dt">psill=</span><span class="dv">10</span>, <span class="dt">model =</span> <span class="st">&#39;Exp&#39;</span>, <span class="dt">range=</span><span class="dv">900</span>)
model_exp</code></pre></div>
<pre><code>##   model psill range
## 1   Exp    10   900</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(vario, <span class="dt">model=</span>model_exp)</code></pre></div>
<p><img src="04-modelowanie_files/figure-html/unnamed-chunk-9-2.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fitted_exp &lt;-<span class="st"> </span><span class="kw">fit.variogram</span>(vario, model_exp)
fitted_exp</code></pre></div>
<pre><code>##   model    psill    range
## 1   Exp 15.44448 2611.625</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(vario, <span class="dt">model=</span>fitted_exp)</code></pre></div>
<p><img src="04-modelowanie_files/figure-html/unnamed-chunk-9-3.png" alt="" /><!-- --></p>
</div>
<div id="modelowanie-izotropowe-modele-zozone-i" class="section level3">
<h3><span class="header-section-number">5.4.7</span> Modelowanie izotropowe | Modele złożone I</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vario &lt;-<span class="st"> </span><span class="kw">variogram</span>(temp~<span class="dv">1</span>, punkty)
model_zl1 &lt;-<span class="st"> </span><span class="kw">vgm</span>(<span class="dt">psill=</span><span class="dv">10</span>, <span class="dt">model =</span> <span class="st">&#39;Sph&#39;</span>, <span class="dt">range =</span> <span class="dv">3000</span>, <span class="dt">add.to =</span> <span class="kw">vgm</span>(<span class="fl">0.5</span>, <span class="st">&quot;Nug&quot;</span>))
model_zl1</code></pre></div>
<pre><code>##   model psill range
## 1   Nug   0.5     0
## 2   Sph  10.0  3000</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(vario, <span class="dt">model=</span>model_zl1)</code></pre></div>
<p><img src="04-modelowanie_files/figure-html/unnamed-chunk-10-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fitted_zl1 &lt;-<span class="st"> </span><span class="kw">fit.variogram</span>(vario, model_zl1)
fitted_zl1</code></pre></div>
<pre><code>##   model      psill    range
## 1   Nug  0.7886708    0.000
## 2   Sph 11.9758279 4637.317</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(vario, <span class="dt">model=</span>fitted_zl1)</code></pre></div>
<p><img src="04-modelowanie_files/figure-html/unnamed-chunk-10-2.png" alt="" /><!-- --></p>
</div>
<div id="modelowanie-izotropowe-modele-zozone-ii" class="section level3">
<h3><span class="header-section-number">5.4.8</span> Modelowanie izotropowe | Modele złożone II</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vario &lt;-<span class="st"> </span><span class="kw">variogram</span>(temp~<span class="dv">1</span>, punkty)
model_zl2 &lt;-<span class="st"> </span><span class="kw">vgm</span>(<span class="dv">2</span>, <span class="st">&quot;Gau&quot;</span>, <span class="dv">3000</span>, <span class="dt">add.to =</span> <span class="kw">vgm</span>(<span class="dv">8</span>, <span class="dt">model =</span> <span class="st">&#39;Sph&#39;</span>, <span class="dt">range =</span> <span class="dv">2000</span>, <span class="dt">nugget =</span> <span class="fl">0.5</span>))
model_zl2</code></pre></div>
<pre><code>##   model psill range
## 1   Nug   0.5     0
## 2   Sph   8.0  2000
## 3   Gau   2.0  3000</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(vario, <span class="dt">model=</span>model_zl2)</code></pre></div>
<p><img src="04-modelowanie_files/figure-html/unnamed-chunk-11-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fitted_zl2 &lt;-<span class="st"> </span><span class="kw">fit.variogram</span>(vario, model_zl2)
<span class="kw">plot</span>(vario, <span class="dt">model=</span>fitted_zl2)</code></pre></div>
<p><img src="04-modelowanie_files/figure-html/unnamed-chunk-11-2.png" alt="" /><!-- --></p>
</div>
</div>
<div id="modelowanie-anizotropowe" class="section level2">
<h2><span class="header-section-number">5.5</span> Modelowanie anizotropowe</h2>
<div id="anizotropia-1" class="section level3">
<h3><span class="header-section-number">5.5.1</span> Anizotropia</h3>
<ul>
<li>Uwzględnienie anizotropii wymaga zamiany parametru zasięgu na trzy inne parametry:</li>
<li>Zasięg w dominującym kierunku</li>
<li>Kąt określający dominujący kierunek</li>
<li>Proporcję anizotropii, czyli relację pomiędzy zasięgiem w dominującym kierunku a zasięgiem w przeciwległym kierunku</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vario_map &lt;-<span class="st"> </span><span class="kw">variogram</span>(temp~<span class="dv">1</span>, punkty, <span class="dt">cutoff=</span><span class="dv">4000</span>, <span class="dt">width=</span><span class="dv">400</span>, <span class="dt">map=</span><span class="ot">TRUE</span>)
<span class="kw">plot</span>(vario_map)</code></pre></div>
<p><img src="04-modelowanie_files/figure-html/unnamed-chunk-12-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vario_kier &lt;-<span class="st"> </span><span class="kw">variogram</span>(temp~<span class="dv">1</span>, punkty, <span class="dt">alpha =</span> <span class="kw">c</span>(<span class="dv">60</span>, <span class="dv">105</span>, <span class="dv">150</span>, <span class="dv">195</span>), <span class="dt">cutoff=</span><span class="dv">20000</span>)
<span class="kw">plot</span>(vario_kier, <span class="dt">plot.numbers=</span><span class="ot">TRUE</span>)</code></pre></div>
<p><img src="04-modelowanie_files/figure-html/unnamed-chunk-12-2.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vario_kier_fit &lt;-<span class="st"> </span><span class="kw">vgm</span>(<span class="dt">psill=</span><span class="dv">8</span>, <span class="dt">model=</span><span class="st">&quot;Sph&quot;</span>, <span class="dt">range=</span><span class="dv">4000</span>, <span class="dt">nugget=</span><span class="fl">0.5</span>, <span class="dt">anis =</span> <span class="kw">c</span>(<span class="dv">60</span>, .<span class="dv">4</span>))
<span class="kw">plot</span>(vario_kier, vario_kier_fit, <span class="dt">as.table=</span><span class="ot">TRUE</span>)</code></pre></div>
<p><img src="04-modelowanie_files/figure-html/unnamed-chunk-12-3.png" alt="" /><!-- --></p>
</div>
</div>
<div id="modelowanie-krossemiwariogramow" class="section level2">
<h2><span class="header-section-number">5.6</span> Modelowanie krossemiwariogramów</h2>
<div id="modelowanie-krossemiwariogramow-fit.lmc" class="section level3">
<h3><span class="header-section-number">5.6.1</span> Modelowanie krossemiwariogramów | <em>fit.lmc</em></h3>
<ul>
<li>Funkcja <em>fit.lmc</em> dopasowuje liniowy model koregionalizacji do semiwariogramów wielozmienych</li>
</ul>
</div>
<div id="modelowanie-krossemiwariogramow-1" class="section level3">
<h3><span class="header-section-number">5.6.2</span> Modelowanie krossemiwariogramów</h3>
<p>toDo</p>
<!--

```r
punkty_255 <- punkty[!is.na(punkty$temp), ]
punkty_750 <- punkty

library('gstat')
g <- gstat(NULL, id="TPZ1999", form = temp~1, data = punkty_255)
g <- gstat(g, id="TPZ2002", form = temp~1, data = punkty_750)
g
v <- variogram(g)
plot(v)
g <- gstat(g, model=vgm(17, "Sph", 12000, 5), fill.all=TRUE)
g_fit <- fit.lmc(v, g, fit.ranges = FALSE, fit.method=1)
g_fit
plot(v, g_fit)
```

-->
<!--chapter:end:04-modelowanie.Rmd-->
</div>
</div>
</div>
<div id="estymacje-jednozmienne" class="section level1">
<h1><span class="header-section-number">6</span> Estymacje jednozmienne</h1>
<div id="kriging" class="section level2">
<h2><span class="header-section-number">6.1</span> Kriging</h2>
<div id="kriging-interpolacja-geostatystyczna" class="section level3">
<h3><span class="header-section-number">6.1.1</span> Kriging | Interpolacja geostatystyczna</h3>
<ul>
<li>Zaproponowana w latach 50. przez Daniela Krige</li>
<li>Istnieje wiele rodzajów krigingu</li>
<li>Główna zasada mówi, że prognoza w danej lokalizacji jest kombinacją obokległych obserwacji</li>
<li>Waga nadawana każdej z obserwacji jest zależna od stopnia (przestrzennej) korelacji - stąd też bierze się istotna rola semiwariogramów</li>
</ul>
</div>
</div>
<div id="rodzaje-krigingu" class="section level2">
<h2><span class="header-section-number">6.2</span> Rodzaje krigingu</h2>
<div id="rodzaje-krigingu-1" class="section level3">
<h3><span class="header-section-number">6.2.1</span> Rodzaje krigingu</h3>
<ul>
<li>Kriging prosty (ang. <em>Simple kriging</em>)</li>
<li>Kriging zwykły (ang. <em>Ordinary kriging</em>)</li>
<li>Kriging z trendem (ang. <em>Kriging with a trend</em>)</li>
<li>Kriging stratyfikowany (ang. <em>Kriging within strata</em> – KWS)</li>
<li>Kriging prosty ze zmiennymi średnimi lokalnymi (ang. <em>Simple kriging with varying local means</em> - SKlm)</li>
<li>Kriging z zewnętrznym trendem/Uniwersalny kriging (ang.<em>Kriging with an external trend/Universal kriging</em>)</li>
<li>Kriging danych kodowanych (ang. <em>Indicator kriging</em>)</li>
<li>Kokriging (ang. <em>Co-kriging</em>)</li>
<li>Inne</li>
</ul>
</div>
</div>
<div id="kriging-prosty-ang.-simple-kriging" class="section level2">
<h2><span class="header-section-number">6.3</span> Kriging prosty (ang. <em>Simple kriging</em>)</h2>
<div id="kriging-prosty-ang.-simple-kriging-1" class="section level3">
<h3><span class="header-section-number">6.3.1</span> Kriging prosty (ang. <em>Simple kriging</em>)</h3>
<ul>
<li>Zakłada, że średnia jest znana i stała na całym obszarze</li>
</ul>
</div>
<div id="kriging-prosty-ang.-simple-kriging-2" class="section level3">
<h3><span class="header-section-number">6.3.2</span> Kriging prosty (ang. <em>Simple kriging</em>)</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&#39;raster&#39;</span>)
ras &lt;-<span class="st"> </span><span class="kw">raster</span>(<span class="st">&#39;dane/siatka.tif&#39;</span>)
grid &lt;-<span class="st"> </span><span class="kw">as</span>(ras, <span class="st">&quot;SpatialGridDataFrame&quot;</span>)
<span class="kw">proj4string</span>(grid) &lt;-<span class="st"> </span><span class="kw">proj4string</span>(punkty)

<span class="kw">library</span>(<span class="st">&#39;gstat&#39;</span>)
vario &lt;-<span class="st"> </span><span class="kw">variogram</span>(temp~<span class="dv">1</span>, punkty)
model &lt;-<span class="st"> </span><span class="kw">vgm</span>(<span class="dv">10</span>, <span class="dt">model =</span> <span class="st">&#39;Sph&#39;</span>, <span class="dt">range =</span> <span class="dv">4000</span>, <span class="dt">nugget =</span> <span class="fl">0.5</span>)
model</code></pre></div>
<pre><code>##   model psill range
## 1   Nug   0.5     0
## 2   Sph  10.0  4000</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fitted &lt;-<span class="st"> </span><span class="kw">fit.variogram</span>(vario, model)
<span class="kw">plot</span>(vario, <span class="dt">model=</span>fitted)</code></pre></div>
<p><img src="05-estymacje_files/figure-html/unnamed-chunk-1-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sk &lt;-<span class="st"> </span><span class="kw">krige</span>(temp~<span class="dv">1</span>, punkty, grid, <span class="dt">model=</span>fitted, <span class="dt">beta=</span><span class="fl">15.324</span>)</code></pre></div>
<pre><code>## [using simple kriging]</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(sk)</code></pre></div>
<pre><code>## Object of class SpatialGridDataFrame
## Coordinates:
##         min      max
## s1 745541.7 757001.7
## s2 712646.2 721256.2
## Is projected: TRUE 
## proj4string :
## [+init=epsg:2180 +proj=tmerc +lat_0=0 +lon_0=19 +k=0.9993
## +x_0=500000 +y_0=-5300000 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0
## +units=m +no_defs]
## Grid attributes:
##    cellcentre.offset cellsize cells.dim
## s1          745556.7       30       382
## s2          712661.2       30       287
## Data attributes:
##    var1.pred         var1.var    
##  Min.   : 8.316   Min.   :1.134  
##  1st Qu.:12.545   1st Qu.:2.022  
##  Median :14.927   Median :2.373  
##  Mean   :15.469   Mean   :2.462  
##  3rd Qu.:18.070   3rd Qu.:2.751  
##  Max.   :25.362   Max.   :6.317  
##  NA&#39;s   :11142    NA&#39;s   :11142</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">spplot</span>(sk, <span class="st">&quot;var1.pred&quot;</span>)
<span class="kw">spplot</span>(sk, <span class="st">&quot;var1.var&quot;</span>)</code></pre></div>
<p><img src="05-estymacje_files/figure-html/plotsy2-1.png" alt="" /><!-- --></p>
</div>
</div>
<div id="kriging-zwyky-ang.-ordinary-kriging" class="section level2">
<h2><span class="header-section-number">6.4</span> Kriging zwykły (ang. <em>Ordinary kriging</em>)</h2>
<div id="kriging-zwyky-ang.-ordinary-kriging-1" class="section level3">
<h3><span class="header-section-number">6.4.1</span> Kriging zwykły (ang. <em>Ordinary kriging</em>)</h3>
<ul>
<li>Średnia traktowana jest jako nieznana</li>
<li>Uwzględnia lokalne fluktuacje średniej poprzez stosowanie ruchomego okna</li>
</ul>
</div>
<div id="kriging-zwyky-ang.-ordinary-kriging-2" class="section level3">
<h3><span class="header-section-number">6.4.2</span> Kriging zwykły (ang. <em>Ordinary kriging</em>)</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ok &lt;-<span class="st"> </span><span class="kw">krige</span>(temp~<span class="dv">1</span>, punkty, grid, <span class="dt">model=</span>fitted, <span class="dt">maxdist=</span><span class="dv">1000</span>)</code></pre></div>
<pre><code>## [using ordinary kriging]</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># ok &lt;- krige(temp~1, punkty, grid, model=fitted, nmax=30)</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">spplot</span>(ok, <span class="st">&quot;var1.pred&quot;</span>)
<span class="kw">spplot</span>(ok, <span class="st">&quot;var1.var&quot;</span>)</code></pre></div>
<p><img src="05-estymacje_files/figure-html/plotsy2ok2-1.png" alt="" /><!-- --></p>
<!--


```r
spplot(ok, "var1.pred", sp.layout=list(punkty, pch=21, col="white"))
```

![](05-estymacje_files/figure-html/unnamed-chunk-3-1.png)<!-- -->
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">spplot</span>(ok, <span class="st">&quot;var1.var&quot;</span>, <span class="dt">sp.layout=</span><span class="kw">list</span>(punkty, <span class="dt">pch=</span><span class="dv">21</span>, <span class="dt">col=</span><span class="st">&quot;white&quot;</span>))</code></pre></div>
<p><img src="05-estymacje_files/figure-html/unnamed-chunk-3-2.png" alt="" /><!-- --></p>
<p>–&gt; ## Kriging z trendem (ang. <em>Kriging with a trend</em>) ### Kriging z trendem (ang. <em>Kriging with a trend</em>)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vario_kzt &lt;-<span class="st"> </span><span class="kw">variogram</span>(temp~x+y, <span class="dt">data=</span>punkty)
<span class="kw">plot</span>(vario_kzt)</code></pre></div>
<p><img src="05-estymacje_files/figure-html/unnamed-chunk-4-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model_kzt &lt;-<span class="st"> </span><span class="kw">vgm</span>(<span class="dt">psill =</span> <span class="dv">5</span>, <span class="dt">model =</span> <span class="st">&#39;Sph&#39;</span>, <span class="dt">range =</span> <span class="dv">2500</span>, <span class="dt">nugget =</span> <span class="dv">1</span>)
fitted_kzt &lt;-<span class="st"> </span><span class="kw">fit.variogram</span>(vario_kzt, model_kzt)
fitted_kzt</code></pre></div>
<pre><code>##   model     psill    range
## 1   Nug 0.7272135    0.000
## 2   Sph 6.1096673 2355.502</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(vario_kzt, fitted_kzt)</code></pre></div>
<p><img src="05-estymacje_files/figure-html/unnamed-chunk-4-2.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">grid_sp &lt;-<span class="st"> </span><span class="kw">as</span>(ras, <span class="st">&quot;SpatialPixelsDataFrame&quot;</span>)
<span class="kw">proj4string</span>(grid_sp) &lt;-<span class="st"> </span><span class="kw">proj4string</span>(punkty)
grid_sp@data &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">coordinates</span>(grid_sp))

punkty@data &lt;-<span class="st"> </span><span class="kw">cbind</span>(punkty@data, <span class="kw">as.data.frame</span>(<span class="kw">coordinates</span>(punkty)))
kzt &lt;-<span class="st"> </span><span class="kw">krige</span>(temp~x+y, punkty, grid_sp, <span class="dt">model=</span>fitted_kzt)</code></pre></div>
<pre><code>## [using universal kriging]</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">spplot</span>(kzt, <span class="st">&quot;var1.pred&quot;</span>)
<span class="kw">spplot</span>(kzt, <span class="st">&quot;var1.var&quot;</span>)</code></pre></div>
<p><img src="05-estymacje_files/figure-html/plotsy2kzt-1.png" alt="" /><!-- --></p>
</div>
</div>
<div id="porownanie-wynikow-sk-ok-i-kzt" class="section level2">
<h2><span class="header-section-number">6.5</span> Porównanie wyników SK, OK i KZT</h2>
<p><img src="05-estymacje_files/figure-html/ploty_trzy-1.png" alt="" /><!-- --></p>
<!--chapter:end:05-estymacje.Rmd-->
</div>
</div>
<div id="ocena-jakosci-estymacji-uwaga-pomieszany-me-z-reszta" class="section level1">
<h1><span class="header-section-number">7</span> Ocena jakości estymacji [UWAGA POMIESZANY ME Z RESZTĄ!!]</h1>
<div id="statystyki-jakosci-estymacji" class="section level2">
<h2><span class="header-section-number">7.1</span> Statystyki jakości estymacji</h2>
<div id="statystyki-jakosci-estymacji-1" class="section level3">
<h3><span class="header-section-number">7.1.1</span> Statystyki jakości estymacji</h3>
<ul>
<li>Służą do oceny i porównania jakości estymacji</li>
<li>Do podstawowych statystyk ocen jakości estymacji należą:
<ul>
<li>Średni błąd estymacji (ME, ang. <em>mean error</em>)</li>
<li>Pierwiastek średniego błędu kwadratowego (RMSE, ang. <em>root square prediction error</em>)</li>
<li>Współczynnik korelacji</li>
<li>Rozkład błędu (np. 5. percentyl, mediana, 95. percentyl)</li>
</ul></li>
</ul>
</div>
<div id="statystyki-jakosci-estymacji-2" class="section level3">
<h3><span class="header-section-number">7.1.2</span> Statystyki jakości estymacji</h3>
<ul>
<li>Idealna estymacja dawałaby brak błędu oraz wspołczynnik korelacji pomiędzy pomiarami (całą populacją) i szacunkiem równy 1</li>
<li>Wysokie, pojedyncze wartości błędu mogą świadczyć, np. o wystapieniu wartości odstających</li>
</ul>
</div>
<div id="sredni-bad-estymacji" class="section level3">
<h3><span class="header-section-number">7.1.3</span> Średni błąd estymacji</h3>
<ul>
<li>Optymalnie wartość średniego błędu estymacji powinna być jak najbliżej 0</li>
</ul>
<p><span class="math display">\[ ME=\frac{\sum_{i=1}^{n}(\hat{v}_i-v_i)}{n} \]</span></p>
</div>
<div id="pierwiastek-sredniego-bedu-kwadratowego" class="section level3">
<h3><span class="header-section-number">7.1.4</span> Pierwiastek średniego błędu kwadratowego</h3>
<ul>
<li>Optymalnie wartość pierwiastka średniego błędu kwadratowego powinna być jak najmniejsza</li>
</ul>
<p><span class="math display">\[ RMSE=\sqrt{\frac{\sum_{i=1}^{n}(\hat{v}_i-v_i)^2}{n}} \]</span></p>
</div>
<div id="wspoczynnik-korelacji-1" class="section level3">
<h3><span class="header-section-number">7.1.5</span> Współczynnik korelacji</h3>
<ul>
<li>Optymalnie wartość współczynnika korelacji powinna być jak najwyższa</li>
</ul>
</div>
<div id="statystyki-jakosci-estymacji-mapa" class="section level3">
<h3><span class="header-section-number">7.1.6</span> Statystyki jakości estymacji | Mapa</h3>
<pre><code>## [using simple kriging]</code></pre>
<p><img src="06-ocena_files/figure-html/mapa-1.png" alt="" /><!-- --></p>
</div>
<div id="statystyki-jakosci-estymacji-histogram" class="section level3">
<h3><span class="header-section-number">7.1.7</span> Statystyki jakości estymacji | Histogram</h3>
<p><img src="06-ocena_files/figure-html/hist-1.png" alt="" /><!-- --></p>
</div>
<div id="statystyki-jakosci-estymacji-wykres-rozrzutu" class="section level3">
<h3><span class="header-section-number">7.1.8</span> Statystyki jakości estymacji | Wykres rozrzutu</h3>
<p><img src="06-ocena_files/figure-html/point-1.png" alt="" /><!-- --></p>
</div>
</div>
<div id="walidacja-wynikow-estymacji" class="section level2">
<h2><span class="header-section-number">7.2</span> Walidacja wyników estymacji</h2>
<div id="walidacja-wynikow-estymacji-1" class="section level3">
<h3><span class="header-section-number">7.2.1</span> Walidacja wyników estymacji</h3>
<ul>
<li>Dokładne dopasowanie modelu do danych może w efekcie nie dawać najlepszych wyników</li>
<li>W efekcie ważne jest stosowanie metod pozwalających na wybranie optymalnego modelu</li>
<li>Do takich metod należy, między innymi, walidacja podzbiorem (ang. <em>jackknifing</em>) oraz kroswalidacja (ang. <em>crossvalidation</em>)</li>
</ul>
</div>
<div id="walidacja-podzbiorem" class="section level3">
<h3><span class="header-section-number">7.2.2</span> Walidacja podzbiorem</h3>
<ul>
<li>Polega na podziale zbioru danych na dwa podzbiory - treningowy i testowy</li>
<li>Zbiór treningowy służy do estymacji wartości</li>
<li>Wynik estymacji porównywany jest z rzeczywistymi wartościami ze zbioru testowego</li>
<li>Zaletą tego podejścia jest stosowanie danych niezależnych od estymacji</li>
<li>Wadą jest konieczność posiadania dużego zbioru danych</li>
</ul>
</div>
<div id="walidacja-podzbiorem-1" class="section level3">
<h3><span class="header-section-number">7.2.3</span> Walidacja podzbiorem</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&#39;caret&#39;</span>)
<span class="kw">set.seed</span>(<span class="dv">124</span>)
indeks &lt;-<span class="st"> </span><span class="kw">as.vector</span>(<span class="kw">createDataPartition</span>(punkty$temp, <span class="dt">p=</span><span class="fl">0.75</span>, <span class="dt">list=</span><span class="ot">FALSE</span>))
indeks</code></pre></div>
<pre><code>##   [1]   1   2   5   6   7   8   9  10  11  12  15  16  17  18  20  21  23
##  [18]  24  25  26  28  30  31  32  33  34  35  36  38  39  41  42  44  45
##  [35]  46  47  48  51  53  54  59  60  63  65  66  67  71  72  73  74  75
##  [52]  77  78  81  82  83  84  85  86  87  88  89  90  91  92  93  94  95
##  [69]  96  98  99 100 101 102 103 105 106 107 108 109 110 111 112 116 117
##  [86] 118 119 120 121 122 123 126 128 129 130 132 134 135 136 138 139 140
## [103] 141 142 144 145 146 147 148 149 150 151 153 154 155 156 158 159 161
## [120] 162 163 164 166 167 169 171 172 174 175 176 177 178 179 180 181 183
## [137] 184 185 186 187 188 189 190 191 193 194 195 196 197 198 199 200 201
## [154] 203 204 206 207 210 211 212 213 214 215 216 217 218 219 220 221 223
## [171] 224 226 227 228 229 231 232 234 235 236 237 238 242 244</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">train &lt;-<span class="st"> </span>punkty[indeks, ]
test &lt;-<span class="st"> </span>punkty[-indeks, ]
vario &lt;-<span class="st"> </span><span class="kw">variogram</span>(temp~<span class="dv">1</span>, <span class="dt">data=</span>train)
model &lt;-<span class="st"> </span><span class="kw">vgm</span>(<span class="dv">10</span>, <span class="dt">model =</span> <span class="st">&#39;Sph&#39;</span>, <span class="dt">range =</span> <span class="dv">4000</span>, <span class="dt">nugget =</span> <span class="fl">0.5</span>)
fitted &lt;-<span class="st"> </span><span class="kw">fit.variogram</span>(vario, model)
<span class="kw">plot</span>(vario, <span class="dt">model=</span>fitted)</code></pre></div>
<p><img src="06-ocena_files/figure-html/unnamed-chunk-1-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">test_sk &lt;-<span class="st"> </span><span class="kw">krige</span>(temp~<span class="dv">1</span>, train, test, <span class="dt">model=</span>fitted, <span class="dt">beta=</span><span class="fl">15.324</span>)</code></pre></div>
<pre><code>## [using simple kriging]</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(test_sk)</code></pre></div>
<pre><code>## Object of class SpatialPointsDataFrame
## Coordinates:
##        min      max
## x 745638.8 756082.1
## y 712705.0 721228.1
## Is projected: TRUE 
## proj4string :
## [+init=epsg:2180 +proj=tmerc +lat_0=0 +lon_0=19 +k=0.9993
## +x_0=500000 +y_0=-5300000 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0
## +units=m +no_defs]
## Number of points: 60
## Data attributes:
##    var1.pred         var1.var    
##  Min.   : 9.394   Min.   :1.258  
##  1st Qu.:12.344   1st Qu.:2.085  
##  Median :14.218   Median :2.480  
##  Mean   :15.017   Mean   :2.544  
##  3rd Qu.:17.529   3rd Qu.:3.001  
##  Max.   :22.963   Max.   :4.021</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">reszta_sk &lt;-<span class="st">  </span>test_sk$var1.pred -<span class="st"> </span>test$temp
<span class="kw">summary</span>(reszta_sk)</code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
## -4.1530 -1.1090 -0.2059 -0.1075  0.6296  6.6670</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ME &lt;-<span class="st"> </span><span class="kw">sum</span>(reszta_sk)/<span class="kw">length</span>(reszta_sk)
ME</code></pre></div>
<pre><code>## [1] -0.1075438</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">RMSE &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">sum</span>(reszta_sk^<span class="dv">2</span>)/<span class="kw">length</span>(reszta_sk))
RMSE</code></pre></div>
<pre><code>## [1] 2.008649</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">srednia_reszta &lt;-<span class="st"> </span>test$temp -<span class="st"> </span><span class="kw">mean</span>(test$temp)
R2 &lt;-<span class="st"> </span><span class="dv">1</span> -<span class="st"> </span><span class="kw">sum</span>(reszta_sk^<span class="dv">2</span>)/<span class="kw">sum</span>(srednia_reszta^<span class="dv">2</span>)
R2</code></pre></div>
<pre><code>## [1] 0.68205</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">test_sk$reszty &lt;-<span class="st"> </span>reszta_sk
<span class="kw">spplot</span>(test_sk, <span class="st">&quot;reszty&quot;</span>)</code></pre></div>
<p><img src="06-ocena_files/figure-html/unnamed-chunk-1-2.png" alt="" /><!-- --></p>
</div>
<div id="kroswalidacja" class="section level3">
<h3><span class="header-section-number">7.2.4</span> Kroswalidacja</h3>
<ul>
<li>W przypadku kroswalidacji te same dane wykorzystywane są do budowy modelu, estymacji, a następnie do oceny prognozy</li>
<li>Procedura kroswalidacji LOO (ang. <em>leave-one-out cross-validation</em>)</li>
</ul>
<ol style="list-style-type: decimal">
<li>Zbudowanie matematycznego modelu z dostępnych obserwacji</li>
<li>Dla każdej znanej obserwacji następuje:
<ul>
<li>Usunięcie jej ze zbioru danych</li>
<li>Użycie modelu do wykonania predykcji w miejscu tej obserwacji</li>
<li>Wyliczenie reszty (ang. <em>residual</em>), czyli różnicy pomiędzy znaną wartością a obserwacją</li>
</ul></li>
<li>Podsumowanie otrzymanych wyników</li>
</ol>
<ul>
<li>W pakiecie <strong>gstat</strong>, kroswalidacja LOO jest dostępna w funkcjach <em>krige.cv</em> oraz <em>gstat.cv</em></li>
</ul>
</div>
<div id="kroswalidacja-1" class="section level3">
<h3><span class="header-section-number">7.2.5</span> Kroswalidacja</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vario &lt;-<span class="st"> </span><span class="kw">variogram</span>(temp~<span class="dv">1</span>, <span class="dt">data=</span>punkty)
model &lt;-<span class="st"> </span><span class="kw">vgm</span>(<span class="dv">10</span>, <span class="dt">model =</span> <span class="st">&#39;Sph&#39;</span>, <span class="dt">range =</span> <span class="dv">4000</span>, <span class="dt">nugget =</span> <span class="fl">0.5</span>)
fitted &lt;-<span class="st"> </span><span class="kw">fit.variogram</span>(vario, model)

cv_sk &lt;-<span class="st"> </span><span class="kw">krige.cv</span>(temp~<span class="dv">1</span>, punkty, <span class="dt">model=</span>fitted, <span class="dt">beta=</span><span class="fl">15.324</span>)
<span class="kw">summary</span>(cv_sk)</code></pre></div>
<pre><code>## Object of class SpatialPointsDataFrame
## Coordinates:
##        min      max
## x 745573.7 756977.8
## y 712659.1 721228.1
## Is projected: NA 
## proj4string : [NA]
## Number of points: 244
## Data attributes:
##    var1.pred        var1.var        observed         residual        
##  Min.   : 9.49   Min.   :1.321   Min.   : 7.805   Min.   :-6.425156  
##  1st Qu.:12.65   1st Qu.:1.992   1st Qu.:12.192   1st Qu.:-0.852296  
##  Median :14.88   Median :2.345   Median :15.134   Median :-0.042211  
##  Mean   :15.32   Mean   :2.453   Mean   :15.324   Mean   : 0.003435  
##  3rd Qu.:17.26   3rd Qu.:2.818   3rd Qu.:17.343   3rd Qu.: 0.926687  
##  Max.   :24.99   Max.   :4.859   Max.   :26.072   Max.   : 6.825684  
##      zscore               fold       
##  Min.   :-3.636753   Min.   :  1.00  
##  1st Qu.:-0.532630   1st Qu.: 61.75  
##  Median :-0.027623   Median :122.50  
##  Mean   : 0.003269   Mean   :122.50  
##  3rd Qu.: 0.635316   3rd Qu.:183.25  
##  Max.   : 4.064887   Max.   :244.00</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">spplot</span>(cv_sk, <span class="st">&quot;residual&quot;</span>)</code></pre></div>
<p><img src="06-ocena_files/figure-html/loovv-1.png" alt="" /><!-- --></p>
<!-- 


```r
# ok_loocv <- krige.cv(temp~1, punkty, model=model_zl2)
# summary(ok_loocv)
```


- Tutaj inne przykłady
- Wykresy z loocv
- wykresy porównujące



```r
# ok_fit <- gstat(formula=temp~1, data=punkty, model=model_zl2)
# ok_loocv <- gstat.cv(OK_fit, debug.level=0, random=FALSE)
# spplot(pe[6])
```


## 
- prezentacja 5 Ani
- spatinter folder
- AIC

## Walidacja wyników estymacji

### Walidacja wyników estymacji |  Kriging zwykły - LOO crossvalidation
krige.cv


```r
# OK_fit <- gstat(id="OK_fit", formula=temp~1, data=punkty, model=fitted)
# pe <- gstat.cv(OK_fit, debug.level=0, random=FALSE)
# spplot(pe[6])
# 
# z <- predict(OK_fit, newdata = grid, debug.level = 0)
# grid2 <- grid
# grid2$OK_pred <- z$OK_fit.pred
# grid2$OK_se <- sqrt(z$OK_fit.var)
# library('rasterVis')
# spplot(grid2, 'OK_pred')
# spplot(grid2, 'OK_se')
```

### Walidacja wyników estymacji |  K  Kriging uniwersalny - LOO crossvalidation


```r
# KU_fit <- gstat(id="KU_fit", formula=temp~odl_od_morza, data=punkty, model=fitted_ku)
# pe <- gstat.cv(KU_fit, debug.level=0, random=FALSE)
# spplot(pe[6])

# dodanie odległości od morza do siatki !!
# z_KU <- predict(KU_fit, newdata = grid, debug.level = 0)
# grid$KU_pred <- z$KU_fit.pred
# grid$KU_se <- sqrt(z$KU_fit.var)
# library('rasterVis')
# spplot(grid, 'KU_pred')
# spplot(grid, 'KU_se')
```

-->
<!--chapter:end:06-ocena.Rmd-->
</div>
</div>
</div>
<div id="wykorzystanie-do-estymacji-danych-uzupeniajacych" class="section level1">
<h1><span class="header-section-number">8</span> Wykorzystanie do estymacji danych uzupełniających</h1>
<div id="kriging-stratyfikowany-ang.-kriging-within-strata" class="section level2">
<h2><span class="header-section-number">8.1</span> Kriging stratyfikowany (ang. <em>Kriging within strata</em>)</h2>
<div id="kriging-stratyfikowany-ang.-kriging-within-strata-1" class="section level3">
<h3><span class="header-section-number">8.1.1</span> Kriging stratyfikowany (ang. <em>Kriging within strata</em>)</h3>
<ul>
<li>Zakłada on, że zmienność badanego zjawiska zależy od zmiennej jakościowej (kategoryzowanej)</li>
<li>Przykładowo, zróżnicowanie badanej zmiennej jest różne w zależności od pokrycia terenu</li>
<li>Kriging stratyfikowany wymaga posiadania danych zmiennej jakościowej (kategoryzowanej) na całym badanym obszarze</li>
</ul>
</div>
<div id="kriging-stratyfikowany-ang.-kriging-within-strata-2" class="section level3">
<h3><span class="header-section-number">8.1.2</span> Kriging stratyfikowany (ang. <em>Kriging within strata</em>)</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&#39;gstat&#39;</span>)
grid &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;dane/siatka.csv&quot;</span>)
<span class="kw">head</span>(grid)</code></pre></div>
<pre><code>##       srtm clc      ndvi      savi        x        y
## 1 242.1462   1        NA        NA 748886.7 721241.2
## 2 240.9517   1        NA        NA 748916.7 721241.2
## 3 239.9704   1        NA        NA 748946.7 721241.2
## 4 239.2956   1        NA        NA 748976.7 721241.2
## 5 238.6385   1 0.5022462 0.3166959 749006.7 721241.2
## 6 237.9930   1 0.5480913 0.3545066 749036.7 721241.2</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">coordinates</span>(grid) &lt;-<span class="st"> </span><span class="er">~</span>x+y
<span class="kw">proj4string</span>(grid) &lt;-<span class="st"> </span><span class="kw">proj4string</span>(punkty)
<span class="kw">gridded</span>(grid) &lt;-<span class="st"> </span><span class="ot">TRUE</span>

grid$clc &lt;-<span class="st"> </span><span class="kw">as.factor</span>(grid$clc)
<span class="kw">spplot</span>(grid, <span class="st">&quot;clc&quot;</span>)</code></pre></div>
<p><img src="07-dane_uzupelniajace_files/figure-html/unnamed-chunk-2-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vario_kws1 &lt;-<span class="st"> </span><span class="kw">variogram</span>(temp~<span class="dv">1</span>, punkty[punkty$clc==<span class="dv">1</span>, ])
<span class="kw">plot</span>(vario_kws1)</code></pre></div>
<p><img src="07-dane_uzupelniajace_files/figure-html/unnamed-chunk-2-2.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fitted_kws1 &lt;-<span class="st"> </span><span class="kw">fit.variogram</span>(vario_kws1, <span class="kw">vgm</span>(<span class="dv">10</span>, <span class="dt">model =</span> <span class="st">&#39;Sph&#39;</span>, <span class="dt">range =</span> <span class="dv">4500</span>, <span class="dt">nugget =</span> <span class="fl">0.5</span>))
<span class="kw">plot</span>(vario_kws1, fitted_kws1)</code></pre></div>
<p><img src="07-dane_uzupelniajace_files/figure-html/unnamed-chunk-2-3.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vario_kws2 &lt;-<span class="st"> </span><span class="kw">variogram</span>(temp~<span class="dv">1</span>, punkty[punkty$clc==<span class="dv">2</span>, ])
<span class="kw">plot</span>(vario_kws2)</code></pre></div>
<p><img src="07-dane_uzupelniajace_files/figure-html/unnamed-chunk-2-4.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fitted_kws2 &lt;-<span class="st"> </span><span class="kw">fit.variogram</span>(vario_kws2, <span class="kw">vgm</span>(<span class="dv">5</span>, <span class="dt">model =</span> <span class="st">&#39;Sph&#39;</span>, <span class="dt">range =</span> <span class="dv">4500</span>, <span class="dt">nugget =</span> <span class="fl">0.1</span>))
<span class="kw">plot</span>(vario_kws2, fitted_kws2)</code></pre></div>
<p><img src="07-dane_uzupelniajace_files/figure-html/unnamed-chunk-2-5.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vario_kws4 &lt;-<span class="st"> </span><span class="kw">variogram</span>(temp~<span class="dv">1</span>, punkty[punkty$clc==<span class="dv">4</span>, ])
<span class="kw">plot</span>(vario_kws4)</code></pre></div>
<p><img src="07-dane_uzupelniajace_files/figure-html/unnamed-chunk-2-6.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fitted_kws4 &lt;-<span class="st"> </span><span class="kw">fit.variogram</span>(vario_kws4, <span class="kw">vgm</span>(<span class="fl">0.5</span>, <span class="dt">model =</span> <span class="st">&#39;Nug&#39;</span>))
<span class="kw">plot</span>(vario_kws4, fitted_kws4)</code></pre></div>
<p><img src="07-dane_uzupelniajace_files/figure-html/unnamed-chunk-2-7.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">kws1 &lt;-<span class="st"> </span><span class="kw">krige</span>(temp~<span class="dv">1</span>, punkty[punkty$clc==<span class="dv">1</span>, ], grid[<span class="kw">na.omit</span>(grid$clc==<span class="dv">1</span>), ], <span class="dt">model =</span> fitted_kws1, <span class="dt">nmax =</span> <span class="dv">50</span>)</code></pre></div>
<pre><code>## [using ordinary kriging]</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">kws2 &lt;-<span class="st"> </span><span class="kw">krige</span>(temp~<span class="dv">1</span>, punkty[punkty$clc==<span class="dv">2</span>, ], grid[<span class="kw">na.omit</span>(grid$clc==<span class="dv">2</span>), ], <span class="dt">model =</span> fitted_kws2, <span class="dt">nmax =</span> <span class="dv">50</span>)</code></pre></div>
<pre><code>## [using ordinary kriging]</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">kws4 &lt;-<span class="st"> </span><span class="kw">krige</span>(temp~<span class="dv">1</span>, punkty[punkty$clc==<span class="dv">4</span>, ], grid[<span class="kw">na.omit</span>(grid$clc==<span class="dv">4</span>), ], <span class="dt">model =</span> fitted_kws4, <span class="dt">nmax =</span> <span class="dv">50</span>)</code></pre></div>
<pre><code>## [using ordinary kriging]</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">kws &lt;-<span class="st"> </span><span class="kw">rbind</span>(<span class="kw">as.data.frame</span>(kws1), <span class="kw">as.data.frame</span>(kws2), <span class="kw">as.data.frame</span>(kws4))
<span class="kw">coordinates</span>(kws) &lt;-<span class="st"> </span><span class="er">~</span>x+y
kws &lt;-<span class="st"> </span><span class="kw">as</span>(kws, <span class="st">&quot;SpatialPixelsDataFrame&quot;</span>)
<span class="kw">spplot</span>(kws, <span class="st">&quot;var1.pred&quot;</span>, <span class="dt">sp.layout=</span>(<span class="dt">list=</span><span class="kw">SpatialPoints</span>(punkty)))</code></pre></div>
<p><img src="07-dane_uzupelniajace_files/figure-html/unnamed-chunk-2-8.png" alt="" /><!-- --></p>
</div>
</div>
<div id="prosty-kriging-ze-zmiennymi-srednimi-lokalnymi-lvm" class="section level2">
<h2><span class="header-section-number">8.2</span> Prosty kriging ze zmiennymi średnimi lokalnymi (LVM)</h2>
<div id="prosty-kriging-ze-zmiennymi-srednimi-lokalnymi-lvm-1" class="section level3">
<h3><span class="header-section-number">8.2.1</span> Prosty kriging ze zmiennymi średnimi lokalnymi (LVM)</h3>
<ul>
<li>Prosty kriging ze zmiennymi średnimi lokalnymi zamiast znanej (stałej) stacjonarnej średniej wykorzystuje zmienne średnie lokalne uzyskane na podstawie innej informacji</li>
<li>Lokalna średnia może być uzyskana za pomocą wyliczenia regresji liniowej pomiędzy zmienną badaną a zmienną dodatkową</li>
</ul>
</div>
<div id="prosty-kriging-ze-zmiennymi-srednimi-lokalnymi-lvm-2" class="section level3">
<h3><span class="header-section-number">8.2.2</span> Prosty kriging ze zmiennymi średnimi lokalnymi (LVM)</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">coef &lt;-<span class="st"> </span><span class="kw">lm</span>(temp~srtm, punkty)$coef
coef</code></pre></div>
<pre><code>## (Intercept)        srtm 
## 18.91937897 -0.01699626</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vario &lt;-<span class="st"> </span><span class="kw">variogram</span>(temp~srtm, punkty)
model_sim &lt;-<span class="st"> </span><span class="kw">vgm</span>(<span class="dv">10</span>, <span class="dt">model =</span> <span class="st">&#39;Sph&#39;</span>, <span class="dt">range =</span> <span class="dv">4000</span>, <span class="dt">nugget =</span> <span class="dv">1</span>)
model_sim</code></pre></div>
<pre><code>##   model psill range
## 1   Nug     1     0
## 2   Sph    10  4000</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fitted_sim &lt;-<span class="st"> </span><span class="kw">fit.variogram</span>(vario, model_sim)
fitted_sim</code></pre></div>
<pre><code>##   model      psill    range
## 1   Nug  0.8106758    0.000
## 2   Sph 11.3220167 4239.323</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(vario, <span class="dt">model=</span>fitted_sim)</code></pre></div>
<p><img src="07-dane_uzupelniajace_files/figure-html/unnamed-chunk-3-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sk_lvm &lt;-<span class="st"> </span><span class="kw">krige</span>(temp~srtm, punkty, grid, <span class="dt">model=</span>fitted_sim, <span class="dt">beta =</span> coef)</code></pre></div>
<pre><code>## [using simple kriging]</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(sk_lvm)</code></pre></div>
<pre><code>## Object of class SpatialPixelsDataFrame
## Coordinates:
##        min      max
## x 745556.7 756986.7
## y 712661.2 721241.2
## Is projected: TRUE 
## proj4string :
## [+init=epsg:2180 +proj=tmerc +lat_0=0 +lon_0=19 +k=0.9993
## +x_0=500000 +y_0=-5300000 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0
## +units=m +no_defs]
## Number of points: 98572
## Grid attributes:
##   cellcentre.offset cellsize cells.dim
## x          745556.7       30       382
## y          712661.2       30       287
## Data attributes:
##    var1.pred         var1.var    
##  Min.   : 8.278   Min.   :1.166  
##  1st Qu.:12.515   1st Qu.:2.084  
##  Median :14.960   Median :2.448  
##  Mean   :15.465   Mean   :2.540  
##  3rd Qu.:18.119   3rd Qu.:2.838  
##  Max.   :25.372   Max.   :6.507  
##  NA&#39;s   :80       NA&#39;s   :80</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">spplot</span>(sk_lvm, <span class="st">&quot;var1.pred&quot;</span>)
<span class="kw">spplot</span>(sk_lvm, <span class="st">&quot;var1.var&quot;</span>)</code></pre></div>
<p><img src="07-dane_uzupelniajace_files/figure-html/plotsylvm2-1.png" alt="" /><!-- --></p>
</div>
</div>
<div id="kriging-uniwersalny-ang.-universal-kriging" class="section level2">
<h2><span class="header-section-number">8.3</span> Kriging uniwersalny (ang. <em>Universal kriging</em>)</h2>
<div id="kriging-uniwersalny-ang.-universal-kriging-1" class="section level3">
<h3><span class="header-section-number">8.3.1</span> Kriging uniwersalny (ang. <em>Universal kriging</em>)</h3>
<ul>
<li>Określany również jako kriging z trendem (ang. <em>Kriging with a trend model</em>)</li>
<li>Zakłada on, że nieznana średnia lokalna zmiania się stopniowo na badanym obszarze</li>
</ul>
</div>
<div id="kriging-uniwersalny-ang.-universal-kriging-2" class="section level3">
<h3><span class="header-section-number">8.3.2</span> Kriging uniwersalny (ang. <em>Universal kriging</em>)</h3>
<!--

```r
# vario_ku <- variogram(temp~odl_od_morza, data=punkty)
# plot(vario_ku)
# model_ku <- vgm(psill = 17, model = 'Sph', range = 12000, nugget = 5)
# fitted_ku <- fit.variogram(vario_ku, model_ku)
# fitted_ku
# plot(vario_ku, fitted_ku)
```

-->
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">punkty$clc &lt;-<span class="st"> </span><span class="kw">as.factor</span>(punkty$clc)
vario_uk1 &lt;-<span class="st"> </span><span class="kw">variogram</span>(temp~clc, punkty)
vario_uk1</code></pre></div>
<pre><code>##      np      dist     gamma dir.hor dir.ver   id
## 1   106  216.1844  1.789125       0       0 var1
## 2   297  480.4988  2.605557       0       0 var1
## 3   483  809.9846  3.452457       0       0 var1
## 4   675 1120.7278  4.810112       0       0 var1
## 5   763 1435.6421  4.985586       0       0 var1
## 6   939 1751.4373  5.562505       0       0 var1
## 7  1038 2060.9052  6.522438       0       0 var1
## 8  1173 2375.2790  6.965343       0       0 var1
## 9  1284 2698.7080  7.347384       0       0 var1
## 10 1336 3010.7474  8.274137       0       0 var1
## 11 1346 3328.7317  8.364764       0       0 var1
## 12 1380 3647.2702  8.809890       0       0 var1
## 13 1426 3963.2623  9.161750       0       0 var1
## 14 1299 4280.0420  9.329572       0       0 var1
## 15 1431 4599.6926 10.882716       0       0 var1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(vario_uk1)</code></pre></div>
<p><img src="07-dane_uzupelniajace_files/figure-html/unnamed-chunk-5-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model_uk1 &lt;-<span class="st"> </span><span class="kw">vgm</span>(<span class="dv">8</span>, <span class="dt">model =</span> <span class="st">&#39;Sph&#39;</span>, <span class="dt">range =</span> <span class="dv">3000</span>, <span class="dt">nugget =</span> <span class="dv">1</span>)
vario_fit_uk1 &lt;-<span class="st"> </span><span class="kw">fit.variogram</span>(vario_uk1, <span class="dt">model=</span>model_uk1)
vario_fit_uk1</code></pre></div>
<pre><code>##   model    psill    range
## 1   Nug 1.316597    0.000
## 2   Sph 8.499845 4837.699</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(vario_uk1, vario_fit_uk1)</code></pre></div>
<p><img src="07-dane_uzupelniajace_files/figure-html/unnamed-chunk-5-2.png" alt="" /><!-- --></p>
<!--


```r
# przygotowanie siatki
# grid <- read.csv("data/Wolin_TPZ_p_lato_popN.csv")
# head(grid)
# coordinates(grid) <- ~X+Y
# proj4string(grid) <- proj4string(punkty)
# gridded(grid) <- TRUE
# plot(grid)
# names(grid)[6] <- c("clc")
# names(grid)[7] <- c("odl_od_morza")
# grid@data <- grid@data[c(2, 4:9)]
# # grid@data <- cbind(grid@data, as.data.frame(coordinates(grid)))
# write.csv(grid, 'data/siatka_wolin_lato.csv', row.names=FALSE)
# spplot(grid)
```

-->
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">grid$clc &lt;-<span class="st"> </span><span class="kw">as.factor</span>(grid$clc)
<span class="kw">spplot</span>(grid, <span class="st">&quot;clc&quot;</span>)</code></pre></div>
<p><img src="07-dane_uzupelniajace_files/figure-html/unnamed-chunk-7-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">uk1 &lt;-<span class="st"> </span><span class="kw">krige</span>(temp~clc, <span class="dt">locations =</span> punkty, <span class="dt">newdata=</span>grid, <span class="dt">model=</span>vario_fit_uk1)</code></pre></div>
<pre><code>## [using universal kriging]</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">spplot</span>(uk1, <span class="st">&quot;var1.pred&quot;</span>)
<span class="kw">spplot</span>(uk1, <span class="st">&quot;var1.var&quot;</span>)</code></pre></div>
<p><img src="07-dane_uzupelniajace_files/figure-html/plotsy4uk1-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vario_uk2 &lt;-<span class="st"> </span><span class="kw">variogram</span>(temp~ndvi+srtm, punkty)
vario_uk2</code></pre></div>
<pre><code>##      np      dist     gamma dir.hor dir.ver   id
## 1   106  216.1844  1.376210       0       0 var1
## 2   297  480.4988  2.901703       0       0 var1
## 3   483  809.9846  3.788317       0       0 var1
## 4   675 1120.7278  5.036029       0       0 var1
## 5   763 1435.6421  6.337475       0       0 var1
## 6   939 1751.4373  7.439551       0       0 var1
## 7  1038 2060.9052  8.262829       0       0 var1
## 8  1173 2375.2790  9.176715       0       0 var1
## 9  1284 2698.7080  9.452524       0       0 var1
## 10 1336 3010.7474 10.321034       0       0 var1
## 11 1346 3328.7317  9.949039       0       0 var1
## 12 1380 3647.2702 10.314282       0       0 var1
## 13 1426 3963.2623 11.676009       0       0 var1
## 14 1299 4280.0420 12.279317       0       0 var1
## 15 1431 4599.6926 14.471317       0       0 var1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(vario_uk2)</code></pre></div>
<p><img src="07-dane_uzupelniajace_files/figure-html/unnamed-chunk-8-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model &lt;-<span class="st"> </span><span class="kw">vgm</span>(<span class="dv">8</span>, <span class="dt">model =</span> <span class="st">&#39;Sph&#39;</span>, <span class="dt">range =</span> <span class="dv">3000</span>, <span class="dt">nugget =</span> <span class="dv">1</span>)
vario_fit_uk2 &lt;-<span class="st"> </span><span class="kw">fit.variogram</span>(vario_uk2, <span class="dt">model=</span>model)
vario_fit_uk2</code></pre></div>
<pre><code>##   model      psill    range
## 1   Nug  0.7796684    0.000
## 2   Sph 11.5478605 4580.795</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(vario_uk2, vario_fit_uk2)</code></pre></div>
<p><img src="07-dane_uzupelniajace_files/figure-html/unnamed-chunk-8-2.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">uk2 &lt;-<span class="st"> </span><span class="kw">krige</span>(temp~ndvi+srtm, <span class="dt">locations =</span> punkty, <span class="dt">newdata=</span>grid, <span class="dt">model=</span>vario_fit_uk2)</code></pre></div>
<pre><code>## [using universal kriging]</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">spplot</span>(uk2, <span class="st">&quot;var1.pred&quot;</span>)
<span class="kw">spplot</span>(uk2, <span class="st">&quot;var1.var&quot;</span>)</code></pre></div>
<p><img src="07-dane_uzupelniajace_files/figure-html/plotsy4ked-1.png" alt="" /><!-- --></p>
<!--chapter:end:07-dane_uzupelniajace.Rmd-->
</div>
</div>
</div>
<div id="estymacja-lokalnego-rozkadu-prawdopodobienstwa" class="section level1">
<h1><span class="header-section-number">9</span> Estymacja lokalnego rozkładu prawdopodobieństwa</h1>
<div id="kriging-danych-kodowanych-ang.-indicator-kriging-wprowadzenie" class="section level2">
<h2><span class="header-section-number">9.1</span> Kriging danych kodowanych (ang. <em>Indicator kriging</em>) | Wprowadzenie</h2>
<div id="kriging-danych-kodowanych-ang.-indicator-kriging" class="section level3">
<h3><span class="header-section-number">9.1.1</span> Kriging danych kodowanych (ang. <em>Indicator kriging</em>)</h3>
<ul>
<li>Jest to metoda krigingu oparta o dane kategoryzowane lub też dane przetworzone z postaci ciągłej do binarnej</li>
<li>Zazwyczaj używana jest to oszacowania prawdopodobieństwa przekroczenia zdefiniowanej wartości progowej</li>
<li>Może być też używana do szacowania wartości z całego rozkładu</li>
</ul>
<!--
http://geostat-course.org/system/files/geostat13_ind.pdf
-->
</div>
<div id="kriging-danych-kodowanych-ang.-indicator-kriging-1" class="section level3">
<h3><span class="header-section-number">9.1.2</span> Kriging danych kodowanych (ang. <em>Indicator kriging</em>)</h3>
<ul>
<li>Wartości danych wykorzystywane do krigingu danych kodowanych są określone jako 0 lub 1</li>
<li>Powyzsze kategorie reprezentują czy wartość danej zmiennej jest powyżej czy poniżej określonego progu</li>
</ul>
</div>
<div id="kriging-danych-kodowanych-ang.-indicator-kriging-wady-i-zalety" class="section level3">
<h3><span class="header-section-number">9.1.3</span> Kriging danych kodowanych (ang. <em>Indicator kriging</em>)| Wady i zalety</h3>
<ul>
<li>Zalety:
<ul>
<li>Możliwość zastosowania, gdy nie interesuje nas konkretna wartość, ale znalezienie obszarów o wartości przekraczającej dany poziom</li>
<li>Nie jest istotny kszałt rozkładu</li>
</ul></li>
<li>Wady:
<ul>
<li>Potencjalnie trudne do modelowania semiwariogramy (szczególnie skrajnych przedziałów)</li>
<li>Czasochłonność/pracochłonność</li>
</ul></li>
</ul>
</div>
</div>
<div id="kriging-danych-kodowanych-ang.-indicator-kriging-przykady" class="section level2">
<h2><span class="header-section-number">9.2</span> Kriging danych kodowanych (ang. <em>Indicator kriging</em>) | Przykłady</h2>
<div id="binaryzacja-danych" class="section level3">
<h3><span class="header-section-number">9.2.1</span> Binaryzacja danych</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(punkty$temp) </code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   7.805  12.190  15.130  15.320  17.340  26.070</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">punkty$temp_ind &lt;-<span class="st"> </span>punkty$temp &gt;<span class="st"> </span><span class="dv">20</span>
<span class="kw">summary</span>(punkty$temp_ind) </code></pre></div>
<pre><code>##    Mode   FALSE    TRUE    NA&#39;s 
## logical     212      32       0</code></pre>
</div>
<div id="eksploracja-danych" class="section level3">
<h3><span class="header-section-number">9.2.2</span> Eksploracja danych</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&#39;ggplot2&#39;</span>)
<span class="kw">ggplot</span>(punkty@data, <span class="kw">aes</span>(temp)) +<span class="st"> </span><span class="kw">stat_ecdf</span>()</code></pre></div>
<p><img src="08-dane_kodowane_files/figure-html/unnamed-chunk-2-1.png" alt="" /><!-- --></p>
</div>
<div id="kriging-danych-kodowanych-ang.-indicator-kriging-semiwariogram" class="section level3">
<h3><span class="header-section-number">9.2.3</span> Kriging danych kodowanych (ang. <em>Indicator kriging</em>) | Semiwariogram</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&#39;gstat&#39;</span>)
vario_ind &lt;-<span class="st"> </span><span class="kw">variogram</span>(temp_ind~<span class="dv">1</span>, punkty)         
<span class="kw">plot</span>(vario_ind)</code></pre></div>
<p><img src="08-dane_kodowane_files/figure-html/unnamed-chunk-3-1.png" alt="" /><!-- --></p>
</div>
<div id="kriging-danych-kodowanych-ang.-indicator-kriging-modelowanie" class="section level3">
<h3><span class="header-section-number">9.2.4</span> Kriging danych kodowanych (ang. <em>Indicator kriging</em>) | Modelowanie</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model_ind &lt;-<span class="st"> </span><span class="kw">vgm</span>(<span class="fl">0.07</span>, <span class="dt">model =</span> <span class="st">&#39;Sph&#39;</span>, <span class="dt">range =</span> <span class="dv">3000</span>,  <span class="dt">nugget =</span> <span class="fl">0.01</span>)  
<span class="kw">plot</span>(vario_ind, <span class="dt">model=</span>model_ind)</code></pre></div>
<p><img src="08-dane_kodowane_files/figure-html/unnamed-chunk-4-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fitted_ind &lt;-<span class="st"> </span><span class="kw">fit.variogram</span>(vario_ind, model_ind)
fitted_ind</code></pre></div>
<pre><code>##   model      psill    range
## 1   Nug 0.01191334    0.000
## 2   Sph 0.07626873 3533.054</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(vario_ind, <span class="dt">model=</span>fitted_ind)</code></pre></div>
<p><img src="08-dane_kodowane_files/figure-html/unnamed-chunk-4-2.png" alt="" /><!-- --></p>
</div>
<div id="kriging-danych-kodowanych-ang.-indicator-kriging-interpolacja" class="section level3">
<h3><span class="header-section-number">9.2.5</span> Kriging danych kodowanych (ang. <em>Indicator kriging</em>) | Interpolacja</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ik &lt;-<span class="st"> </span><span class="kw">krige</span>(temp_ind~<span class="dv">1</span>, punkty, grid, <span class="dt">model=</span>fitted_ind)</code></pre></div>
<pre><code>## [using ordinary kriging]</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">spplot</span>(ik, <span class="st">&quot;var1.pred&quot;</span>)
<span class="kw">spplot</span>(ik, <span class="st">&quot;var1.var&quot;</span>)</code></pre></div>
<p><img src="08-dane_kodowane_files/figure-html/plotsy2ok-1.png" alt="" /><!-- --></p>
</div>
<div id="kriging-danych-kodowanych-ang.-indicator-kriging-2" class="section level3">
<h3><span class="header-section-number">9.2.6</span> Kriging danych kodowanych (ang. <em>Indicator kriging</em>)</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vario_ind20 &lt;-<span class="st"> </span><span class="kw">variogram</span>(<span class="kw">I</span>(temp&lt;<span class="dv">20</span>)~<span class="dv">1</span>, punkty)  
fitted_ind20 &lt;-<span class="st"> </span><span class="kw">fit.variogram</span>(vario_ind20, <span class="kw">vgm</span>(<span class="fl">0.08</span>, <span class="st">&quot;Sph&quot;</span>, <span class="dv">3500</span>, <span class="dt">nugget=</span><span class="fl">0.01</span>))
vario_ind16 &lt;-<span class="st"> </span><span class="kw">variogram</span>(<span class="kw">I</span>(temp&lt;<span class="dv">16</span>)~<span class="dv">1</span>, punkty)  
fitted_ind16 &lt;-<span class="st"> </span><span class="kw">fit.variogram</span>(vario_ind16, <span class="kw">vgm</span>(<span class="fl">0.18</span>, <span class="st">&quot;Sph&quot;</span>, <span class="dv">3500</span>, <span class="dt">nugget=</span><span class="fl">0.03</span>))
vario_ind12 &lt;-<span class="st"> </span><span class="kw">variogram</span>(<span class="kw">I</span>(temp&lt;<span class="dv">12</span>)~<span class="dv">1</span>, punkty)  
fitted_ind12 &lt;-<span class="st"> </span><span class="kw">fit.variogram</span>(vario_ind12, <span class="kw">vgm</span>(<span class="fl">0.13</span>, <span class="st">&quot;Sph&quot;</span>, <span class="dv">2000</span>, <span class="dt">nugget=</span><span class="fl">0.03</span>))

ik20 &lt;-<span class="st"> </span><span class="kw">krige</span>(<span class="kw">I</span>(temp&lt;<span class="dv">20</span>)~<span class="dv">1</span>, punkty, grid, <span class="dt">model=</span>fitted_ind20, <span class="dt">nmax=</span><span class="dv">30</span>)</code></pre></div>
<pre><code>## [using ordinary kriging]</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ik16 &lt;-<span class="st"> </span><span class="kw">krige</span>(<span class="kw">I</span>(temp&lt;<span class="dv">16</span>)~<span class="dv">1</span>, punkty, grid, <span class="dt">model=</span>fitted_ind16, <span class="dt">nmax=</span><span class="dv">30</span>)</code></pre></div>
<pre><code>## [using ordinary kriging]</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ik12 &lt;-<span class="st"> </span><span class="kw">krige</span>(<span class="kw">I</span>(temp&lt;<span class="dv">12</span>)~<span class="dv">1</span>, punkty, grid, <span class="dt">model=</span>fitted_ind12, <span class="dt">nmax=</span><span class="dv">30</span>)</code></pre></div>
<pre><code>## [using ordinary kriging]</code></pre>
<p><img src="08-dane_kodowane_files/figure-html/ploty_trzyik-1.png" alt="" /><!-- --></p>
<!--chapter:end:08-dane_kodowane.Rmd-->
</div>
</div>
</div>
<div id="symulacje" class="section level1">
<h1><span class="header-section-number">10</span> Symulacje</h1>
<!--
## Symulacje przestrzenne 1:
 sekwencyjna symulacja i ko symulacja gaussowska,
  sekwencyjna symulacja danych kodowanych, 
  przetwarzanie (postprocesing) wyników symulacji
 
-->
<div id="symulacje-geostatystyczne" class="section level2">
<h2><span class="header-section-number">10.1</span> Symulacje geostatystyczne</h2>
<div id="symulacje-geostatystyczne-1" class="section level3">
<h3><span class="header-section-number">10.1.1</span> Symulacje geostatystyczne</h3>
<ul>
<li>Kriging daje optymalne predykcje, czyli wyznacza najbardziej potencjalnie możliwą wartość dla wybranej lokalizacji</li>
<li>Dodatkowo, efektem krigingu jest wygładzony obraz. W konsekwencji wyniki estymacji różnią się od danych pomiarowych</li>
<li>Jest to tylko (aż?) predykcja. Prawdziwa wartość jest niepewna …</li>
<li>Korzystając z symulacji geostatystycznych nie tworzymy predykcji, ale generujemy równie prawdopodobne możliwości poprzez symulację z rozkładu prawdopodobieństwa (wykorzystując genereator liczb losowych)</li>
</ul>
</div>
<div id="symulacje-geostatystyczne-cel" class="section level3">
<h3><span class="header-section-number">10.1.2</span> Symulacje geostatystyczne | Cel</h3>
<ul>
<li>Efekt symulacji ma bardziej realistyczny przestrzenny wzór (ang. <em>pattern</em>) niż kriging, którego efektem jest wygładzona reprezentacja rzeczywistości</li>
<li>Każda z symulowanych map jest równie prawdopodobna</li>
<li>Symulacje pozwalają na przedstawianie niepewności interpolacji</li>
<li>Jednocześnie - kriging jest znacznie lepszy, gdy naszym celem jest jak najdokładniejsza predykcja</li>
</ul>
</div>
</div>
<div id="typy-symulacji" class="section level2">
<h2><span class="header-section-number">10.2</span> Typy symulacji</h2>
<div id="typy-symulacji-1" class="section level3">
<h3><span class="header-section-number">10.2.1</span> Typy symulacji</h3>
<ul>
<li>Symulacje bezwarunkowe (ang. Unconditional Simulations) - wykorzystuje semiwariogram, żeby włączyć informację przestrzenną, ale wartości ze zmierzonych punktów nie są wykorzystywane.</li>
<li>Symulacje warunkowe (ang. Conditional Simulations) - opiera się ona o średnią wartość, strukturę kowariancji oraz obserwowane wartości</li>
</ul>
</div>
</div>
<div id="symulacje-bezwarunkowe" class="section level2">
<h2><span class="header-section-number">10.3</span> Symulacje bezwarunkowe</h2>
<!--
http://santiago.begueria.es/2010/10/generating-spatially-correlated-random-fields-with-r/
-->
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">grid &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;dane/siatka.csv&quot;</span>)
<span class="kw">head</span>(grid)</code></pre></div>
<pre><code>##       srtm clc      ndvi      savi        x        y
## 1 242.1462   1        NA        NA 748886.7 721241.2
## 2 240.9517   1        NA        NA 748916.7 721241.2
## 3 239.9704   1        NA        NA 748946.7 721241.2
## 4 239.2956   1        NA        NA 748976.7 721241.2
## 5 238.6385   1 0.5022462 0.3166959 749006.7 721241.2
## 6 237.9930   1 0.5480913 0.3545066 749036.7 721241.2</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">coordinates</span>(grid) &lt;-<span class="st"> </span><span class="er">~</span>x+y
<span class="kw">proj4string</span>(grid) &lt;-<span class="st"> </span><span class="kw">proj4string</span>(punkty)
<span class="kw">gridded</span>(grid) &lt;-<span class="st"> </span><span class="ot">TRUE</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&#39;gstat&#39;</span>)
sym_bezw1 &lt;-<span class="st"> </span><span class="kw">krige</span>(<span class="dt">formula=</span>z~<span class="dv">1</span>, <span class="dt">locations=</span><span class="ot">NULL</span>, <span class="dt">newdata=</span>grid, <span class="dt">dummy=</span><span class="ot">TRUE</span>,
                         <span class="dt">beta=</span><span class="dv">1</span>, <span class="dt">model=</span><span class="kw">vgm</span>(<span class="dt">psill=</span><span class="fl">0.025</span>,<span class="dt">model=</span><span class="st">&#39;Exp&#39;</span>,<span class="dt">range=</span><span class="dv">100</span>), <span class="dt">nsim=</span><span class="dv">4</span>, <span class="dt">nmax=</span><span class="dv">30</span>)</code></pre></div>
<pre><code>## [using unconditional Gaussian simulation]</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">spplot</span>(sym_bezw1, <span class="dt">main=</span><span class="st">&quot;Przestrzennie skorelowana powierzchnia </span><span class="ch">\n</span><span class="st">średnia=1, sill=0.025, zasięg=100, model wykładniczy&quot;</span>)</code></pre></div>
<p><img src="10-symulacje_files/figure-html/sym_bezw1-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sym_bezw2 &lt;-<span class="st"> </span><span class="kw">krige</span>(<span class="dt">formula=</span>z~<span class="dv">1</span>, <span class="dt">locations=</span><span class="ot">NULL</span>, <span class="dt">newdata=</span>grid, <span class="dt">dummy=</span><span class="ot">TRUE</span>, 
                   <span class="dt">beta=</span><span class="dv">1</span>, <span class="dt">model=</span><span class="kw">vgm</span>(<span class="dt">psill=</span><span class="fl">0.025</span>,<span class="dt">model=</span><span class="st">&#39;Exp&#39;</span>,<span class="dt">range=</span><span class="dv">1500</span>), <span class="dt">nsim=</span><span class="dv">4</span>, <span class="dt">nmax=</span><span class="dv">30</span>)</code></pre></div>
<pre><code>## [using unconditional Gaussian simulation]</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">spplot</span>(sym_bezw2, <span class="dt">main=</span><span class="st">&quot;Przestrzennie skorelowana powierzchnia </span><span class="ch">\n</span><span class="st">średnia=1, sill=0.025, zasięg=1500, model wykładniczy&quot;</span>)</code></pre></div>
<p><img src="10-symulacje_files/figure-html/sym_bezw2-1.png" alt="" /><!-- --></p>
<!--
sym_bezw_model3 <- gstat(formula=~1+X+Y, locations=~X+Y, dummy=T, beta=c(1,0,0.005), model=vgm(psill=0.025,model='Exp',range=1500), nmax=20)
sym_bezw3 <- predict(sym_bezw_model3, newdata=grid, nsim=4)
spplot(sym_bezw3, main="Przestrzennie skorelowana powierzchnia \nśrednia=1, sill=0.025, zasięg=1500, model wykładniczy \ntrend na osi y = 0.005")

sym_bezw_model4 <- gstat(formula=~1+X+Y, locations=~X+Y, dummy=T, beta=c(1,0.02,0.005), model=vgm(psill=0.025,model='Exp',range=1500), nmax=20)
sym_bezw4 <- predict(sym_bezw_model4, newdata=grid, nsim=4)
spplot(sym_bezw4, main="Przestrzennie skorelowana powierzchnia \nśrednia=1, sill=0.025, zasięg=500, model wykładniczy \ntrend na osi x = 0.02, trend na osi y = 0.005")
-->
</div>
<div id="symulacje-warunkowe" class="section level2">
<h2><span class="header-section-number">10.4</span> Symulacje warunkowe</h2>
<div id="sekwencyjna-symulacja-gaussowska-ang.-sequential-gaussian-simulation" class="section level3">
<h3><span class="header-section-number">10.4.1</span> Sekwencyjna symulacja gaussowska (ang. <em>Sequential Gaussian simulation</em>)</h3>
<ol style="list-style-type: decimal">
<li>Wybranie lokalizacji nie posiadającej zmierzonej wartości badanej zmiennej</li>
<li>Kriging wartości tej lokalizacji korzystając z dostepnych danych, co pozwala na uzyskanie rozkładu prawdopodobieństwa badanej zmiennej</li>
<li>Wylosowanie wartości z rozkładu prawdopodobieństwa za pomocą generatora liczba losowych i przypisanie tej wartości do lokalizacji</li>
<li>Dodanie symulowaniej wartości do zbioru danych i przejście do kolejnej lokalizacji</li>
<li>Powtórzenie poprzednich kroków, aż do momentu gdy nie pozostanie już żadna nieokreślona lokalizacja</li>
</ol>
</div>
<div id="sekwencyjna-symulacja-gaussowska-ang.-sequential-gaussian-simulation-1" class="section level3">
<h3><span class="header-section-number">10.4.2</span> Sekwencyjna symulacja gaussowska (ang. <em>Sequential Gaussian simulation</em>)</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vario &lt;-<span class="st"> </span><span class="kw">variogram</span>(temp~<span class="dv">1</span>, punkty)
model &lt;-<span class="st"> </span><span class="kw">vgm</span>(<span class="dv">10</span>, <span class="dt">model =</span> <span class="st">&#39;Sph&#39;</span>, <span class="dt">range =</span> <span class="dv">4500</span>, <span class="dt">nugget=</span><span class="dv">1</span>)
fitted &lt;-<span class="st"> </span><span class="kw">fit.variogram</span>(vario, model)
<span class="kw">plot</span>(vario, <span class="dt">model=</span>fitted)</code></pre></div>
<p><img src="10-symulacje_files/figure-html/sym_ok-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sym_ok &lt;-<span class="st"> </span><span class="kw">krige</span>(temp~<span class="dv">1</span>, punkty, grid, <span class="dt">model=</span>fitted, <span class="dt">nsim=</span><span class="dv">4</span>, <span class="dt">nmax=</span><span class="dv">30</span>)</code></pre></div>
<pre><code>## drawing 4 GLS realisations of beta...
## [using conditional Gaussian simulation]</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">spplot</span>(sym_ok)</code></pre></div>
<p><img src="10-symulacje_files/figure-html/sym_ok-2.png" alt="" /><!-- --></p>
</div>
<div id="sekwencyjna-symulacja-gaussowska-ang.-sequential-gaussian-simulation-2" class="section level3">
<h3><span class="header-section-number">10.4.3</span> Sekwencyjna symulacja gaussowska (ang. <em>Sequential Gaussian simulation</em>)</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sym_sk &lt;-<span class="st"> </span><span class="kw">krige</span>(temp~<span class="dv">1</span>, punkty, grid, <span class="dt">model=</span>fitted, <span class="dt">beta=</span><span class="fl">15.324</span>, <span class="dt">nsim=</span><span class="dv">100</span>, <span class="dt">nmax=</span><span class="dv">30</span>)</code></pre></div>
<pre><code>## [using conditional Gaussian simulation]</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&#39;raster&#39;</span>)
sym_sk &lt;-<span class="st"> </span><span class="kw">stack</span>(sym_sk)
sym_sk_sd &lt;-<span class="st"> </span><span class="kw">calc</span>(sym_sk, <span class="dt">fun =</span> sd)
<span class="kw">spplot</span>(sym_sk_sd)</code></pre></div>
<p><img src="10-symulacje_files/figure-html/master_symulation-1.png" alt="" /><!-- --></p>
</div>
</div>
<div id="sekwencyjna-symulacja-danych-kodowanych-ang.-sequential-indicator-simulation" class="section level2">
<h2><span class="header-section-number">10.5</span> Sekwencyjna symulacja danych kodowanych (ang. <em>Sequential indicator simulation</em>)</h2>
<div id="sekwencyjna-symulacja-danych-kodowanych-ang.-sequential-indicator-simulation-1" class="section level3">
<h3><span class="header-section-number">10.5.1</span> Sekwencyjna symulacja danych kodowanych (ang. <em>Sequential indicator simulation</em>)</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(punkty$temp) </code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   7.805  12.190  15.130  15.320  17.340  26.070</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">punkty$temp_ind &lt;-<span class="st"> </span>punkty$temp &lt;<span class="st"> </span><span class="dv">12</span>
<span class="kw">summary</span>(punkty$temp_ind) </code></pre></div>
<pre><code>##    Mode   FALSE    TRUE    NA&#39;s 
## logical     188      56       0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vario_ind &lt;-<span class="st"> </span><span class="kw">variogram</span>(temp_ind~<span class="dv">1</span>, punkty)         
<span class="kw">plot</span>(vario_ind)</code></pre></div>
<p><img src="10-symulacje_files/figure-html/sym_ind-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model_ind &lt;-<span class="st"> </span><span class="kw">vgm</span>(<span class="fl">0.14</span>, <span class="dt">model =</span> <span class="st">&#39;Sph&#39;</span>, <span class="dt">range =</span> <span class="dv">2000</span>, <span class="dt">nugget =</span> <span class="fl">0.02</span>)
<span class="kw">plot</span>(vario_ind, <span class="dt">model=</span>model_ind)</code></pre></div>
<p><img src="10-symulacje_files/figure-html/sym_ind-2.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fitted_ind &lt;-<span class="st"> </span><span class="kw">fit.variogram</span>(vario_ind, model_ind)
fitted_ind</code></pre></div>
<pre><code>##   model      psill    range
## 1   Nug 0.03275448    0.000
## 2   Sph 0.13398278 1922.352</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(vario_ind, <span class="dt">model=</span>fitted_ind)</code></pre></div>
<p><img src="10-symulacje_files/figure-html/sym_ind-3.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sym_ind &lt;-<span class="st"> </span><span class="kw">krige</span>(temp_ind~<span class="dv">1</span>, punkty, grid, <span class="dt">model=</span>fitted_ind, <span class="dt">indicators=</span><span class="ot">TRUE</span>, <span class="dt">nsim=</span><span class="dv">4</span>, <span class="dt">nmax=</span><span class="dv">30</span>)</code></pre></div>
<pre><code>## drawing 4 GLS realisations of beta...
## [using conditional indicator simulation]</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">spplot</span>(sym_ind, <span class="dt">main=</span><span class="st">&#39;Symulacje warunkowe&#39;</span>)</code></pre></div>
<p><img src="10-symulacje_files/figure-html/sym_ind-4.png" alt="" /><!-- --></p>
<!--
łączenie sis - wiele symulacji
-->
<!--chapter:end:10-symulacje.Rmd-->
</div>
</div>
</div>
<div id="bibliografia" class="section level1">
<h1><span class="header-section-number">11</span> Bibliografia</h1>
<div id="zroda-wiedzy" class="section level3">
<h3><span class="header-section-number">11.0.1</span> Źródła wiedzy</h3>
<ul>
<li><a href="http://cran.r-project.org/doc/manuals/R-intro.pdf">An Introduction to R</a> - oficjalne wprowadzenie do R</li>
<li><a href="http://www.biecek.pl/R/">Przewodnik po pakiecie R</a>, <a href="http://rksiazka.rexamine.com/">Programowanie w języku R</a>, <a href="http://ksiegarnia.pwn.pl/7371_pozycja.html?npt=233">Statystyczna analiza danych z wykorzystaniem programu R</a> - polskie wydawnictwa</li>
<li><a href="http://www.asdar-book.org/">Applied Spatial Dala Analysis with R</a></li>
<li><a href="http://spatial-analyst.net/book/system/files/Hengl_2009_GEOSTATe2c1w.pdf">A Practical Guide to Geostatistical Mapping</a></li>
<li><a href="http://www.gstat.org/gstat.pdf">gstat user’s manual</a></li>
<li><a href="https://cran.r-project.org/web/views/Spatial.html">CRAN Task View: Analysis of Spatial Data</a></li>
<li><a href="https://books.google.pl/books?id=vC2dcXFLI3YC">Applied Geostatistics</a>, <a href="https://books.google.pl/books?id=4SdRAAAAMAAJ">Statistics for spatial data</a></li>
<li><a href="http://www.geoinfo.amu.edu.pl/staff/astach/www_geostat/programy/A_Stach_%20poradnik_geostatystyki.pdf">Praktyczny poradnik - jak szybko zrozumieć i wykorzystać geostatystykę w pracy badawczej</a></li>
<li>Wyszukiwarki internetowe <a href="http://www.rseek.org/">Rseek</a>, <a href="http://duckduckgo.com/">Duckduckgo</a>, <a href="http://google.com/">Google</a>, <a href="http://bing.com/">Bing</a>, itd.</li>
</ul>
<!--chapter:end:11-references.Rmd-->
<div id="refs" class="references">

</div>
</div>
</div>
<!--bookdown:body:end-->
            </section>

          </div>
        </div>
      </div>
<!--bookdown:link_prev-->
<!--bookdown:link_next-->

<!--bookdown:config-->


</body>

</html>
