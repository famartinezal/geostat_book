<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Geostatystyka</title>
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
  <meta name="description" content="Geostatystyka">
  <meta name="generator" content="bookdown <!--bookdown:version--> and GitBook 2.6.7">

<meta name="author" content="Jakub Nowosad">

<meta name="date" content="2016-03-14">

  <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>

  <meta name="HandheldFriendly" content="true">
  <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<!--bookdown:link_prev-->
<!--bookdown:link_next-->

<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<script src="libs/gitbook-2.6.7/js/app.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>


<!--bookdown:title:start-->
<div id="header">
<h1 class="title">Geostatystyka</h1>
<h4 class="author"><em>Jakub Nowosad</em></h4>
<h4 class="date"><em>2016-03-14</em></h4>
</div>
<!--bookdown:title:end-->

<!--bookdown:toc:start-->
  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">
<!--bookdown:toc2:start-->
<ul>
<li><a href="#dzien-dobry"><span class="toc-section-number">1</span> Dzień dobry</a></li>
<li><a href="#intro"><span class="toc-section-number">2</span> Wprowadzenie</a><ul>
<li><a href="#wymagania-wstepne"><span class="toc-section-number">2.1</span> Wymagania wstępne</a><ul>
<li><a href="#oprogramowanie"><span class="toc-section-number">2.1.1</span> Oprogramowanie</a></li>
<li><a href="#dane"><span class="toc-section-number">2.1.2</span> Dane</a></li>
</ul></li>
<li><a href="#r-a-dane-przestrzenne"><span class="toc-section-number">2.2</span> R a dane przestrzenne</a><ul>
<li><a href="#pakiety"><span class="toc-section-number">2.2.1</span> Pakiety</a></li>
<li><a href="#reprezentacja-danych-nieprzestrzennych"><span class="toc-section-number">2.2.2</span> Reprezentacja danych nieprzestrzennych</a></li>
<li><a href="#reprezentacja-danych-przestrzennych"><span class="toc-section-number">2.2.3</span> Reprezentacja danych przestrzennych</a></li>
<li><a href="#gdalogr"><span class="toc-section-number">2.2.4</span> GDAL/OGR</a></li>
<li><a href="#proj.4"><span class="toc-section-number">2.2.5</span> PROJ.4</a></li>
<li><a href="#epsg"><span class="toc-section-number">2.2.6</span> EPSG</a></li>
<li><a href="#ukad-geograficzny"><span class="toc-section-number">2.2.7</span> Układ geograficzny</a></li>
</ul></li>
<li><a href="#import-danych"><span class="toc-section-number">2.3</span> Import danych</a><ul>
<li><a href="#dane-punktowe-format-csv"><span class="toc-section-number">2.3.1</span> Dane punktowe (format csv)</a></li>
<li><a href="#dane-poligonowe-formaty-gisowe"><span class="toc-section-number">2.3.2</span> Dane poligonowe (formaty gisowe)</a></li>
<li><a href="#rastry"><span class="toc-section-number">2.3.3</span> Rastry</a></li>
</ul></li>
<li><a href="#eksport-danych"><span class="toc-section-number">2.4</span> Eksport danych</a><ul>
<li><a href="#zapisywanie-danych-wektorowych"><span class="toc-section-number">2.4.1</span> Zapisywanie danych wektorowych</a></li>
<li><a href="#zapisywanie-danych-rastrowych"><span class="toc-section-number">2.4.2</span> Zapisywanie danych rastrowych</a></li>
</ul></li>
<li><a href="#wizualizacja-danych-2d"><span class="toc-section-number">2.5</span> Wizualizacja danych 2D</a><ul>
<li><a href="#dane-punktowe"><span class="toc-section-number">2.5.1</span> Dane punktowe</a></li>
<li><a href="#dane-punktowe---kategorie"><span class="toc-section-number">2.5.2</span> Dane punktowe - kategorie</a></li>
<li><a href="#rastry-1"><span class="toc-section-number">2.5.3</span> Rastry</a></li>
</ul></li>
<li><a href="#tworzenie-siatek"><span class="toc-section-number">2.6</span> Tworzenie siatek</a><ul>
<li><a href="#siatki-regularne"><span class="toc-section-number">2.6.1</span> Siatki regularne</a></li>
<li><a href="#siatki-regularne-1"><span class="toc-section-number">2.6.2</span> Siatki regularne</a></li>
<li><a href="#siatki-nieregularne---klasa-rasterlayer"><span class="toc-section-number">2.6.3</span> Siatki nieregularne - klasa <code>RasterLayer</code></a></li>
<li><a href="#siatki-nieregularne---klasa-spatialpixelsdataframe"><span class="toc-section-number">2.6.4</span> Siatki nieregularne - klasa <code>SpatialPixelsDataFrame</code></a></li>
</ul></li>
</ul></li>
<li><a href="#eksploracyjna-analiza-danych"><span class="toc-section-number">3</span> Eksploracyjna analiza danych</a><ul>
<li><a href="#eksploracyjna-analiza-danych-cel"><span class="toc-section-number">3.1</span> Eksploracyjna analiza danych | Cel</a></li>
<li><a href="#dane-1"><span class="toc-section-number">3.2</span> Dane</a><ul>
<li><a href="#dane-2"><span class="toc-section-number">3.2.1</span> Dane</a></li>
</ul></li>
<li><a href="#statystyki-opisowe"><span class="toc-section-number">3.3</span> Statystyki opisowe</a><ul>
<li><a href="#statystyki-opisowe-1"><span class="toc-section-number">3.3.1</span> Statystyki opisowe</a></li>
<li><a href="#statystyki-opisowe-srednia-i-mediana"><span class="toc-section-number">3.3.2</span> Statystyki opisowe | średnia i mediana</a></li>
<li><a href="#statystyki-opisowe-srednia-i-mediana-1"><span class="toc-section-number">3.3.3</span> Statystyki opisowe | średnia i mediana</a></li>
<li><a href="#statystyki-opisowe-minimum-i-maksimum"><span class="toc-section-number">3.3.4</span> Statystyki opisowe | minimum i maksimum</a></li>
<li><a href="#statystyki-opisowe-ochylenie-standardowe"><span class="toc-section-number">3.3.5</span> Statystyki opisowe | ochylenie standardowe</a></li>
</ul></li>
<li><a href="#wykresy"><span class="toc-section-number">3.4</span> Wykresy</a><ul>
<li><a href="#histogram"><span class="toc-section-number">3.4.1</span> Histogram</a></li>
<li><a href="#estymator-jadrowy-gestosci-ang.-kernel-density-estimation"><span class="toc-section-number">3.4.2</span> Estymator jądrowy gęstości (ang. <em>kernel density estimation</em>)</a></li>
<li><a href="#wykresy-kwantyl-kwantyl-ang.quantile-quantile"><span class="toc-section-number">3.4.3</span> Wykresy kwantyl-kwantyl (ang.<em>quantile-quantile</em>)</a></li>
<li><a href="#wykresy-kwantyl-kwantyl-ang.-quantile-quantile"><span class="toc-section-number">3.4.4</span> Wykresy kwantyl-kwantyl (ang. <em>quantile-quantile</em>)</a></li>
<li><a href="#dystrybuanta-cdf"><span class="toc-section-number">3.4.5</span> Dystrybuanta (CDF)</a></li>
</ul></li>
<li><a href="#porownanie-zmiennych"><span class="toc-section-number">3.5</span> Porównanie zmiennych</a><ul>
<li><a href="#kowariancja"><span class="toc-section-number">3.5.1</span> Kowariancja</a></li>
<li><a href="#wspoczynnik-korelacji"><span class="toc-section-number">3.5.2</span> Współczynnik korelacji</a></li>
<li><a href="#wykresy-pudekowe"><span class="toc-section-number">3.5.3</span> Wykresy pudełkowe</a></li>
<li><a href="#testowanie-istotnosci-roznic-sredniej-pomiedzy-grupami"><span class="toc-section-number">3.5.4</span> Testowanie istotności różnić średniej pomiędzy grupami</a></li>
<li><a href="#testowanie-istotnosci-roznic-sredniej-pomiedzy-grupami-1"><span class="toc-section-number">3.5.5</span> Testowanie istotności różnić średniej pomiędzy grupami</a></li>
</ul></li>
<li><a href="#transformacje-danych"><span class="toc-section-number">3.6</span> Transformacje danych</a><ul>
<li><a href="#transformacje-danych-1"><span class="toc-section-number">3.6.1</span> Transformacje danych</a></li>
<li><a href="#transformacja-danych-logarytmizacja"><span class="toc-section-number">3.6.2</span> Transformacja danych | Logarytmizacja</a></li>
<li><a href="#transformacja-danych-pierwiastkowanie"><span class="toc-section-number">3.6.3</span> Transformacja danych | Pierwiastkowanie</a></li>
<li><a href="#transformacja-danych-rodzina-transformacji-boxa-coxa"><span class="toc-section-number">3.6.4</span> Transformacja danych | Rodzina transformacji Boxa Coxa</a></li>
</ul></li>
</ul></li>
<li><a href="#eksploracyjna-analiza-danych---geostatystyka"><span class="toc-section-number">4</span> Eksploracyjna analiza danych - geostatystyka</a><ul>
<li><a href="#mapy"><span class="toc-section-number">4.1</span> Mapy</a><ul>
<li><a href="#podstawowe-terminy-kontekst-przestrzenny"><span class="toc-section-number">4.1.1</span> Podstawowe terminy | Kontekst przestrzenny</a></li>
<li><a href="#mapy-punktowe-cel"><span class="toc-section-number">4.1.2</span> Mapy punktowe | Cel</a></li>
<li><a href="#typ-probowania"><span class="toc-section-number">4.1.3</span> Typ próbowania</a></li>
<li><a href="#typ-probowania-regularny"><span class="toc-section-number">4.1.4</span> Typ próbowania | Regularny</a></li>
<li><a href="#typ-probowania-losowy"><span class="toc-section-number">4.1.5</span> Typ próbowania | Losowy</a></li>
<li><a href="#typ-probowania-losowy-stratyfikowany"><span class="toc-section-number">4.1.6</span> Typ próbowania | Losowy stratyfikowany</a></li>
<li><a href="#typ-probowania-preferencyjny-i"><span class="toc-section-number">4.1.7</span> Typ próbowania | Preferencyjny I</a></li>
<li><a href="#typ-probowania-liniowy"><span class="toc-section-number">4.1.8</span> Typ próbowania | Liniowy</a></li>
<li><a href="#mapy-punktowe-i-dane-lokalnie-odstajace"><span class="toc-section-number">4.1.9</span> Mapy punktowe i dane lokalnie odstające</a></li>
</ul></li>
<li><a href="#rozgrupowanie-danych"><span class="toc-section-number">4.2</span> Rozgrupowanie danych</a><ul>
<li><a href="#rozgrupowanie-danych-1"><span class="toc-section-number">4.2.1</span> Rozgrupowanie danych</a></li>
<li><a href="#rozgrupowanie-danych-2"><span class="toc-section-number">4.2.2</span> Rozgrupowanie danych</a></li>
<li><a href="#rozgrupowanie-komorkowe-i-ang.-cell-declustering"><span class="toc-section-number">4.2.3</span> Rozgrupowanie komórkowe I | (ang. <em>cell declustering</em>)</a></li>
<li><a href="#rozgrupowanie-komorkowe-i-ang.-cell-declustering-1"><span class="toc-section-number">4.2.4</span> Rozgrupowanie komórkowe I | (ang. <em>cell declustering</em>)</a></li>
<li><a href="#rozgrupowanie-komorkowe-ii-ang.-cell-declustering"><span class="toc-section-number">4.2.5</span> Rozgrupowanie komórkowe II | (ang. <em>cell declustering</em>)</a></li>
<li><a href="#rozgrupowanie-poligonowe-ang.-polygon-declustering"><span class="toc-section-number">4.2.6</span> Rozgrupowanie poligonowe | (ang. <em>polygon declustering</em>)</a></li>
<li><a href="#rozgrupowanie-poligonowe-ang.-polygon-declustering-1"><span class="toc-section-number">4.2.7</span> Rozgrupowanie poligonowe | (ang. <em>polygon declustering</em>)</a></li>
</ul></li>
</ul></li>
<li><a href="#eksploracyjna-analiza-danych---geostatystyka-1"><span class="toc-section-number">5</span> Eksploracyjna analiza danych - geostatystyka</a><ul>
<li><a href="#interpolacja"><span class="toc-section-number">5.1</span> Interpolacja</a><ul>
<li><a href="#modele-deterministyczne"><span class="toc-section-number">5.1.1</span> Modele deterministyczne</a></li>
<li><a href="#modele-deterministyczne-1"><span class="toc-section-number">5.1.2</span> Modele deterministyczne</a></li>
<li><a href="#modele-deterministyczne-funkcje-wielomianowe"><span class="toc-section-number">5.1.3</span> Modele deterministyczne | Funkcje wielomianowe</a></li>
<li><a href="#modele-deterministyczne-funkcje-sklejane"><span class="toc-section-number">5.1.4</span> Modele deterministyczne | Funkcje sklejane</a></li>
<li><a href="#modele-deterministyczne-triangulacje-thiessen"><span class="toc-section-number">5.1.5</span> Modele deterministyczne | Triangulacje (Thiessen)</a></li>
<li><a href="#modele-deterministyczne-idw"><span class="toc-section-number">5.1.6</span> Modele deterministyczne | IDW</a></li>
<li><a href="#modele-deterministyczne-porownanie"><span class="toc-section-number">5.1.7</span> Modele deterministyczne | Porównanie</a></li>
</ul></li>
</ul></li>
<li><a href="#geostatystyka"><span class="toc-section-number">6</span> … - geostatystyka</a><ul>
<li><a href="#modele-statystyczne"><span class="toc-section-number">6.0.1</span> Modele statystyczne</a></li>
<li><a href="#geostatystyka---prolog"><span class="toc-section-number">6.1</span> Geostatystyka - prolog</a><ul>
<li><a href="#geostatystyka-1"><span class="toc-section-number">6.1.1</span> Geostatystyka</a></li>
<li><a href="#geostatystyka-funkcje"><span class="toc-section-number">6.1.2</span> Geostatystyka | Funkcje</a></li>
<li><a href="#geostatystyczna-analiza-danych"><span class="toc-section-number">6.1.3</span> Geostatystyczna analiza danych</a></li>
<li><a href="#geostatystyka-dane-wejsciowe"><span class="toc-section-number">6.1.4</span> Geostatystyka | Dane wejściowe</a></li>
<li><a href="#geostatystyka-podstawowe-etapy"><span class="toc-section-number">6.1.5</span> Geostatystyka | Podstawowe etapy</a></li>
</ul></li>
<li><a href="#przestrzenna-kowariancja-korelacja-i-semiwariancja"><span class="toc-section-number">6.2</span> Przestrzenna kowariancja, korelacja i semiwariancja</a><ul>
<li><a href="#przestrzenna-kowariancja-korelacja-i-semiwariancja-zaozenia"><span class="toc-section-number">6.2.1</span> Przestrzenna kowariancja, korelacja i semiwariancja | Założenia</a></li>
<li><a href="#przestrzenna-kowariancja-korelacja-i-semiwariancja-1"><span class="toc-section-number">6.2.2</span> Przestrzenna kowariancja, korelacja i semiwariancja</a></li>
<li><a href="#przestrzenna-kowariancja-korelacja-i-semiwariancja-2"><span class="toc-section-number">6.2.3</span> Przestrzenna kowariancja, korelacja i semiwariancja</a></li>
<li><a href="#wykres-rozrzutu-z-przesunieciem"><span class="toc-section-number">6.2.4</span> Wykres rozrzutu z przesunięciem</a></li>
<li><a href="#autokowariancja"><span class="toc-section-number">6.2.5</span> Autokowariancja</a></li>
<li><a href="#autokorelacja"><span class="toc-section-number">6.2.6</span> Autokorelacja</a></li>
<li><a href="#semiwariancja"><span class="toc-section-number">6.2.7</span> Semiwariancja</a></li>
<li><a href="#okreslenie-wystepowania-autokorelacji-przestrzennej-chmura-semiwariogramu"><span class="toc-section-number">6.2.8</span> Określenie występowania autokorelacji przestrzennej | Chmura semiwariogramu</a></li>
<li><a href="#semiwariancja-przykadowe-obliczenia"><span class="toc-section-number">6.2.9</span> Semiwariancja | Przykładowe obliczenia</a></li>
<li><a href="#okreslenie-wystepowania-autokorelacji-przestrzennej-chmura-semiwariogramu-1"><span class="toc-section-number">6.2.10</span> Określenie występowania autokorelacji przestrzennej | Chmura semiwariogramu</a></li>
<li><a href="#okreslenie-wystepowania-autokorelacji-przestrzennej-chmura-semiwariogramu-2"><span class="toc-section-number">6.2.11</span> Określenie występowania autokorelacji przestrzennej | Chmura semiwariogramu</a></li>
<li><a href="#semiwariogram-charakterystyka-struktury-przestrzennej"><span class="toc-section-number">6.2.12</span> Semiwariogram | Charakterystyka struktury przestrzennej</a></li>
<li><a href="#semiwariogram"><span class="toc-section-number">6.2.13</span> Semiwariogram</a></li>
<li><a href="#semiwariogram-rules-of-thumb"><span class="toc-section-number">6.2.14</span> Semiwariogram | Rules of thumb</a></li>
<li><a href="#semiwariogram-obliczenia-pomocnicze"><span class="toc-section-number">6.2.15</span> Semiwariogram | Obliczenia pomocnicze</a></li>
<li><a href="#semiwariogram-maksymalny-zasieg-semiwariogramu-ang.-cutoff-distance"><span class="toc-section-number">6.2.16</span> Semiwariogram | Maksymalny zasięg semiwariogramu (ang. <em>Cutoff distance</em>)</a></li>
<li><a href="#semiwariogram-odlegosc-miedzy-przedziaami-ang.-interval-width"><span class="toc-section-number">6.2.17</span> Semiwariogram | Odległość między przedziałami (ang. <em>Interval width</em>)</a></li>
</ul></li>
<li><a href="#anizotropia"><span class="toc-section-number">6.3</span> Anizotropia</a><ul>
<li><a href="#anizotropia-struktury-przestrzennej"><span class="toc-section-number">6.3.1</span> Anizotropia struktury przestrzennej</a></li>
<li><a href="#mapa-semiwariogramu"><span class="toc-section-number">6.3.2</span> Mapa semiwariogramu</a></li>
<li><a href="#mapa-semiwariogramu-3d"><span class="toc-section-number">6.3.3</span> Mapa semiwariogramu | 3D</a></li>
<li><a href="#semiwariogramy-kierunkowe-kierunki"><span class="toc-section-number">6.3.4</span> Semiwariogramy kierunkowe | Kierunki</a></li>
<li><a href="#semiwariogramy-kierunkowe-kierunki-1"><span class="toc-section-number">6.3.5</span> Semiwariogramy kierunkowe | Kierunki</a></li>
</ul></li>
</ul></li>
<li><a href="#modelowanie-matematycznie-autokorelacji-przestrzennej"><span class="toc-section-number">7</span> Modelowanie matematycznie autokorelacji przestrzennej</a><ul>
<li><a href="#modelowanie-matematycznie-autokorelacji-przestrzennej-1"><span class="toc-section-number">7.0.1</span> Modelowanie matematycznie autokorelacji przestrzennej</a></li>
<li><a href="#modele-podstawowe"><span class="toc-section-number">7.1</span> Modele podstawowe</a><ul>
<li><a href="#modele-podstawowe-1"><span class="toc-section-number">7.1.1</span> Modele podstawowe</a></li>
</ul></li>
<li><a href="#metody-modelowania"><span class="toc-section-number">7.2</span> Metody modelowania</a><ul>
<li><a href="#metody-modelowania-1"><span class="toc-section-number">7.2.1</span> Metody modelowania</a></li>
<li><a href="#metody-modelowania-2"><span class="toc-section-number">7.2.2</span> Metody modelowania</a></li>
<li><a href="#metody-modelowania-liniowy-model-regionalizacji"><span class="toc-section-number">7.2.3</span> Metody modelowania | Liniowy model regionalizacji</a></li>
</ul></li>
<li><a href="#modelowanie-semiwariogramu"><span class="toc-section-number">7.3</span> Modelowanie semiwariogramu</a><ul>
<li><a href="#modelowanie-semiwariogramu-funkcja-fit.variogram"><span class="toc-section-number">7.3.1</span> Modelowanie semiwariogramu | funkcja <code>fit.variogram</code></a></li>
</ul></li>
<li><a href="#modelowanie-izotropowe"><span class="toc-section-number">7.4</span> Modelowanie izotropowe</a><ul>
<li><a href="#modelowanie-izotropowe-modelowanie-wizualne"><span class="toc-section-number">7.4.1</span> Modelowanie izotropowe | Modelowanie “wizualne”</a></li>
<li><a href="#modelowanie-izotropowe-model-nuggetowy"><span class="toc-section-number">7.4.2</span> Modelowanie izotropowe | Model nuggetowy</a></li>
<li><a href="#modelowanie-izotropowe-model-sferyczny"><span class="toc-section-number">7.4.3</span> Modelowanie izotropowe | Model sferyczny</a></li>
<li><a href="#modelowanie-izotropowe-model-gaussowski"><span class="toc-section-number">7.4.4</span> Modelowanie izotropowe | Model Gaussowski</a></li>
<li><a href="#modelowanie-izotropowe-model-potegowy"><span class="toc-section-number">7.4.5</span> Modelowanie izotropowe | Model potęgowy</a></li>
<li><a href="#modelowanie-izotropowe-model-wykadniczy"><span class="toc-section-number">7.4.6</span> Modelowanie izotropowe | Model wykładniczy</a></li>
<li><a href="#modelowanie-izotropowe-modele-zozone-i"><span class="toc-section-number">7.4.7</span> Modelowanie izotropowe | Modele złożone I</a></li>
<li><a href="#modelowanie-izotropowe-modele-zozone-ii"><span class="toc-section-number">7.4.8</span> Modelowanie izotropowe | Modele złożone II</a></li>
</ul></li>
<li><a href="#modelowanie-anizotropowe"><span class="toc-section-number">7.5</span> Modelowanie anizotropowe</a><ul>
<li><a href="#anizotropia-1"><span class="toc-section-number">7.5.1</span> Anizotropia</a></li>
</ul></li>
</ul></li>
<li><a href="#estymacje-jednozmienne"><span class="toc-section-number">8</span> Estymacje jednozmienne</a><ul>
<li><a href="#kriging"><span class="toc-section-number">8.1</span> Kriging</a><ul>
<li><a href="#kriging-interpolacja-geostatystyczna"><span class="toc-section-number">8.1.1</span> Kriging | Interpolacja geostatystyczna</a></li>
</ul></li>
<li><a href="#rodzaje-krigingu"><span class="toc-section-number">8.2</span> Rodzaje krigingu</a><ul>
<li><a href="#rodzaje-krigingu-1"><span class="toc-section-number">8.2.1</span> Rodzaje krigingu</a></li>
</ul></li>
<li><a href="#kriging-prosty-ang.-simple-kriging"><span class="toc-section-number">8.3</span> Kriging prosty (ang. <em>Simple kriging</em>)</a><ul>
<li><a href="#kriging-prosty-ang.-simple-kriging-1"><span class="toc-section-number">8.3.1</span> Kriging prosty (ang. <em>Simple kriging</em>)</a></li>
<li><a href="#kriging-prosty-ang.-simple-kriging-2"><span class="toc-section-number">8.3.2</span> Kriging prosty (ang. <em>Simple kriging</em>)</a></li>
</ul></li>
<li><a href="#kriging-zwyky-ang.-ordinary-kriging"><span class="toc-section-number">8.4</span> Kriging zwykły (ang. <em>Ordinary kriging</em>)</a><ul>
<li><a href="#kriging-zwyky-ang.-ordinary-kriging-1"><span class="toc-section-number">8.4.1</span> Kriging zwykły (ang. <em>Ordinary kriging</em>)</a></li>
<li><a href="#kriging-zwyky-ang.-ordinary-kriging-2"><span class="toc-section-number">8.4.2</span> Kriging zwykły (ang. <em>Ordinary kriging</em>)</a></li>
</ul></li>
<li><a href="#porownanie-wynikow-sk-ok-i-kzt"><span class="toc-section-number">8.5</span> Porównanie wyników SK, OK i KZT</a></li>
</ul></li>
<li><a href="#estymacja-lokalnego-rozkadu-prawdopodobienstwa"><span class="toc-section-number">9</span> Estymacja lokalnego rozkładu prawdopodobieństwa</a><ul>
<li><a href="#kriging-danych-kodowanych-ang.-indicator-kriging-wprowadzenie"><span class="toc-section-number">9.1</span> Kriging danych kodowanych (ang. <em>Indicator kriging</em>) | Wprowadzenie</a><ul>
<li><a href="#kriging-danych-kodowanych-ang.-indicator-kriging"><span class="toc-section-number">9.1.1</span> Kriging danych kodowanych (ang. <em>Indicator kriging</em>)</a></li>
<li><a href="#kriging-danych-kodowanych-ang.-indicator-kriging-1"><span class="toc-section-number">9.1.2</span> Kriging danych kodowanych (ang. <em>Indicator kriging</em>)</a></li>
<li><a href="#kriging-danych-kodowanych-ang.-indicator-kriging-wady-i-zalety"><span class="toc-section-number">9.1.3</span> Kriging danych kodowanych (ang. <em>Indicator kriging</em>)| Wady i zalety</a></li>
</ul></li>
<li><a href="#kriging-danych-kodowanych-ang.-indicator-kriging-przykady"><span class="toc-section-number">9.2</span> Kriging danych kodowanych (ang. <em>Indicator kriging</em>) | Przykłady</a><ul>
<li><a href="#binaryzacja-danych"><span class="toc-section-number">9.2.1</span> Binaryzacja danych</a></li>
<li><a href="#eksploracja-danych"><span class="toc-section-number">9.2.2</span> Eksploracja danych</a></li>
<li><a href="#kriging-danych-kodowanych-ang.-indicator-kriging-semiwariogram"><span class="toc-section-number">9.2.3</span> Kriging danych kodowanych (ang. <em>Indicator kriging</em>) | Semiwariogram</a></li>
<li><a href="#kriging-danych-kodowanych-ang.-indicator-kriging-modelowanie"><span class="toc-section-number">9.2.4</span> Kriging danych kodowanych (ang. <em>Indicator kriging</em>) | Modelowanie</a></li>
<li><a href="#kriging-danych-kodowanych-ang.-indicator-kriging-interpolacja"><span class="toc-section-number">9.2.5</span> Kriging danych kodowanych (ang. <em>Indicator kriging</em>) | Interpolacja</a></li>
<li><a href="#kriging-danych-kodowanych-ang.-indicator-kriging-2"><span class="toc-section-number">9.2.6</span> Kriging danych kodowanych (ang. <em>Indicator kriging</em>)</a></li>
</ul></li>
</ul></li>
<li><a href="#estymacje-wielozmienne"><span class="toc-section-number">10</span> Estymacje wielozmienne</a><ul>
<li><a href="#kokriging-prosty-i-zwyky-sck-i-ock"><span class="toc-section-number">10.1</span> Kokriging (prosty i zwykły, SCK i OCK)</a><ul>
<li><a href="#kokriging-ang.-co-kriging"><span class="toc-section-number">10.1.1</span> Kokriging (ang. <em>co-kriging</em>)</a></li>
<li><a href="#kokriging-wybor-dodatkowej-zmiennej"><span class="toc-section-number">10.1.2</span> Kokriging | Wybór dodatkowej zmiennej</a></li>
</ul></li>
<li><a href="#krossemiwariogramy"><span class="toc-section-number">10.2</span> Krossemiwariogramy</a><ul>
<li><a href="#krossemiwariogramy-1"><span class="toc-section-number">10.2.1</span> Krossemiwariogramy</a></li>
<li><a href="#krossemiwariogramy-2"><span class="toc-section-number">10.2.2</span> Krossemiwariogramy</a></li>
</ul></li>
<li><a href="#modelowanie-krossemiwariogramow"><span class="toc-section-number">10.3</span> Modelowanie krossemiwariogramów</a><ul>
<li><a href="#modelowanie-krossemiwariogramow-fit.lmc"><span class="toc-section-number">10.3.1</span> Modelowanie krossemiwariogramów | <code>fit.lmc</code></a></li>
<li><a href="#modelowanie-krossemiwariogramow-1"><span class="toc-section-number">10.3.2</span> Modelowanie krossemiwariogramów</a></li>
</ul></li>
<li><a href="#kokriging"><span class="toc-section-number">10.4</span> Kokriging</a><ul>
<li><a href="#kokriging-1"><span class="toc-section-number">10.4.1</span> Kokriging</a></li>
</ul></li>
</ul></li>
<li><a href="#wykorzystanie-do-estymacji-danych-uzupeniajacych"><span class="toc-section-number">11</span> Wykorzystanie do estymacji danych uzupełniających</a><ul>
<li><a href="#kriging-stratyfikowany-ang.-kriging-within-strata"><span class="toc-section-number">11.1</span> Kriging stratyfikowany (ang. <em>Kriging within strata</em>)</a><ul>
<li><a href="#kriging-stratyfikowany-ang.-kriging-within-strata-1"><span class="toc-section-number">11.1.1</span> Kriging stratyfikowany (ang. <em>Kriging within strata</em>)</a></li>
<li><a href="#kriging-stratyfikowany-ang.-kriging-within-strata-2"><span class="toc-section-number">11.1.2</span> Kriging stratyfikowany (ang. <em>Kriging within strata</em>)</a></li>
</ul></li>
<li><a href="#prosty-kriging-ze-zmiennymi-srednimi-lokalnymi-lvm"><span class="toc-section-number">11.2</span> Prosty kriging ze zmiennymi średnimi lokalnymi (LVM)</a><ul>
<li><a href="#prosty-kriging-ze-zmiennymi-srednimi-lokalnymi-lvm-1"><span class="toc-section-number">11.2.1</span> Prosty kriging ze zmiennymi średnimi lokalnymi (LVM)</a></li>
<li><a href="#prosty-kriging-ze-zmiennymi-srednimi-lokalnymi-lvm-2"><span class="toc-section-number">11.2.2</span> Prosty kriging ze zmiennymi średnimi lokalnymi (LVM)</a></li>
</ul></li>
<li><a href="#kriging-uniwersalny-ang.-universal-kriging"><span class="toc-section-number">11.3</span> Kriging uniwersalny (ang. <em>Universal kriging</em>)</a><ul>
<li><a href="#kriging-uniwersalny-ang.-universal-kriging-1"><span class="toc-section-number">11.3.1</span> Kriging uniwersalny (ang. <em>Universal kriging</em>)</a></li>
<li><a href="#kriging-uniwersalny-ang.-universal-kriging-2"><span class="toc-section-number">11.3.2</span> Kriging uniwersalny (ang. <em>Universal kriging</em>)</a></li>
</ul></li>
</ul></li>
<li><a href="#ocena-jakosci-estymacji-uwaga-pomieszany-me-z-reszta"><span class="toc-section-number">12</span> Ocena jakości estymacji [UWAGA POMIESZANY ME Z RESZTĄ!!]</a><ul>
<li><a href="#statystyki-jakosci-estymacji"><span class="toc-section-number">12.1</span> Statystyki jakości estymacji</a><ul>
<li><a href="#statystyki-jakosci-estymacji-1"><span class="toc-section-number">12.1.1</span> Statystyki jakości estymacji</a></li>
<li><a href="#statystyki-jakosci-estymacji-2"><span class="toc-section-number">12.1.2</span> Statystyki jakości estymacji</a></li>
<li><a href="#sredni-bad-estymacji"><span class="toc-section-number">12.1.3</span> Średni błąd estymacji</a></li>
<li><a href="#wspoczynnik-korelacji-1"><span class="toc-section-number">12.1.4</span> Współczynnik korelacji</a></li>
<li><a href="#statystyki-jakosci-estymacji-mapa"><span class="toc-section-number">12.1.5</span> Statystyki jakości estymacji | Mapa</a></li>
<li><a href="#statystyki-jakosci-estymacji-histogram"><span class="toc-section-number">12.1.6</span> Statystyki jakości estymacji | Histogram</a></li>
<li><a href="#statystyki-jakosci-estymacji-wykres-rozrzutu"><span class="toc-section-number">12.1.7</span> Statystyki jakości estymacji | Wykres rozrzutu</a></li>
</ul></li>
<li><a href="#walidacja-wynikow-estymacji"><span class="toc-section-number">12.2</span> Walidacja wyników estymacji</a><ul>
<li><a href="#walidacja-wynikow-estymacji-1"><span class="toc-section-number">12.2.1</span> Walidacja wyników estymacji</a></li>
<li><a href="#walidacja-podzbiorem"><span class="toc-section-number">12.2.2</span> Walidacja podzbiorem</a></li>
<li><a href="#walidacja-podzbiorem-1"><span class="toc-section-number">12.2.3</span> Walidacja podzbiorem</a></li>
<li><a href="#kroswalidacja"><span class="toc-section-number">12.2.4</span> Kroswalidacja</a></li>
<li><a href="#kroswalidacja-1"><span class="toc-section-number">12.2.5</span> Kroswalidacja</a></li>
</ul></li>
</ul></li>
<li><a href="#symulacje"><span class="toc-section-number">13</span> Symulacje</a><ul>
<li><a href="#symulacje-geostatystyczne"><span class="toc-section-number">13.1</span> Symulacje geostatystyczne</a><ul>
<li><a href="#symulacje-geostatystyczne-1"><span class="toc-section-number">13.1.1</span> Symulacje geostatystyczne</a></li>
<li><a href="#symulacje-geostatystyczne-cel"><span class="toc-section-number">13.1.2</span> Symulacje geostatystyczne | Cel</a></li>
</ul></li>
<li><a href="#typy-symulacji"><span class="toc-section-number">13.2</span> Typy symulacji</a><ul>
<li><a href="#typy-symulacji-1"><span class="toc-section-number">13.2.1</span> Typy symulacji</a></li>
</ul></li>
<li><a href="#symulacje-bezwarunkowe"><span class="toc-section-number">13.3</span> Symulacje bezwarunkowe</a></li>
<li><a href="#symulacje-warunkowe"><span class="toc-section-number">13.4</span> Symulacje warunkowe</a><ul>
<li><a href="#sekwencyjna-symulacja-gaussowska-ang.-sequential-gaussian-simulation"><span class="toc-section-number">13.4.1</span> Sekwencyjna symulacja gaussowska (ang. <em>Sequential Gaussian simulation</em>)</a></li>
<li><a href="#sekwencyjna-symulacja-gaussowska-ang.-sequential-gaussian-simulation-1"><span class="toc-section-number">13.4.2</span> Sekwencyjna symulacja gaussowska (ang. <em>Sequential Gaussian simulation</em>)</a></li>
<li><a href="#sekwencyjna-symulacja-gaussowska-ang.-sequential-gaussian-simulation-2"><span class="toc-section-number">13.4.3</span> Sekwencyjna symulacja gaussowska (ang. <em>Sequential Gaussian simulation</em>)</a></li>
</ul></li>
<li><a href="#sekwencyjna-symulacja-danych-kodowanych-ang.-sequential-indicator-simulation"><span class="toc-section-number">13.5</span> Sekwencyjna symulacja danych kodowanych (ang. <em>Sequential indicator simulation</em>)</a><ul>
<li><a href="#sekwencyjna-symulacja-danych-kodowanych-ang.-sequential-indicator-simulation-1"><span class="toc-section-number">13.5.1</span> Sekwencyjna symulacja danych kodowanych (ang. <em>Sequential indicator simulation</em>)</a></li>
</ul></li>
</ul></li>
<li><a href="#bibliografia"><span class="toc-section-number">14</span> Bibliografia</a></li>
</ul>
<!--bookdown:toc2:end-->
      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Geostatystyka</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<!--bookdown:toc:end-->
<!--bookdown:body:start-->
<div id="dzien-dobry" class="section level1">
<h1><span class="header-section-number">1</span> Dzień dobry</h1>
<p>Kłaniam się.</p>
<blockquote>
<p>Tutaj będzie wstęp mówiący o tym co znajduje się dalej</p>
</blockquote>
<iframe src="http://giphy.com/embed/cNb6ey1bD9uPC" width="480" height="360" frameBorder="0" class="giphy-embed" allowFullScreen>
</iframe>
<p>
<a href="http://giphy.com/gifs/george-costanza-dapper-cNb6ey1bD9uPC">via GIPHY</a>
</p>
</div>
<div id="intro" class="section level1">
<h1><span class="header-section-number">2</span> Wprowadzenie</h1>
<div id="wymagania-wstepne" class="section level2">
<h2><span class="header-section-number">2.1</span> Wymagania wstępne</h2>
<p>Oprogramowanie, pakiety i dane.</p>
<div id="oprogramowanie" class="section level3">
<h3><span class="header-section-number">2.1.1</span> Oprogramowanie</h3>
<ul>
<li><a href="www.r-project.org">R</a> - <a href="https://cloud.r-project.org/" class="uri">https://cloud.r-project.org/</a></li>
<li><a href="www.rstudio.com">RStudio</a> - <a href="https://www.rstudio.com/products/rstudio/download/" class="uri">https://www.rstudio.com/products/rstudio/download/</a></li>
</ul>
</div>
<div id="dane" class="section level3">
<h3><span class="header-section-number">2.1.2</span> Dane</h3>
<ul>
<li>Adres</li>
<li>Pliki + ryciny</li>
</ul>
<!--chapter:end:index.Rmd-->
</div>
</div>
<div id="r-a-dane-przestrzenne" class="section level2">
<h2><span class="header-section-number">2.2</span> R a dane przestrzenne</h2>
<div id="pakiety" class="section level3">
<h3><span class="header-section-number">2.2.1</span> Pakiety</h3>
<ul>
<li>GIS - <code>sp</code>, <code>rgdal</code>, <code>raster</code>, <code>rasterVis</code>, <code>rgeos</code>, <code>maptools</code>, <code>GeoXp</code>, <code>deldir</code>, <code>pgirmess</code></li>
<li>Geostatystyka - <code>gstat</code>, <code>geoR</code>, <code>geoRglm</code>, <code>fields</code>, <code>spBayes</code>, <code>RandomFields</code>, <code>vardiag</code></li>
<li>Inne - <code>ggplot2</code>, <code>corrplot</code>, <code>caret</code></li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pakiety &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;caret&#39;</span>, <span class="st">&#39;corrplot&#39;</span>, <span class="st">&#39;dismo&#39;</span>, <span class="st">&#39;fields&#39;</span>, <span class="st">&#39;geoR&#39;</span>, <span class="st">&#39;ggplot2&#39;</span>, <span class="st">&#39;gridExtra&#39;</span>, <span class="st">&#39;gstat&#39;</span>, <span class="st">&#39;pgirmess&#39;</span>, <span class="st">&#39;raster&#39;</span>, <span class="st">&#39;rasterVis&#39;</span>, <span class="st">&#39;rgdal&#39;</span>, <span class="st">&#39;rgeos&#39;</span>, <span class="st">&#39;sp&#39;</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">install.packages</span>(pakiety)</code></pre></div>
<p>Pakiety R oraz zbiory danych używane w tej książce można również zainstalować poprzez:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">devtools::<span class="kw">install_github</span>(<span class="st">&quot;nowosad/geostatbook&quot;</span>)</code></pre></div>
</div>
<div id="reprezentacja-danych-nieprzestrzennych" class="section level3">
<h3><span class="header-section-number">2.2.2</span> Reprezentacja danych nieprzestrzennych</h3>
<ul>
<li>Wektory (ang. <em>vector</em>):
<ul>
<li>liczbowe (ang. <em>integer</em>, <em>numeric</em>) - c(1, 2, 3) i c(1.21, 3.32, 4.43)</li>
<li>znakowe (ang. <em>character</em>) - c(‘jeden’, ‘dwa’, ‘trzy’)</li>
<li>logiczne (ang. <em>logical</em>) - c(TRUE, FALSE)</li>
<li>czynnikowe (ang. <em>factor</em>) - c(‘jeden’, ‘dwa’, ‘trzy’, ‘jeden’)</li>
</ul></li>
<li>Ramki danych (ang. <em>data.frame</em>) - to zbiór zmiennych (kolumn) oraz obserwacji (wierszy) zawierających różne typy danych</li>
<li>Macierze (ang. <em>matrix</em>)</li>
<li>Listy (ang. <em>list</em>)</li>
</ul>
</div>
<div id="reprezentacja-danych-przestrzennych" class="section level3">
<h3><span class="header-section-number">2.2.3</span> Reprezentacja danych przestrzennych</h3>
<ul>
<li>Obiekty klasy <code>Spatial*</code> z pakietu <code>sp</code> - wszystkie z nich zawierają dwie dodatkowe informacje:
<ul>
<li>bounding box (<code>bbox</code>) - obwiednia - określa zasięg danych</li>
<li>CRS (<code>proj4string</code>) - układ współrzędnych</li>
</ul></li>
<li>Najczęściej stosowane obiekty klasy <code>Spatial*</code> to <code>SpatialPointsDataFrame</code>, <code>SpatialPolygonsDataFrame</code> oraz <code>SpatialGridDataFrame</code></li>
<li>Obiekty klasy <code>Raster*</code> z pakietu <code>raster</code>, tj. <code>RasterLayer</code>, <code>RasterStack</code>, <code>RasterBrick</code></li>
<li>Inne</li>
</ul>
</div>
<div id="gdalogr" class="section level3">
<h3><span class="header-section-number">2.2.4</span> GDAL/OGR</h3>
<ul>
<li><a href="http://www.gdal.org/" class="uri">http://www.gdal.org/</a></li>
<li>GDAL to biblioteka zawierająca funkcje służące do odczytywania i zapiswania danych w formatach rastrowych</li>
<li>OGR to bibioteka służąca to odczytywania i zapiswania danych w formatach wektorowych</li>
<li>Pakiet <code>rgdal</code> pozwala na wykorzystanie bibliotek GDAL/OGR w R</li>
</ul>
</div>
<div id="proj.4" class="section level3">
<h3><span class="header-section-number">2.2.5</span> PROJ.4</h3>
<ul>
<li>Dane przestrzenne powinny być zawsze powiązane z układem współrzednych</li>
<li>PROJ.4 - to biblioteka pozwalająca na identyfiację oraz konwersję pomiędzy różnymi układami współrzędnych <a href="http://www.spatialreference.org/" class="uri">http://www.spatialreference.org/</a></li>
</ul>
</div>
<div id="epsg" class="section level3">
<h3><span class="header-section-number">2.2.6</span> EPSG</h3>
<ul>
<li>Kod EPSG (ang. <em>European Petroleum Survey Group</em>) pozwala na łatwe identyfikowanie układów współrzędnych</li>
<li>Przykładowo, układ PL 1992 może być określony jako:</li>
</ul>
<p>“+proj=tmerc +lat_0=0 +lon_0=19 +k=0.9993 +x_0=500000 +y_0=-5300000 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs”</p>
<ul>
<li>…lub też za pomocą kodu EPSG:</li>
</ul>
<p>“+init=epsg:2180”</p>
</div>
<div id="ukad-geograficzny" class="section level3">
<h3><span class="header-section-number">2.2.7</span> Układ geograficzny</h3>
<ul>
<li>Proporcje pomiędzy współrzedną oznaczjącą długość geograficzną (X) a oznaczającą szerokość geograficzną (Y) nie są równe 1:1</li>
<li>Wielkość oczka siatki jest zmienna</li>
<li>Nie pozwala to na proste określanie odległości czy powierzchni</li>
<li><p>Jednostka mapy jest abstrakcyjna</p></li>
<li><p>Do większości algorytmów w geostatystyce wykorzystywane są układy współrzędnych prostokątnych płaskich</p></li>
</ul>
</div>
</div>
<div id="import-danych" class="section level2">
<h2><span class="header-section-number">2.3</span> Import danych</h2>
<div id="dane-punktowe-format-csv" class="section level3">
<h3><span class="header-section-number">2.3.1</span> Dane punktowe (format csv)</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dane_punktowe &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&#39;dane/punkty.csv&#39;</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(dane_punktowe)</code></pre></div>
<pre><code>##       srtm clc      temp      ndvi       savi        x        y
## 1 223.7413   2 16.686657 0.5824910 0.34681170 750794.1 714358.7
## 2 182.1080   4 15.433375 0.1390970 0.04292461 754097.3 714523.3
## 3 207.2538   1 16.177960 0.4633545 0.31007461 754421.8 720854.1
## 4 172.1708   1 14.381898 0.5805432 0.38777806 750261.2 716601.2
## 5 225.0000   4  9.389477 0.2140123 0.08478602 748175.4 718660.5
## 6 260.5744   2 10.215618 0.5307761 0.32831149 750605.8 719174.1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">coordinates</span>(dane_punktowe) &lt;-<span class="st"> </span><span class="er">~</span>x+y
<span class="kw">summary</span>(dane_punktowe)</code></pre></div>
<pre><code>## Object of class SpatialPointsDataFrame
## Coordinates:
##        min      max
## x 745751.4 756397.3
## y 712639.5 721183.7
## Is projected: NA 
## proj4string : [NA]
## Number of points: 241
## Data attributes:
##       srtm            clc             temp             ndvi       
##  Min.   :146.6   Min.   :1.000   Min.   : 7.618   Min.   :0.1391  
##  1st Qu.:189.0   1st Qu.:1.000   1st Qu.:12.301   1st Qu.:0.4534  
##  Median :219.9   Median :1.000   Median :15.225   Median :0.5113  
##  Mean   :214.6   Mean   :1.442   Mean   :15.846   Mean   :0.4980  
##  3rd Qu.:234.0   3rd Qu.:2.000   3rd Qu.:18.924   3rd Qu.:0.5560  
##  Max.   :281.7   Max.   :4.000   Max.   :25.729   Max.   :0.6547  
##  NA&#39;s   :1       NA&#39;s   :1                                        
##       savi        
##  Min.   :0.04292  
##  1st Qu.:0.28451  
##  Median :0.31848  
##  Mean   :0.31309  
##  3rd Qu.:0.35672  
##  Max.   :0.46381  
## </code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">proj4string</span>(dane_punktowe) &lt;-<span class="st"> &#39;+init=epsg:2180&#39;</span>
<span class="kw">summary</span>(dane_punktowe)</code></pre></div>
<pre><code>## Object of class SpatialPointsDataFrame
## Coordinates:
##        min      max
## x 745751.4 756397.3
## y 712639.5 721183.7
## Is projected: TRUE 
## proj4string :
## [+init=epsg:2180 +proj=tmerc +lat_0=0 +lon_0=19 +k=0.9993
## +x_0=500000 +y_0=-5300000 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0
## +units=m +no_defs]
## Number of points: 241
## Data attributes:
##       srtm            clc             temp             ndvi       
##  Min.   :146.6   Min.   :1.000   Min.   : 7.618   Min.   :0.1391  
##  1st Qu.:189.0   1st Qu.:1.000   1st Qu.:12.301   1st Qu.:0.4534  
##  Median :219.9   Median :1.000   Median :15.225   Median :0.5113  
##  Mean   :214.6   Mean   :1.442   Mean   :15.846   Mean   :0.4980  
##  3rd Qu.:234.0   3rd Qu.:2.000   3rd Qu.:18.924   3rd Qu.:0.5560  
##  Max.   :281.7   Max.   :4.000   Max.   :25.729   Max.   :0.6547  
##  NA&#39;s   :1       NA&#39;s   :1                                        
##       savi        
##  Min.   :0.04292  
##  1st Qu.:0.28451  
##  Median :0.31848  
##  Mean   :0.31309  
##  3rd Qu.:0.35672  
##  Max.   :0.46381  
## </code></pre>
<!--
### Usuwanie punktów zawierających braki wartości


```r
sp_na_omit <- function(x, margin=1) {
    if (!inherits(x, "SpatialPointsDataFrame") & !inherits(x, "SpatialPolygonsDataFrame")) 
        stop("MUST BE sp SpatialPointsDataFrame OR SpatialPolygonsDataFrame CLASS OBJECT") 
    na.index <- unique(as.data.frame(which(is.na(x@data),arr.ind=TRUE))[,margin])
    if(margin == 1) {  
        cat("DELETING ROWS: ", na.index, "\n") 
        return( x[-na.index,]  ) 
    }
    if(margin == 2) {  
        cat("DELETING COLUMNS: ", na.index, "\n") 
        return( x[,-na.index]  ) 
    }
}
# wolin_lato_los2 <- sp_na_omit(wolin_lato_los) 
# summary(wolin_lato_los2)
```
-->
</div>
<div id="dane-poligonowe-formaty-gisowe" class="section level3">
<h3><span class="header-section-number">2.3.2</span> Dane poligonowe (formaty gisowe)</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">granica &lt;-<span class="st"> </span><span class="kw">readOGR</span>(<span class="dt">dsn=</span><span class="st">&#39;dane&#39;</span>, <span class="dt">layer=</span><span class="st">&#39;granica&#39;</span>, <span class="dt">verbose=</span><span class="ot">FALSE</span>)
<span class="kw">plot</span>(granica)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-10-1.png" alt="" /><!-- --></p>
</div>
<div id="rastry" class="section level3">
<h3><span class="header-section-number">2.3.3</span> Rastry</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">siatka_raster &lt;-<span class="st"> </span><span class="kw">raster</span>(<span class="st">&#39;dane/siatka.tif&#39;</span>)
<span class="kw">plot</span>(siatka_raster)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-11-1.png" alt="" /><!-- --></p>
</div>
</div>
<div id="eksport-danych" class="section level2">
<h2><span class="header-section-number">2.4</span> Eksport danych</h2>
<div id="zapisywanie-danych-wektorowych" class="section level3">
<h3><span class="header-section-number">2.4.1</span> Zapisywanie danych wektorowych</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">writeOGR</span>(poligon, <span class="dt">dsn=</span><span class="st">&#39;nazwa_folderu&#39;</span>, <span class="dt">layer=</span><span class="st">&#39;nowy_poligon&#39;</span>, <span class="dt">driver=</span><span class="st">&#39;ESRI Shapefile&#39;</span>)</code></pre></div>
</div>
<div id="zapisywanie-danych-rastrowych" class="section level3">
<h3><span class="header-section-number">2.4.2</span> Zapisywanie danych rastrowych</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">writeRaster</span>(siatka_raster, <span class="dt">filename=</span><span class="st">&#39;nazwa_folderu/nowy_raster.tif&#39;</span>)</code></pre></div>
</div>
</div>
<div id="wizualizacja-danych-2d" class="section level2">
<h2><span class="header-section-number">2.5</span> Wizualizacja danych 2D</h2>
<div id="dane-punktowe" class="section level3">
<h3><span class="header-section-number">2.5.1</span> Dane punktowe</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(dane_punktowe)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-12-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">spplot</span>(dane_punktowe, <span class="st">&#39;temp&#39;</span>)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-13-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">spplot</span>(dane_punktowe, <span class="st">&#39;srtm&#39;</span>)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-14-1.png" alt="" /><!-- --></p>
</div>
<div id="dane-punktowe---kategorie" class="section level3">
<h3><span class="header-section-number">2.5.2</span> Dane punktowe - kategorie</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dane_punktowe@data$clc &lt;-<span class="st"> </span><span class="kw">as.factor</span>(dane_punktowe@data$clc)
<span class="kw">spplot</span>(dane_punktowe, <span class="st">&#39;clc&#39;</span>)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-15-1.png" alt="" /><!-- --></p>
</div>
<div id="rastry-1" class="section level3">
<h3><span class="header-section-number">2.5.3</span> Rastry</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">levelplot</span>(siatka_raster, <span class="dt">margin=</span><span class="ot">FALSE</span>)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-16-1.png" alt="" /><!-- --></p>
</div>
</div>
<div id="tworzenie-siatek" class="section level2">
<h2><span class="header-section-number">2.6</span> Tworzenie siatek</h2>
<div id="siatki-regularne" class="section level3">
<h3><span class="header-section-number">2.6.1</span> Siatki regularne</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">bbox</span>(dane_punktowe)</code></pre></div>
<pre><code>##        min      max
## x 745751.4 756397.3
## y 712639.5 721183.7</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">extent</span>(dane_punktowe)</code></pre></div>
<pre><code>## class       : Extent 
## xmin        : 745751.4 
## xmax        : 756397.3 
## ymin        : 712639.5 
## ymax        : 721183.7</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">siatka &lt;-<span class="st"> </span><span class="kw">expand.grid</span>(<span class="dt">x =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">745050</span>, <span class="dt">to =</span> <span class="dv">757050</span>, <span class="dt">by =</span> <span class="dv">500</span>),
                      <span class="dt">y =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">712650</span>, <span class="dt">to =</span> <span class="dv">721650</span>, <span class="dt">by =</span> <span class="dv">500</span>))
<span class="kw">coordinates</span>(siatka) &lt;-<span class="st"> </span><span class="er">~</span>x +<span class="st"> </span>y
<span class="kw">gridded</span>(siatka) &lt;-<span class="st"> </span><span class="ot">TRUE</span>
<span class="kw">proj4string</span>(siatka) &lt;-<span class="st"> </span><span class="kw">proj4string</span>(dane_punktowe)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">siatka &lt;-<span class="st"> </span><span class="kw">makegrid</span>(dane_punktowe, <span class="dt">cellsize=</span><span class="dv">500</span>)
<span class="kw">names</span>(siatka) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;x&#39;</span>, <span class="st">&#39;y&#39;</span>)
<span class="kw">coordinates</span>(siatka) &lt;-<span class="st"> </span><span class="er">~</span>x +<span class="st"> </span>y
<span class="kw">gridded</span>(siatka) &lt;-<span class="st"> </span><span class="ot">TRUE</span>
<span class="kw">proj4string</span>(siatka) &lt;-<span class="st"> </span><span class="kw">proj4string</span>(dane_punktowe)</code></pre></div>
</div>
<div id="siatki-regularne-1" class="section level3">
<h3><span class="header-section-number">2.6.2</span> Siatki regularne</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(siatka)
<span class="kw">plot</span>(dane_punktowe, <span class="dt">add=</span><span class="ot">TRUE</span>)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-20-1.png" alt="" /><!-- --></p>
</div>
<div id="siatki-nieregularne---klasa-rasterlayer" class="section level3">
<h3><span class="header-section-number">2.6.3</span> Siatki nieregularne - klasa <code>RasterLayer</code></h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">granica &lt;-<span class="st"> </span><span class="kw">readOGR</span>(<span class="dt">dsn=</span><span class="st">&#39;dane&#39;</span>, <span class="dt">layer=</span><span class="st">&#39;granica&#39;</span>)</code></pre></div>
<pre><code>## OGR data source with driver: ESRI Shapefile 
## Source: &quot;dane&quot;, layer: &quot;granica&quot;
## with 1 features
## It has 3 fields</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">siatka_n &lt;-<span class="st"> </span><span class="kw">raster</span>(<span class="kw">extent</span>(granica))
<span class="kw">res</span>(siatka_n) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">500</span>, <span class="dv">500</span>)
siatka_n[] &lt;-<span class="st"> </span><span class="dv">0</span>
<span class="kw">proj4string</span>(siatka_n) &lt;-<span class="st"> </span><span class="kw">proj4string</span>(granica)
siatka_n &lt;-<span class="st"> </span><span class="kw">mask</span>(siatka_n, granica)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">levelplot</span>(siatka_n, <span class="dt">margin=</span><span class="ot">FALSE</span>)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-22-1.png" alt="" /><!-- --></p>
</div>
<div id="siatki-nieregularne---klasa-spatialpixelsdataframe" class="section level3">
<h3><span class="header-section-number">2.6.4</span> Siatki nieregularne - klasa <code>SpatialPixelsDataFrame</code></h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">siatka_n &lt;-<span class="st"> </span><span class="kw">as</span>(siatka_n, <span class="st">&#39;SpatialPointsDataFrame&#39;</span>)
siatka_n &lt;-<span class="st"> </span>siatka_n[!<span class="kw">is.na</span>(siatka_n@data$layer), ]
<span class="kw">gridded</span>(siatka_n) &lt;-<span class="st"> </span><span class="ot">TRUE</span>
<span class="kw">plot</span>(siatka_n)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-23-1.png" alt="" /><!-- --></p>
<!--chapter:end:01-wprowadzenie.Rmd-->
</div>
</div>
</div>
<div id="eksploracyjna-analiza-danych" class="section level1">
<h1><span class="header-section-number">3</span> Eksploracyjna analiza danych</h1>
<div id="eksploracyjna-analiza-danych-cel" class="section level2">
<h2><span class="header-section-number">3.1</span> Eksploracyjna analiza danych | Cel</h2>
<ul>
<li>Ogólna charakterystyka danych oraz badanego zjawiska</li>
<li>Określenie przestrzennego/czasowego typu próbkowania</li>
<li>Informacja o relacji pomiędzy lokalizacją obserwacji a czynnikami wpływającymi na zmienność przestrzenną cechy</li>
</ul>
</div>
<div id="dane-1" class="section level2">
<h2><span class="header-section-number">3.2</span> Dane</h2>
<div id="dane-2" class="section level3">
<h3><span class="header-section-number">3.2.1</span> Dane</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&#39;geostatbook&#39;</span>)
<span class="kw">data</span>(punkty)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">4</span>)))
<span class="kw">plot</span>(punkty)

<span class="kw">str</span>(punkty)</code></pre></div>
<pre><code>## Formal class &#39;SpatialPointsDataFrame&#39; [package &quot;sp&quot;] with 5 slots
##   ..@ data       :&#39;data.frame&#39;:  252 obs. of  5 variables:
##   .. ..$ srtm: num [1:252] 225 226 202 218 196 ...
##   .. ..$ clc : int [1:252] 4 1 1 1 1 2 1 2 1 1 ...
##   .. ..$ temp: num [1:252] 8.45 26.46 16.22 19.48 20.68 ...
##   .. ..$ ndvi: num [1:252] 0.271 0.399 0.541 0.502 0.414 ...
##   .. ..$ savi: num [1:252] 0.134 0.278 0.319 0.277 0.224 ...
##   ..@ coords.nrs : int [1:2] 6 7
##   ..@ coords     : num [1:252, 1:2] 748319 746796 755747 752827 748584 ...
##   .. ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. .. ..$ : chr [1:252] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...
##   .. .. ..$ : chr [1:2] &quot;x&quot; &quot;y&quot;
##   ..@ bbox       : num [1:2, 1:2] 745619 712664 756964 721254
##   .. ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. .. ..$ : chr [1:2] &quot;x&quot; &quot;y&quot;
##   .. .. ..$ : chr [1:2] &quot;min&quot; &quot;max&quot;
##   ..@ proj4string:Formal class &#39;CRS&#39; [package &quot;sp&quot;] with 1 slot
##   .. .. ..@ projargs: chr &quot;+init=epsg:2180 +proj=tmerc +lat_0=0 +lon_0=19 +k=0.9993 +x_0=500000 +y_0=-5300000 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m&quot;| __truncated__</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(punkty@data)</code></pre></div>
<pre><code>## &#39;data.frame&#39;:    252 obs. of  5 variables:
##  $ srtm: num  225 226 202 218 196 ...
##  $ clc : int  4 1 1 1 1 2 1 2 1 1 ...
##  $ temp: num  8.45 26.46 16.22 19.48 20.68 ...
##  $ ndvi: num  0.271 0.399 0.541 0.502 0.414 ...
##  $ savi: num  0.134 0.278 0.319 0.277 0.224 ...</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(granica)
<span class="kw">plot</span>(granica, <span class="dt">add=</span><span class="ot">TRUE</span>)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-26-1.png" alt="" /><!-- --></p>
</div>
</div>
<div id="statystyki-opisowe" class="section level2">
<h2><span class="header-section-number">3.3</span> Statystyki opisowe</h2>
<div id="statystyki-opisowe-1" class="section level3">
<h3><span class="header-section-number">3.3.1</span> Statystyki opisowe</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(punkty@data)</code></pre></div>
<pre><code>##       srtm            clc             temp             ndvi       
##  Min.   :145.8   Min.   :1.000   Min.   : 8.153   Min.   :0.1772  
##  1st Qu.:184.6   1st Qu.:1.000   1st Qu.:12.459   1st Qu.:0.4520  
##  Median :215.0   Median :1.000   Median :15.210   Median :0.5105  
##  Mean   :211.4   Mean   :1.508   Mean   :15.522   Mean   :0.4974  
##  3rd Qu.:235.4   3rd Qu.:2.000   3rd Qu.:18.258   3rd Qu.:0.5587  
##  Max.   :277.0   Max.   :4.000   Max.   :26.700   Max.   :0.6955  
##       savi        
##  Min.   :0.05808  
##  1st Qu.:0.27785  
##  Median :0.31928  
##  Mean   :0.31185  
##  3rd Qu.:0.35793  
##  Max.   :0.46736</code></pre>
</div>
<div id="statystyki-opisowe-srednia-i-mediana" class="section level3">
<h3><span class="header-section-number">3.3.2</span> Statystyki opisowe | średnia i mediana</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">median</span>(punkty$temp, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## [1] 15.20954</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>(punkty$temp, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## [1] 15.52164</code></pre>
</div>
<div id="statystyki-opisowe-srednia-i-mediana-1" class="section level3">
<h3><span class="header-section-number">3.3.3</span> Statystyki opisowe | średnia i mediana</h3>
<ul>
<li>W wypadku symetrycznego rozkładu te dwie cechy są równe</li>
<li>Średnia jest bardziej wrażliwa na wartości odstające</li>
<li>Mediana jest lepszą miarą środka danych, jeżeli są one skośne</li>
</ul>
<p>Po co używać średniej?</p>
<ul>
<li>Bardziej przydatna w przypadku małych zbiorów danych</li>
<li>Gdy rozkład danych jest symetryczny</li>
<li>(Jednak) często warto podawać obie miary</li>
</ul>
</div>
<div id="statystyki-opisowe-minimum-i-maksimum" class="section level3">
<h3><span class="header-section-number">3.3.4</span> Statystyki opisowe | minimum i maksimum</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">min</span>(punkty$temp, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## [1] 8.153331</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">max</span>(punkty$temp, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## [1] 26.69978</code></pre>
</div>
<div id="statystyki-opisowe-ochylenie-standardowe" class="section level3">
<h3><span class="header-section-number">3.3.5</span> Statystyki opisowe | ochylenie standardowe</h3>
<div class="figure">
<img src="figs/sd.png" alt="" />

</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sd</span>(punkty$temp, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## [1] 4.079184</code></pre>
</div>
</div>
<div id="wykresy" class="section level2">
<h2><span class="header-section-number">3.4</span> Wykresy</h2>
<div id="histogram" class="section level3">
<h3><span class="header-section-number">3.4.1</span> Histogram</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(punkty@data, <span class="kw">aes</span>(temp)) +<span class="st"> </span><span class="kw">geom_histogram</span>()</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-31-1.png" alt="" /><!-- --></p>
<ul>
<li>Stworzony przez Karla Pearsona</li>
<li>Jest graficzną reprezentacją rozkładu <br> danych</li>
<li>Wartości danych są łączone w przedziały (na osi poziomej) a na osi pionowej jest ukazana liczba punktów (obserwacji) w każdym przedziale</li>
<li>Różny dobór przedziałów może dawać inną informację</li>
<li>W pakiecie ggplot2, domyślnie przedział to zakres/30</li>
</ul>
</div>
<div id="estymator-jadrowy-gestosci-ang.-kernel-density-estimation" class="section level3">
<h3><span class="header-section-number">3.4.2</span> Estymator jądrowy gęstości (ang. <em>kernel density estimation</em>)</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(punkty@data, <span class="kw">aes</span>(temp)) +<span class="st"> </span><span class="kw">geom_density</span>()</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-32-1.png" alt="" /><!-- --></p>
</div>
<div id="wykresy-kwantyl-kwantyl-ang.quantile-quantile" class="section level3">
<h3><span class="header-section-number">3.4.3</span> Wykresy kwantyl-kwantyl (ang.<em>quantile-quantile</em>)</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(punkty@data, <span class="kw">aes</span>(<span class="dt">sample=</span>temp)) +<span class="st"> </span><span class="kw">stat_qq</span>()</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-33-1.png" alt="" /><!-- --></p>
</div>
<div id="wykresy-kwantyl-kwantyl-ang.-quantile-quantile" class="section level3">
<h3><span class="header-section-number">3.4.4</span> Wykresy kwantyl-kwantyl (ang. <em>quantile-quantile</em>)</h3>
<p><a href="http://stats.stackexchange.com/questions/101274/how-to-interpret-a-qq-plot" class="uri">http://stats.stackexchange.com/questions/101274/how-to-interpret-a-qq-plot</a> <img src="figs/qq.png" alt="http://stats.stackexchange.com/questions/101274/how-to-interpret-a-qq-plot" /></p>
</div>
<div id="dystrybuanta-cdf" class="section level3">
<h3><span class="header-section-number">3.4.5</span> Dystrybuanta (CDF)</h3>
<ul>
<li>Dystrybuanta (ang. <em>conditional density function</em> - CDF) wyświetla prawdopodobieństwo, że wartość zmiennej przewidywanej jest mniejsza lub równa określonej wartości</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(punkty@data, <span class="kw">aes</span>(temp)) +<span class="st"> </span><span class="kw">stat_ecdf</span>()</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-34-1.png" alt="" /><!-- --></p>
</div>
</div>
<div id="porownanie-zmiennych" class="section level2">
<h2><span class="header-section-number">3.5</span> Porównanie zmiennych</h2>
<div id="kowariancja" class="section level3">
<h3><span class="header-section-number">3.5.1</span> Kowariancja</h3>
<ul>
<li>Kowariancja jest nieunormowaną miarą zależności liniowej pomiędzy dwiema zmiennymi</li>
<li>Kowariancja dwóch zmiennych <span class="math inline">\(x\)</span> i <span class="math inline">\(y\)</span> pokazuje jak dwie zmienne są ze sobą liniowo powiązane</li>
<li>Dodatnia kowariancja wzkazuje na pozytywną relację liniową pomiędzy zmiennymi, podczas gdy ujemna kowariancja świadczy o odwrotnej sytuacji</li>
<li>Jeżeli zmienne nie są ze sobą liniowo powiązane, wartość kowariacji jest bliska zeru</li>
<li>Inaczej mówiąc, kowariancja stanowi miarę wspólnej zmienności dwóch zmiennych<br />
</li>
<li>Wielkość samej kowariancji uzależniona jest od przyjętej skali zmiennej (jednostki)</li>
<li>Inne wyniku uzyskamy (przy tej samej zależności pomiędzy parą zmiennych), gdy będziemy analizować wyniki np. wieku i dochodu w złotówkach a inne dla wieku i dochodu w dolarach</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cov</span>(punkty$temp, punkty$ndvi, <span class="dt">use=</span><span class="st">&#39;complete.obs&#39;</span>)</code></pre></div>
<pre><code>## [1] 0.02515738</code></pre>
</div>
<div id="wspoczynnik-korelacji" class="section level3">
<h3><span class="header-section-number">3.5.2</span> Współczynnik korelacji</h3>
<ul>
<li>Wspołczynnik korelacji to unormowana miara zależności pomiędzy dwiema zmiennymi, przyjmująca wartości od -1 do 1</li>
<li>Współczynnik korelacji jest uzyskiwany poprzez podzielenie wartości kowariancji przez odchylenie standardowe wyników</li>
<li>Z racji unormowania nie jest ona uzależniona od jednostki</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(punkty@data, <span class="kw">aes</span>(temp, ndvi)) +<span class="st"> </span><span class="kw">geom_point</span>()</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-36-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cor</span>(punkty$temp, punkty$ndvi, <span class="dt">use=</span><span class="st">&#39;complete.obs&#39;</span>)</code></pre></div>
<pre><code>## [1] 0.0642325</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cor.test</span>(punkty$temp, punkty$ndvi)</code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  punkty$temp and punkty$ndvi
## t = 1.0177, df = 250, p-value = 0.3098
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  -0.05981513  0.18632640
## sample estimates:
##       cor 
## 0.0642325</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cor</span>(punkty@data[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>:<span class="dv">5</span>)], <span class="dt">use=</span><span class="st">&#39;complete.obs&#39;</span>)</code></pre></div>
<pre><code>##            srtm        temp      ndvi       savi
## srtm  1.0000000 -0.03717220 0.1116264 0.09361020
## temp -0.0371722  1.00000000 0.0642325 0.04570619
## ndvi  0.1116264  0.06423250 1.0000000 0.94296709
## savi  0.0936102  0.04570619 0.9429671 1.00000000</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">corrplot</span>(<span class="kw">cor</span>(punkty@data[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>:<span class="dv">5</span>)], <span class="dt">use=</span><span class="st">&#39;complete.obs&#39;</span>))</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-39-1.png" alt="" /><!-- --></p>
</div>
<div id="wykresy-pudekowe" class="section level3">
<h3><span class="header-section-number">3.5.3</span> Wykresy pudełkowe</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">punkty$clc &lt;-<span class="st"> </span><span class="kw">as.factor</span>(punkty$clc)
<span class="kw">ggplot</span>(punkty@data, <span class="kw">aes</span>(clc, temp)) +<span class="st"> </span><span class="kw">geom_boxplot</span>()</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-40-1.png" alt="" /><!-- --></p>
<ul>
<li>Obrazuje pięc podstawowych statystyk opisowych oraz wartości odstające</li>
<li>Pudełko to zakres międzykwantylowy</li>
<li>Linie oznaczają najbardziej ekstremalne wartości, ale nie odstające. Górna to 1,5*IQR ponad krawędź pudełka, dolna to 1,5*IQR poniżej wartości dolnej krawędzi pudełka</li>
<li>Linia środkowa to mediana</li>
</ul>
<!--
1. Tereny komunikacyjne i porty
2. Zabudowa luźna, złożone systemy upraw i działek
3. Grunty orne, Łąki
4. Lasy liściaste,  Lasy iglaste, mieszane
5. Bagna, Torfowiska
6. Zbiorniki wodne
-->
</div>
<div id="testowanie-istotnosci-roznic-sredniej-pomiedzy-grupami" class="section level3">
<h3><span class="header-section-number">3.5.4</span> Testowanie istotności różnić średniej pomiędzy grupami</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">punkty$clc &lt;-<span class="st"> </span><span class="kw">as.factor</span>(punkty$clc)
aov_test &lt;-<span class="st"> </span><span class="kw">aov</span>(temp~clc, <span class="dt">data=</span>punkty)
<span class="kw">summary</span>(aov_test)</code></pre></div>
<pre><code>##              Df Sum Sq Mean Sq F value Pr(&gt;F)    
## clc           2   1577   788.4   75.51 &lt;2e-16 ***
## Residuals   249   2600    10.4                   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<div id="testowanie-istotnosci-roznic-sredniej-pomiedzy-grupami-1" class="section level3">
<h3><span class="header-section-number">3.5.5</span> Testowanie istotności różnić średniej pomiędzy grupami</h3>
<pre><code>## null device 
##           1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tukey &lt;-<span class="st"> </span><span class="kw">TukeyHSD</span>(aov_test, <span class="st">&#39;clc&#39;</span>)
<span class="kw">plot</span>(tukey, <span class="dt">las=</span><span class="dv">1</span>)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-43-1.png" alt="" /><!-- --></p>
</div>
</div>
<div id="transformacje-danych" class="section level2">
<h2><span class="header-section-number">3.6</span> Transformacje danych</h2>
<div id="transformacje-danych-1" class="section level3">
<h3><span class="header-section-number">3.6.1</span> Transformacje danych</h3>
<ul>
<li>Transformacja danych może mieć na celu ułatwienie porównywania różnych zmiennych, zniwelowanie skośności rozkładu lub też zmniejszenie wpływu danych odstających</li>
<li>Centrowanie i skalowanie (standaryzacja):
<ul>
<li>Centrowanie danych - wybierana jest przeciętna wartość predyktora, a następnie od wszystkich wartości predyktorów odejmowana jest wybrana wcześniej wartość</li>
<li>Skalowanie danych - dzielenie każdej wartości predyktora przez jego odchylenie standardowe</li>
<li>Wadą tego podjeścia jest główne zmniejszenie interpretowalności pojedynczych wartości</li>
</ul></li>
<li>Redukcja skośności:
<ul>
<li>Logarytmizacja</li>
<li>Pierwiastkowanie</li>
<li>Rodzina transformacji Boxa Coxa</li>
<li>Inne</li>
</ul></li>
</ul>
</div>
<div id="transformacja-danych-logarytmizacja" class="section level3">
<h3><span class="header-section-number">3.6.2</span> Transformacja danych | Logarytmizacja</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(punkty@data, <span class="kw">aes</span>(temp)) +<span class="st"> </span><span class="kw">geom_density</span>()</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-44-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">punkty$log_tpz &lt;-<span class="st"> </span><span class="kw">log</span>(punkty$temp)
<span class="kw">ggplot</span>(punkty@data, <span class="kw">aes</span>(log_tpz)) +<span class="st"> </span><span class="kw">geom_density</span>()</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-44-2.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">punkty$exp_tpz &lt;-<span class="st"> </span><span class="kw">exp</span>(punkty$log_tpz)
<span class="kw">ggplot</span>(punkty@data, <span class="kw">aes</span>(exp_tpz)) +<span class="st"> </span><span class="kw">geom_density</span>()</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-44-3.png" alt="" /><!-- --></p>
</div>
<div id="transformacja-danych-pierwiastkowanie" class="section level3">
<h3><span class="header-section-number">3.6.3</span> Transformacja danych | Pierwiastkowanie</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(punkty@data, <span class="kw">aes</span>(temp)) +<span class="st"> </span><span class="kw">geom_density</span>()</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-45-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">punkty$sqrt_tpz &lt;-<span class="st"> </span><span class="kw">sqrt</span>(punkty$temp)
<span class="kw">ggplot</span>(punkty@data, <span class="kw">aes</span>(sqrt_tpz)) +<span class="st"> </span><span class="kw">geom_density</span>()</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-45-2.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">punkty$pow_tpz &lt;-<span class="st"> </span>punkty$sqrt_tpz^<span class="dv">2</span>
<span class="kw">ggplot</span>(punkty@data, <span class="kw">aes</span>(pow_tpz)) +<span class="st"> </span><span class="kw">geom_density</span>()</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-45-3.png" alt="" /><!-- --></p>
</div>
<div id="transformacja-danych-rodzina-transformacji-boxa-coxa" class="section level3">
<h3><span class="header-section-number">3.6.4</span> Transformacja danych | Rodzina transformacji Boxa Coxa</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(punkty@data, <span class="kw">aes</span>(temp)) +<span class="st"> </span><span class="kw">geom_density</span>()</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-46-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">transformacja &lt;-<span class="st"> </span><span class="kw">BoxCoxTrans</span>(punkty$temp)
transformacja</code></pre></div>
<pre><code>## Box-Cox Transformation
## 
## 252 data points used to estimate Lambda
## 
## Input data summary:
##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   8.153  12.460  15.210  15.520  18.260  26.700 
## 
## Largest/Smallest: 3.27 
## Sample Skewness: 0.474 
## 
## Estimated Lambda: 0.1 
## With fudge factor, Lambda = 0 will be used for transformations</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">punkty$bc_tpz &lt;-<span class="st"> </span><span class="kw">predict</span>(transformacja, punkty$temp)
<span class="kw">ggplot</span>(punkty@data, <span class="kw">aes</span>(bc_tpz)) +<span class="st"> </span><span class="kw">geom_density</span>()</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-46-2.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">invBoxCox &lt;-<span class="st"> </span>function(x, lambda) if (lambda ==<span class="st"> </span><span class="dv">0</span>) <span class="kw">exp</span>(x) else (lambda*x +<span class="st"> </span><span class="dv">1</span>)^(<span class="dv">1</span>/lambda) 
punkty$bc_tpz_inv &lt;-<span class="st"> </span><span class="kw">invBoxCox</span>(punkty$bc_tpz, <span class="dt">lambda=</span>-<span class="fl">0.3</span>)
<span class="kw">ggplot</span>(punkty@data, <span class="kw">aes</span>(bc_tpz_inv)) +<span class="st"> </span><span class="kw">geom_density</span>()</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-46-3.png" alt="" /><!-- --></p>
<!--chapter:end:02-eksp_analiza_danych.Rmd-->
</div>
</div>
</div>
<div id="eksploracyjna-analiza-danych---geostatystyka" class="section level1">
<h1><span class="header-section-number">4</span> Eksploracyjna analiza danych - geostatystyka</h1>
<div id="mapy" class="section level2">
<h2><span class="header-section-number">4.1</span> Mapy</h2>
<div id="podstawowe-terminy-kontekst-przestrzenny" class="section level3">
<h3><span class="header-section-number">4.1.1</span> Podstawowe terminy | Kontekst przestrzenny</h3>
<ul>
<li>Populacja - cały obszar, dla którego chcemy określić wybrane właściwości</li>
<li>Próba - zbiór obserwacji, dla których mamy informacje. Inaczej, próba to podzbiór populacji. Zazwyczaj niemożliwe (lub bardzo kosztowne) jest zdobycie informacji o całej populacji. Z tego powodu bardzo cenne jest odpowiednie wykorzystanie informacji z próby.</li>
</ul>
</div>
<div id="mapy-punktowe-cel" class="section level3">
<h3><span class="header-section-number">4.1.2</span> Mapy punktowe | Cel</h3>
<ul>
<li>Sprawdzenie poprawności współrzędnych</li>
<li>Wgląd w typ próbkowania</li>
<li>Sprawdzenie poprawności danych - dane odstające lokalnie</li>
<li>Identyfikacja głównych cech struktury przestrzennej zjawiska (np. trend)</li>
</ul>
</div>
<div id="typ-probowania" class="section level3">
<h3><span class="header-section-number">4.1.3</span> Typ próbowania</h3>
<ul>
<li>Regularny</li>
<li>Losowy</li>
<li>Losowy stratyfikowany</li>
<li>Preferencyjny</li>
<li>Liniowy</li>
</ul>
</div>
<div id="typ-probowania-regularny" class="section level3">
<h3><span class="header-section-number">4.1.4</span> Typ próbowania | Regularny</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">225</span>)
regularny &lt;-<span class="st"> </span><span class="kw">spsample</span>(granica, <span class="dv">150</span>, <span class="dt">type =</span> <span class="st">&#39;regular&#39;</span>)
<span class="kw">plot</span>(regularny)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-48-1.png" alt="" /><!-- --></p>
<ul>
<li>Zmienna <em>offset</em></li>
</ul>
</div>
<div id="typ-probowania-losowy" class="section level3">
<h3><span class="header-section-number">4.1.5</span> Typ próbowania | Losowy</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">301</span>)
losowy &lt;-<span class="st"> </span><span class="kw">spsample</span>(granica, <span class="dv">150</span>, <span class="dt">type =</span> <span class="st">&#39;random&#39;</span>)
<span class="kw">plot</span>(losowy)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-49-1.png" alt="" /><!-- --></p>
<ul>
<li>Każda lokalizacja ma takie samo prawdopodobieństwo wystąpienia</li>
<li>Każdy punkt jest losowany niezależnie od pozostałych</li>
</ul>
</div>
<div id="typ-probowania-losowy-stratyfikowany" class="section level3">
<h3><span class="header-section-number">4.1.6</span> Typ próbowania | Losowy stratyfikowany</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">125</span>)
strat &lt;-<span class="st"> </span><span class="kw">spsample</span>(granica, <span class="dv">150</span>, <span class="dt">type =</span> <span class="st">&#39;stratified&#39;</span>)
<span class="kw">plot</span>(strat)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-50-1.png" alt="" /><!-- --></p>
</div>
<div id="typ-probowania-preferencyjny-i" class="section level3">
<h3><span class="header-section-number">4.1.7</span> Typ próbowania | Preferencyjny I</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">425</span>)
pref &lt;-<span class="st"> </span><span class="kw">spsample</span>(granica, <span class="dv">150</span>, <span class="dt">type =</span> <span class="st">&#39;clustered&#39;</span>, <span class="dt">nclusters=</span><span class="dv">80</span>)
<span class="kw">plot</span>(pref)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-51-1.png" alt="" /><!-- --></p>
</div>
<div id="typ-probowania-liniowy" class="section level3">
<h3><span class="header-section-number">4.1.8</span> Typ próbowania | Liniowy</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># library(&#39;rgdal&#39;)</span>
<span class="co"># linia &lt;- readOGR(&quot;data&quot;, &quot;linia&quot;, verbose=FALSE)</span>
<span class="co"># set.seed(224)</span>
<span class="co"># izoliniowy &lt;- spsample(linia, 150, type = &#39;regular&#39;)</span>
<span class="co"># plot(izoliniowy)</span></code></pre></div>
</div>
<div id="mapy-punktowe-i-dane-lokalnie-odstajace" class="section level3">
<h3><span class="header-section-number">4.1.9</span> Mapy punktowe i dane lokalnie odstające</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">4</span>)))
<span class="kw">data</span>(granica)
<span class="kw">plot</span>(granica) 
<span class="kw">plot</span>(punkty, <span class="dt">add=</span><span class="ot">TRUE</span>) </code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-53-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># select.spatial(punkty, digitize=FALSE, rownames=TRUE)</span>
<span class="kw">spplot</span>(punkty, <span class="st">&#39;temp&#39;</span>, <span class="dt">identify=</span><span class="ot">TRUE</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">spplot</span>(punkty, <span class="st">&#39;temp&#39;</span>, <span class="dt">sp.layout =</span> granica)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-54-1.png" alt="" /><!-- --></p>
</div>
</div>
<div id="rozgrupowanie-danych" class="section level2">
<h2><span class="header-section-number">4.2</span> Rozgrupowanie danych</h2>
<div id="rozgrupowanie-danych-1" class="section level3">
<h3><span class="header-section-number">4.2.1</span> Rozgrupowanie danych</h3>
<ul>
<li>Istnieje szereg metod rozgrupowywania danych, między innymi:
<ul>
<li>Rozgrupowywanie komórkowe</li>
<li>Rozgrupowywanie poligonowe</li>
</ul></li>
<li>Celem tych metod jest nadanie wag obserwacjom w celu zapewnienia reprezentatywności przestrzennej danych</li>
</ul>
</div>
<div id="rozgrupowanie-danych-2" class="section level3">
<h3><span class="header-section-number">4.2.2</span> Rozgrupowanie danych</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(punkty_pref)
<span class="kw">spplot</span>(punkty_pref, <span class="st">&#39;temp&#39;</span>)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-55-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(punkty_pref$temp)</code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   7.404  11.600  13.800  14.130  15.660  25.210</code></pre>
</div>
<div id="rozgrupowanie-komorkowe-i-ang.-cell-declustering" class="section level3">
<h3><span class="header-section-number">4.2.3</span> Rozgrupowanie komórkowe I | (ang. <em>cell declustering</em>)</h3>
<p><span class="math display">\[w&#39;_j=\frac{\frac{1}{n_i}}{\text{liczba komórek z danymi}} \cdot n\]</span> , gdzie <span class="math inline">\(n_i\)</span> to liczba obserwacji w komórce, a <span class="math inline">\(n\)</span> to łączna liczba obserwacji</p>
</div>
<div id="rozgrupowanie-komorkowe-i-ang.-cell-declustering-1" class="section level3">
<h3><span class="header-section-number">4.2.4</span> Rozgrupowanie komórkowe I | (ang. <em>cell declustering</em>)</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(punkty_pref)
punkty_pref$id &lt;-<span class="st"> </span><span class="dv">1</span>:<span class="kw">nrow</span>(punkty_pref)
<span class="kw">spplot</span>(punkty_pref, <span class="st">&#39;id&#39;</span>, <span class="dt">colorkey=</span><span class="ot">TRUE</span>)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-56-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(granica)
siatka_n &lt;-<span class="st"> </span><span class="kw">raster</span>(<span class="kw">extent</span>(granica))
<span class="co"># siatka_n &lt;- raster(xmn=450000, xmx=485000, ymn=5960000, ymx=5989000)</span>
<span class="kw">res</span>(siatka_n) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">500</span>, <span class="dv">500</span>)
siatka_n[] &lt;-<span class="st"> </span><span class="dv">0</span>
<span class="kw">proj4string</span>(siatka_n) &lt;-<span class="st"> </span><span class="kw">CRS</span>(<span class="kw">proj4string</span>(punkty_pref))
siatka_n &lt;-<span class="st"> </span><span class="kw">mask</span>(siatka_n, <span class="kw">gBuffer</span>(granica, <span class="dt">width =</span> <span class="dv">500</span>))
siatka_n &lt;-<span class="st"> </span><span class="kw">as</span>(siatka_n, <span class="st">&#39;SpatialPolygonsDataFrame&#39;</span>)
siatka_n &lt;-<span class="st"> </span>siatka_n[!<span class="kw">is.na</span>(siatka_n@data$layer), ]
<span class="kw">plot</span>(siatka_n)
<span class="kw">plot</span>(punkty_pref, <span class="dt">add=</span><span class="ot">TRUE</span>)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-56-2.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">punkty_pref$liczebnosc &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, <span class="kw">length</span>(punkty_pref))
siatka_nr &lt;-<span class="st"> </span><span class="kw">aggregate</span>(punkty_pref[<span class="st">&#39;liczebnosc&#39;</span>], <span class="dt">by =</span> siatka_n, <span class="dt">FUN =</span> length) 
<span class="kw">spplot</span>(siatka_nr, <span class="st">&#39;liczebnosc&#39;</span>)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-56-3.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">liczba &lt;-<span class="st"> </span><span class="kw">over</span>(punkty_pref, siatka_nr)
punkty_pref$waga &lt;-<span class="st"> </span>((<span class="dv">1</span>/liczba$liczebnosc)/<span class="kw">sum</span>(!<span class="kw">is.na</span>(siatka_nr$liczebnosc))) *<span class="st"> </span><span class="kw">length</span>(punkty_pref)

<span class="kw">spplot</span>(punkty_pref, <span class="st">&#39;waga&#39;</span>)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-56-4.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">srednia_arytmetyczna &lt;-<span class="st"> </span><span class="kw">mean</span>(punkty_pref$temp)
srednia_wazona_c1 &lt;-<span class="st"> </span><span class="kw">mean</span>(punkty_pref$temp *<span class="st"> </span>punkty_pref$waga, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)</code></pre></div>
</div>
<div id="rozgrupowanie-komorkowe-ii-ang.-cell-declustering" class="section level3">
<h3><span class="header-section-number">4.2.5</span> Rozgrupowanie komórkowe II | (ang. <em>cell declustering</em>)</h3>
<!--
- Przygotowanie danych
https://stat.ethz.ch/pipermail/r-sig-geo/2010-February/007710.html

When "interpolating" with nmax=1, you basically assign the value of the 
nearest observation to each grid cell, so, honoustly, it's hard to call 
this interpolation, it is rather something of a discretized Thiessen 
polygon.
-->
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(punkty_pref)
punkty_pref$id &lt;-<span class="st"> </span><span class="dv">1</span>:<span class="kw">nrow</span>(punkty_pref)
<span class="kw">spplot</span>(punkty_pref, <span class="st">&#39;id&#39;</span>, <span class="dt">colorkey=</span><span class="ot">TRUE</span>)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-57-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(granica)
siatka_n &lt;-<span class="st"> </span><span class="kw">raster</span>(<span class="kw">extent</span>(granica))
<span class="kw">res</span>(siatka_n) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">500</span>, <span class="dv">500</span>)
siatka_n[] &lt;-<span class="st"> </span><span class="dv">0</span>
<span class="kw">proj4string</span>(siatka_n) &lt;-<span class="st"> </span><span class="kw">CRS</span>(<span class="kw">proj4string</span>(punkty_pref))
siatka_n &lt;-<span class="st"> </span><span class="kw">mask</span>(siatka_n, granica)
siatka_n &lt;-<span class="st"> </span><span class="kw">as</span>(siatka_n, <span class="st">&#39;SpatialPointsDataFrame&#39;</span>)
siatka_n &lt;-<span class="st"> </span>siatka_n[!<span class="kw">is.na</span>(siatka_n@data$layer), ]
<span class="kw">gridded</span>(siatka_n) &lt;-<span class="st"> </span><span class="ot">TRUE</span>
<span class="kw">plot</span>(siatka_n)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-57-2.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">out &lt;-<span class="st">  </span><span class="kw">krige</span>(id~<span class="dv">1</span>, punkty_pref, siatka_n, <span class="dt">nmax=</span><span class="dv">1</span>)</code></pre></div>
<pre><code>## [inverse distance weighted interpolation]</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">spplot</span>(out, <span class="st">&#39;var1.pred&#39;</span>)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-58-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">table</span>(out[[<span class="dv">1</span>]]))
df$waga &lt;-<span class="st"> </span>df$Freq/<span class="kw">sum</span>(df$Freq)
punkty_pref &lt;-<span class="st"> </span><span class="kw">merge</span>(punkty_pref, df, <span class="dt">by.x=</span><span class="st">&#39;id&#39;</span>, <span class="dt">by.y=</span><span class="st">&#39;Var1&#39;</span>)
<span class="kw">summary</span>(punkty_pref$waga)</code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA&#39;s 
## 0.00389 0.00389 0.00389 0.00637 0.00778 0.01946     108</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">spplot</span>(out, <span class="st">&#39;var1.pred&#39;</span>, <span class="dt">sp.layout=</span><span class="kw">list</span>(<span class="st">&#39;sp.points&#39;</span>, punkty_pref))</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-58-2.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">spplot</span>(punkty_pref[<span class="st">&#39;waga&#39;</span>])</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-58-3.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">srednia_arytmetyczna &lt;-<span class="st"> </span><span class="kw">mean</span>(punkty_pref$temp)
srednia_wazona_c2 &lt;-<span class="st"> </span><span class="kw">sum</span>(punkty_pref$temp *<span class="st"> </span>punkty_pref$waga, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)</code></pre></div>
</div>
<div id="rozgrupowanie-poligonowe-ang.-polygon-declustering" class="section level3">
<h3><span class="header-section-number">4.2.6</span> Rozgrupowanie poligonowe | (ang. <em>polygon declustering</em>)</h3>
<p><span class="math display">\[w&#39;_j=\frac{area_j}{\sum_{j=1}^{n}area_j} \cdot n\]</span> , gdzie <span class="math inline">\(area_j\)</span> powierzchnia dla wybranej obserwacji, a <span class="math inline">\(n\)</span> to łączna liczba obserwacji</p>
</div>
<div id="rozgrupowanie-poligonowe-ang.-polygon-declustering-1" class="section level3">
<h3><span class="header-section-number">4.2.7</span> Rozgrupowanie poligonowe | (ang. <em>polygon declustering</em>)</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(punkty_pref)
punkty_pref$id &lt;-<span class="st"> </span><span class="dv">1</span>:<span class="kw">nrow</span>(punkty_pref)
<span class="kw">spplot</span>(punkty_pref, <span class="st">&#39;id&#39;</span>, <span class="dt">colorkey=</span><span class="ot">TRUE</span>)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-59-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">v &lt;-<span class="st"> </span><span class="kw">voronoi</span>(punkty_pref)
<span class="kw">plot</span>(punkty_pref, <span class="dt">cex=</span><span class="fl">0.2</span>, <span class="dt">col=</span><span class="st">&#39;red&#39;</span>)
<span class="kw">plot</span>(v, <span class="dt">add=</span><span class="ot">TRUE</span>)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-59-2.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">v_intersect &lt;-<span class="kw">intersect</span>(granica, v)
<span class="kw">plot</span>(punkty_pref, <span class="dt">cex=</span><span class="fl">0.2</span>, <span class="dt">col=</span><span class="st">&#39;red&#39;</span>)
<span class="kw">plot</span>(v_intersect, <span class="dt">add=</span><span class="ot">TRUE</span>)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-59-3.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">v_intersect$pow &lt;-<span class="st"> </span><span class="kw">area</span>(v_intersect)
v_intersect$waga &lt;-<span class="st"> </span>v_intersect$pow/<span class="kw">sum</span>(v_intersect$pow) *<span class="st"> </span><span class="kw">length</span>(punkty_pref)

punkty_pref &lt;-<span class="st"> </span><span class="kw">merge</span>(punkty_pref, v_intersect[<span class="kw">c</span>(<span class="st">&#39;id&#39;</span>, <span class="st">&#39;waga&#39;</span>)], <span class="dt">by=</span><span class="st">&#39;id&#39;</span>)
<span class="kw">spplot</span>(punkty_pref, <span class="st">&#39;waga&#39;</span>)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-59-4.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">srednia_arytmetyczna &lt;-<span class="st"> </span><span class="kw">mean</span>(punkty_pref$temp, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)
srednia_wazona_p &lt;-<span class="st"> </span><span class="kw">mean</span>(punkty_pref$temp*punkty_pref$waga, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Średnia arytmetyczna</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Populacja</td>
<td align="right">15.59128</td>
</tr>
<tr class="even">
<td align="left">Próba</td>
<td align="right">14.12719</td>
</tr>
<tr class="odd">
<td align="left">Rozgrupowanie komórkowe I</td>
<td align="right">16.81255</td>
</tr>
<tr class="even">
<td align="left">Rozgrupowanie komórkowe II</td>
<td align="right">14.98559</td>
</tr>
<tr class="odd">
<td align="left">Rozgrupowanie poligonowe</td>
<td align="right">18.09165</td>
</tr>
</tbody>
</table>
<!--
polygon declustering - http://gis.stackexchange.com/questions/122376/cell-declustering-using-open-source-software
cell declustering - https://stat.ethz.ch/pipermail/r-sig-geo/2010-February/007710.html
http://gaa.org.au/pdf/DeclusterDebias-CCG.pdf
-->
<!--chapter:end:03-eksp_przestrzenna.Rmd-->
</div>
</div>
</div>
<div id="eksploracyjna-analiza-danych---geostatystyka-1" class="section level1">
<h1><span class="header-section-number">5</span> Eksploracyjna analiza danych - geostatystyka</h1>
<div id="interpolacja" class="section level2">
<h2><span class="header-section-number">5.1</span> Interpolacja</h2>
<div id="modele-deterministyczne" class="section level3">
<h3><span class="header-section-number">5.1.1</span> Modele deterministyczne</h3>
<ul>
<li>Parametry tych modeli są zazwyczaj ustalane w oparciu o funkcję odległości lub powierzchni. Brakuje również szacunków na temat oceny błędu modelu. Np:
<ul>
<li>Funkcje wielomianowe</li>
<li>Funkcje sklejane (ang. <em>Splines</em>)</li>
<li>Triangulacje</li>
<li>IDW (ang. <em>Inverse Distance Weighted</em>)</li>
</ul></li>
</ul>
<p><a href="http://neondataskills.org/Data-Workshops/ESA15-Going-On-The-Grid-Spatial-Interpolation-Basics/" class="uri">http://neondataskills.org/Data-Workshops/ESA15-Going-On-The-Grid-Spatial-Interpolation-Basics/</a></p>
</div>
<div id="modele-deterministyczne-1" class="section level3">
<h3><span class="header-section-number">5.1.2</span> Modele deterministyczne</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&#39;geostatbook&#39;</span>)
<span class="kw">data</span>(punkty)
<span class="kw">data</span>(siatka)
<span class="kw">data</span>(granica)</code></pre></div>
</div>
<div id="modele-deterministyczne-funkcje-wielomianowe" class="section level3">
<h3><span class="header-section-number">5.1.3</span> Modele deterministyczne | Funkcje wielomianowe</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">wielomian_1 &lt;-<span class="st"> </span><span class="kw">gstat</span>(<span class="dt">formula=</span>temp~<span class="dv">1</span>, <span class="dt">data=</span>punkty, <span class="dt">degree=</span><span class="dv">1</span>)
wielomian_1_pred &lt;-<span class="st"> </span><span class="kw">predict</span>(wielomian_1, <span class="dt">newdata=</span>siatka)</code></pre></div>
<pre><code>## [ordinary or weighted least squares prediction]</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">spplot</span>(wielomian_1_pred[<span class="dv">1</span>], <span class="dt">contour=</span><span class="ot">TRUE</span>,<span class="dt">main=</span><span class="st">&#39;Powierzchnia trendu - wielomian pierwszego stopnia&#39;</span>)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-61-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">wielomian_2 &lt;-<span class="st"> </span><span class="kw">gstat</span>(<span class="dt">formula=</span>temp~<span class="dv">1</span>, <span class="dt">data=</span>punkty, <span class="dt">degree=</span><span class="dv">2</span>)
wielomian_2_pred &lt;-<span class="st"> </span><span class="kw">predict</span>(wielomian_2, <span class="dt">newdata=</span>siatka)</code></pre></div>
<pre><code>## [ordinary or weighted least squares prediction]</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">spplot</span>(wielomian_2_pred[<span class="dv">1</span>], <span class="dt">contour=</span><span class="ot">TRUE</span>,<span class="dt">main=</span><span class="st">&#39;Powierzchnia trendu - wielomian drugiego stopnia&#39;</span>)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-61-2.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">wielomian_3 &lt;-<span class="st"> </span><span class="kw">gstat</span>(<span class="dt">formula=</span>temp~<span class="dv">1</span>, <span class="dt">data=</span>punkty, <span class="dt">degree=</span><span class="dv">3</span>)
wielomian_3_pred &lt;-<span class="st"> </span><span class="kw">predict</span>(wielomian_3, <span class="dt">newdata=</span>siatka)</code></pre></div>
<pre><code>## [ordinary or weighted least squares prediction]</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">spplot</span>(wielomian_3_pred[<span class="dv">1</span>], <span class="dt">contour=</span><span class="ot">TRUE</span>,<span class="dt">main=</span><span class="st">&#39;Powierzchnia trendu - wielomian trzeciego stopnia&#39;</span>)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-61-3.png" alt="" /><!-- --></p>
<!--
library('rasterVis')
xx <- as(wielomian_1_pred[1], "SpatialPointsDataFrame")
raster <- raster(extent(wielomian_1_pred))
res(raster) <- c(100, 100)
raster <- rasterize(x=xx, y=raster)
plot3D(raster[[1]])
-->
</div>
<div id="modele-deterministyczne-funkcje-sklejane" class="section level3">
<h3><span class="header-section-number">5.1.4</span> Modele deterministyczne | Funkcje sklejane</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tps &lt;-<span class="st"> </span><span class="kw">Tps</span>(<span class="kw">coordinates</span>(punkty), punkty@data$temp)</code></pre></div>
<pre><code>## Warning: 
## Grid searches over lambda (nugget and sill variances) with  minima at the endpoints: 
##   (GCV) Generalized Cross-Validation 
##    minimum at  right endpoint  lambda  =  2.084086e-06 (eff. df= 239.4 )</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ras &lt;-<span class="st"> </span><span class="kw">raster</span>(siatka)
spline &lt;-<span class="st"> </span><span class="kw">interpolate</span>(ras, tps)
spline &lt;-<span class="st"> </span><span class="kw">mask</span>(spline, ras)
<span class="kw">spplot</span>(spline, <span class="dt">contour=</span><span class="ot">TRUE</span> , <span class="dt">main=</span><span class="st">&#39;Funkcje sklejane&#39;</span>)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-62-1.png" alt="" /><!-- --></p>
</div>
<div id="modele-deterministyczne-triangulacje-thiessen" class="section level3">
<h3><span class="header-section-number">5.1.5</span> Modele deterministyczne | Triangulacje (Thiessen)</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">voronoi_interp &lt;-<span class="st"> </span><span class="kw">voronoi</span>(punkty)
voronoi_interp &lt;-<span class="st"> </span><span class="kw">intersect</span>(granica, voronoi_interp)
<span class="kw">spplot</span>(voronoi_interp, <span class="st">&#39;temp&#39;</span>, <span class="dt">contour=</span><span class="ot">TRUE</span>, <span class="dt">main=</span><span class="st">&#39;Poligony Voronoia&#39;</span>)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-63-1.png" alt="" /><!-- --></p>
</div>
<div id="modele-deterministyczne-idw" class="section level3">
<h3><span class="header-section-number">5.1.6</span> Modele deterministyczne | IDW</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">idw_wolin &lt;-<span class="st"> </span><span class="kw">idw</span>(temp~<span class="dv">1</span>, punkty, siatka, <span class="dt">idp=</span><span class="dv">2</span>)</code></pre></div>
<pre><code>## [inverse distance weighted interpolation]</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">spplot</span>(idw_wolin, <span class="st">&#39;var1.pred&#39;</span>, <span class="dt">contour=</span><span class="ot">TRUE</span>, <span class="dt">main=</span><span class="st">&#39;IDW&#39;</span>)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-64-1.png" alt="" /><!-- --></p>
<!--
dodaj wykresy idw
https://rpubs.com/DonalOLeary/80504
-->
</div>
<div id="modele-deterministyczne-porownanie" class="section level3">
<h3><span class="header-section-number">5.1.7</span> Modele deterministyczne | Porównanie</h3>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-65-1.png" alt="" /><!-- --></p>
<!--chapter:end:04-intepolacje.Rmd-->
</div>
</div>
</div>
<div id="geostatystyka" class="section level1">
<h1><span class="header-section-number">6</span> … - geostatystyka</h1>
<div id="modele-statystyczne" class="section level3">
<h3><span class="header-section-number">6.0.1</span> Modele statystyczne</h3>
<ul>
<li>Parametry modeli są określane w oparciu o teorię prawdopodobieństwa. Dodatkowo wynik estymacji zawiera oszacowanie błędu. Np.:
<ul>
<li>Kriging</li>
<li>Modele regresyjne</li>
<li>Modele bayesowe</li>
<li>Modele hybrydowe</li>
</ul></li>
</ul>
<!--
http://www.inside-r.org/packages/cran/raster/docs/interpolate
![](fig_skrypt/m_feat.png)
-->
</div>
<div id="geostatystyka---prolog" class="section level2">
<h2><span class="header-section-number">6.1</span> Geostatystyka - prolog</h2>
<div id="geostatystyka-1" class="section level3">
<h3><span class="header-section-number">6.1.1</span> Geostatystyka</h3>
<ul>
<li>Zbiór narzędzi statystycznych uwzględniających w analizie danych ich przestrzenną i czasową lokalizację, a opartych o teorię funkcji losowych.</li>
</ul>
<!--
### Geostatystyka a klasyczna statystyka
- Isnieje informacja o lokalizacji obserwacji
-->
</div>
<div id="geostatystyka-funkcje" class="section level3">
<h3><span class="header-section-number">6.1.2</span> Geostatystyka | Funkcje</h3>
<ul>
<li>Identyfikacja i modelowanie struktury przestrzennej/czasowej zjawiska</li>
<li>Estymacja - szacowanie wartości badanej zmiennej w nieopróbowanym miejscu i/lub momencie czasu</li>
<li>Symulacja - generowanie alternatywnych obrazów, które honorują wyniki pomiarów i strukturę przestrzenną/czasową zjawiska</li>
<li>Optymalizacja próbkowania/sieci pomiarowej</li>
</ul>
</div>
<div id="geostatystyczna-analiza-danych" class="section level3">
<h3><span class="header-section-number">6.1.3</span> Geostatystyczna analiza danych</h3>
<div class="figure">
<img src="figs/diag.png" alt="" />

</div>
</div>
<div id="geostatystyka-dane-wejsciowe" class="section level3">
<h3><span class="header-section-number">6.1.4</span> Geostatystyka | Dane wejściowe</h3>
<ol style="list-style-type: decimal">
<li>Wystarczająca duża liczba punktów (minimalnie &gt;30, ale zazwyczaj więcej niż 100/150)</li>
<li>Są reprezentatywne</li>
<li>Są niezależne</li>
<li>Były stworzone używając stałej metodyki</li>
<li>Są wystarczająco dokładne</li>
</ol>
<!--
### Geostatystyka | Cele
- Charakterystyka struktury przestrzennej badanego zjawiska
- Uwzględnienie przestrzennych relacji między zmiennymi
- Interpolacja wartości
- Wizualizacja
- Określenie niepewności danych
- Stwierdzenie niepewności estymacji
-->
</div>
<div id="geostatystyka-podstawowe-etapy" class="section level3">
<h3><span class="header-section-number">6.1.5</span> Geostatystyka | Podstawowe etapy</h3>
<ol style="list-style-type: decimal">
<li>Zaprojektowanie sposobu (typu) próbkowania oraz organizacji zadań</li>
<li>Zebranie danych, analiza labolatoryjna</li>
<li>Wstepna eksploracja danych, ocena ich jakości</li>
<li>Modelowanie semiwariogramów na podstawie dostępnych danych</li>
<li>Estymacja badanej cechy</li>
<li>Porównanie i ocena modeli</li>
<li>Stworzenie wynikowego produktu i jego dystrybucja</li>
</ol>
</div>
</div>
<div id="przestrzenna-kowariancja-korelacja-i-semiwariancja" class="section level2">
<h2><span class="header-section-number">6.2</span> Przestrzenna kowariancja, korelacja i semiwariancja</h2>
<div id="przestrzenna-kowariancja-korelacja-i-semiwariancja-zaozenia" class="section level3">
<h3><span class="header-section-number">6.2.1</span> Przestrzenna kowariancja, korelacja i semiwariancja | Założenia</h3>
<ol style="list-style-type: decimal">
<li>Przestrzennej ciągłości - przestrzenna korelacja między zmienny w dwóch lokalizacjach zależy tylko od ich odległości (oraz czasem kierunku), lecz nie od tego gdzie są one położone</li>
<li>Stacjonarności - średnia i wariancja są stałe na całym badanym obszarze</li>
</ol>
</div>
<div id="przestrzenna-kowariancja-korelacja-i-semiwariancja-1" class="section level3">
<h3><span class="header-section-number">6.2.2</span> Przestrzenna kowariancja, korelacja i semiwariancja</h3>
<ul>
<li><span class="math inline">\(u\)</span> - wektor współrzędnych</li>
<li><span class="math inline">\(z(u)\)</span> - badana zmienna jako funkcja położenia - inaczej określany jako ogon (ang. <em>tail</em>)</li>
<li><span class="math inline">\(h\)</span> - lag - odstęp pomiędzy dwoma lokalizacjami</li>
<li><span class="math inline">\(z(u+h)\)</span> - wartość badanej zmiennej odległej o odstęp <span class="math inline">\(h\)</span> - inaczej określany jako głowa (ang. <em>head</em>)</li>
</ul>
</div>
<div id="przestrzenna-kowariancja-korelacja-i-semiwariancja-2" class="section level3">
<h3><span class="header-section-number">6.2.3</span> Przestrzenna kowariancja, korelacja i semiwariancja</h3>
<ul>
<li>Kowariancja i korelacja to miary podobieństwa pomiędzy dwoma zmiennymi</li>
<li>Przenosząc to na aspekt przestrzenny, badamy jedną zmienną ale pomiędzy dwoma punktami odległymi od siebie o pewien dystans (okreslany jako lag)</li>
<li>W efekcie otrzymujemy miarę podobieństwa pomiędzy wartością głowy i ogona</li>
<li>Trzecią miarę charakteryzującą relację między obserwacjami odległymi o kolejne odstępy jest semiwariancja</li>
<li>Z praktycznego punktu widzenia, semiwariogram jest preferowaną miarą relacji przestrzennej, ponieważ wykazuje tendencję do lepszego wygładzania danych niż funkcja kowariancji</li>
<li>Dodatkowo, semiwariogram jest mniej wymagający obliczeniowo</li>
<li>Jednocześnie, dla potrzeb interpretacji relacji kowarancja i korelacja przestrzenna nadaje się nie gorzej niż semiwariancja</li>
</ul>
<p><img src="Geostatystyka_files/figure-html/z_przs0-1.png" alt="" /><!-- --></p>
</div>
<div id="wykres-rozrzutu-z-przesunieciem" class="section level3">
<h3><span class="header-section-number">6.2.4</span> Wykres rozrzutu z przesunięciem</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hscat</span>(temp~<span class="dv">1</span>, punkty, <span class="dt">breaks=</span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">4000</span>, <span class="dt">by=</span><span class="dv">500</span>))</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/z_przs-1.png" alt="" /><!-- --></p>
</div>
<div id="autokowariancja" class="section level3">
<h3><span class="header-section-number">6.2.5</span> Autokowariancja</h3>
<ul>
<li>Autokowariancja pokazuje jak mocno są ze sobą powiązane przestrzennie wartości pary obserwacji odległych od siebie o kolejne przedziały</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">kowario &lt;-<span class="st"> </span><span class="kw">variogram</span>(temp~<span class="dv">1</span>, punkty, <span class="dt">covariogram =</span> <span class="ot">TRUE</span>)
<span class="kw">plot</span>(kowario)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-67-1.png" alt="" /><!-- --></p>
</div>
<div id="autokorelacja" class="section level3">
<h3><span class="header-section-number">6.2.6</span> Autokorelacja</h3>
<ul>
<li>Autokorelogram jest wykresem pokazującym jedną z miar autokorelacji (np. I Morana lub C Geary’ego) w stosunku do odległości</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">wsp &lt;-<span class="st"> </span><span class="kw">coordinates</span>(punkty)
kor &lt;-<span class="st"> </span><span class="kw">correlog</span>(wsp, punkty$temp)
kor &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(kor)
<span class="kw">ggplot</span>(kor, <span class="kw">aes</span>(dist.class, coef)) +<span class="st"> </span><span class="kw">geom_smooth</span>(<span class="dt">linetype=</span><span class="dv">0</span>) +<span class="st"> </span><span class="kw">geom_line</span>() +<span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">size=</span><span class="dv">5</span>)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-68-1.png" alt="" /><!-- --></p>
</div>
<div id="semiwariancja" class="section level3">
<h3><span class="header-section-number">6.2.7</span> Semiwariancja</h3>
<ul>
<li>Zmienność przestrzenna może być określona za pomocą semiwariancji. Jest to połowa średniej kwadratu różnicy pomiędzy wartościami badanej zmiennej w dwóch lokalizacjach odległych o wektor <span class="math inline">\(h\)</span> <span class="math display">\[ \gamma(h) = \frac{1}{2}E[(z(s) - z(s+h))^2] \]</span></li>
</ul>
</div>
<div id="okreslenie-wystepowania-autokorelacji-przestrzennej-chmura-semiwariogramu" class="section level3">
<h3><span class="header-section-number">6.2.8</span> Określenie występowania autokorelacji przestrzennej | Chmura semiwariogramu</h3>
<ul>
<li>Jeżeli w badanej próbie mamy <span class="math inline">\(n\)</span> obserwacji oznacza to, że możemy zaobserwować <span class="math inline">\(\frac{1}{2}n(n-1)\)</span> par obserwacji</li>
<li>Każda para obserwacji daje nam informacje o semiwariancji występującej wraz z odległością</li>
<li>Semiwariancję można zaprezentować na wykresie zwanym chumrą semiwariogramu</li>
</ul>
</div>
<div id="semiwariancja-przykadowe-obliczenia" class="section level3">
<h3><span class="header-section-number">6.2.9</span> Semiwariancja | Przykładowe obliczenia</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">odl &lt;-<span class="st"> </span><span class="kw">dist</span>(<span class="kw">coordinates</span>(punkty)[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), ])
gamma &lt;-<span class="st"> </span><span class="fl">0.5</span> *<span class="st"> </span>(punkty$temp[<span class="dv">1</span>] -<span class="st"> </span>punkty$temp[<span class="dv">2</span>])^<span class="dv">2</span>
gamma</code></pre></div>
<pre><code>## [1] 162.2628</code></pre>
</div>
<div id="okreslenie-wystepowania-autokorelacji-przestrzennej-chmura-semiwariogramu-1" class="section level3">
<h3><span class="header-section-number">6.2.10</span> Określenie występowania autokorelacji przestrzennej | Chmura semiwariogramu</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vario_cloud &lt;-<span class="st"> </span><span class="kw">variogram</span>(temp~<span class="dv">1</span>, punkty, <span class="dt">cloud=</span><span class="ot">TRUE</span>)
<span class="kw">plot</span>(vario_cloud) </code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-70-1.png" alt="" /><!-- --></p>
</div>
<div id="okreslenie-wystepowania-autokorelacji-przestrzennej-chmura-semiwariogramu-2" class="section level3">
<h3><span class="header-section-number">6.2.11</span> Określenie występowania autokorelacji przestrzennej | Chmura semiwariogramu</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vario_cloud_sel &lt;-<span class="st"> </span><span class="kw">plot</span>(<span class="kw">variogram</span>(temp~<span class="dv">1</span>, punkty, <span class="dt">cloud=</span><span class="ot">TRUE</span>), <span class="dt">digitize=</span><span class="ot">TRUE</span>)
<span class="kw">plot</span>(vario_cloud_sel, punkty) </code></pre></div>
</div>
<div id="semiwariogram-charakterystyka-struktury-przestrzennej" class="section level3">
<h3><span class="header-section-number">6.2.12</span> Semiwariogram | Charakterystyka struktury przestrzennej</h3>
<ul>
<li>Semiwariogram to wykres pokazujący relację pomiędzy odległością a semiwariancją</li>
<li>Jest to uśrednieniem semiwariancji dla kolejnych odstępów (lagów)</li>
<li>W oparciu o semiwariogram empiryczny możemy następnie dopasować do niego model/e</li>
</ul>
<p><span class="math display">\[ \hat{\gamma}(h) = \frac{1}{2N(h)}\sum_{i=1}^{N(h)}(z(s_i) - z(s_i+h))^2 \]</span></p>
<p>gdzie <span class="math inline">\(N(h)\)</span> oznacza liczbę par punktów w odstępie <span class="math inline">\(h\)</span></p>
</div>
<div id="semiwariogram" class="section level3">
<h3><span class="header-section-number">6.2.13</span> Semiwariogram</h3>
<ul>
<li>Nugget - efekt nuggetowy - pozwala na określenie błędu w danych wejściowych oraz zmienności na dystansie krótszym niż pierwszy odstęp</li>
<li>Sill - semiwariancja progowa - oznacza wariancję badanej zmiennej</li>
<li>Range - zasięg - to odległość do której istnieje przestrzenna korelacja</li>
</ul>
</div>
<div id="semiwariogram-rules-of-thumb" class="section level3">
<h3><span class="header-section-number">6.2.14</span> Semiwariogram | Rules of thumb</h3>
<ul>
<li>W każdym odstępie powinno się znaleźć co najmniej 30 par punktów</li>
<li>Maksymalny zasięg semiwariogramu (ang. <em>cutoff distance</em>) to 1/2 pierwiastka z badanej powierzchni (inne źródła mówią o połowie z przekątnej badanego obszaru/jednej trzeciej)</li>
<li>Liczba odstępów powinna nie być mniejsza niż 10</li>
<li>Optymalnie maksymalny zasięg semiwariogramu powinien być dłuższy o 10-15% od zasięgu zjawiska</li>
<li>Optymalnie odstępy powinny być jak najbliżej siebie i jednocześnie nie być chaotyczne</li>
<li>Warto metodą prób i błędów określić optymalne parametry semiwariogramu</li>
<li>Należy określić czy zjawisko wykazuje anizotropię przestrzenną</li>
</ul>
</div>
<div id="semiwariogram-obliczenia-pomocnicze" class="section level3">
<h3><span class="header-section-number">6.2.15</span> Semiwariogram | Obliczenia pomocnicze</h3>
<ul>
<li>Liczba par obserwacji</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="fl">0.5</span>*<span class="kw">length</span>(punkty)*(<span class="kw">length</span>(punkty)-<span class="dv">1</span>)</code></pre></div>
<pre><code>## [1] 31626</code></pre>
<ul>
<li>Połowa pierwiastka powierzchni</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pow &lt;-<span class="st"> </span><span class="kw">area</span>(granica)
<span class="kw">as.vector</span>(<span class="fl">0.5</span>*<span class="kw">sqrt</span>(pow))</code></pre></div>
<pre><code>## [1] 3980.472</code></pre>
<p><!--
- Połowa przekątnej obszaru
Twierdzenie Pitagorasa

$$x^2 + y^2 = z^2$$


```r
wierz <- as.vector(extent(poligon))
kraw_x <- wierz[2] - wierz[1]
kraw_y <- wierz[4] - wierz[3]
z_kwadrat <- kraw_x^2 + kraw_y^2
0.5*sqrt(z_kwadrat)
```

--> - Powierzchnia zajmowana przez jedną próbkę</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pow_pr &lt;-<span class="st"> </span><span class="kw">area</span>(granica)/<span class="kw">length</span>(punkty)
pow_pr</code></pre></div>
<pre><code>##        0 
## 251494.6</code></pre>
<ul>
<li>Średnia odległość między punktami</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sqrt</span>(pow_pr)</code></pre></div>
<pre><code>##        0 
## 501.4924</code></pre>
</div>
<div id="semiwariogram-maksymalny-zasieg-semiwariogramu-ang.-cutoff-distance" class="section level3">
<h3><span class="header-section-number">6.2.16</span> Semiwariogram | Maksymalny zasięg semiwariogramu (ang. <em>Cutoff distance</em>)</h3>
<ul>
<li>Maksymalny zasięg semiwariogramu (ang. <em>Cutoff distance</em>) jest domyślnie wyliczany w pakiecie <code>gstat</code> jako 1/3 z najdłuższej przekątnej badanego obszaru</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vario_par &lt;-<span class="st"> </span><span class="kw">variogram</span>(temp~<span class="dv">1</span>, punkty)
vario_par</code></pre></div>
<pre><code>##      np      dist     gamma dir.hor dir.ver   id
## 1   131  218.6119  1.424513       0       0 var1
## 2   312  490.7338  2.902181       0       0 var1
## 3   516  797.7160  4.558657       0       0 var1
## 4   683 1114.7117  4.659557       0       0 var1
## 5   849 1433.5720  6.429404       0       0 var1
## 6   965 1743.1558  7.539542       0       0 var1
## 7  1103 2057.9031  7.622834       0       0 var1
## 8  1246 2370.6101  8.663066       0       0 var1
## 9  1219 2690.1356  9.657865       0       0 var1
## 10 1343 3005.8324 10.384925       0       0 var1
## 11 1377 3324.7716 11.179461       0       0 var1
## 12 1432 3635.2805 11.959684       0       0 var1
## 13 1485 3952.0183 13.396273       0       0 var1
## 14 1494 4268.2314 14.485038       0       0 var1
## 15 1478 4585.7878 15.256081       0       0 var1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(vario_par, <span class="dt">plot.numbers=</span><span class="ot">TRUE</span>)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-76-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vario_par &lt;-<span class="st"> </span><span class="kw">variogram</span>(temp~<span class="dv">1</span>, punkty, <span class="dt">cutoff =</span> <span class="dv">4000</span>)
<span class="kw">plot</span>(vario_par)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-76-2.png" alt="" /><!-- --></p>
</div>
<div id="semiwariogram-odlegosc-miedzy-przedziaami-ang.-interval-width" class="section level3">
<h3><span class="header-section-number">6.2.17</span> Semiwariogram | Odległość między przedziałami (ang. <em>Interval width</em>)</h3>
<ul>
<li>Domyślnie to maksymalny zasięg semiwariogramu podzielony przez 15 dahe odległość między przedziałami (ang. <em>Interval width</em>)</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vario_par &lt;-<span class="st"> </span><span class="kw">variogram</span>(temp~<span class="dv">1</span>, punkty, <span class="dt">cutoff =</span> <span class="dv">1000</span>, <span class="dt">width =</span> <span class="dv">250</span>)
<span class="kw">plot</span>(vario_par)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-77-1.png" alt="" /><!-- --></p>
<!--
## Wpływa danych odstających

Tak jak inne statystyki typu wariancji, wartości kowariancji i semiwariogramu są bardzo czułe na występowanie danych ekstremalnych – potencjalnie błędnych. Stosuje się trzy sposoby aby ten problem rozwiązać:
Transformację matematyczną danych (logarytmowanie, pierwiastkowanie itp.) , aby zredukować skośność ich histogramu,
Usuwanie par danych, które zaburzają wartość semiwariancji dla określonych odstępów h. Procedura ta zwana jest czyszczeniem wykresu rozrzutu z przesunięciem („h-scattergram cleansing”).
Używanie innych statystyk h-scattergramu, które są mniej czułe na występowanie danych ekstremalnych.
### Rodogram/madogram


```r
# library('SpatialExtremes')
# n.site <- 15
# locations <- matrix(runif(2*n.site, 0, 10), ncol = 2)
# colnames(locations) <- c("lon", "lat")
# 
# ##Simulate a max-stable process - with unit Frechet margins
# data <- rmaxstab(40, locations, cov.mod = "whitmat", nugget = 0, range = 1,
#                  smooth = 2)
# 
# ##Compute the madogram
# madogram(data, locations)
# data2 <- matrix(c(punkty$temp, punkty$X2002.08.20_NDVI), nrow=2)
# locations2 <- coordinates(punkty)
# colnames(locations2) <- c("lon", "lat")
# madogram(data2, locations2)
```

-->
</div>
</div>
<div id="anizotropia" class="section level2">
<h2><span class="header-section-number">6.3</span> Anizotropia</h2>
<div id="anizotropia-struktury-przestrzennej" class="section level3">
<h3><span class="header-section-number">6.3.1</span> Anizotropia struktury przestrzennej</h3>
<ul>
<li>W wielu rzeczywistych sytuacjach, wartość cechy zależy nie tylko od odległości, ale także od kierunku</li>
</ul>
</div>
<div id="mapa-semiwariogramu" class="section level3">
<h3><span class="header-section-number">6.3.2</span> Mapa semiwariogramu</h3>
<ul>
<li>Mapa semiwariogramu (powierzchnia semiwariogramu) służy do określenia czy struktura przestrzenna zjawiska posiada anizotropię, a jeżeli tak to w jakim kierunku</li>
<li>Na podstawie mapy semiwariogramu identyfikuje się parametry potrzebne do zbudowania semiwariogramów kierunkowych</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vario_map &lt;-<span class="st"> </span><span class="kw">variogram</span>(temp~<span class="dv">1</span>, punkty, <span class="dt">cutoff=</span><span class="dv">4000</span>, <span class="dt">width=</span><span class="dv">400</span>, <span class="dt">map=</span><span class="ot">TRUE</span>)
<span class="kw">plot</span>(vario_map, <span class="dt">threshold=</span><span class="dv">30</span>) <span class="co"># co najmniej 30 par punktów</span></code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-79-1.png" alt="" /><!-- --></p>
</div>
<div id="mapa-semiwariogramu-3d" class="section level3">
<h3><span class="header-section-number">6.3.3</span> Mapa semiwariogramu | 3D</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot3D</span>(<span class="kw">raster</span>(vario_map$map), <span class="dt">col=</span>rainbow)</code></pre></div>
</div>
<div id="semiwariogramy-kierunkowe-kierunki" class="section level3">
<h3><span class="header-section-number">6.3.4</span> Semiwariogramy kierunkowe | Kierunki</h3>
<ul>
<li>W przypadku, gdy zjawisko wykazuje anizotropię przestrzenną, możliwe jest stworzenie semiwariogramów dla różnych wybranych kierunków</li>
<li>Przykładowo, dla argumentu <em>alpha = c(0, 45, 90, 135)</em> cztery główne kierunki to 0, 45, 90 i 135 stopni. Oznacza to, że dla kierunku 45 stopni brane pod uwagę będą wszystkie pary punktów pomiędzy 22,5 a 67,5 stopnia.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vario_kier &lt;-<span class="st"> </span><span class="kw">variogram</span>(temp~<span class="dv">1</span>, punkty, <span class="dt">alpha =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">45</span>, <span class="dv">90</span>, <span class="dv">135</span>))
<span class="kw">plot</span>(vario_kier)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-80-1.png" alt="" /><!-- --></p>
</div>
<div id="semiwariogramy-kierunkowe-kierunki-1" class="section level3">
<h3><span class="header-section-number">6.3.5</span> Semiwariogramy kierunkowe | Kierunki</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vario_kier &lt;-<span class="st"> </span><span class="kw">variogram</span>(temp~<span class="dv">1</span>, punkty, <span class="dt">alpha =</span> <span class="kw">c</span>(<span class="dv">60</span>, <span class="dv">105</span>, <span class="dv">150</span>, <span class="dv">195</span>))
<span class="kw">plot</span>(vario_kier)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-81-1.png" alt="" /><!-- --></p>
<!--chapter:end:05-semiwariancja.Rmd-->
</div>
</div>
</div>
<div id="modelowanie-matematycznie-autokorelacji-przestrzennej" class="section level1">
<h1><span class="header-section-number">7</span> Modelowanie matematycznie autokorelacji przestrzennej</h1>
<div id="modelowanie-matematycznie-autokorelacji-przestrzennej-1" class="section level3">
<h3><span class="header-section-number">7.0.1</span> Modelowanie matematycznie autokorelacji przestrzennej</h3>
<ul>
<li>Semiwariogram empiryczny jest:
<ul>
<li>Nieciągły - wartości semiwariancji są średnimi przedziałowymi</li>
<li>Chaotyczny - badana próba jest jedynie przybliżeniem rzeczywistości, dodatkowo obciążonym błędami</li>
</ul></li>
<li>Estymacje i symulacje przestrzenne wymagają modelu struktury przestrzennej analizowanej cechy, a nie tylko wartości empirycznych (wyliczonych z danych)</li>
<li>Dodatkowo, matematycznie modelowanie wygładza chaotyczne fluktuacje danych empirycznych</li>
</ul>
</div>
<div id="modele-podstawowe" class="section level2">
<h2><span class="header-section-number">7.1</span> Modele podstawowe</h2>
<div id="modele-podstawowe-1" class="section level3">
<h3><span class="header-section-number">7.1.1</span> Modele podstawowe</h3>
<ul>
<li>Nuggetowy (ang. <em>Nugget effect model</em>)</li>
<li>Sferyczny (ang. <em>Spherical model</em>)</li>
<li>Gaussowski (ang. <em>Gaussian model</em>)</li>
<li>Potęgowy (ang. <em>Power model</em>)</li>
<li>Wykładniczy (ang. <em>Exponential model</em>)</li>
<li>Inne</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">vgm</span>()</code></pre></div>
<pre><code>##    short                                      long
## 1    Nug                              Nug (nugget)
## 2    Exp                         Exp (exponential)
## 3    Sph                           Sph (spherical)
## 4    Gau                            Gau (gaussian)
## 5    Exc        Exclass (Exponential class/stable)
## 6    Mat                              Mat (Matern)
## 7    Ste Mat (Matern, M. Stein&#39;s parameterization)
## 8    Cir                            Cir (circular)
## 9    Lin                              Lin (linear)
## 10   Bes                              Bes (bessel)
## 11   Pen                      Pen (pentaspherical)
## 12   Per                            Per (periodic)
## 13   Wav                                Wav (wave)
## 14   Hol                                Hol (hole)
## 15   Log                         Log (logarithmic)
## 16   Pow                               Pow (power)
## 17   Spl                              Spl (spline)
## 18   Leg                            Leg (Legendre)
## 19   Err                   Err (Measurement error)
## 20   Int                           Int (Intercept)</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">show.vgms</span>()</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-84-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">show.vgms</span>(<span class="dt">models=</span><span class="kw">c</span>(<span class="st">&#39;Nug&#39;</span>, <span class="st">&#39;Sph&#39;</span>, <span class="st">&#39;Gau&#39;</span>, <span class="st">&#39;Pow&#39;</span>, <span class="st">&#39;Exp&#39;</span>), <span class="dt">range=</span><span class="fl">1.4</span>, <span class="dt">max=</span><span class="fl">2.5</span>)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-85-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">show.vgms</span>(<span class="dt">models=</span><span class="kw">c</span>(<span class="st">&#39;Nug&#39;</span>, <span class="st">&#39;Sph&#39;</span>, <span class="st">&#39;Gau&#39;</span>, <span class="st">&#39;Pow&#39;</span>, <span class="st">&#39;Exp&#39;</span>), <span class="dt">range=</span><span class="fl">1.4</span>, <span class="dt">max=</span><span class="fl">2.5</span>, <span class="dt">as.groups =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-86-1.png" alt="" /><!-- --></p>
</div>
</div>
<div id="metody-modelowania" class="section level2">
<h2><span class="header-section-number">7.2</span> Metody modelowania</h2>
<div id="metody-modelowania-1" class="section level3">
<h3><span class="header-section-number">7.2.1</span> Metody modelowania</h3>
<ul>
<li>Ustawianie “ręczne” parametrów modelu, np. funkcja <code>vgm</code> z pakietu <code>gstat</code></li>
<li>Ustawianie “wizualne” parametrów modelu, np. funkcja <code>eyefit</code> z pakietu <code>geoR</code></li>
<li>Automatyczny wybór parametrów na podstawie różnych kryterów statystycznych, np. funkcja <code>fit.variogram</code> z pakietu <code>gstat</code>, <code>variofit</code> z pakietu <code>geoR</code>, <code>autofitVariogram</code> z pakietu <code>automap</code></li>
</ul>
</div>
<div id="metody-modelowania-2" class="section level3">
<h3><span class="header-section-number">7.2.2</span> Metody modelowania</h3>
<ul>
<li>Odpowiednie określenie modelu matematycznego często nie jest proste</li>
<li>Automatyczne metody nie zawsze są w stanie dać lepszy wynik od modelowania “ręcznego”</li>
<li>Najlepiej, gdy wybór modelu oparty jest o wiedzę na temat zakładanego procesu przestrzennego</li>
</ul>
</div>
<div id="metody-modelowania-liniowy-model-regionalizacji" class="section level3">
<h3><span class="header-section-number">7.2.3</span> Metody modelowania | Liniowy model regionalizacji</h3>
<ul>
<li>W przypadku, gdy analizowane zjawisko jest złożone, odwzorowanie kształtu semiwariogramu empirycznego wymaga połączenia dwóch lub większej liczby modeli podstawowych</li>
<li>W takiej sytuacji konieczne jest spełnienie dwóch warunków:
<ul>
<li>Wszystkie zastosowane modele muszą być dopuszczalne (<code>vgm()</code>)</li>
<li>Wariancja progowa każdego podstawowego modelu musi być dodatnia</li>
</ul></li>
</ul>
</div>
</div>
<div id="modelowanie-semiwariogramu" class="section level2">
<h2><span class="header-section-number">7.3</span> Modelowanie semiwariogramu</h2>
<div id="modelowanie-semiwariogramu-funkcja-fit.variogram" class="section level3">
<h3><span class="header-section-number">7.3.1</span> Modelowanie semiwariogramu | funkcja <code>fit.variogram</code></h3>
<ul>
<li>Funkcja <code>fit.variogram</code> dopasowuje zasięg oraz semiwariancję progową w oparciu o ustalone “ręcznie” parametry modelu</li>
</ul>
<!--
Modelowanie semiwariogramu

-->
</div>
</div>
<div id="modelowanie-izotropowe" class="section level2">
<h2><span class="header-section-number">7.4</span> Modelowanie izotropowe</h2>
<div id="modelowanie-izotropowe-modelowanie-wizualne" class="section level3">
<h3><span class="header-section-number">7.4.1</span> Modelowanie izotropowe | Modelowanie “wizualne”</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&#39;geostatbook&#39;</span>)
<span class="kw">data</span>(punkty)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">v_eye &lt;-<span class="st"> </span><span class="kw">eyefit</span>(<span class="kw">variog</span>(<span class="kw">as.geodata</span>(punkty, <span class="st">&#39;temp&#39;</span>)))
ve_fit &lt;-<span class="st"> </span><span class="kw">as.vgm.variomodel</span>(v_eye[[<span class="dv">1</span>]])</code></pre></div>
</div>
<div id="modelowanie-izotropowe-model-nuggetowy" class="section level3">
<h3><span class="header-section-number">7.4.2</span> Modelowanie izotropowe | Model nuggetowy</h3>
<p>toFix</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vario &lt;-<span class="st"> </span><span class="kw">variogram</span>(temp~<span class="dv">1</span>, punkty)
<span class="kw">plot</span>(vario)
model_nug &lt;-<span class="st"> </span><span class="kw">vgm</span>(<span class="dv">10</span>, <span class="dt">model =</span> <span class="st">&#39;Nug&#39;</span>)
model_nug
<span class="kw">plot</span>(vario, <span class="dt">model=</span>model_nug)
fitted_nug &lt;-<span class="st"> </span><span class="kw">fit.variogram</span>(vario, model_nug)
fitted_nug
<span class="kw">plot</span>(vario, <span class="dt">model=</span>fitted_nug)</code></pre></div>
</div>
<div id="modelowanie-izotropowe-model-sferyczny" class="section level3">
<h3><span class="header-section-number">7.4.3</span> Modelowanie izotropowe | Model sferyczny</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vario &lt;-<span class="st"> </span><span class="kw">variogram</span>(temp~<span class="dv">1</span>, punkty)
<span class="kw">plot</span>(vario)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-89-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model_sph &lt;-<span class="st"> </span><span class="kw">vgm</span>(<span class="dt">psill=</span><span class="dv">10</span>, <span class="dt">model =</span> <span class="st">&#39;Sph&#39;</span>, <span class="dt">range=</span><span class="dv">3000</span>)
model_sph</code></pre></div>
<pre><code>##   model psill range
## 1   Sph    10  3000</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(vario, <span class="dt">model=</span>model_sph)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-89-2.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fitted_sph &lt;-<span class="st"> </span><span class="kw">fit.variogram</span>(vario, model_sph)
fitted_sph</code></pre></div>
<pre><code>##   model   psill    range
## 1   Sph 13.5325 4570.822</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(vario, <span class="dt">model=</span>fitted_sph)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-89-3.png" alt="" /><!-- --></p>
</div>
<div id="modelowanie-izotropowe-model-gaussowski" class="section level3">
<h3><span class="header-section-number">7.4.4</span> Modelowanie izotropowe | Model Gaussowski</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vario &lt;-<span class="st"> </span><span class="kw">variogram</span>(temp~<span class="dv">1</span>, punkty)
<span class="kw">plot</span>(vario)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-90-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model_gau &lt;-<span class="st"> </span><span class="kw">vgm</span>(<span class="dt">psill=</span><span class="dv">15</span>, <span class="dt">model =</span> <span class="st">&#39;Gau&#39;</span>, <span class="dt">range=</span><span class="dv">3000</span>)
model_gau</code></pre></div>
<pre><code>##   model psill range
## 1   Gau    15  3000</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(vario, <span class="dt">model=</span>model_gau)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-90-2.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fitted_gau &lt;-<span class="st"> </span><span class="kw">fit.variogram</span>(vario, model_gau)
fitted_gau</code></pre></div>
<pre><code>##   model    psill    range
## 1   Gau 8.361489 761.2621</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(vario, <span class="dt">model=</span>fitted_gau)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-90-3.png" alt="" /><!-- --></p>
</div>
<div id="modelowanie-izotropowe-model-potegowy" class="section level3">
<h3><span class="header-section-number">7.4.5</span> Modelowanie izotropowe | Model potęgowy</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vario &lt;-<span class="st"> </span><span class="kw">variogram</span>(temp~<span class="dv">1</span>, punkty)
<span class="kw">plot</span>(vario)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-91-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model_pow &lt;-<span class="st"> </span><span class="kw">vgm</span>(<span class="dt">psill=</span><span class="dv">1</span>, <span class="dt">model =</span> <span class="st">&#39;Pow&#39;</span>, <span class="dt">range=</span><span class="fl">0.30</span>)
model_pow</code></pre></div>
<pre><code>##   model psill range
## 1   Pow     1   0.3</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(vario, <span class="dt">model=</span>model_pow)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-91-2.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fitted_pow &lt;-<span class="st"> </span><span class="kw">fit.variogram</span>(vario, model_pow)
fitted_pow</code></pre></div>
<pre><code>##   model      psill     range
## 1   Pow 0.02920527 0.7371518</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(vario, <span class="dt">model=</span>fitted_pow)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-91-3.png" alt="" /><!-- --></p>
</div>
<div id="modelowanie-izotropowe-model-wykadniczy" class="section level3">
<h3><span class="header-section-number">7.4.6</span> Modelowanie izotropowe | Model wykładniczy</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vario &lt;-<span class="st"> </span><span class="kw">variogram</span>(temp~<span class="dv">1</span>, punkty)
<span class="kw">plot</span>(vario)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-92-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model_exp &lt;-<span class="st"> </span><span class="kw">vgm</span>(<span class="dt">psill=</span><span class="dv">10</span>, <span class="dt">model =</span> <span class="st">&#39;Exp&#39;</span>, <span class="dt">range=</span><span class="dv">900</span>)
model_exp</code></pre></div>
<pre><code>##   model psill range
## 1   Exp    10   900</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(vario, <span class="dt">model=</span>model_exp)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-92-2.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fitted_exp &lt;-<span class="st"> </span><span class="kw">fit.variogram</span>(vario, model_exp)
fitted_exp</code></pre></div>
<pre><code>##   model   psill    range
## 1   Exp 17.9672 3217.767</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(vario, <span class="dt">model=</span>fitted_exp)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-92-3.png" alt="" /><!-- --></p>
</div>
<div id="modelowanie-izotropowe-modele-zozone-i" class="section level3">
<h3><span class="header-section-number">7.4.7</span> Modelowanie izotropowe | Modele złożone I</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vario &lt;-<span class="st"> </span><span class="kw">variogram</span>(temp~<span class="dv">1</span>, punkty)
model_zl1 &lt;-<span class="st"> </span><span class="kw">vgm</span>(<span class="dt">psill=</span><span class="dv">10</span>, <span class="dt">model =</span> <span class="st">&#39;Sph&#39;</span>, <span class="dt">range =</span> <span class="dv">3000</span>, <span class="dt">add.to =</span> <span class="kw">vgm</span>(<span class="fl">0.5</span>, <span class="st">&#39;Nug&#39;</span>))
model_zl1</code></pre></div>
<pre><code>##   model psill range
## 1   Nug   0.5    NA
## 2   Sph  10.0  3000</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(vario, <span class="dt">model=</span>model_zl1)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-93-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fitted_zl1 &lt;-<span class="st"> </span><span class="kw">fit.variogram</span>(vario, model_zl1)
fitted_zl1</code></pre></div>
<pre><code>##   model      psill    range
## 1   Nug  0.8981984    0.000
## 2   Sph 14.8165152 6117.773</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(vario, <span class="dt">model=</span>fitted_zl1)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-93-2.png" alt="" /><!-- --></p>
</div>
<div id="modelowanie-izotropowe-modele-zozone-ii" class="section level3">
<h3><span class="header-section-number">7.4.8</span> Modelowanie izotropowe | Modele złożone II</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vario &lt;-<span class="st"> </span><span class="kw">variogram</span>(temp~<span class="dv">1</span>, punkty)
model_zl2 &lt;-<span class="st"> </span><span class="kw">vgm</span>(<span class="dv">2</span>, <span class="st">&#39;Gau&#39;</span>, <span class="dv">3000</span>, <span class="dt">add.to =</span> <span class="kw">vgm</span>(<span class="dv">8</span>, <span class="dt">model =</span> <span class="st">&#39;Sph&#39;</span>, <span class="dt">range =</span> <span class="dv">2000</span>, <span class="dt">nugget =</span> <span class="fl">0.5</span>))
model_zl2</code></pre></div>
<pre><code>##   model psill range
## 1   Nug   0.5     0
## 2   Sph   8.0  2000
## 3   Gau   2.0  3000</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(vario, <span class="dt">model=</span>model_zl2)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-94-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fitted_zl2 &lt;-<span class="st"> </span><span class="kw">fit.variogram</span>(vario, model_zl2)
<span class="kw">plot</span>(vario, <span class="dt">model=</span>fitted_zl2)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-94-2.png" alt="" /><!-- --></p>
</div>
</div>
<div id="modelowanie-anizotropowe" class="section level2">
<h2><span class="header-section-number">7.5</span> Modelowanie anizotropowe</h2>
<div id="anizotropia-1" class="section level3">
<h3><span class="header-section-number">7.5.1</span> Anizotropia</h3>
<ul>
<li>Uwzględnienie anizotropii wymaga zamiany parametru zasięgu na trzy inne parametry:</li>
<li>Zasięg w dominującym kierunku</li>
<li>Kąt określający dominujący kierunek</li>
<li>Proporcję anizotropii, czyli relację pomiędzy zasięgiem w dominującym kierunku a zasięgiem w przeciwległym kierunku</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vario_map &lt;-<span class="st"> </span><span class="kw">variogram</span>(temp~<span class="dv">1</span>, punkty, <span class="dt">cutoff=</span><span class="dv">4000</span>, <span class="dt">width=</span><span class="dv">400</span>, <span class="dt">map=</span><span class="ot">TRUE</span>)
<span class="kw">plot</span>(vario_map)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-95-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vario_kier &lt;-<span class="st"> </span><span class="kw">variogram</span>(temp~<span class="dv">1</span>, punkty, <span class="dt">alpha =</span> <span class="kw">c</span>(<span class="dv">60</span>, <span class="dv">105</span>, <span class="dv">150</span>, <span class="dv">195</span>), <span class="dt">cutoff=</span><span class="dv">20000</span>)
<span class="kw">plot</span>(vario_kier, <span class="dt">plot.numbers=</span><span class="ot">TRUE</span>)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-95-2.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vario_kier_fit &lt;-<span class="st"> </span><span class="kw">vgm</span>(<span class="dt">psill=</span><span class="dv">8</span>, <span class="dt">model=</span><span class="st">&#39;Sph&#39;</span>, <span class="dt">range=</span><span class="dv">4000</span>, <span class="dt">nugget=</span><span class="fl">0.5</span>, <span class="dt">anis =</span> <span class="kw">c</span>(<span class="dv">60</span>, .<span class="dv">4</span>))
<span class="kw">plot</span>(vario_kier, vario_kier_fit, <span class="dt">as.table=</span><span class="ot">TRUE</span>)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-95-3.png" alt="" /><!-- --></p>
<!--chapter:end:06-modelowanie.Rmd-->
</div>
</div>
</div>
<div id="estymacje-jednozmienne" class="section level1">
<h1><span class="header-section-number">8</span> Estymacje jednozmienne</h1>
<div id="kriging" class="section level2">
<h2><span class="header-section-number">8.1</span> Kriging</h2>
<div id="kriging-interpolacja-geostatystyczna" class="section level3">
<h3><span class="header-section-number">8.1.1</span> Kriging | Interpolacja geostatystyczna</h3>
<ul>
<li>Zaproponowana w latach 50. przez Daniela Krige</li>
<li>Istnieje wiele rodzajów krigingu</li>
<li>Główna zasada mówi, że prognoza w danej lokalizacji jest kombinacją obokległych obserwacji</li>
<li>Waga nadawana każdej z obserwacji jest zależna od stopnia (przestrzennej) korelacji - stąd też bierze się istotna rola semiwariogramów</li>
</ul>
</div>
</div>
<div id="rodzaje-krigingu" class="section level2">
<h2><span class="header-section-number">8.2</span> Rodzaje krigingu</h2>
<div id="rodzaje-krigingu-1" class="section level3">
<h3><span class="header-section-number">8.2.1</span> Rodzaje krigingu</h3>
<ul>
<li>Kriging prosty (ang. <em>Simple kriging</em>)</li>
<li>Kriging zwykły (ang. <em>Ordinary kriging</em>)</li>
<li>Kriging z trendem (ang. <em>Kriging with a trend</em>)</li>
<li>Kriging danych kodowanych (ang. <em>Indicator kriging</em>)</li>
<li>Kriging stratyfikowany (ang. <em>Kriging within strata</em> – KWS)</li>
<li>Kriging prosty ze zmiennymi średnimi lokalnymi (ang. <em>Simple kriging with varying local means</em> - SKlm)</li>
<li>Kriging z zewnętrznym trendem/Uniwersalny kriging (ang.<em>Kriging with an external trend/Universal kriging</em>)</li>
<li>Kokriging (ang. <em>Co-kriging</em>)</li>
<li>Inne</li>
</ul>
</div>
</div>
<div id="kriging-prosty-ang.-simple-kriging" class="section level2">
<h2><span class="header-section-number">8.3</span> Kriging prosty (ang. <em>Simple kriging</em>)</h2>
<div id="kriging-prosty-ang.-simple-kriging-1" class="section level3">
<h3><span class="header-section-number">8.3.1</span> Kriging prosty (ang. <em>Simple kriging</em>)</h3>
<ul>
<li>Zakłada, że średnia jest znana i stała na całym obszarze</li>
</ul>
</div>
<div id="kriging-prosty-ang.-simple-kriging-2" class="section level3">
<h3><span class="header-section-number">8.3.2</span> Kriging prosty (ang. <em>Simple kriging</em>)</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&#39;geostatbook&#39;</span>)
<span class="kw">data</span>(punkty)
<span class="kw">data</span>(siatka)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vario &lt;-<span class="st"> </span><span class="kw">variogram</span>(temp~<span class="dv">1</span>, punkty)
model &lt;-<span class="st"> </span><span class="kw">vgm</span>(<span class="dv">10</span>, <span class="dt">model =</span> <span class="st">&#39;Sph&#39;</span>, <span class="dt">range =</span> <span class="dv">4000</span>, <span class="dt">nugget =</span> <span class="fl">0.5</span>)
model</code></pre></div>
<pre><code>##   model psill range
## 1   Nug   0.5     0
## 2   Sph  10.0  4000</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fitted &lt;-<span class="st"> </span><span class="kw">fit.variogram</span>(vario, model)
<span class="kw">plot</span>(vario, <span class="dt">model=</span>fitted)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-98-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sk &lt;-<span class="st"> </span><span class="kw">krige</span>(temp~<span class="dv">1</span>, punkty, siatka, <span class="dt">model=</span>fitted, <span class="dt">beta=</span><span class="fl">15.324</span>)</code></pre></div>
<pre><code>## [using simple kriging]</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(sk)</code></pre></div>
<pre><code>## Object of class SpatialPixelsDataFrame
## Coordinates:
##        min      max
## x 745586.7 756926.7
## y 712661.2 721211.2
## Is projected: TRUE 
## proj4string :
## [+init=epsg:2180 +proj=tmerc +lat_0=0 +lon_0=19 +k=0.9993
## +x_0=500000 +y_0=-5300000 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0
## +units=m +no_defs]
## Number of points: 10993
## Grid attributes:
##   cellcentre.offset cellsize cells.dim
## x          745586.7       90       127
## y          712661.2       90        96
## Data attributes:
##    var1.pred         var1.var    
##  Min.   : 8.606   Min.   :1.365  
##  1st Qu.:12.913   1st Qu.:2.100  
##  Median :15.009   Median :2.412  
##  Mean   :15.663   Mean   :2.499  
##  3rd Qu.:17.874   3rd Qu.:2.810  
##  Max.   :25.938   Max.   :5.266</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">spplot</span>(sk, <span class="st">&#39;var1.pred&#39;</span>)
<span class="kw">spplot</span>(sk, <span class="st">&#39;var1.var&#39;</span>)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/plotsy2-1.png" alt="" /><!-- --></p>
</div>
</div>
<div id="kriging-zwyky-ang.-ordinary-kriging" class="section level2">
<h2><span class="header-section-number">8.4</span> Kriging zwykły (ang. <em>Ordinary kriging</em>)</h2>
<div id="kriging-zwyky-ang.-ordinary-kriging-1" class="section level3">
<h3><span class="header-section-number">8.4.1</span> Kriging zwykły (ang. <em>Ordinary kriging</em>)</h3>
<ul>
<li>Średnia traktowana jest jako nieznana</li>
<li>Uwzględnia lokalne fluktuacje średniej poprzez stosowanie ruchomego okna</li>
</ul>
</div>
<div id="kriging-zwyky-ang.-ordinary-kriging-2" class="section level3">
<h3><span class="header-section-number">8.4.2</span> Kriging zwykły (ang. <em>Ordinary kriging</em>)</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ok &lt;-<span class="st"> </span><span class="kw">krige</span>(temp~<span class="dv">1</span>, punkty, siatka, <span class="dt">model=</span>fitted, <span class="dt">maxdist=</span><span class="dv">1000</span>)</code></pre></div>
<pre><code>## [using ordinary kriging]</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># ok &lt;- krige(temp~1, punkty, siatka, model=fitted, nmax=30)</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">spplot</span>(ok, <span class="st">&#39;var1.pred&#39;</span>)
<span class="kw">spplot</span>(ok, <span class="st">&#39;var1.var&#39;</span>)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/plotsy2ok2-1.png" alt="" /><!-- --></p>
<!--


```r
spplot(ok, "var1.pred", sp.layout=list(punkty, pch=21, col="white"))
```

![](Geostatystyka_files/figure-html/unnamed-chunk-100-1.png)<!-- -->
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">spplot</span>(ok, <span class="st">&quot;var1.var&quot;</span>, <span class="dt">sp.layout=</span><span class="kw">list</span>(punkty, <span class="dt">pch=</span><span class="dv">21</span>, <span class="dt">col=</span><span class="st">&quot;white&quot;</span>))</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-100-2.png" alt="" /><!-- --></p>
<p>–&gt; ## Kriging z trendem (ang. <em>Kriging with a trend</em>) ### Kriging z trendem (ang. <em>Kriging with a trend</em>)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vario_kzt &lt;-<span class="st"> </span><span class="kw">variogram</span>(temp~x+y, <span class="dt">data=</span>punkty)
<span class="kw">plot</span>(vario_kzt)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-101-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model_kzt &lt;-<span class="st"> </span><span class="kw">vgm</span>(<span class="dt">psill =</span> <span class="dv">5</span>, <span class="dt">model =</span> <span class="st">&#39;Sph&#39;</span>, <span class="dt">range =</span> <span class="dv">2500</span>, <span class="dt">nugget =</span> <span class="dv">1</span>)
fitted_kzt &lt;-<span class="st"> </span><span class="kw">fit.variogram</span>(vario_kzt, model_kzt)
fitted_kzt</code></pre></div>
<pre><code>##   model     psill range
## 1   Nug 0.4470857     0
## 2   Sph 6.5817020  2052</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(vario_kzt, fitted_kzt)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-101-2.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">punkty@data &lt;-<span class="st"> </span><span class="kw">cbind</span>(punkty@data, <span class="kw">as.data.frame</span>(<span class="kw">coordinates</span>(punkty)))
kzt &lt;-<span class="st"> </span><span class="kw">krige</span>(temp~x+y, punkty, siatka, <span class="dt">model=</span>fitted_kzt)</code></pre></div>
<pre><code>## [using universal kriging]</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">spplot</span>(kzt, <span class="st">&#39;var1.pred&#39;</span>)
<span class="kw">spplot</span>(kzt, <span class="st">&#39;var1.var&#39;</span>)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/plotsy2kzt-1.png" alt="" /><!-- --></p>
</div>
</div>
<div id="porownanie-wynikow-sk-ok-i-kzt" class="section level2">
<h2><span class="header-section-number">8.5</span> Porównanie wyników SK, OK i KZT</h2>
<p><img src="Geostatystyka_files/figure-html/ploty_trzy-1.png" alt="" /><!-- --></p>
<!--chapter:end:07-estymacje.Rmd-->
</div>
</div>
<div id="estymacja-lokalnego-rozkadu-prawdopodobienstwa" class="section level1">
<h1><span class="header-section-number">9</span> Estymacja lokalnego rozkładu prawdopodobieństwa</h1>
<div id="kriging-danych-kodowanych-ang.-indicator-kriging-wprowadzenie" class="section level2">
<h2><span class="header-section-number">9.1</span> Kriging danych kodowanych (ang. <em>Indicator kriging</em>) | Wprowadzenie</h2>
<div id="kriging-danych-kodowanych-ang.-indicator-kriging" class="section level3">
<h3><span class="header-section-number">9.1.1</span> Kriging danych kodowanych (ang. <em>Indicator kriging</em>)</h3>
<ul>
<li>Jest to metoda krigingu oparta o dane kategoryzowane lub też dane przetworzone z postaci ciągłej do binarnej</li>
<li>Zazwyczaj używana jest to oszacowania prawdopodobieństwa przekroczenia zdefiniowanej wartości progowej</li>
<li>Może być też używana do szacowania wartości z całego rozkładu</li>
</ul>
<!--
http://geostat-course.org/system/files/geostat13_ind.pdf
-->
</div>
<div id="kriging-danych-kodowanych-ang.-indicator-kriging-1" class="section level3">
<h3><span class="header-section-number">9.1.2</span> Kriging danych kodowanych (ang. <em>Indicator kriging</em>)</h3>
<ul>
<li>Wartości danych wykorzystywane do krigingu danych kodowanych są określone jako 0 lub 1</li>
<li>Powyzsze kategorie reprezentują czy wartość danej zmiennej jest powyżej czy poniżej określonego progu</li>
</ul>
</div>
<div id="kriging-danych-kodowanych-ang.-indicator-kriging-wady-i-zalety" class="section level3">
<h3><span class="header-section-number">9.1.3</span> Kriging danych kodowanych (ang. <em>Indicator kriging</em>)| Wady i zalety</h3>
<ul>
<li>Zalety:
<ul>
<li>Możliwość zastosowania, gdy nie interesuje nas konkretna wartość, ale znalezienie obszarów o wartości przekraczającej dany poziom</li>
<li>Nie jest istotny kszałt rozkładu</li>
</ul></li>
<li>Wady:
<ul>
<li>Potencjalnie trudne do modelowania semiwariogramy (szczególnie skrajnych przedziałów)</li>
<li>Czasochłonność/pracochłonność</li>
</ul></li>
</ul>
</div>
</div>
<div id="kriging-danych-kodowanych-ang.-indicator-kriging-przykady" class="section level2">
<h2><span class="header-section-number">9.2</span> Kriging danych kodowanych (ang. <em>Indicator kriging</em>) | Przykłady</h2>
<div id="binaryzacja-danych" class="section level3">
<h3><span class="header-section-number">9.2.1</span> Binaryzacja danych</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&#39;geostatbook&#39;</span>)
<span class="kw">data</span>(punkty)
<span class="kw">data</span>(siatka)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(punkty$temp) </code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   8.153  12.460  15.210  15.520  18.260  26.700</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">punkty$temp_ind &lt;-<span class="st"> </span>punkty$temp &gt;<span class="st"> </span><span class="dv">20</span>
<span class="kw">summary</span>(punkty$temp_ind) </code></pre></div>
<pre><code>##    Mode   FALSE    TRUE    NA&#39;s 
## logical     212      40       0</code></pre>
</div>
<div id="eksploracja-danych" class="section level3">
<h3><span class="header-section-number">9.2.2</span> Eksploracja danych</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(punkty@data, <span class="kw">aes</span>(temp)) +<span class="st"> </span><span class="kw">stat_ecdf</span>()</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-105-1.png" alt="" /><!-- --></p>
</div>
<div id="kriging-danych-kodowanych-ang.-indicator-kriging-semiwariogram" class="section level3">
<h3><span class="header-section-number">9.2.3</span> Kriging danych kodowanych (ang. <em>Indicator kriging</em>) | Semiwariogram</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vario_ind &lt;-<span class="st"> </span><span class="kw">variogram</span>(temp_ind~<span class="dv">1</span>, punkty)         
<span class="kw">plot</span>(vario_ind)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-106-1.png" alt="" /><!-- --></p>
</div>
<div id="kriging-danych-kodowanych-ang.-indicator-kriging-modelowanie" class="section level3">
<h3><span class="header-section-number">9.2.4</span> Kriging danych kodowanych (ang. <em>Indicator kriging</em>) | Modelowanie</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model_ind &lt;-<span class="st"> </span><span class="kw">vgm</span>(<span class="fl">0.07</span>, <span class="dt">model =</span> <span class="st">&#39;Sph&#39;</span>, <span class="dt">range =</span> <span class="dv">3000</span>,  <span class="dt">nugget =</span> <span class="fl">0.01</span>)  
<span class="kw">plot</span>(vario_ind, <span class="dt">model=</span>model_ind)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-107-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fitted_ind &lt;-<span class="st"> </span><span class="kw">fit.variogram</span>(vario_ind, model_ind)
fitted_ind</code></pre></div>
<pre><code>##   model      psill    range
## 1   Nug 0.01303201    0.000
## 2   Sph 0.09822073 4710.163</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(vario_ind, <span class="dt">model=</span>fitted_ind)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-107-2.png" alt="" /><!-- --></p>
</div>
<div id="kriging-danych-kodowanych-ang.-indicator-kriging-interpolacja" class="section level3">
<h3><span class="header-section-number">9.2.5</span> Kriging danych kodowanych (ang. <em>Indicator kriging</em>) | Interpolacja</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ik &lt;-<span class="st"> </span><span class="kw">krige</span>(temp_ind~<span class="dv">1</span>, punkty, siatka, <span class="dt">model=</span>fitted_ind)</code></pre></div>
<pre><code>## [using ordinary kriging]</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">spplot</span>(ik, <span class="st">&#39;var1.pred&#39;</span>)
<span class="kw">spplot</span>(ik, <span class="st">&#39;var1.var&#39;</span>)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/plotsy2ok-1.png" alt="" /><!-- --></p>
</div>
<div id="kriging-danych-kodowanych-ang.-indicator-kriging-2" class="section level3">
<h3><span class="header-section-number">9.2.6</span> Kriging danych kodowanych (ang. <em>Indicator kriging</em>)</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vario_ind20 &lt;-<span class="st"> </span><span class="kw">variogram</span>(<span class="kw">I</span>(temp&lt;<span class="dv">20</span>)~<span class="dv">1</span>, punkty)  
fitted_ind20 &lt;-<span class="st"> </span><span class="kw">fit.variogram</span>(vario_ind20, <span class="kw">vgm</span>(<span class="fl">0.08</span>, <span class="st">&#39;Sph&#39;</span>, <span class="dv">3500</span>, <span class="dt">nugget=</span><span class="fl">0.01</span>))
vario_ind16 &lt;-<span class="st"> </span><span class="kw">variogram</span>(<span class="kw">I</span>(temp&lt;<span class="dv">16</span>)~<span class="dv">1</span>, punkty)  
fitted_ind16 &lt;-<span class="st"> </span><span class="kw">fit.variogram</span>(vario_ind16, <span class="kw">vgm</span>(<span class="fl">0.18</span>, <span class="st">&#39;Sph&#39;</span>, <span class="dv">3500</span>, <span class="dt">nugget=</span><span class="fl">0.03</span>))
vario_ind12 &lt;-<span class="st"> </span><span class="kw">variogram</span>(<span class="kw">I</span>(temp&lt;<span class="dv">12</span>)~<span class="dv">1</span>, punkty)  
fitted_ind12 &lt;-<span class="st"> </span><span class="kw">fit.variogram</span>(vario_ind12, <span class="kw">vgm</span>(<span class="fl">0.13</span>, <span class="st">&#39;Sph&#39;</span>, <span class="dv">2000</span>, <span class="dt">nugget=</span><span class="fl">0.03</span>))

ik20 &lt;-<span class="st"> </span><span class="kw">krige</span>(<span class="kw">I</span>(temp&lt;<span class="dv">20</span>)~<span class="dv">1</span>, punkty, siatka, <span class="dt">model=</span>fitted_ind20, <span class="dt">nmax=</span><span class="dv">30</span>)</code></pre></div>
<pre><code>## [using ordinary kriging]</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ik16 &lt;-<span class="st"> </span><span class="kw">krige</span>(<span class="kw">I</span>(temp&lt;<span class="dv">16</span>)~<span class="dv">1</span>, punkty, siatka, <span class="dt">model=</span>fitted_ind16, <span class="dt">nmax=</span><span class="dv">30</span>)</code></pre></div>
<pre><code>## [using ordinary kriging]</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ik12 &lt;-<span class="st"> </span><span class="kw">krige</span>(<span class="kw">I</span>(temp&lt;<span class="dv">12</span>)~<span class="dv">1</span>, punkty, siatka, <span class="dt">model=</span>fitted_ind12, <span class="dt">nmax=</span><span class="dv">30</span>)</code></pre></div>
<pre><code>## [using ordinary kriging]</code></pre>
<p><img src="Geostatystyka_files/figure-html/ploty_trzyik-1.png" alt="" /><!-- --></p>
<!--chapter:end:08-dane_kodowane.Rmd-->
</div>
</div>
</div>
<div id="estymacje-wielozmienne" class="section level1">
<h1><span class="header-section-number">10</span> Estymacje wielozmienne</h1>
<div id="kokriging-prosty-i-zwyky-sck-i-ock" class="section level2">
<h2><span class="header-section-number">10.1</span> Kokriging (prosty i zwykły, SCK i OCK)</h2>
<div id="kokriging-ang.-co-kriging" class="section level3">
<h3><span class="header-section-number">10.1.1</span> Kokriging (ang. <em>co-kriging</em>)</h3>
<ul>
<li>Kokriging pozwala na wykorzystanie dodatkowej zmiennej (ang. <em>auxiliary variable</em>), zwanej inaczej kozmienną (ang. <em>co-variable</em>), która może być użyta do prognozwania wartości badanej zmiennej w nieopróbowanej lokalizacji</li>
<li>Zmienna dodatkowa może być pomierzona w tych samych miejscach, gdzie badana zmienna, jak też w innych niż badana zmienna</li>
<li>Możliwa jest też sytuacja, gdy zmienna dodatkowa jest pomierzona w dwóch powyższych przypadkach</li>
<li>Kokriging wymaga, aby obie zmienne były istotnie ze sobą skorelowane</li>
<li>Najczęściej kokriging jest stosowany w sytuacji, gdy zmienna dodatkowa jest łatwiejsza (tańsza) do pomierzenia niż zmienna główna</li>
<li>W efekcie, uzyskany zbiór danych zawiera informacje o badanej zmiennej oraz gęściej opróbowane informacje o zmiennej dodatkowej</li>
<li>Jeżeli informacje o zmiennej dodatkowej są znane dla całego obszaru wówczas bardziej odpowiednią techniką będzie kriging z zewnątrznym trendem (KED)</li>
</ul>
</div>
<div id="kokriging-wybor-dodatkowej-zmiennej" class="section level3">
<h3><span class="header-section-number">10.1.2</span> Kokriging | Wybór dodatkowej zmiennej</h3>
<ul>
<li>Wybór zmiennej dodatkowej może opierać się na dwóch kryteriach:
<ul>
<li>Teoretycznym</li>
<li>Empirycznym</li>
</ul></li>
</ul>
<!--
Kroskowariogramy
Kroskorelogramy
-->
</div>
</div>
<div id="krossemiwariogramy" class="section level2">
<h2><span class="header-section-number">10.2</span> Krossemiwariogramy</h2>
<div id="krossemiwariogramy-1" class="section level3">
<h3><span class="header-section-number">10.2.1</span> Krossemiwariogramy</h3>
<ul>
<li>Krossemiwariogram jest to wariancja różnicy pomiędzy dwiema zmiennymi w dwóch lokalizacjach</li>
<li>Wyliczając Krossemiwariogram otrzymujemy empiryczne semiwatiogramy dla dwóch badanych zmiennych oraz kroswariogram dla kombinacji dwóch zmiennych</li>
<li>Krossemiwariogram znajduje swoje zastosowanie w technice zwanej kokrigingiem</li>
</ul>
</div>
<div id="krossemiwariogramy-2" class="section level3">
<h3><span class="header-section-number">10.2.2</span> Krossemiwariogramy</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&#39;geostatbook&#39;</span>)
<span class="kw">data</span>(punkty)
<span class="kw">data</span>(punkty_ndvi)
<span class="kw">data</span>(siatka)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">g &lt;-<span class="st"> </span><span class="kw">gstat</span>(<span class="ot">NULL</span>, <span class="dt">id=</span><span class="st">&#39;SAVI&#39;</span>, <span class="dt">form =</span> savi~<span class="dv">1</span>, <span class="dt">data =</span> punkty)
g &lt;-<span class="st"> </span><span class="kw">gstat</span>(g, <span class="dt">id=</span><span class="st">&#39;NDVI&#39;</span>, <span class="dt">form =</span> ndvi~<span class="dv">1</span>, <span class="dt">data =</span> punkty_ndvi)
g</code></pre></div>
<pre><code>## data:
## SAVI : formula = savi`~`1 ; data dim = 252 x 5
## NDVI : formula = ndvi`~`1 ; data dim = 1011 x 1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">v &lt;-<span class="st"> </span><span class="kw">variogram</span>(g)
<span class="kw">plot</span>(v)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/krosssemi-1.png" alt="" /><!-- --></p>
</div>
</div>
<div id="modelowanie-krossemiwariogramow" class="section level2">
<h2><span class="header-section-number">10.3</span> Modelowanie krossemiwariogramów</h2>
<div id="modelowanie-krossemiwariogramow-fit.lmc" class="section level3">
<h3><span class="header-section-number">10.3.1</span> Modelowanie krossemiwariogramów | <code>fit.lmc</code></h3>
<ul>
<li>Funkcja <code>fit.lmc</code> dopasowuje liniowy model koregionalizacji do semiwariogramów wielozmienych</li>
</ul>
</div>
<div id="modelowanie-krossemiwariogramow-1" class="section level3">
<h3><span class="header-section-number">10.3.2</span> Modelowanie krossemiwariogramów</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">g &lt;-<span class="st"> </span><span class="kw">gstat</span>(g, <span class="dt">model=</span><span class="kw">vgm</span>(<span class="fl">0.006</span>, <span class="st">&#39;Sph&#39;</span>, <span class="dv">2000</span>, <span class="fl">0.001</span>), <span class="dt">fill.all=</span><span class="ot">TRUE</span>)
g_fit &lt;-<span class="st"> </span><span class="kw">fit.lmc</span>(v, g)
g_fit</code></pre></div>
<pre><code>## data:
## SAVI : formula = savi`~`1 ; data dim = 252 x 5
## NDVI : formula = ndvi`~`1 ; data dim = 1011 x 1
## variograms:
##              model       psill range
## SAVI[1]        Nug 0.002841025     0
## SAVI[2]        Sph 0.004263643  2000
## NDVI[1]        Nug 0.003120480     0
## NDVI[2]        Sph 0.006335148  2000
## SAVI.NDVI[1]   Nug 0.002977476     0
## SAVI.NDVI[2]   Sph 0.004962607  2000</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(v, g_fit)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-112-1.png" alt="" /><!-- --></p>
<!--

```r
# plot(variogram(g, map=TRUE, cutoff=12000, width=800))
plot(variogram(g, alpha = c(60, 105, 150, 195)))
```
-->
</div>
</div>
<div id="kokriging" class="section level2">
<h2><span class="header-section-number">10.4</span> Kokriging</h2>
<div id="kokriging-1" class="section level3">
<h3><span class="header-section-number">10.4.1</span> Kokriging</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ck &lt;-<span class="st"> </span><span class="kw">predict</span>(g_fit, siatka) </code></pre></div>
<pre><code>## Linear Model of Coregionalization found. Good.
## [using ordinary cokriging]</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(ck)</code></pre></div>
<pre><code>## Object of class SpatialPixelsDataFrame
## Coordinates:
##        min      max
## x 745586.7 756926.7
## y 712661.2 721211.2
## Is projected: TRUE 
## proj4string :
## [+init=epsg:2180 +proj=tmerc +lat_0=0 +lon_0=19 +k=0.9993
## +x_0=500000 +y_0=-5300000 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0
## +units=m +no_defs]
## Number of points: 10993
## Grid attributes:
##   cellcentre.offset cellsize cells.dim
## x          745586.7       90       127
## y          712661.2       90        96
## Data attributes:
##    SAVI.pred         SAVI.var          NDVI.pred         NDVI.var       
##  Min.   :0.1092   Min.   :0.003400   Min.   :0.2284   Min.   :0.003685  
##  1st Qu.:0.2903   1st Qu.:0.003778   1st Qu.:0.4714   1st Qu.:0.004258  
##  Median :0.3166   Median :0.003893   Median :0.5051   Median :0.004427  
##  Mean   :0.3132   Mean   :0.003914   Mean   :0.5008   Mean   :0.004458  
##  3rd Qu.:0.3438   3rd Qu.:0.004024   3rd Qu.:0.5406   3rd Qu.:0.004613  
##  Max.   :0.4055   Max.   :0.005113   Max.   :0.6260   Max.   :0.006300  
##  cov.SAVI.NDVI     
##  Min.   :0.003399  
##  1st Qu.:0.003824  
##  Median :0.003953  
##  Mean   :0.003980  
##  3rd Qu.:0.004103  
##  Max.   :0.005439</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">spplot</span>(ck, <span class="st">&#39;SAVI.pred&#39;</span>)
<span class="kw">spplot</span>(ck, <span class="st">&#39;SAVI.var&#39;</span>)</code></pre></div>
<!--   
## Kokriging pełny i medianowy, kokriging kolokacyjny, 
## Kokriging na podstawie uproszczonych modeli Markowa I i II
-->
<!--chapter:end:09-kokriging.Rmd-->
</div>
</div>
</div>
<div id="wykorzystanie-do-estymacji-danych-uzupeniajacych" class="section level1">
<h1><span class="header-section-number">11</span> Wykorzystanie do estymacji danych uzupełniających</h1>
<div id="kriging-stratyfikowany-ang.-kriging-within-strata" class="section level2">
<h2><span class="header-section-number">11.1</span> Kriging stratyfikowany (ang. <em>Kriging within strata</em>)</h2>
<div id="kriging-stratyfikowany-ang.-kriging-within-strata-1" class="section level3">
<h3><span class="header-section-number">11.1.1</span> Kriging stratyfikowany (ang. <em>Kriging within strata</em>)</h3>
<ul>
<li>Zakłada on, że zmienność badanego zjawiska zależy od zmiennej jakościowej (kategoryzowanej)</li>
<li>Przykładowo, zróżnicowanie badanej zmiennej jest różne w zależności od pokrycia terenu</li>
<li>Kriging stratyfikowany wymaga posiadania danych zmiennej jakościowej (kategoryzowanej) na całym badanym obszarze</li>
</ul>
</div>
<div id="kriging-stratyfikowany-ang.-kriging-within-strata-2" class="section level3">
<h3><span class="header-section-number">11.1.2</span> Kriging stratyfikowany (ang. <em>Kriging within strata</em>)</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&#39;geostatbook&#39;</span>)
<span class="kw">data</span>(punkty)
<span class="kw">data</span>(siatka)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">siatka$clc &lt;-<span class="st"> </span><span class="kw">as.factor</span>(siatka$clc)
<span class="kw">spplot</span>(siatka, <span class="st">&#39;clc&#39;</span>)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-117-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vario_kws1 &lt;-<span class="st"> </span><span class="kw">variogram</span>(temp~<span class="dv">1</span>, punkty[punkty$clc==<span class="dv">1</span>, ])
<span class="kw">plot</span>(vario_kws1)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-117-2.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fitted_kws1 &lt;-<span class="st"> </span><span class="kw">fit.variogram</span>(vario_kws1, <span class="kw">vgm</span>(<span class="dv">10</span>, <span class="dt">model =</span> <span class="st">&#39;Sph&#39;</span>, <span class="dt">range =</span> <span class="dv">4500</span>, <span class="dt">nugget =</span> <span class="fl">0.5</span>))
<span class="kw">plot</span>(vario_kws1, fitted_kws1)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-117-3.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vario_kws2 &lt;-<span class="st"> </span><span class="kw">variogram</span>(temp~<span class="dv">1</span>, punkty[punkty$clc==<span class="dv">2</span>, ])
<span class="kw">plot</span>(vario_kws2)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-117-4.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fitted_kws2 &lt;-<span class="st"> </span><span class="kw">fit.variogram</span>(vario_kws2, <span class="kw">vgm</span>(<span class="dv">5</span>, <span class="dt">model =</span> <span class="st">&#39;Sph&#39;</span>, <span class="dt">range =</span> <span class="dv">4500</span>, <span class="dt">nugget =</span> <span class="fl">0.1</span>))
<span class="kw">plot</span>(vario_kws2, fitted_kws2)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-117-5.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vario_kws4 &lt;-<span class="st"> </span><span class="kw">variogram</span>(temp~<span class="dv">1</span>, punkty[punkty$clc==<span class="dv">4</span>, ])
<span class="kw">plot</span>(vario_kws4)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-117-6.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fitted_kws4 &lt;-<span class="st"> </span><span class="kw">fit.variogram</span>(vario_kws4, <span class="kw">vgm</span>(<span class="fl">0.5</span>, <span class="dt">model =</span> <span class="st">&#39;Nug&#39;</span>))
<span class="kw">plot</span>(vario_kws4, fitted_kws4)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-117-7.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">kws1 &lt;-<span class="st"> </span><span class="kw">krige</span>(temp~<span class="dv">1</span>, punkty[punkty$clc==<span class="dv">1</span>, ], siatka[<span class="kw">na.omit</span>(siatka$clc==<span class="dv">1</span>), ], <span class="dt">model =</span> fitted_kws1, <span class="dt">nmax =</span> <span class="dv">50</span>)</code></pre></div>
<pre><code>## [using ordinary kriging]</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">kws2 &lt;-<span class="st"> </span><span class="kw">krige</span>(temp~<span class="dv">1</span>, punkty[punkty$clc==<span class="dv">2</span>, ], siatka[<span class="kw">na.omit</span>(siatka$clc==<span class="dv">2</span>), ], <span class="dt">model =</span> fitted_kws2, <span class="dt">nmax =</span> <span class="dv">50</span>)</code></pre></div>
<pre><code>## [using ordinary kriging]</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">kws4 &lt;-<span class="st"> </span><span class="kw">krige</span>(temp~<span class="dv">1</span>, punkty[punkty$clc==<span class="dv">4</span>, ], siatka[<span class="kw">na.omit</span>(siatka$clc==<span class="dv">4</span>), ], <span class="dt">model =</span> fitted_kws4, <span class="dt">nmax =</span> <span class="dv">50</span>)</code></pre></div>
<pre><code>## [using ordinary kriging]</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">kws &lt;-<span class="st"> </span><span class="kw">rbind</span>(<span class="kw">as.data.frame</span>(kws1), <span class="kw">as.data.frame</span>(kws2), <span class="kw">as.data.frame</span>(kws4))
<span class="kw">coordinates</span>(kws) &lt;-<span class="st"> </span><span class="er">~</span>x+y
kws &lt;-<span class="st"> </span><span class="kw">as</span>(kws, <span class="st">&#39;SpatialPixelsDataFrame&#39;</span>)
<span class="kw">spplot</span>(kws, <span class="st">&#39;var1.pred&#39;</span>, <span class="dt">sp.layout=</span>(<span class="dt">list=</span><span class="kw">SpatialPoints</span>(punkty)))</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-117-8.png" alt="" /><!-- --></p>
</div>
</div>
<div id="prosty-kriging-ze-zmiennymi-srednimi-lokalnymi-lvm" class="section level2">
<h2><span class="header-section-number">11.2</span> Prosty kriging ze zmiennymi średnimi lokalnymi (LVM)</h2>
<div id="prosty-kriging-ze-zmiennymi-srednimi-lokalnymi-lvm-1" class="section level3">
<h3><span class="header-section-number">11.2.1</span> Prosty kriging ze zmiennymi średnimi lokalnymi (LVM)</h3>
<ul>
<li>Prosty kriging ze zmiennymi średnimi lokalnymi zamiast znanej (stałej) stacjonarnej średniej wykorzystuje zmienne średnie lokalne uzyskane na podstawie innej informacji</li>
<li>Lokalna średnia może być uzyskana za pomocą wyliczenia regresji liniowej pomiędzy zmienną badaną a zmienną dodatkową</li>
</ul>
</div>
<div id="prosty-kriging-ze-zmiennymi-srednimi-lokalnymi-lvm-2" class="section level3">
<h3><span class="header-section-number">11.2.2</span> Prosty kriging ze zmiennymi średnimi lokalnymi (LVM)</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">coef &lt;-<span class="st"> </span><span class="kw">lm</span>(temp~srtm, punkty)$coef
coef</code></pre></div>
<pre><code>##  (Intercept)         srtm 
## 16.480355788 -0.004535255</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vario &lt;-<span class="st"> </span><span class="kw">variogram</span>(temp~srtm, punkty)
model_sim &lt;-<span class="st"> </span><span class="kw">vgm</span>(<span class="dv">10</span>, <span class="dt">model =</span> <span class="st">&#39;Sph&#39;</span>, <span class="dt">range =</span> <span class="dv">4000</span>, <span class="dt">nugget =</span> <span class="dv">1</span>)
model_sim</code></pre></div>
<pre><code>##   model psill range
## 1   Nug     1     0
## 2   Sph    10  4000</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fitted_sim &lt;-<span class="st"> </span><span class="kw">fit.variogram</span>(vario, model_sim)
fitted_sim</code></pre></div>
<pre><code>##   model      psill    range
## 1   Nug  0.9382992    0.000
## 2   Sph 14.5761601 6027.977</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(vario, <span class="dt">model=</span>fitted_sim)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-118-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sk_lvm &lt;-<span class="st"> </span><span class="kw">krige</span>(temp~srtm, punkty, siatka, <span class="dt">model=</span>fitted_sim, <span class="dt">beta =</span> coef)</code></pre></div>
<pre><code>## [using simple kriging]</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(sk_lvm)</code></pre></div>
<pre><code>## Object of class SpatialPixelsDataFrame
## Coordinates:
##        min      max
## x 745586.7 756926.7
## y 712661.2 721211.2
## Is projected: TRUE 
## proj4string :
## [+init=epsg:2180 +proj=tmerc +lat_0=0 +lon_0=19 +k=0.9993
## +x_0=500000 +y_0=-5300000 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0
## +units=m +no_defs]
## Number of points: 10993
## Grid attributes:
##   cellcentre.offset cellsize cells.dim
## x          745586.7       90       127
## y          712661.2       90        96
## Data attributes:
##    var1.pred         var1.var    
##  Min.   : 8.624   Min.   :1.415  
##  1st Qu.:12.942   1st Qu.:2.148  
##  Median :15.037   Median :2.458  
##  Mean   :15.666   Mean   :2.543  
##  3rd Qu.:17.875   3rd Qu.:2.853  
##  Max.   :25.922   Max.   :5.313  
##  NA&#39;s   :43       NA&#39;s   :43</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">spplot</span>(sk_lvm, <span class="st">&#39;var1.pred&#39;</span>)
<span class="kw">spplot</span>(sk_lvm, <span class="st">&#39;var1.var&#39;</span>)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/plotsylvm2-1.png" alt="" /><!-- --></p>
</div>
</div>
<div id="kriging-uniwersalny-ang.-universal-kriging" class="section level2">
<h2><span class="header-section-number">11.3</span> Kriging uniwersalny (ang. <em>Universal kriging</em>)</h2>
<div id="kriging-uniwersalny-ang.-universal-kriging-1" class="section level3">
<h3><span class="header-section-number">11.3.1</span> Kriging uniwersalny (ang. <em>Universal kriging</em>)</h3>
<ul>
<li>Określany również jako kriging z trendem (ang. <em>Kriging with a trend model</em>)</li>
<li>Zakłada on, że nieznana średnia lokalna zmiania się stopniowo na badanym obszarze</li>
</ul>
</div>
<div id="kriging-uniwersalny-ang.-universal-kriging-2" class="section level3">
<h3><span class="header-section-number">11.3.2</span> Kriging uniwersalny (ang. <em>Universal kriging</em>)</h3>
<!--

```r
# vario_ku <- variogram(temp~odl_od_morza, data=punkty)
# plot(vario_ku)
# model_ku <- vgm(psill = 17, model = 'Sph', range = 12000, nugget = 5)
# fitted_ku <- fit.variogram(vario_ku, model_ku)
# fitted_ku
# plot(vario_ku, fitted_ku)
```

-->
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">punkty$clc &lt;-<span class="st"> </span><span class="kw">as.factor</span>(punkty$clc)
vario_uk1 &lt;-<span class="st"> </span><span class="kw">variogram</span>(temp~clc, punkty)
vario_uk1</code></pre></div>
<pre><code>##      np      dist    gamma dir.hor dir.ver   id
## 1   131  218.6119 1.492195       0       0 var1
## 2   312  490.7338 2.692324       0       0 var1
## 3   516  797.7160 4.143141       0       0 var1
## 4   683 1114.7117 4.032339       0       0 var1
## 5   849 1433.5720 4.422906       0       0 var1
## 6   965 1743.1558 5.112034       0       0 var1
## 7  1103 2057.9031 5.212272       0       0 var1
## 8  1246 2370.6101 5.790961       0       0 var1
## 9  1219 2690.1356 6.934307       0       0 var1
## 10 1343 3005.8324 7.179945       0       0 var1
## 11 1377 3324.7716 7.685214       0       0 var1
## 12 1432 3635.2805 7.885347       0       0 var1
## 13 1485 3952.0183 8.361701       0       0 var1
## 14 1494 4268.2314 9.018930       0       0 var1
## 15 1478 4585.7878 9.241991       0       0 var1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(vario_uk1)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-120-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model_uk1 &lt;-<span class="st"> </span><span class="kw">vgm</span>(<span class="dv">8</span>, <span class="dt">model =</span> <span class="st">&#39;Sph&#39;</span>, <span class="dt">range =</span> <span class="dv">3000</span>, <span class="dt">nugget =</span> <span class="dv">1</span>)
vario_fit_uk1 &lt;-<span class="st"> </span><span class="kw">fit.variogram</span>(vario_uk1, <span class="dt">model=</span>model_uk1)
vario_fit_uk1</code></pre></div>
<pre><code>##   model    psill    range
## 1   Nug 1.292171    0.000
## 2   Sph 7.441007 4763.345</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(vario_uk1, vario_fit_uk1)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-120-2.png" alt="" /><!-- --></p>
<!--


```r
# przygotowanie siatki
# siatka <- read.csv("data/Wolin_TPZ_p_lato_popN.csv")
# head(siatka)
# coordinates(siatka) <- ~X+Y
# proj4string(siatka) <- proj4string(punkty)
# siatkaded(siatka) <- TRUE
# plot(siatka)
# names(siatka)[6] <- c("clc")
# names(siatka)[7] <- c("odl_od_morza")
# siatka@data <- siatka@data[c(2, 4:9)]
# # siatka@data <- cbind(siatka@data, as.data.frame(coordinates(siatka)))
# write.csv(siatka, 'data/siatka_wolin_lato.csv', row.names=FALSE)
# spplot(siatka)
```

-->
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">siatka$clc &lt;-<span class="st"> </span><span class="kw">as.factor</span>(siatka$clc)
<span class="kw">spplot</span>(siatka, <span class="st">&#39;clc&#39;</span>)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-122-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">uk1 &lt;-<span class="st"> </span><span class="kw">krige</span>(temp~clc, <span class="dt">locations =</span> punkty, <span class="dt">newdata=</span>siatka, <span class="dt">model=</span>vario_fit_uk1)</code></pre></div>
<pre><code>## [using universal kriging]</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">spplot</span>(uk1, <span class="st">&#39;var1.pred&#39;</span>)
<span class="kw">spplot</span>(uk1, <span class="st">&#39;var1.var&#39;</span>)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/plotsy4uk1-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vario_uk2 &lt;-<span class="st"> </span><span class="kw">variogram</span>(temp~ndvi+srtm, punkty)
vario_uk2</code></pre></div>
<pre><code>##      np      dist     gamma dir.hor dir.ver   id
## 1   131  218.6119  1.386828       0       0 var1
## 2   312  490.7338  2.822672       0       0 var1
## 3   516  797.7160  4.294554       0       0 var1
## 4   683 1114.7117  4.501500       0       0 var1
## 5   849 1433.5720  6.310286       0       0 var1
## 6   965 1743.1558  7.395085       0       0 var1
## 7  1103 2057.9031  7.375078       0       0 var1
## 8  1246 2370.6101  8.529375       0       0 var1
## 9  1219 2690.1356  9.517366       0       0 var1
## 10 1343 3005.8324 10.213423       0       0 var1
## 11 1377 3324.7716 11.100148       0       0 var1
## 12 1432 3635.2805 11.730141       0       0 var1
## 13 1485 3952.0183 13.053957       0       0 var1
## 14 1494 4268.2314 14.252817       0       0 var1
## 15 1478 4585.7878 14.968739       0       0 var1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(vario_uk2)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-123-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model &lt;-<span class="st"> </span><span class="kw">vgm</span>(<span class="dv">8</span>, <span class="dt">model =</span> <span class="st">&#39;Sph&#39;</span>, <span class="dt">range =</span> <span class="dv">3000</span>, <span class="dt">nugget =</span> <span class="dv">1</span>)
vario_fit_uk2 &lt;-<span class="st"> </span><span class="kw">fit.variogram</span>(vario_uk2, <span class="dt">model=</span>model)
vario_fit_uk2</code></pre></div>
<pre><code>##   model      psill    range
## 1   Nug  0.8470453    0.000
## 2   Sph 14.8073531 6243.382</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(vario_uk2, vario_fit_uk2)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-123-2.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">uk2 &lt;-<span class="st"> </span><span class="kw">krige</span>(temp~ndvi+srtm, <span class="dt">locations =</span> punkty, <span class="dt">newdata=</span>siatka, <span class="dt">model=</span>vario_fit_uk2)</code></pre></div>
<pre><code>## [using universal kriging]</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">spplot</span>(uk2, <span class="st">&#39;var1.pred&#39;</span>)
<span class="kw">spplot</span>(uk2, <span class="st">&#39;var1.var&#39;</span>)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/plotsy4ked-1.png" alt="" /><!-- --></p>
<!--chapter:end:10-dane_uzupelniajace.Rmd-->
</div>
</div>
</div>
<div id="ocena-jakosci-estymacji-uwaga-pomieszany-me-z-reszta" class="section level1">
<h1><span class="header-section-number">12</span> Ocena jakości estymacji [UWAGA POMIESZANY ME Z RESZTĄ!!]</h1>
<div id="statystyki-jakosci-estymacji" class="section level2">
<h2><span class="header-section-number">12.1</span> Statystyki jakości estymacji</h2>
<div id="statystyki-jakosci-estymacji-1" class="section level3">
<h3><span class="header-section-number">12.1.1</span> Statystyki jakości estymacji</h3>
<ul>
<li>Służą do oceny i porównania jakości estymacji</li>
<li>Do podstawowych statystyk ocen jakości estymacji należą:
<ul>
<li>Średni błąd estymacji (ME, ang. <em>mean error</em>)</li>
<li>Pierwiastek średniego błędu kwadratowego (RMSE, ang. <em>root square prediction error</em>)</li>
<li>Współczynnik korelacji</li>
<li>Rozkład błędu (np. 5. percentyl, mediana, 95. percentyl)</li>
</ul></li>
</ul>
</div>
<div id="statystyki-jakosci-estymacji-2" class="section level3">
<h3><span class="header-section-number">12.1.2</span> Statystyki jakości estymacji</h3>
<ul>
<li>Idealna estymacja dawałaby brak błędu oraz wspołczynnik korelacji pomiędzy pomiarami (całą populacją) i szacunkiem równy 1</li>
<li>Wysokie, pojedyncze wartości błędu mogą świadczyć, np. o wystapieniu wartości odstających</li>
</ul>
</div>
<div id="sredni-bad-estymacji" class="section level3">
<h3><span class="header-section-number">12.1.3</span> Średni błąd estymacji</h3>
<ul>
<li>Optymalnie wartość średniego błędu estymacji powinna być jak najbliżej 0</li>
</ul>
<p><span class="math display">\[ ME=\frac{\sum_{i=1}^{n}(\hat{v}_i-v_i)}{n} \]</span><br />
### Pierwiastek średniego błędu kwadratowego - Optymalnie wartość pierwiastka średniego błędu kwadratowego powinna być jak najmniejsza</p>
<p><span class="math display">\[ RMSE=\sqrt{\frac{\sum_{i=1}^{n}(\hat{v}_i-v_i)^2}{n}} \]</span></p>
</div>
<div id="wspoczynnik-korelacji-1" class="section level3">
<h3><span class="header-section-number">12.1.4</span> Współczynnik korelacji</h3>
<ul>
<li>Optymalnie wartość współczynnika korelacji powinna być jak najwyższa</li>
</ul>
</div>
<div id="statystyki-jakosci-estymacji-mapa" class="section level3">
<h3><span class="header-section-number">12.1.5</span> Statystyki jakości estymacji | Mapa</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&#39;geostatbook&#39;</span>)
<span class="kw">data</span>(punkty)</code></pre></div>
<pre><code>## [using simple kriging]</code></pre>
<p><img src="Geostatystyka_files/figure-html/mapa-1.png" alt="" /><!-- --></p>
</div>
<div id="statystyki-jakosci-estymacji-histogram" class="section level3">
<h3><span class="header-section-number">12.1.6</span> Statystyki jakości estymacji | Histogram</h3>
<p><img src="Geostatystyka_files/figure-html/hist-1.png" alt="" /><!-- --></p>
</div>
<div id="statystyki-jakosci-estymacji-wykres-rozrzutu" class="section level3">
<h3><span class="header-section-number">12.1.7</span> Statystyki jakości estymacji | Wykres rozrzutu</h3>
<p><img src="Geostatystyka_files/figure-html/point-1.png" alt="" /><!-- --></p>
</div>
</div>
<div id="walidacja-wynikow-estymacji" class="section level2">
<h2><span class="header-section-number">12.2</span> Walidacja wyników estymacji</h2>
<div id="walidacja-wynikow-estymacji-1" class="section level3">
<h3><span class="header-section-number">12.2.1</span> Walidacja wyników estymacji</h3>
<ul>
<li>Dokładne dopasowanie modelu do danych może w efekcie nie dawać najlepszych wyników</li>
<li>W efekcie ważne jest stosowanie metod pozwalających na wybranie optymalnego modelu</li>
<li>Do takich metod należy, między innymi, walidacja podzbiorem (ang. <em>jackknifing</em>) oraz kroswalidacja (ang. <em>crossvalidation</em>)</li>
</ul>
</div>
<div id="walidacja-podzbiorem" class="section level3">
<h3><span class="header-section-number">12.2.2</span> Walidacja podzbiorem</h3>
<ul>
<li>Polega na podziale zbioru danych na dwa podzbiory - treningowy i testowy</li>
<li>Zbiór treningowy służy do estymacji wartości</li>
<li>Wynik estymacji porównywany jest z rzeczywistymi wartościami ze zbioru testowego</li>
<li>Zaletą tego podejścia jest stosowanie danych niezależnych od estymacji</li>
<li>Wadą jest konieczność posiadania dużego zbioru danych</li>
</ul>
</div>
<div id="walidacja-podzbiorem-1" class="section level3">
<h3><span class="header-section-number">12.2.3</span> Walidacja podzbiorem</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">124</span>)
indeks &lt;-<span class="st"> </span><span class="kw">as.vector</span>(<span class="kw">createDataPartition</span>(punkty$temp, <span class="dt">p=</span><span class="fl">0.75</span>, <span class="dt">list=</span><span class="ot">FALSE</span>))
indeks</code></pre></div>
<pre><code>##   [1]   2   3   5   6   7   8  11  12  13  14  15  16  18  19  20  21  22
##  [18]  24  25  26  28  30  31  32  34  35  36  38  40  41  42  46  48  49
##  [35]  50  53  55  58  61  63  64  66  68  69  71  72  73  74  75  76  78
##  [52]  79  81  82  83  84  86  87  88  89  90  91  92  93  95  96  97  98
##  [69]  99 100 101 102 103 104 105 106 107 108 109 110 111 113 114 115 117
##  [86] 119 120 122 123 124 126 127 128 129 131 132 133 134 135 136 138 139
## [103] 141 142 143 144 145 146 147 148 150 151 153 156 157 158 159 161 162
## [120] 163 164 165 166 167 168 169 170 171 173 174 176 178 180 181 182 183
## [137] 184 185 186 187 189 190 191 192 193 194 195 196 198 199 201 202 203
## [154] 204 206 207 210 211 213 214 215 216 217 218 219 221 222 223 225 227
## [171] 228 229 230 231 232 233 234 235 236 237 238 240 241 242 243 244 245
## [188] 246 248 249 250 251</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">train &lt;-<span class="st"> </span>punkty[indeks, ]
test &lt;-<span class="st"> </span>punkty[-indeks, ]
vario &lt;-<span class="st"> </span><span class="kw">variogram</span>(temp~<span class="dv">1</span>, <span class="dt">data=</span>train)
model &lt;-<span class="st"> </span><span class="kw">vgm</span>(<span class="dv">10</span>, <span class="dt">model =</span> <span class="st">&#39;Sph&#39;</span>, <span class="dt">range =</span> <span class="dv">4000</span>, <span class="dt">nugget =</span> <span class="fl">0.5</span>)
fitted &lt;-<span class="st"> </span><span class="kw">fit.variogram</span>(vario, model)
<span class="kw">plot</span>(vario, <span class="dt">model=</span>fitted)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-126-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">test_sk &lt;-<span class="st"> </span><span class="kw">krige</span>(temp~<span class="dv">1</span>, train, test, <span class="dt">model=</span>fitted, <span class="dt">beta=</span><span class="fl">15.324</span>)</code></pre></div>
<pre><code>## [using simple kriging]</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(test_sk)</code></pre></div>
<pre><code>## Object of class SpatialPointsDataFrame
## Coordinates:
##        min      max
## x 745947.9 756963.6
## y 712721.8 720961.5
## Is projected: TRUE 
## proj4string :
## [+init=epsg:2180 +proj=tmerc +lat_0=0 +lon_0=19 +k=0.9993
## +x_0=500000 +y_0=-5300000 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0
## +units=m +no_defs]
## Number of points: 60
## Data attributes:
##    var1.pred         var1.var    
##  Min.   : 9.557   Min.   :1.767  
##  1st Qu.:12.603   1st Qu.:2.251  
##  Median :15.391   Median :2.612  
##  Mean   :15.634   Mean   :2.696  
##  3rd Qu.:17.426   3rd Qu.:3.097  
##  Max.   :24.848   Max.   :4.622</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">reszta_sk &lt;-<span class="st">  </span>test_sk$var1.pred -<span class="st"> </span>test$temp
<span class="kw">summary</span>(reszta_sk)</code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
## -5.1500 -0.6094  0.2412  0.1428  0.8380  3.9580</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ME &lt;-<span class="st"> </span><span class="kw">sum</span>(reszta_sk)/<span class="kw">length</span>(reszta_sk)
ME</code></pre></div>
<pre><code>## [1] 0.1427624</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">RMSE &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">sum</span>(reszta_sk^<span class="dv">2</span>)/<span class="kw">length</span>(reszta_sk))
RMSE</code></pre></div>
<pre><code>## [1] 1.553077</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">srednia_reszta &lt;-<span class="st"> </span>test$temp -<span class="st"> </span><span class="kw">mean</span>(test$temp)
R2 &lt;-<span class="st"> </span><span class="dv">1</span> -<span class="st"> </span><span class="kw">sum</span>(reszta_sk^<span class="dv">2</span>)/<span class="kw">sum</span>(srednia_reszta^<span class="dv">2</span>)
R2</code></pre></div>
<pre><code>## [1] 0.8579729</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">test_sk$reszty &lt;-<span class="st"> </span>reszta_sk
<span class="kw">spplot</span>(test_sk, <span class="st">&#39;reszty&#39;</span>)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/unnamed-chunk-126-2.png" alt="" /><!-- --></p>
</div>
<div id="kroswalidacja" class="section level3">
<h3><span class="header-section-number">12.2.4</span> Kroswalidacja</h3>
<ul>
<li>W przypadku kroswalidacji te same dane wykorzystywane są do budowy modelu, estymacji, a następnie do oceny prognozy</li>
<li>Procedura kroswalidacji LOO (ang. <em>leave-one-out cross-validation</em>)</li>
</ul>
<ol style="list-style-type: decimal">
<li>Zbudowanie matematycznego modelu z dostępnych obserwacji</li>
<li>Dla każdej znanej obserwacji następuje:
<ul>
<li>Usunięcie jej ze zbioru danych</li>
<li>Użycie modelu do wykonania predykcji w miejscu tej obserwacji</li>
<li>Wyliczenie reszty (ang. <em>residual</em>), czyli różnicy pomiędzy znaną wartością a obserwacją</li>
</ul></li>
<li>Podsumowanie otrzymanych wyników</li>
</ol>
<ul>
<li>W pakiecie <code>gstat</code>, kroswalidacja LOO jest dostępna w funkcjach <code>krige.cv</code> oraz <code>gstat.cv</code></li>
</ul>
</div>
<div id="kroswalidacja-1" class="section level3">
<h3><span class="header-section-number">12.2.5</span> Kroswalidacja</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vario &lt;-<span class="st"> </span><span class="kw">variogram</span>(temp~<span class="dv">1</span>, <span class="dt">data=</span>punkty)
model &lt;-<span class="st"> </span><span class="kw">vgm</span>(<span class="dv">10</span>, <span class="dt">model =</span> <span class="st">&#39;Sph&#39;</span>, <span class="dt">range =</span> <span class="dv">4000</span>, <span class="dt">nugget =</span> <span class="fl">0.5</span>)
fitted &lt;-<span class="st"> </span><span class="kw">fit.variogram</span>(vario, model)

cv_sk &lt;-<span class="st"> </span><span class="kw">krige.cv</span>(temp~<span class="dv">1</span>, punkty, <span class="dt">model=</span>fitted, <span class="dt">beta=</span><span class="fl">15.324</span>)
<span class="kw">summary</span>(cv_sk)</code></pre></div>
<pre><code>## Object of class SpatialPointsDataFrame
## Coordinates:
##        min      max
## x 745619.3 756963.6
## y 712664.4 721253.9
## Is projected: NA 
## proj4string : [NA]
## Number of points: 252
## Data attributes:
##    var1.pred         var1.var        observed         residual       
##  Min.   : 8.975   Min.   :1.593   Min.   : 8.153   Min.   :-5.47105  
##  1st Qu.:12.482   1st Qu.:2.016   1st Qu.:12.459   1st Qu.:-0.83011  
##  Median :15.102   Median :2.325   Median :15.210   Median :-0.12253  
##  Mean   :15.546   Mean   :2.477   Mean   :15.522   Mean   :-0.02396  
##  3rd Qu.:17.743   3rd Qu.:2.760   3rd Qu.:18.258   3rd Qu.: 0.85718  
##  Max.   :25.531   Max.   :7.124   Max.   :26.700   Max.   : 4.91660  
##      zscore               fold       
##  Min.   :-3.641395   Min.   :  1.00  
##  1st Qu.:-0.554410   1st Qu.: 63.75  
##  Median :-0.083264   Median :126.50  
##  Mean   :-0.003519   Mean   :126.50  
##  3rd Qu.: 0.597911   3rd Qu.:189.25  
##  Max.   : 2.890799   Max.   :252.00</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">spplot</span>(cv_sk, <span class="st">&#39;residual&#39;</span>)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/loovv-1.png" alt="" /><!-- --></p>
<!-- 


```r
# ok_loocv <- krige.cv(temp~1, punkty, model=model_zl2)
# summary(ok_loocv)
```

- Tutaj inne przykłady
- Wykresy z loocv
- wykresy porównujące


```r
# ok_fit <- gstat(formula=temp~1, data=punkty, model=model_zl2)
# ok_loocv <- gstat.cv(OK_fit, debug.level=0, random=FALSE)
# spplot(pe[6])
```

## 
- prezentacja 5 Ani
- spatinter folder
- AIC

## Walidacja wyników estymacji

### Walidacja wyników estymacji |  Kriging zwykły - LOO crossvalidation
krige.cv


```r
# OK_fit <- gstat(id="OK_fit", formula=temp~1, data=punkty, model=fitted)
# pe <- gstat.cv(OK_fit, debug.level=0, random=FALSE)
# spplot(pe[6])
# 
# z <- predict(OK_fit, newdata = grid, debug.level = 0)
# grid2 <- grid
# grid2$OK_pred <- z$OK_fit.pred
# grid2$OK_se <- sqrt(z$OK_fit.var)
# library('rasterVis')
# spplot(grid2, 'OK_pred')
# spplot(grid2, 'OK_se')
```

### Walidacja wyników estymacji |  K  Kriging uniwersalny - LOO crossvalidation


```r
# KU_fit <- gstat(id="KU_fit", formula=temp~odl_od_morza, data=punkty, model=fitted_ku)
# pe <- gstat.cv(KU_fit, debug.level=0, random=FALSE)
# spplot(pe[6])

# dodanie odległości od morza do siatki !!
# z_KU <- predict(KU_fit, newdata = grid, debug.level = 0)
# grid$KU_pred <- z$KU_fit.pred
# grid$KU_se <- sqrt(z$KU_fit.var)
# library('rasterVis')
# spplot(grid, 'KU_pred')
# spplot(grid, 'KU_se')
```
-->
<!--chapter:end:11-ocena.Rmd-->
</div>
</div>
</div>
<div id="symulacje" class="section level1">
<h1><span class="header-section-number">13</span> Symulacje</h1>
<!--
## Symulacje przestrzenne 1:
 sekwencyjna symulacja i ko symulacja gaussowska,
  sekwencyjna symulacja danych kodowanych, 
  przetwarzanie (postprocesing) wyników symulacji
-->
<div id="symulacje-geostatystyczne" class="section level2">
<h2><span class="header-section-number">13.1</span> Symulacje geostatystyczne</h2>
<div id="symulacje-geostatystyczne-1" class="section level3">
<h3><span class="header-section-number">13.1.1</span> Symulacje geostatystyczne</h3>
<ul>
<li>Kriging daje optymalne predykcje, czyli wyznacza najbardziej potencjalnie możliwą wartość dla wybranej lokalizacji</li>
<li>Dodatkowo, efektem krigingu jest wygładzony obraz. W konsekwencji wyniki estymacji różnią się od danych pomiarowych</li>
<li>Jest to tylko (aż?) predykcja. Prawdziwa wartość jest niepewna …</li>
<li>Korzystając z symulacji geostatystycznych nie tworzymy predykcji, ale generujemy równie prawdopodobne możliwości poprzez symulację z rozkładu prawdopodobieństwa (wykorzystując genereator liczb losowych)</li>
</ul>
</div>
<div id="symulacje-geostatystyczne-cel" class="section level3">
<h3><span class="header-section-number">13.1.2</span> Symulacje geostatystyczne | Cel</h3>
<ul>
<li>Efekt symulacji ma bardziej realistyczny przestrzenny wzór (ang. <em>pattern</em>) niż kriging, którego efektem jest wygładzona reprezentacja rzeczywistości</li>
<li>Każda z symulowanych map jest równie prawdopodobna</li>
<li>Symulacje pozwalają na przedstawianie niepewności interpolacji</li>
<li>Jednocześnie - kriging jest znacznie lepszy, gdy naszym celem jest jak najdokładniejsza predykcja</li>
</ul>
</div>
</div>
<div id="typy-symulacji" class="section level2">
<h2><span class="header-section-number">13.2</span> Typy symulacji</h2>
<div id="typy-symulacji-1" class="section level3">
<h3><span class="header-section-number">13.2.1</span> Typy symulacji</h3>
<ul>
<li>Symulacje bezwarunkowe (ang. Unconditional Simulations) - wykorzystuje semiwariogram, żeby włączyć informację przestrzenną, ale wartości ze zmierzonych punktów nie są wykorzystywane.</li>
<li>Symulacje warunkowe (ang. Conditional Simulations) - opiera się ona o średnią wartość, strukturę kowariancji oraz obserwowane wartości</li>
</ul>
</div>
</div>
<div id="symulacje-bezwarunkowe" class="section level2">
<h2><span class="header-section-number">13.3</span> Symulacje bezwarunkowe</h2>
<!--
http://santiago.begueria.es/2010/10/generating-spatially-correlated-random-fields-with-r/
-->
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&#39;geostatbook&#39;</span>)
<span class="kw">data</span>(punkty)
<span class="kw">data</span>(siatka)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sym_bezw1 &lt;-<span class="st"> </span><span class="kw">krige</span>(<span class="dt">formula=</span>z~<span class="dv">1</span>, <span class="dt">locations=</span><span class="ot">NULL</span>, <span class="dt">newdata=</span>siatka, <span class="dt">dummy=</span><span class="ot">TRUE</span>,
                         <span class="dt">beta=</span><span class="dv">1</span>, <span class="dt">model=</span><span class="kw">vgm</span>(<span class="dt">psill=</span><span class="fl">0.025</span>,<span class="dt">model=</span><span class="st">&#39;Exp&#39;</span>,<span class="dt">range=</span><span class="dv">100</span>), <span class="dt">nsim=</span><span class="dv">4</span>, <span class="dt">nmax=</span><span class="dv">30</span>)</code></pre></div>
<pre><code>## [using unconditional Gaussian simulation]</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">spplot</span>(sym_bezw1, <span class="dt">main=</span><span class="st">&#39;Przestrzennie skorelowana powierzchnia </span><span class="ch">\n</span><span class="st">średnia=1, sill=0.025, zasięg=100, model wykładniczy&#39;</span>)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/sym_bezw1-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sym_bezw2 &lt;-<span class="st"> </span><span class="kw">krige</span>(<span class="dt">formula=</span>z~<span class="dv">1</span>, <span class="dt">locations=</span><span class="ot">NULL</span>, <span class="dt">newdata=</span>siatka, <span class="dt">dummy=</span><span class="ot">TRUE</span>, 
                   <span class="dt">beta=</span><span class="dv">1</span>, <span class="dt">model=</span><span class="kw">vgm</span>(<span class="dt">psill=</span><span class="fl">0.025</span>,<span class="dt">model=</span><span class="st">&#39;Exp&#39;</span>,<span class="dt">range=</span><span class="dv">1500</span>), <span class="dt">nsim=</span><span class="dv">4</span>, <span class="dt">nmax=</span><span class="dv">30</span>)</code></pre></div>
<pre><code>## [using unconditional Gaussian simulation]</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">spplot</span>(sym_bezw2, <span class="dt">main=</span><span class="st">&#39;Przestrzennie skorelowana powierzchnia </span><span class="ch">\n</span><span class="st">średnia=1, sill=0.025, zasięg=1500, model wykładniczy&#39;</span>)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/sym_bezw2-1.png" alt="" /><!-- --></p>
<!--
sym_bezw_model3 <- gstat(formula=~1+X+Y, locations=~X+Y, dummy=T, beta=c(1,0,0.005), model=vgm(psill=0.025,model='Exp',range=1500), nmax=20)
sym_bezw3 <- predict(sym_bezw_model3, newdata=siatka, nsim=4)
spplot(sym_bezw3, main="Przestrzennie skorelowana powierzchnia \nśrednia=1, sill=0.025, zasięg=1500, model wykładniczy \ntrend na osi y = 0.005")

sym_bezw_model4 <- gstat(formula=~1+X+Y, locations=~X+Y, dummy=T, beta=c(1,0.02,0.005), model=vgm(psill=0.025,model='Exp',range=1500), nmax=20)
sym_bezw4 <- predict(sym_bezw_model4, newdata=siatka, nsim=4)
spplot(sym_bezw4, main="Przestrzennie skorelowana powierzchnia \nśrednia=1, sill=0.025, zasięg=500, model wykładniczy \ntrend na osi x = 0.02, trend na osi y = 0.005")
-->
</div>
<div id="symulacje-warunkowe" class="section level2">
<h2><span class="header-section-number">13.4</span> Symulacje warunkowe</h2>
<div id="sekwencyjna-symulacja-gaussowska-ang.-sequential-gaussian-simulation" class="section level3">
<h3><span class="header-section-number">13.4.1</span> Sekwencyjna symulacja gaussowska (ang. <em>Sequential Gaussian simulation</em>)</h3>
<ol style="list-style-type: decimal">
<li>Wybranie lokalizacji nie posiadającej zmierzonej wartości badanej zmiennej</li>
<li>Kriging wartości tej lokalizacji korzystając z dostepnych danych, co pozwala na uzyskanie rozkładu prawdopodobieństwa badanej zmiennej</li>
<li>Wylosowanie wartości z rozkładu prawdopodobieństwa za pomocą generatora liczba losowych i przypisanie tej wartości do lokalizacji</li>
<li>Dodanie symulowaniej wartości do zbioru danych i przejście do kolejnej lokalizacji</li>
<li>Powtórzenie poprzednich kroków, aż do momentu gdy nie pozostanie już żadna nieokreślona lokalizacja</li>
</ol>
</div>
<div id="sekwencyjna-symulacja-gaussowska-ang.-sequential-gaussian-simulation-1" class="section level3">
<h3><span class="header-section-number">13.4.2</span> Sekwencyjna symulacja gaussowska (ang. <em>Sequential Gaussian simulation</em>)</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vario &lt;-<span class="st"> </span><span class="kw">variogram</span>(temp~<span class="dv">1</span>, punkty)
model &lt;-<span class="st"> </span><span class="kw">vgm</span>(<span class="dv">10</span>, <span class="dt">model =</span> <span class="st">&#39;Sph&#39;</span>, <span class="dt">range =</span> <span class="dv">4500</span>, <span class="dt">nugget=</span><span class="dv">1</span>)
fitted &lt;-<span class="st"> </span><span class="kw">fit.variogram</span>(vario, model)
<span class="kw">plot</span>(vario, <span class="dt">model=</span>fitted)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/sym_ok-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sym_ok &lt;-<span class="st"> </span><span class="kw">krige</span>(temp~<span class="dv">1</span>, punkty, siatka, <span class="dt">model=</span>fitted, <span class="dt">nsim=</span><span class="dv">4</span>, <span class="dt">nmax=</span><span class="dv">30</span>)</code></pre></div>
<pre><code>## drawing 4 GLS realisations of beta...
## [using conditional Gaussian simulation]</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">spplot</span>(sym_ok)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/sym_ok-2.png" alt="" /><!-- --></p>
</div>
<div id="sekwencyjna-symulacja-gaussowska-ang.-sequential-gaussian-simulation-2" class="section level3">
<h3><span class="header-section-number">13.4.3</span> Sekwencyjna symulacja gaussowska (ang. <em>Sequential Gaussian simulation</em>)</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sym_sk &lt;-<span class="st"> </span><span class="kw">krige</span>(temp~<span class="dv">1</span>, punkty, siatka, <span class="dt">model=</span>fitted, <span class="dt">beta=</span><span class="fl">15.324</span>, <span class="dt">nsim=</span><span class="dv">100</span>, <span class="dt">nmax=</span><span class="dv">30</span>)</code></pre></div>
<pre><code>## [using conditional Gaussian simulation]</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sym_sk &lt;-<span class="st"> </span><span class="kw">stack</span>(sym_sk)
sym_sk_sd &lt;-<span class="st"> </span><span class="kw">calc</span>(sym_sk, <span class="dt">fun =</span> sd)
<span class="kw">spplot</span>(sym_sk_sd)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/master_symulation-1.png" alt="" /><!-- --></p>
</div>
</div>
<div id="sekwencyjna-symulacja-danych-kodowanych-ang.-sequential-indicator-simulation" class="section level2">
<h2><span class="header-section-number">13.5</span> Sekwencyjna symulacja danych kodowanych (ang. <em>Sequential indicator simulation</em>)</h2>
<div id="sekwencyjna-symulacja-danych-kodowanych-ang.-sequential-indicator-simulation-1" class="section level3">
<h3><span class="header-section-number">13.5.1</span> Sekwencyjna symulacja danych kodowanych (ang. <em>Sequential indicator simulation</em>)</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(punkty$temp) </code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   8.153  12.460  15.210  15.520  18.260  26.700</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">punkty$temp_ind &lt;-<span class="st"> </span>punkty$temp &lt;<span class="st"> </span><span class="dv">12</span>
<span class="kw">summary</span>(punkty$temp_ind) </code></pre></div>
<pre><code>##    Mode   FALSE    TRUE    NA&#39;s 
## logical     198      54       0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vario_ind &lt;-<span class="st"> </span><span class="kw">variogram</span>(temp_ind~<span class="dv">1</span>, punkty)         
<span class="kw">plot</span>(vario_ind)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/sym_ind-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model_ind &lt;-<span class="st"> </span><span class="kw">vgm</span>(<span class="fl">0.14</span>, <span class="dt">model =</span> <span class="st">&#39;Sph&#39;</span>, <span class="dt">range =</span> <span class="dv">2000</span>, <span class="dt">nugget =</span> <span class="fl">0.02</span>)
<span class="kw">plot</span>(vario_ind, <span class="dt">model=</span>model_ind)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/sym_ind-2.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fitted_ind &lt;-<span class="st"> </span><span class="kw">fit.variogram</span>(vario_ind, model_ind)
fitted_ind</code></pre></div>
<pre><code>##   model      psill    range
## 1   Nug 0.02543208    0.000
## 2   Sph 0.13620532 1565.761</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(vario_ind, <span class="dt">model=</span>fitted_ind)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/sym_ind-3.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sym_ind &lt;-<span class="st"> </span><span class="kw">krige</span>(temp_ind~<span class="dv">1</span>, punkty, siatka, <span class="dt">model=</span>fitted_ind, <span class="dt">indicators=</span><span class="ot">TRUE</span>, <span class="dt">nsim=</span><span class="dv">4</span>, <span class="dt">nmax=</span><span class="dv">30</span>)</code></pre></div>
<pre><code>## drawing 4 GLS realisations of beta...
## [using conditional indicator simulation]</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">spplot</span>(sym_ind, <span class="dt">main=</span><span class="st">&#39;Symulacje warunkowe&#39;</span>)</code></pre></div>
<p><img src="Geostatystyka_files/figure-html/sym_ind-4.png" alt="" /><!-- --></p>
<!--
łączenie sis - wiele symulacji
-->
<!--chapter:end:12-symulacje.Rmd-->
</div>
</div>
</div>
<div id="bibliografia" class="section level1">
<h1><span class="header-section-number">14</span> Bibliografia</h1>
<!--chapter:end:13-references.Rmd-->
</div>
<!--bookdown:body:end-->
            </section>

          </div>
        </div>
      </div>
<!--bookdown:link_prev-->
<!--bookdown:link_next-->

<!--bookdown:config-->


</body>

</html>
