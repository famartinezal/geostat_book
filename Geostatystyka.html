<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Geostatystyka</title>
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
  <meta name="description" content="Geostatystyka">
  <meta name="generator" content="bookdown <!--bookdown:version--> and GitBook 2.6.7">

<meta name="author" content="Jakub Nowosad">

<meta name="date" content="2016-03-03">

  <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>

  <meta name="HandheldFriendly" content="true">
  <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<!--bookdown:link_prev-->
<!--bookdown:link_next-->

<link href="book_assets/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<script src="book_assets/gitbook-2.6.7/js/app.js"></script>
<script src="book_assets/gitbook-2.6.7/js/lunr.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="book_assets/gitbook-2.6.7/js/jquery.highlight.js"></script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>


<!--bookdown:title:start-->
<div id="header">
<h1 class="title">Geostatystyka</h1>
<h4 class="author"><em>Jakub Nowosad</em></h4>
<h4 class="date"><em>2016-03-03</em></h4>
</div>
<!--bookdown:title:end-->

<!--bookdown:toc:start-->
  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">
<!--bookdown:toc2:start-->
<ul>
<li><a href="#dzien-dobry"><span class="toc-section-number">1</span> Dzień dobry</a></li>
<li><a href="#intro"><span class="toc-section-number">2</span> Wprowadzenie</a><ul>
<li><a href="#wprowadzenie"><span class="toc-section-number">2.1</span> Wprowadzenie</a><ul>
<li><a href="#program-zajec"><span class="toc-section-number">2.1.1</span> Program zajęć</a></li>
<li><a href="#formy-oceny"><span class="toc-section-number">2.1.2</span> Formy oceny</a></li>
<li><a href="#kodeks-honorowy"><span class="toc-section-number">2.1.3</span> Kodeks honorowy</a></li>
<li><a href="#zroda-wiedzy"><span class="toc-section-number">2.1.4</span> Źródła wiedzy</a></li>
</ul></li>
<li><a href="#wolin"><span class="toc-section-number">2.2</span> Wolin</a><ul>
<li><a href="#mapa-topograficzna"><span class="toc-section-number">2.2.1</span> Mapa topograficzna</a></li>
<li><a href="#obraz-satelitarny"><span class="toc-section-number">2.2.2</span> Obraz satelitarny</a></li>
<li><a href="#rzezba-terenu"><span class="toc-section-number">2.2.3</span> Rzeźba terenu</a></li>
<li><a href="#pokrycieuzytkowanie-terenu"><span class="toc-section-number">2.2.4</span> Pokrycie/użytkowanie terenu</a></li>
<li><a href="#litologia"><span class="toc-section-number">2.2.5</span> Litologia</a></li>
<li><a href="#wilgotnosc-gruntu"><span class="toc-section-number">2.2.6</span> Wilgotność gruntu</a></li>
</ul></li>
<li><a href="#r-a-dane-przestrzenne"><span class="toc-section-number">2.3</span> R a dane przestrzenne</a><ul>
<li><a href="#pakiety"><span class="toc-section-number">2.3.1</span> Pakiety</a></li>
<li><a href="#reprezentacja-danych-nieprzestrzennych"><span class="toc-section-number">2.3.2</span> Reprezentacja danych nieprzestrzennych</a></li>
<li><a href="#reprezentacja-danych-przestrzennych"><span class="toc-section-number">2.3.3</span> Reprezentacja danych przestrzennych</a></li>
<li><a href="#gdalogr"><span class="toc-section-number">2.3.4</span> GDAL/OGR</a></li>
<li><a href="#proj.4"><span class="toc-section-number">2.3.5</span> PROJ.4</a></li>
<li><a href="#epsg"><span class="toc-section-number">2.3.6</span> EPSG</a></li>
<li><a href="#ukad-geograficzny"><span class="toc-section-number">2.3.7</span> Układ geograficzny</a></li>
</ul></li>
<li><a href="#import-danych"><span class="toc-section-number">2.4</span> Import danych</a><ul>
<li><a href="#dane-punktowe-format-csv"><span class="toc-section-number">2.4.1</span> Dane punktowe (format csv)</a></li>
<li><a href="#dane-punktowe-format-csv-1"><span class="toc-section-number">2.4.2</span> Dane punktowe (format csv)</a></li>
<li><a href="#dane-punktowe-format-csv-2"><span class="toc-section-number">2.4.3</span> Dane punktowe (format csv)</a></li>
<li><a href="#usuwanie-punktow-zawierajacych-braki-wartosci"><span class="toc-section-number">2.4.4</span> Usuwanie punktów zawierających braki wartości</a></li>
<li><a href="#dane-poligonowe-formaty-gisowe"><span class="toc-section-number">2.4.5</span> Dane poligonowe (formaty gisowe)</a></li>
<li><a href="#rastry"><span class="toc-section-number">2.4.6</span> Rastry</a></li>
<li><a href="#siatki-regularne"><span class="toc-section-number">2.4.7</span> Siatki regularne</a></li>
<li><a href="#siatki-nieregularne"><span class="toc-section-number">2.4.8</span> Siatki nieregularne</a></li>
</ul></li>
<li><a href="#eksport-danych"><span class="toc-section-number">2.5</span> Eksport danych</a><ul>
<li><a href="#zapisywanie-danych-wektorowych"><span class="toc-section-number">2.5.1</span> Zapisywanie danych wektorowych</a></li>
<li><a href="#zapisywanie-danych-rastrowych"><span class="toc-section-number">2.5.2</span> Zapisywanie danych rastrowych</a></li>
</ul></li>
<li><a href="#wizualizacja-danych-2d"><span class="toc-section-number">2.6</span> Wizualizacja danych 2D</a><ul>
<li><a href="#dane-punktowe"><span class="toc-section-number">2.6.1</span> Dane punktowe</a></li>
<li><a href="#dane-punktowe-1"><span class="toc-section-number">2.6.2</span> Dane punktowe</a></li>
<li><a href="#dane-punktowe---kategorie"><span class="toc-section-number">2.6.3</span> Dane punktowe - kategorie</a></li>
<li><a href="#rastry-1"><span class="toc-section-number">2.6.4</span> Rastry</a></li>
</ul></li>
<li><a href="#tworzenie-siatek"><span class="toc-section-number">2.7</span> Tworzenie siatek</a><ul>
<li><a href="#siatki-regularne-1"><span class="toc-section-number">2.7.1</span> Siatki regularne</a></li>
<li><a href="#siatki-regularne-2"><span class="toc-section-number">2.7.2</span> Siatki regularne</a></li>
<li><a href="#siatki-nieregularne-1"><span class="toc-section-number">2.7.3</span> Siatki nieregularne</a></li>
<li><a href="#siatki-nieregularne-2"><span class="toc-section-number">2.7.4</span> Siatki nieregularne</a></li>
<li><a href="#siatki-nieregularne-3"><span class="toc-section-number">2.7.5</span> Siatki nieregularne</a></li>
</ul></li>
</ul></li>
<li><a href="#eksploracyjna-analiza-danych"><span class="toc-section-number">3</span> Eksploracyjna analiza danych</a><ul>
<li><a href="#eksploracyjna-analiza-danych-cel"><span class="toc-section-number">3.1</span> Eksploracyjna analiza danych | Cel</a></li>
<li><a href="#dane-wolin"><span class="toc-section-number">3.2</span> Dane Wolin</a><ul>
<li><a href="#dane-wolin-1"><span class="toc-section-number">3.2.1</span> Dane Wolin</a></li>
</ul></li>
<li><a href="#statystyki-opisowe"><span class="toc-section-number">3.3</span> Statystyki opisowe</a><ul>
<li><a href="#statystyki-opisowe-1"><span class="toc-section-number">3.3.1</span> Statystyki opisowe</a></li>
<li><a href="#statystyki-opisowe-srednia-i-mediana"><span class="toc-section-number">3.3.2</span> Statystyki opisowe | średnia i mediana</a></li>
<li><a href="#statystyki-opisowe-srednia-i-mediana-1"><span class="toc-section-number">3.3.3</span> Statystyki opisowe | średnia i mediana</a></li>
<li><a href="#statystyki-opisowe-minimum-i-maksimum"><span class="toc-section-number">3.3.4</span> Statystyki opisowe | minimum i maksimum</a></li>
<li><a href="#statystyki-opisowe-ochylenie-standardowe"><span class="toc-section-number">3.3.5</span> Statystyki opisowe | ochylenie standardowe</a></li>
</ul></li>
<li><a href="#wykresy"><span class="toc-section-number">3.4</span> Wykresy</a><ul>
<li><a href="#histogram"><span class="toc-section-number">3.4.1</span> Histogram</a></li>
<li><a href="#estymator-jadrowy-gestosci-ang.-kernel-density-estimation"><span class="toc-section-number">3.4.2</span> Estymator jądrowy gęstości (ang. <em>kernel density estimation</em>)</a></li>
<li><a href="#wykresy-kwantyl-kwantyl-ang.quantile-quantile"><span class="toc-section-number">3.4.3</span> Wykresy kwantyl-kwantyl (ang.<em>quantile-quantile</em>)</a></li>
<li><a href="#wykresy-kwantyl-kwantyl-ang.-quantile-quantile"><span class="toc-section-number">3.4.4</span> Wykresy kwantyl-kwantyl (ang. <em>quantile-quantile</em>)</a></li>
<li><a href="#dystrybuanta-cdf"><span class="toc-section-number">3.4.5</span> Dystrybuanta (CDF)</a></li>
</ul></li>
<li><a href="#porownanie-zmiennych"><span class="toc-section-number">3.5</span> Porównanie zmiennych</a><ul>
<li><a href="#kowariancja"><span class="toc-section-number">3.5.1</span> Kowariancja</a></li>
<li><a href="#wspoczynnik-korelacji"><span class="toc-section-number">3.5.2</span> Współczynnik korelacji</a></li>
<li><a href="#wspoczynnik-korelacji-1"><span class="toc-section-number">3.5.3</span> Współczynnik korelacji</a></li>
<li><a href="#wspoczynnik-korelacji-2"><span class="toc-section-number">3.5.4</span> Współczynnik korelacji</a></li>
<li><a href="#wspoczynnik-korelacji-3"><span class="toc-section-number">3.5.5</span> Współczynnik korelacji</a></li>
<li><a href="#wykresy-pudekowe"><span class="toc-section-number">3.5.6</span> Wykresy pudełkowe</a></li>
<li><a href="#wykresy-pudekowe-1"><span class="toc-section-number">3.5.7</span> Wykresy pudełkowe</a></li>
<li><a href="#testowanie-istotnosci-roznic-sredniej-pomiedzy-grupami"><span class="toc-section-number">3.5.8</span> Testowanie istotności różnić średniej pomiędzy grupami</a></li>
<li><a href="#testowanie-istotnosci-roznic-sredniej-pomiedzy-grupami-1"><span class="toc-section-number">3.5.9</span> Testowanie istotności różnić średniej pomiędzy grupami</a></li>
</ul></li>
<li><a href="#transformacje-danych"><span class="toc-section-number">3.6</span> Transformacje danych</a><ul>
<li><a href="#transformacje-danych-1"><span class="toc-section-number">3.6.1</span> Transformacje danych</a></li>
<li><a href="#transformacja-danych-logarytmizacja"><span class="toc-section-number">3.6.2</span> Transformacja danych | Logarytmizacja</a></li>
<li><a href="#transformacja-danych-pierwiastkowanie"><span class="toc-section-number">3.6.3</span> Transformacja danych | Pierwiastkowanie</a></li>
<li><a href="#transformacja-danych-rodzina-transformacji-boxa-coxa"><span class="toc-section-number">3.6.4</span> Transformacja danych | Rodzina transformacji Boxa Coxa</a></li>
</ul></li>
<li><a href="#mapy"><span class="toc-section-number">3.7</span> Mapy</a><ul>
<li><a href="#podstawowe-terminy-kontekst-przestrzenny"><span class="toc-section-number">3.7.1</span> Podstawowe terminy | Kontekst przestrzenny</a></li>
<li><a href="#mapy-punktowe-cel"><span class="toc-section-number">3.7.2</span> Mapy punktowe | Cel</a></li>
<li><a href="#typ-probowania"><span class="toc-section-number">3.7.3</span> Typ próbowania</a></li>
<li><a href="#typ-probowania-regularny"><span class="toc-section-number">3.7.4</span> Typ próbowania | Regularny</a></li>
<li><a href="#typ-probowania-losowy"><span class="toc-section-number">3.7.5</span> Typ próbowania | Losowy</a></li>
<li><a href="#typ-probowania-losowy-stratyfikowany"><span class="toc-section-number">3.7.6</span> Typ próbowania | Losowy stratyfikowany</a></li>
<li><a href="#typ-probowania-preferencyjny-i"><span class="toc-section-number">3.7.7</span> Typ próbowania | Preferencyjny I</a></li>
<li><a href="#typ-probowania-liniowy"><span class="toc-section-number">3.7.8</span> Typ próbowania | Liniowy</a></li>
<li><a href="#mapy-punktowe-i-dane-lokalnie-odstajace"><span class="toc-section-number">3.7.9</span> Mapy punktowe i dane lokalnie odstające</a></li>
<li><a href="#mapy-punktowe-i-dane-lokalnie-odstajace-1"><span class="toc-section-number">3.7.10</span> Mapy punktowe i dane lokalnie odstające</a></li>
<li><a href="#mapy-punktowe-i-dane-lokalnie-odstajace-2"><span class="toc-section-number">3.7.11</span> Mapy punktowe i dane lokalnie odstające</a></li>
</ul></li>
<li><a href="#rozgrupowanie-danych"><span class="toc-section-number">3.8</span> Rozgrupowanie danych</a><ul>
<li><a href="#rozgrupowanie-danych-1"><span class="toc-section-number">3.8.1</span> Rozgrupowanie danych</a></li>
<li><a href="#rozgrupowanie-danych-2"><span class="toc-section-number">3.8.2</span> Rozgrupowanie danych</a></li>
<li><a href="#rozgrupowanie-komorkowe-i-ang.-cell-declustering"><span class="toc-section-number">3.8.3</span> Rozgrupowanie komórkowe I | (ang. <em>cell declustering</em>)</a></li>
<li><a href="#rozgrupowanie-komorkowe-i-ang.-cell-declustering-1"><span class="toc-section-number">3.8.4</span> Rozgrupowanie komórkowe I | (ang. <em>cell declustering</em>)</a></li>
<li><a href="#rozgrupowanie-komorkowe-ii-ang.-cell-declustering"><span class="toc-section-number">3.8.5</span> Rozgrupowanie komórkowe II | (ang. <em>cell declustering</em>)</a></li>
<li><a href="#rozgrupowanie-komorkowe-ii-ang.-cell-declustering-1"><span class="toc-section-number">3.8.6</span> Rozgrupowanie komórkowe II | (ang. <em>cell declustering</em>)</a></li>
<li><a href="#rozgrupowanie-poligonowe-ang.-polygon-declustering"><span class="toc-section-number">3.8.7</span> Rozgrupowanie poligonowe | (ang. <em>polygon declustering</em>)</a></li>
<li><a href="#rozgrupowanie-poligonowe-ang.-polygon-declustering-1"><span class="toc-section-number">3.8.8</span> Rozgrupowanie poligonowe | (ang. <em>polygon declustering</em>)</a></li>
</ul></li>
</ul></li>
<li><a href="#eksploracyjna-analiza-danych---geostatystyka"><span class="toc-section-number">4</span> Eksploracyjna analiza danych - geostatystyka</a><ul>
<li><a href="#interpolacja"><span class="toc-section-number">4.1</span> Interpolacja</a><ul>
<li><a href="#modele-deterministyczne"><span class="toc-section-number">4.1.1</span> Modele deterministyczne</a></li>
<li><a href="#modele-deterministyczne-1"><span class="toc-section-number">4.1.2</span> Modele deterministyczne</a></li>
<li><a href="#modele-deterministyczne-funkcje-sklejane"><span class="toc-section-number">4.1.3</span> Modele deterministyczne | Funkcje sklejane</a></li>
<li><a href="#modele-deterministyczne-triangulacje-thiessen"><span class="toc-section-number">4.1.4</span> Modele deterministyczne | Triangulacje (Thiessen)</a></li>
<li><a href="#modele-deterministyczne-idw"><span class="toc-section-number">4.1.5</span> Modele deterministyczne | IDW</a></li>
<li><a href="#modele-deterministyczne-porownanie"><span class="toc-section-number">4.1.6</span> Modele deterministyczne | Porównanie</a></li>
<li><a href="#modele-statystyczne"><span class="toc-section-number">4.1.7</span> Modele statystyczne</a></li>
</ul></li>
<li><a href="#geostatystyka---prolog"><span class="toc-section-number">4.2</span> Geostatystyka - prolog</a><ul>
<li><a href="#geostatystyka"><span class="toc-section-number">4.2.1</span> Geostatystyka</a></li>
<li><a href="#geostatystyka-funkcje"><span class="toc-section-number">4.2.2</span> Geostatystyka | Funkcje</a></li>
<li><a href="#geostatystyczna-analiza-danych"><span class="toc-section-number">4.2.3</span> Geostatystyczna analiza danych</a></li>
<li><a href="#geostatystyka-dane-wejsciowe"><span class="toc-section-number">4.2.4</span> Geostatystyka | Dane wejściowe</a></li>
<li><a href="#geostatystyka-podstawowe-etapy"><span class="toc-section-number">4.2.5</span> Geostatystyka | Podstawowe etapy</a></li>
</ul></li>
<li><a href="#przestrzenna-kowariancja-korelacja-i-semiwariancja"><span class="toc-section-number">4.3</span> Przestrzenna kowariancja, korelacja i semiwariancja</a><ul>
<li><a href="#przestrzenna-kowariancja-korelacja-i-semiwariancja-zaozenia"><span class="toc-section-number">4.3.1</span> Przestrzenna kowariancja, korelacja i semiwariancja | Założenia</a></li>
<li><a href="#przestrzenna-kowariancja-korelacja-i-semiwariancja-1"><span class="toc-section-number">4.3.2</span> Przestrzenna kowariancja, korelacja i semiwariancja</a></li>
<li><a href="#przestrzenna-kowariancja-korelacja-i-semiwariancja-2"><span class="toc-section-number">4.3.3</span> Przestrzenna kowariancja, korelacja i semiwariancja</a></li>
<li><a href="#wykres-rozrzutu-z-przesunieciem"><span class="toc-section-number">4.3.4</span> Wykres rozrzutu z przesunięciem</a></li>
<li><a href="#autokowariancja"><span class="toc-section-number">4.3.5</span> Autokowariancja</a></li>
<li><a href="#autokorelacja"><span class="toc-section-number">4.3.6</span> Autokorelacja</a></li>
<li><a href="#semiwariancja"><span class="toc-section-number">4.3.7</span> Semiwariancja</a></li>
<li><a href="#okreslenie-wystepowania-autokorelacji-przestrzennej-chmura-semiwariogramu"><span class="toc-section-number">4.3.8</span> Określenie występowania autokorelacji przestrzennej | Chmura semiwariogramu</a></li>
<li><a href="#semiwariancja-przykadowe-obliczenia"><span class="toc-section-number">4.3.9</span> Semiwariancja | Przykładowe obliczenia</a></li>
<li><a href="#okreslenie-wystepowania-autokorelacji-przestrzennej-chmura-semiwariogramu-1"><span class="toc-section-number">4.3.10</span> Określenie występowania autokorelacji przestrzennej | Chmura semiwariogramu</a></li>
<li><a href="#okreslenie-wystepowania-autokorelacji-przestrzennej-chmura-semiwariogramu-2"><span class="toc-section-number">4.3.11</span> Określenie występowania autokorelacji przestrzennej | Chmura semiwariogramu</a></li>
<li><a href="#semiwariogram-charakterystyka-struktury-przestrzennej"><span class="toc-section-number">4.3.12</span> Semiwariogram | Charakterystyka struktury przestrzennej</a></li>
<li><a href="#semiwariogram"><span class="toc-section-number">4.3.13</span> Semiwariogram</a></li>
<li><a href="#semiwariogram-rules-of-thumb"><span class="toc-section-number">4.3.14</span> Semiwariogram | Rules of thumb</a></li>
<li><a href="#semiwariogram-obliczenia-pomocnicze"><span class="toc-section-number">4.3.15</span> Semiwariogram | Obliczenia pomocnicze</a></li>
<li><a href="#semiwariogram-maksymalny-zasieg-semiwariogramu-ang.-cutoff-distance"><span class="toc-section-number">4.3.16</span> Semiwariogram | Maksymalny zasięg semiwariogramu (ang. <em>Cutoff distance</em>)</a></li>
<li><a href="#semiwariogram-odlegosc-miedzy-przedziaami-ang-interval-width"><span class="toc-section-number">4.3.17</span> Semiwariogram | Odległość między przedziałami (ang, <em>Interval width </em>)</a></li>
</ul></li>
<li><a href="#anizotropia"><span class="toc-section-number">4.4</span> Anizotropia</a><ul>
<li><a href="#anizotropia-struktury-przestrzennej"><span class="toc-section-number">4.4.1</span> Anizotropia struktury przestrzennej</a></li>
<li><a href="#mapa-semiwariogramu"><span class="toc-section-number">4.4.2</span> Mapa semiwariogramu</a></li>
<li><a href="#mapa-semiwariogramu-3d"><span class="toc-section-number">4.4.3</span> Mapa semiwariogramu | 3D</a></li>
<li><a href="#semiwariogramy-kierunkowe-kierunki"><span class="toc-section-number">4.4.4</span> Semiwariogramy kierunkowe | Kierunki</a></li>
<li><a href="#semiwariogramy-kierunkowe-kierunki-1"><span class="toc-section-number">4.4.5</span> Semiwariogramy kierunkowe | Kierunki</a></li>
</ul></li>
<li><a href="#krossemiwariogramy"><span class="toc-section-number">4.5</span> Krossemiwariogramy</a><ul>
<li><a href="#krossemiwariogramy-1"><span class="toc-section-number">4.5.1</span> Krossemiwariogramy</a></li>
<li><a href="#krossemiwariogramy-2"><span class="toc-section-number">4.5.2</span> Krossemiwariogramy</a></li>
<li><a href="#krossemiwariogramy-3"><span class="toc-section-number">4.5.3</span> Krossemiwariogramy</a></li>
</ul></li>
</ul></li>
<li><a href="#modelowanie-matematycznie-autokorelacji-przestrzennej"><span class="toc-section-number">5</span> Modelowanie matematycznie autokorelacji przestrzennej</a><ul>
<li><a href="#modelowanie-matematycznie-autokorelacji-przestrzennej-1"><span class="toc-section-number">5.0.1</span> Modelowanie matematycznie autokorelacji przestrzennej</a></li>
<li><a href="#modele-podstawowe"><span class="toc-section-number">5.1</span> Modele podstawowe</a><ul>
<li><a href="#modele-podstawowe-1"><span class="toc-section-number">5.1.1</span> Modele podstawowe</a></li>
<li><a href="#modele-podstawowe-2"><span class="toc-section-number">5.1.2</span> Modele podstawowe</a></li>
<li><a href="#modele-podstawowe-3"><span class="toc-section-number">5.1.3</span> Modele podstawowe</a></li>
<li><a href="#modele-podstawowe-4"><span class="toc-section-number">5.1.4</span> Modele podstawowe</a></li>
<li><a href="#modele-podstawowe-5"><span class="toc-section-number">5.1.5</span> Modele podstawowe</a></li>
</ul></li>
<li><a href="#metody-modelowania"><span class="toc-section-number">5.2</span> Metody modelowania</a><ul>
<li><a href="#metody-modelowania-1"><span class="toc-section-number">5.2.1</span> Metody modelowania</a></li>
<li><a href="#metody-modelowania-2"><span class="toc-section-number">5.2.2</span> Metody modelowania</a></li>
<li><a href="#metody-modelowania-liniowy-model-regionalizacji"><span class="toc-section-number">5.2.3</span> Metody modelowania | Liniowy model regionalizacji</a></li>
</ul></li>
<li><a href="#modelowanie-semiwariogramu"><span class="toc-section-number">5.3</span> Modelowanie semiwariogramu</a><ul>
<li><a href="#modelowanie-semiwariogramu-funkcja-fit.variogram"><span class="toc-section-number">5.3.1</span> Modelowanie semiwariogramu | funkcja <em>fit.variogram</em></a></li>
</ul></li>
<li><a href="#modelowanie-izotropowe"><span class="toc-section-number">5.4</span> Modelowanie izotropowe</a><ul>
<li><a href="#modelowanie-izotropowe-modelowanie-wizualne"><span class="toc-section-number">5.4.1</span> Modelowanie izotropowe | Modelowanie “wizualne”</a></li>
<li><a href="#modelowanie-izotropowe-model-nuggetowy"><span class="toc-section-number">5.4.2</span> Modelowanie izotropowe | Model nuggetowy</a></li>
<li><a href="#modelowanie-izotropowe-model-sferyczny"><span class="toc-section-number">5.4.3</span> Modelowanie izotropowe | Model sferyczny</a></li>
<li><a href="#modelowanie-izotropowe-model-gaussowski"><span class="toc-section-number">5.4.4</span> Modelowanie izotropowe | Model Gaussowski</a></li>
<li><a href="#modelowanie-izotropowe-model-potegowy"><span class="toc-section-number">5.4.5</span> Modelowanie izotropowe | Model potęgowy</a></li>
<li><a href="#modelowanie-izotropowe-model-wykadniczy"><span class="toc-section-number">5.4.6</span> Modelowanie izotropowe | Model wykładniczy</a></li>
<li><a href="#modelowanie-izotropowe-modele-zozone-i"><span class="toc-section-number">5.4.7</span> Modelowanie izotropowe | Modele złożone I</a></li>
<li><a href="#modelowanie-izotropowe-modele-zozone-ii"><span class="toc-section-number">5.4.8</span> Modelowanie izotropowe | Modele złożone II</a></li>
</ul></li>
<li><a href="#modelowanie-anizotropowe"><span class="toc-section-number">5.5</span> Modelowanie anizotropowe</a><ul>
<li><a href="#anizotropia-1"><span class="toc-section-number">5.5.1</span> Anizotropia</a></li>
</ul></li>
<li><a href="#modelowanie-krossemiwariogramow"><span class="toc-section-number">5.6</span> Modelowanie krossemiwariogramów</a><ul>
<li><a href="#modelowanie-krossemiwariogramow-fit.lmc"><span class="toc-section-number">5.6.1</span> Modelowanie krossemiwariogramów | <em>fit.lmc</em></a></li>
<li><a href="#modelowanie-krossemiwariogramow-1"><span class="toc-section-number">5.6.2</span> Modelowanie krossemiwariogramów</a></li>
</ul></li>
</ul></li>
<li><a href="#estymacje-jednozmienne"><span class="toc-section-number">6</span> Estymacje jednozmienne</a><ul>
<li><a href="#kriging"><span class="toc-section-number">6.1</span> Kriging</a><ul>
<li><a href="#kriging-interpolacja-geostatystyczna"><span class="toc-section-number">6.1.1</span> Kriging | Interpolacja geostatystyczna</a></li>
</ul></li>
<li><a href="#rodzaje-krigingu"><span class="toc-section-number">6.2</span> Rodzaje krigingu</a><ul>
<li><a href="#rodzaje-krigingu-1"><span class="toc-section-number">6.2.1</span> Rodzaje krigingu</a></li>
</ul></li>
<li><a href="#kriging-prosty-ang.-simple-kriging"><span class="toc-section-number">6.3</span> Kriging prosty (ang. <em>Simple kriging</em>)</a><ul>
<li><a href="#kriging-prosty-ang.-simple-kriging-1"><span class="toc-section-number">6.3.1</span> Kriging prosty (ang. <em>Simple kriging</em>)</a></li>
<li><a href="#kriging-prosty-ang.-simple-kriging-2"><span class="toc-section-number">6.3.2</span> Kriging prosty (ang. <em>Simple kriging</em>)</a></li>
</ul></li>
<li><a href="#kriging-zwyky-ang.-ordinary-kriging"><span class="toc-section-number">6.4</span> Kriging zwykły (ang. <em>Ordinary kriging</em>)</a><ul>
<li><a href="#kriging-zwyky-ang.-ordinary-kriging-1"><span class="toc-section-number">6.4.1</span> Kriging zwykły (ang. <em>Ordinary kriging</em>)</a></li>
<li><a href="#kriging-zwyky-ang.-ordinary-kriging-2"><span class="toc-section-number">6.4.2</span> Kriging zwykły (ang. <em>Ordinary kriging</em>)</a></li>
</ul></li>
<li><a href="#porownanie-wynikow-sk-ok-i-kzt"><span class="toc-section-number">6.5</span> Porównanie wyników SK, OK i KZT</a></li>
</ul></li>
<li><a href="#final-words"><span class="toc-section-number">7</span> Final Words</a></li>
<li><a href="#ocena-jakosci-estymacji-uwaga-pomieszany-me-z-reszta"><span class="toc-section-number">8</span> Ocena jakości estymacji [UWAGA POMIESZANY ME Z RESZTĄ!!]</a><ul>
<li><a href="#statystyki-jakosci-estymacji"><span class="toc-section-number">8.1</span> Statystyki jakości estymacji</a><ul>
<li><a href="#statystyki-jakosci-estymacji-1"><span class="toc-section-number">8.1.1</span> Statystyki jakości estymacji</a></li>
<li><a href="#statystyki-jakosci-estymacji-2"><span class="toc-section-number">8.1.2</span> Statystyki jakości estymacji</a></li>
<li><a href="#sredni-bad-estymacji"><span class="toc-section-number">8.1.3</span> Średni błąd estymacji</a></li>
<li><a href="#pierwiastek-sredniego-bedu-kwadratowego"><span class="toc-section-number">8.1.4</span> Pierwiastek średniego błędu kwadratowego</a></li>
<li><a href="#wspoczynnik-korelacji-4"><span class="toc-section-number">8.1.5</span> Współczynnik korelacji</a></li>
<li><a href="#statystyki-jakosci-estymacji-mapa"><span class="toc-section-number">8.1.6</span> Statystyki jakości estymacji | Mapa</a></li>
<li><a href="#statystyki-jakosci-estymacji-histogram"><span class="toc-section-number">8.1.7</span> Statystyki jakości estymacji | Histogram</a></li>
<li><a href="#statystyki-jakosci-estymacji-wykres-rozrzutu"><span class="toc-section-number">8.1.8</span> Statystyki jakości estymacji | Wykres rozrzutu</a></li>
</ul></li>
<li><a href="#walidacja-wynikow-estymacji"><span class="toc-section-number">8.2</span> Walidacja wyników estymacji</a><ul>
<li><a href="#walidacja-wynikow-estymacji-1"><span class="toc-section-number">8.2.1</span> Walidacja wyników estymacji</a></li>
<li><a href="#walidacja-podzbiorem"><span class="toc-section-number">8.2.2</span> Walidacja podzbiorem</a></li>
<li><a href="#walidacja-podzbiorem-1"><span class="toc-section-number">8.2.3</span> Walidacja podzbiorem</a></li>
<li><a href="#kroswalidacja"><span class="toc-section-number">8.2.4</span> Kroswalidacja</a></li>
<li><a href="#kroswalidacja-1"><span class="toc-section-number">8.2.5</span> Kroswalidacja</a></li>
</ul></li>
</ul></li>
<li><a href="#references"><span class="toc-section-number">9</span> References</a></li>
<li><a href="#wykorzystanie-do-estymacji-danych-uzupeniajacych"><span class="toc-section-number">10</span> Wykorzystanie do estymacji danych uzupełniających</a><ul>
<li><a href="#kriging-stratyfikowany-ang.-kriging-within-strata"><span class="toc-section-number">10.1</span> Kriging stratyfikowany (ang. <em>Kriging within strata</em>)</a><ul>
<li><a href="#kriging-stratyfikowany-ang.-kriging-within-strata-1"><span class="toc-section-number">10.1.1</span> Kriging stratyfikowany (ang. <em>Kriging within strata</em>)</a></li>
<li><a href="#kriging-stratyfikowany-ang.-kriging-within-strata-2"><span class="toc-section-number">10.1.2</span> Kriging stratyfikowany (ang. <em>Kriging within strata</em>)</a></li>
</ul></li>
<li><a href="#prosty-kriging-ze-zmiennymi-srednimi-lokalnymi-lvm"><span class="toc-section-number">10.2</span> Prosty kriging ze zmiennymi średnimi lokalnymi (LVM)</a><ul>
<li><a href="#prosty-kriging-ze-zmiennymi-srednimi-lokalnymi-lvm-1"><span class="toc-section-number">10.2.1</span> Prosty kriging ze zmiennymi średnimi lokalnymi (LVM)</a></li>
<li><a href="#prosty-kriging-ze-zmiennymi-srednimi-lokalnymi-lvm-2"><span class="toc-section-number">10.2.2</span> Prosty kriging ze zmiennymi średnimi lokalnymi (LVM)</a></li>
</ul></li>
<li><a href="#kriging-uniwersalny-ang.-universal-kriging"><span class="toc-section-number">10.3</span> Kriging uniwersalny (ang. <em>Universal kriging</em>)</a><ul>
<li><a href="#kriging-uniwersalny-ang.-universal-kriging-1"><span class="toc-section-number">10.3.1</span> Kriging uniwersalny (ang. <em>Universal kriging</em>)</a></li>
<li><a href="#kriging-uniwersalny-ang.-universal-kriging-2"><span class="toc-section-number">10.3.2</span> Kriging uniwersalny (ang. <em>Universal kriging</em>)</a></li>
</ul></li>
</ul></li>
<li><a href="#estymacja-lokalnego-rozkadu-prawdopodobienstwa"><span class="toc-section-number">11</span> Estymacja lokalnego rozkładu prawdopodobieństwa</a><ul>
<li><a href="#kriging-danych-kodowanych-ang.-indicator-kriging-wprowadzenie"><span class="toc-section-number">11.1</span> Kriging danych kodowanych (ang. <em>Indicator kriging</em>) | Wprowadzenie</a><ul>
<li><a href="#kriging-danych-kodowanych-ang.-indicator-kriging"><span class="toc-section-number">11.1.1</span> Kriging danych kodowanych (ang. <em>Indicator kriging</em>)</a></li>
<li><a href="#kriging-danych-kodowanych-ang.-indicator-kriging-1"><span class="toc-section-number">11.1.2</span> Kriging danych kodowanych (ang. <em>Indicator kriging</em>)</a></li>
<li><a href="#kriging-danych-kodowanych-ang.-indicator-kriging-wady-i-zalety"><span class="toc-section-number">11.1.3</span> Kriging danych kodowanych (ang. <em>Indicator kriging</em>)| Wady i zalety</a></li>
</ul></li>
<li><a href="#kriging-danych-kodowanych-ang.-indicator-kriging-przykady"><span class="toc-section-number">11.2</span> Kriging danych kodowanych (ang. <em>Indicator kriging</em>) | Przykłady</a><ul>
<li><a href="#binaryzacja-danych"><span class="toc-section-number">11.2.1</span> Binaryzacja danych</a></li>
<li><a href="#eksploracja-danych"><span class="toc-section-number">11.2.2</span> Eksploracja danych</a></li>
<li><a href="#kriging-danych-kodowanych-ang.-indicator-kriging-semiwariogram"><span class="toc-section-number">11.2.3</span> Kriging danych kodowanych (ang. <em>Indicator kriging</em>) | Semiwariogram</a></li>
<li><a href="#kriging-danych-kodowanych-ang.-indicator-kriging-modelowanie"><span class="toc-section-number">11.2.4</span> Kriging danych kodowanych (ang. <em>Indicator kriging</em>) | Modelowanie</a></li>
<li><a href="#kriging-danych-kodowanych-ang.-indicator-kriging-interpolacja"><span class="toc-section-number">11.2.5</span> Kriging danych kodowanych (ang. <em>Indicator kriging</em>) | Interpolacja</a></li>
<li><a href="#kriging-danych-kodowanych-ang.-indicator-kriging-2"><span class="toc-section-number">11.2.6</span> Kriging danych kodowanych (ang. <em>Indicator kriging</em>)</a></li>
</ul></li>
</ul></li>
<li><a href="#estymacje-wielozmienne"><span class="toc-section-number">12</span> Estymacje wielozmienne</a><ul>
<li><a href="#kokriging-prosty-i-zwyky-sck-i-ock"><span class="toc-section-number">12.1</span> Kokriging (prosty i zwykły, SCK i OCK)</a><ul>
<li><a href="#kokriging-ang.-co-kriging"><span class="toc-section-number">12.1.1</span> Kokriging (ang. <em>co-kriging</em>)</a></li>
<li><a href="#kokriging-wybor-dodatkowej-zmiennej"><span class="toc-section-number">12.1.2</span> Kokriging | Wybór dodatkowej zmiennej</a></li>
<li><a href="#kokriging"><span class="toc-section-number">12.1.3</span> Kokriging</a></li>
</ul></li>
</ul></li>
<li><a href="#symulacje"><span class="toc-section-number">13</span> Symulacje</a><ul>
<li><a href="#symulacje-geostatystyczne"><span class="toc-section-number">13.1</span> Symulacje geostatystyczne</a><ul>
<li><a href="#symulacje-geostatystyczne-1"><span class="toc-section-number">13.1.1</span> Symulacje geostatystyczne</a></li>
<li><a href="#symulacje-geostatystyczne-cel"><span class="toc-section-number">13.1.2</span> Symulacje geostatystyczne | Cel</a></li>
</ul></li>
<li><a href="#typy-symulacji"><span class="toc-section-number">13.2</span> Typy symulacji</a><ul>
<li><a href="#typy-symulacji-1"><span class="toc-section-number">13.2.1</span> Typy symulacji</a></li>
</ul></li>
<li><a href="#symulacje-bezwarunkowe"><span class="toc-section-number">13.3</span> Symulacje bezwarunkowe</a></li>
<li><a href="#symulacje-warunkowe"><span class="toc-section-number">13.4</span> Symulacje warunkowe</a><ul>
<li><a href="#sekwencyjna-symulacja-gaussowska-ang.-sequential-gaussian-simulation"><span class="toc-section-number">13.4.1</span> Sekwencyjna symulacja gaussowska (ang. <em>Sequential Gaussian simulation</em>)</a></li>
<li><a href="#sekwencyjna-symulacja-gaussowska-ang.-sequential-gaussian-simulation-1"><span class="toc-section-number">13.4.2</span> Sekwencyjna symulacja gaussowska (ang. <em>Sequential Gaussian simulation</em>)</a></li>
<li><a href="#sekwencyjna-symulacja-gaussowska-ang.-sequential-gaussian-simulation-2"><span class="toc-section-number">13.4.3</span> Sekwencyjna symulacja gaussowska (ang. <em>Sequential Gaussian simulation</em>)</a></li>
</ul></li>
<li><a href="#sekwencyjna-symulacja-danych-kodowanych-ang.-sequential-indicator-simulation"><span class="toc-section-number">13.5</span> Sekwencyjna symulacja danych kodowanych (ang. <em>Sequential indicator simulation</em>)</a><ul>
<li><a href="#sekwencyjna-symulacja-danych-kodowanych-ang.-sequential-indicator-simulation-1"><span class="toc-section-number">13.5.1</span> Sekwencyjna symulacja danych kodowanych (ang. <em>Sequential indicator simulation</em>)</a></li>
</ul></li>
</ul></li>
<li><a href="#references-1"><span class="toc-section-number">14</span> References</a></li>
</ul>
<!--bookdown:toc2:end-->
      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Geostatystyka</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<!--bookdown:toc:end-->
<!--bookdown:body:start-->
<div id="dzien-dobry" class="section level1">
<h1><span class="header-section-number">1</span> Dzień dobry</h1>
<p>Kłaniam się.</p>
<iframe src="http://giphy.com/embed/cNb6ey1bD9uPC" width="480" height="360" frameBorder="0" class="giphy-embed" allowFullScreen>
</iframe>
<p>
<a href="http://giphy.com/gifs/george-costanza-dapper-cNb6ey1bD9uPC">via GIPHY</a>
</p>
<!--chapter:end:index.Rmd-->
</div>
<div id="intro" class="section level1">
<h1><span class="header-section-number">2</span> Wprowadzenie</h1>
<div id="wprowadzenie" class="section level2">
<h2><span class="header-section-number">2.1</span> Wprowadzenie</h2>
<div id="program-zajec" class="section level3">
<h3><span class="header-section-number">2.1.1</span> Program zajęć</h3>
<ol style="list-style-type: decimal">
<li>Wstęp do R</li>
<li>Nieprzestrzenna i przestrzenna eksploracyjna analiza danych</li>
<li>Przestrzenna eksploracyjna analiza danych</li>
<li>Matematyczne modelowanie autokorelacji przestrzennej</li>
<li>Estymacje jednozmienne</li>
<li>Ocena jakości estymacji</li>
<li>Wykorzystanie do estymacji danych uzupełniających</li>
<li>Estymacja lokalnego rozkładu prawdopodobieństwa</li>
<li>Estymacje wielozmienne</li>
<li>Symulacje przestrzenne</li>
</ol>
</div>
<div id="formy-oceny" class="section level3">
<h3><span class="header-section-number">2.1.2</span> Formy oceny</h3>
<ul>
<li>Dwa krótkie (0,5 godziny) kolokwia okresowe – na zajęciach, przy komputerach – po 15% wagi przy końcowej ocenie</li>
<li>Projekt do wykonania w domu – końcowe 2 tygodnie semestru – 20% wagi przy końcowej ocenie</li>
<li>Kolokwium końcowe – 1,5 godziny przy komputerach na ostatnich zajęciach w semestrze - 50% wagi przy końcowej ocenie</li>
<li>Zaliczenie zajęć (ocena dostateczna) – co najmniej 55% maksymalnej punktacji</li>
</ul>
</div>
<div id="kodeks-honorowy" class="section level3">
<h3><span class="header-section-number">2.1.3</span> Kodeks honorowy</h3>
<ul>
<li>Wszelkie prace domowe czy zaliczeniowe muszą być samodzielne oraz odzwierciedlać sposób myślenia i pracy ich twórcy</li>
</ul>
</div>
<div id="zroda-wiedzy" class="section level3">
<h3><span class="header-section-number">2.1.4</span> Źródła wiedzy</h3>
<ul>
<li><a href="http://cran.r-project.org/doc/manuals/R-intro.pdf">An Introduction to R</a> - oficjalne wprowadzenie do R</li>
<li><a href="http://www.biecek.pl/R/">Przewodnik po pakiecie R</a>, <a href="http://rksiazka.rexamine.com/">Programowanie w języku R</a>, <a href="http://ksiegarnia.pwn.pl/7371_pozycja.html?npt=233">Statystyczna analiza danych z wykorzystaniem programu R</a> - polskie wydawnictwa</li>
<li><a href="http://www.asdar-book.org/">Applied Spatial Dala Analysis with R</a></li>
<li><a href="http://spatial-analyst.net/book/system/files/Hengl_2009_GEOSTATe2c1w.pdf">A Practical Guide to Geostatistical Mapping</a></li>
<li><a href="http://www.gstat.org/gstat.pdf">gstat user’s manual</a></li>
<li><a href="https://cran.r-project.org/web/views/Spatial.html">CRAN Task View: Analysis of Spatial Data</a></li>
<li><a href="https://books.google.pl/books?id=vC2dcXFLI3YC">Applied Geostatistics</a>, <a href="https://books.google.pl/books?id=4SdRAAAAMAAJ">Statistics for spatial data</a></li>
<li><a href="http://www.geoinfo.amu.edu.pl/staff/astach/www_geostat/programy/A_Stach_%20poradnik_geostatystyki.pdf">Praktyczny poradnik - jak szybko zrozumieć i wykorzystać geostatystykę w pracy badawczej</a></li>
<li>Wyszukiwarki internetowe <a href="http://www.rseek.org/">Rseek</a>, <a href="http://duckduckgo.com/">Duckduckgo</a>, <a href="http://google.com/">Google</a>, <a href="http://bing.com/">Bing</a>, itd.</li>
</ul>
</div>
</div>
<div id="wolin" class="section level2">
<h2><span class="header-section-number">2.2</span> Wolin</h2>
<div id="mapa-topograficzna" class="section level3">
<h3><span class="header-section-number">2.2.1</span> Mapa topograficzna</h3>
<div class="figure">
<img src="figs/wolin_topo.png" alt="" />

</div>
</div>
<div id="obraz-satelitarny" class="section level3">
<h3><span class="header-section-number">2.2.2</span> Obraz satelitarny</h3>
<div class="figure">
<img src="figs/wolin_sat.png" alt="" />

</div>
</div>
<div id="rzezba-terenu" class="section level3">
<h3><span class="header-section-number">2.2.3</span> Rzeźba terenu</h3>
<div class="figure">
<img src="figs/wolin_rze.png" alt="Uproszczona mapa geomorfologiczna wyspy Wolin (Karczewski 1968, zmienione). Objaśnienia: 1 – plaża, 2 – wydmy i powierzchnie piasków eolicznych, 3 – fluwioglacjalne poziomy terasowe, 4 – dna rynien glacjalnych, 5 – wysoczyzna morenowa, 6 – wzgórza moreny czołowej, 7 – sandry, 8 – jeziora." />
<p class="caption">Uproszczona mapa geomorfologiczna wyspy Wolin (Karczewski 1968, zmienione). Objaśnienia: 1 – plaża, 2 – wydmy i powierzchnie piasków eolicznych, 3 – fluwioglacjalne poziomy terasowe, 4 – dna rynien glacjalnych, 5 – wysoczyzna morenowa, 6 – wzgórza moreny czołowej, 7 – sandry, 8 – jeziora.</p>
</div>
<p>Uproszczona mapa geomorfologiczna wyspy Wolin (Karczewski 1968, zmienione).</p>
<p>Objaśnienia: 1 – plaża 2 – wydmy i powierzchnie piasków eolicznych 3 – fluwioglacjalne poziomy terasowe 4 – dna rynien glacjalnych 5 – wysoczyzna morenowa 6 – wzgórza moreny czołowej 7 – sandry 8 – jeziora</p>
</div>
<div id="pokrycieuzytkowanie-terenu" class="section level3">
<h3><span class="header-section-number">2.2.4</span> Pokrycie/użytkowanie terenu</h3>
<div class="figure">
<img src="figs/wolin_COR.png" alt="" />

</div>
</div>
<div id="litologia" class="section level3">
<h3><span class="header-section-number">2.2.5</span> Litologia</h3>
<div class="figure">
<img src="figs/wolin_lit.png" alt="" />

</div>
</div>
<div id="wilgotnosc-gruntu" class="section level3">
<h3><span class="header-section-number">2.2.6</span> Wilgotność gruntu</h3>
<div class="figure">
<img src="figs/wolin_wil.png" alt="" />

</div>
</div>
</div>
<div id="r-a-dane-przestrzenne" class="section level2">
<h2><span class="header-section-number">2.3</span> R a dane przestrzenne</h2>
<div id="pakiety" class="section level3">
<h3><span class="header-section-number">2.3.1</span> Pakiety</h3>
<ul>
<li>GIS - <strong>sp, rgdal, raster, rasterVis, rgeos, maptools, GeoXp, deldir, pgirmess</strong></li>
<li>Geostatystyka - <strong>gstat, geoR, geoRglm, fields, spBayes, RandomFields, vardiag</strong></li>
<li>Inne - <strong>ggplot2, corrplot, caret</strong></li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">install.packages</span>(<span class="kw">c</span>(<span class="st">&#39;sp&#39;</span>, <span class="st">&#39;rgdal&#39;</span>, <span class="st">&#39;raster&#39;</span>, <span class="st">&#39;rasterVis&#39;</span>, <span class="st">&#39;gstat&#39;</span>, <span class="st">&#39;ggplot2&#39;</span>, <span class="st">&#39;corrplot&#39;</span>, <span class="st">&#39;deldir&#39;</span>, <span class="st">&#39;fields&#39;</span>, <span class="st">&#39;geoR&#39;</span>, <span class="st">&#39;pgirmess&#39;</span>, <span class="st">&#39;caret&#39;</span>))</code></pre></div>
</div>
<div id="reprezentacja-danych-nieprzestrzennych" class="section level3">
<h3><span class="header-section-number">2.3.2</span> Reprezentacja danych nieprzestrzennych</h3>
<ul>
<li>Wektory (ang. <em>vector</em>):
<ul>
<li>liczbowe (ang. <em>integer</em>, <em>numeric</em>) - c(1, 2, 3) i c(1.21, 3.32, 4.43)</li>
<li>znakowe (ang. <em>character</em>) - c(‘jeden’, ‘dwa’, ‘trzy’)</li>
<li>logiczne (ang. <em>logical</em>) - c(TRUE, FALSE)</li>
<li>czynnikowe (ang. <em>factor</em>) - c(‘jeden’, ‘dwa’, ‘trzy’, ‘jeden’)</li>
</ul></li>
<li>Ramki danych (ang. <em>data.frame</em>) - to zbiór zmiennych (kolumn) oraz obserwacji (wierszy) zawierających różne typt danych</li>
<li>Macierze (ang. <em>matrix</em>)</li>
<li>Listy (ang. <em>listy</em>)</li>
</ul>
</div>
<div id="reprezentacja-danych-przestrzennych" class="section level3">
<h3><span class="header-section-number">2.3.3</span> Reprezentacja danych przestrzennych</h3>
<ul>
<li>Obiekty klasy Spatial* - wszystkie z nich zawierają dwie dodatkowe informacje:
<ul>
<li>bounding box (bbox) - obwiednia - określa zasięg danych</li>
<li>CRS (proj4string) - układ współrzędnych</li>
</ul></li>
<li>Najczęściej stosowane obiekty klasy Spatial* to SpatialPointsDataFrame, SpatialPolygonsDataFrame oraz SpatialGridDataFrame</li>
<li>Obiekty klasy Raster, tj. RasterLayer, RasterStack, RasterBrick</li>
<li>Inne</li>
</ul>
</div>
<div id="gdalogr" class="section level3">
<h3><span class="header-section-number">2.3.4</span> GDAL/OGR</h3>
<ul>
<li><a href="http://www.gdal.org/" class="uri">http://www.gdal.org/</a></li>
<li>GDAL to biblioteka zawierająca funkcje służące do odczytywania i zapiswania danych w formatach rastrowych</li>
<li>OGR to bibioteka służąca to odczytywania i zapiswania danych w formatach wektorowych</li>
<li>Pakiet <strong>rgdal</strong> pozwala na wykorzystanie bibliotek GDAL/OGR w R</li>
</ul>
</div>
<div id="proj.4" class="section level3">
<h3><span class="header-section-number">2.3.5</span> PROJ.4</h3>
<ul>
<li>Dane przestrzenne powinny być zawsze powiązane z układem współrzednych</li>
<li>PROJ.4 - to biblioteka pozwalająca na identyfiację oraz konwersję pomiędzy różnymi układami współrzędnych <a href="http://www.spatialreference.org/" class="uri">http://www.spatialreference.org/</a></li>
</ul>
</div>
<div id="epsg" class="section level3">
<h3><span class="header-section-number">2.3.6</span> EPSG</h3>
<ul>
<li>Kod EPSG (ang. <em>European Petroleum Survey Group</em>) pozwala na łatwe identyfikowanie układów współrzędnych</li>
<li>Przykładowo, układ PL 1992 może być określony jako:</li>
</ul>
<p>“+proj=tmerc +lat_0=0 +lon_0=19 +k=0.9993 +x_0=500000 +y_0=-5300000 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs”</p>
<p>lub</p>
<p>“+init=epsg:2180”</p>
</div>
<div id="ukad-geograficzny" class="section level3">
<h3><span class="header-section-number">2.3.7</span> Układ geograficzny</h3>
<ul>
<li>Proporcje pomiędzy współrzedną X (długość) a Y (szerokość) nie są 1:1</li>
<li>Wielkość oczka siatki jest zmienna</li>
<li>Nie pozwala na proste określanie odległości czy powierzchni</li>
<li><p>Jednostka mapy jest abstrakcyjna</p></li>
<li><p>Do większości algorytmów w geostatystyce wykorzystywane są układy prostokątne płaskie</p></li>
</ul>
</div>
</div>
<div id="import-danych" class="section level2">
<h2><span class="header-section-number">2.4</span> Import danych</h2>
<div id="dane-punktowe-format-csv" class="section level3">
<h3><span class="header-section-number">2.4.1</span> Dane punktowe (format csv)</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&#39;sp&#39;</span>)
wolin_lato_los &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&#39;data/Wolin_TPZ_p_lato_750losN.csv&#39;</span>, <span class="dt">na.strings=</span>-<span class="fl">999.00</span>)</code></pre></div>
</div>
<div id="dane-punktowe-format-csv-1" class="section level3">
<h3><span class="header-section-number">2.4.2</span> Dane punktowe (format csv)</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">coordinates</span>(wolin_lato_los) &lt;-<span class="st"> </span><span class="er">~</span>X+Y
<span class="kw">summary</span>(wolin_lato_los)</code></pre></div>
<pre><code>## Object of class SpatialPointsDataFrame
## Coordinates:
##       min     max
## X  451470  483570
## Y 5962620 5985510
## Is projected: NA 
## proj4string : [NA]
## Number of points: 750
## Data attributes:
##  X1999.09.13_TPZ X1999.09.13_NDVI  X2002.08.20_TPZ X2002.08.20_NDVI 
##  Min.   :16.01   Min.   :-0.2273   Min.   :17.11   Min.   :-0.2500  
##  1st Qu.:20.24   1st Qu.: 0.3207   1st Qu.:20.48   1st Qu.: 0.2673  
##  Median :21.46   Median : 0.4101   Median :21.89   Median : 0.3766  
##  Mean   :22.86   Mean   : 0.3627   Mean   :23.56   Mean   : 0.3295  
##  3rd Qu.:24.92   3rd Qu.: 0.4752   3rd Qu.:25.81   3rd Qu.: 0.4483  
##  Max.   :33.19   Max.   : 0.5912   Max.   :41.79   Max.   : 0.5724  
##  NA&#39;s   :495     NA&#39;s   :495                                        
##      CLC06      CLC06_p_lato    odl_od_morza   InsCalk_1999.09
##  Min.   :112   Min.   :1.000   Min.   :    0   Min.   :31.89  
##  1st Qu.:231   1st Qu.:3.000   1st Qu.: 1928   1st Qu.:47.89  
##  Median :311   Median :4.000   Median : 4259   Median :48.25  
##  Mean   :282   Mean   :3.603   Mean   : 4940   Mean   :48.03  
##  3rd Qu.:312   3rd Qu.:4.000   3rd Qu.: 7127   3rd Qu.:48.45  
##  Max.   :512   Max.   :6.000   Max.   :16276   Max.   :54.55  
##                                                               
##  InsCalk_2002.08
##  Min.   :47.02  
##  1st Qu.:63.78  
##  Median :64.09  
##  Mean   :63.87  
##  3rd Qu.:64.26  
##  Max.   :69.44  
## </code></pre>
</div>
<div id="dane-punktowe-format-csv-2" class="section level3">
<h3><span class="header-section-number">2.4.3</span> Dane punktowe (format csv)</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">proj4string</span>(wolin_lato_los) &lt;-<span class="st"> &#39;+init=epsg:32633&#39;</span>
<span class="kw">summary</span>(wolin_lato_los)</code></pre></div>
<pre><code>## Object of class SpatialPointsDataFrame
## Coordinates:
##       min     max
## X  451470  483570
## Y 5962620 5985510
## Is projected: TRUE 
## proj4string :
## [+init=epsg:32633 +proj=utm +zone=33 +datum=WGS84 +units=m +no_defs
## +ellps=WGS84 +towgs84=0,0,0]
## Number of points: 750
## Data attributes:
##  X1999.09.13_TPZ X1999.09.13_NDVI  X2002.08.20_TPZ X2002.08.20_NDVI 
##  Min.   :16.01   Min.   :-0.2273   Min.   :17.11   Min.   :-0.2500  
##  1st Qu.:20.24   1st Qu.: 0.3207   1st Qu.:20.48   1st Qu.: 0.2673  
##  Median :21.46   Median : 0.4101   Median :21.89   Median : 0.3766  
##  Mean   :22.86   Mean   : 0.3627   Mean   :23.56   Mean   : 0.3295  
##  3rd Qu.:24.92   3rd Qu.: 0.4752   3rd Qu.:25.81   3rd Qu.: 0.4483  
##  Max.   :33.19   Max.   : 0.5912   Max.   :41.79   Max.   : 0.5724  
##  NA&#39;s   :495     NA&#39;s   :495                                        
##      CLC06      CLC06_p_lato    odl_od_morza   InsCalk_1999.09
##  Min.   :112   Min.   :1.000   Min.   :    0   Min.   :31.89  
##  1st Qu.:231   1st Qu.:3.000   1st Qu.: 1928   1st Qu.:47.89  
##  Median :311   Median :4.000   Median : 4259   Median :48.25  
##  Mean   :282   Mean   :3.603   Mean   : 4940   Mean   :48.03  
##  3rd Qu.:312   3rd Qu.:4.000   3rd Qu.: 7127   3rd Qu.:48.45  
##  Max.   :512   Max.   :6.000   Max.   :16276   Max.   :54.55  
##                                                               
##  InsCalk_2002.08
##  Min.   :47.02  
##  1st Qu.:63.78  
##  Median :64.09  
##  Mean   :63.87  
##  3rd Qu.:64.26  
##  Max.   :69.44  
## </code></pre>
</div>
<div id="usuwanie-punktow-zawierajacych-braki-wartosci" class="section level3">
<h3><span class="header-section-number">2.4.4</span> Usuwanie punktów zawierających braki wartości</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sp_na_omit &lt;-<span class="st"> </span>function(x, <span class="dt">margin=</span><span class="dv">1</span>) {
    if (!<span class="kw">inherits</span>(x, <span class="st">&quot;SpatialPointsDataFrame&quot;</span>) &amp;<span class="st"> </span>!<span class="kw">inherits</span>(x, <span class="st">&quot;SpatialPolygonsDataFrame&quot;</span>)) 
        <span class="kw">stop</span>(<span class="st">&quot;MUST BE sp SpatialPointsDataFrame OR SpatialPolygonsDataFrame CLASS OBJECT&quot;</span>) 
    na.index &lt;-<span class="st"> </span><span class="kw">unique</span>(<span class="kw">as.data.frame</span>(<span class="kw">which</span>(<span class="kw">is.na</span>(x@data),<span class="dt">arr.ind=</span><span class="ot">TRUE</span>))[,margin])
    if(margin ==<span class="st"> </span><span class="dv">1</span>) {  
        <span class="kw">cat</span>(<span class="st">&quot;DELETING ROWS: &quot;</span>, na.index, <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>) 
        <span class="kw">return</span>( x[-na.index,]  ) 
    }
    if(margin ==<span class="st"> </span><span class="dv">2</span>) {  
        <span class="kw">cat</span>(<span class="st">&quot;DELETING COLUMNS: &quot;</span>, na.index, <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>) 
        <span class="kw">return</span>( x[,-na.index]  ) 
    }
}
wolin_lato_los2 &lt;-<span class="st"> </span><span class="kw">sp_na_omit</span>(wolin_lato_los) </code></pre></div>
<pre><code>## DELETING ROWS:  256 257 258 259 260 261 262 263 264 265 266 267 268 269 270 271 272 273 274 275 276 277 278 279 280 281 282 283 284 285 286 287 288 289 290 291 292 293 294 295 296 297 298 299 300 301 302 303 304 305 306 307 308 309 310 311 312 313 314 315 316 317 318 319 320 321 322 323 324 325 326 327 328 329 330 331 332 333 334 335 336 337 338 339 340 341 342 343 344 345 346 347 348 349 350 351 352 353 354 355 356 357 358 359 360 361 362 363 364 365 366 367 368 369 370 371 372 373 374 375 376 377 378 379 380 381 382 383 384 385 386 387 388 389 390 391 392 393 394 395 396 397 398 399 400 401 402 403 404 405 406 407 408 409 410 411 412 413 414 415 416 417 418 419 420 421 422 423 424 425 426 427 428 429 430 431 432 433 434 435 436 437 438 439 440 441 442 443 444 445 446 447 448 449 450 451 452 453 454 455 456 457 458 459 460 461 462 463 464 465 466 467 468 469 470 471 472 473 474 475 476 477 478 479 480 481 482 483 484 485 486 487 488 489 490 491 492 493 494 495 496 497 498 499 500 501 502 503 504 505 506 507 508 509 510 511 512 513 514 515 516 517 518 519 520 521 522 523 524 525 526 527 528 529 530 531 532 533 534 535 536 537 538 539 540 541 542 543 544 545 546 547 548 549 550 551 552 553 554 555 556 557 558 559 560 561 562 563 564 565 566 567 568 569 570 571 572 573 574 575 576 577 578 579 580 581 582 583 584 585 586 587 588 589 590 591 592 593 594 595 596 597 598 599 600 601 602 603 604 605 606 607 608 609 610 611 612 613 614 615 616 617 618 619 620 621 622 623 624 625 626 627 628 629 630 631 632 633 634 635 636 637 638 639 640 641 642 643 644 645 646 647 648 649 650 651 652 653 654 655 656 657 658 659 660 661 662 663 664 665 666 667 668 669 670 671 672 673 674 675 676 677 678 679 680 681 682 683 684 685 686 687 688 689 690 691 692 693 694 695 696 697 698 699 700 701 702 703 704 705 706 707 708 709 710 711 712 713 714 715 716 717 718 719 720 721 722 723 724 725 726 727 728 729 730 731 732 733 734 735 736 737 738 739 740 741 742 743 744 745 746 747 748 749 750</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(wolin_lato_los2)</code></pre></div>
<pre><code>## Object of class SpatialPointsDataFrame
## Coordinates:
##       min     max
## X  452070  483570
## Y 5964330 5985330
## Is projected: TRUE 
## proj4string :
## [+init=epsg:32633 +proj=utm +zone=33 +datum=WGS84 +units=m +no_defs
## +ellps=WGS84 +towgs84=0,0,0]
## Number of points: 255
## Data attributes:
##  X1999.09.13_TPZ X1999.09.13_NDVI  X2002.08.20_TPZ X2002.08.20_NDVI 
##  Min.   :16.01   Min.   :-0.2273   Min.   :17.16   Min.   :-0.1905  
##  1st Qu.:20.24   1st Qu.: 0.3207   1st Qu.:20.44   1st Qu.: 0.2626  
##  Median :21.46   Median : 0.4101   Median :21.84   Median : 0.3827  
##  Mean   :22.86   Mean   : 0.3627   Mean   :23.37   Mean   : 0.3394  
##  3rd Qu.:24.92   3rd Qu.: 0.4752   3rd Qu.:25.70   3rd Qu.: 0.4417  
##  Max.   :33.19   Max.   : 0.5912   Max.   :37.36   Max.   : 0.5534  
##      CLC06      CLC06_p_lato    odl_od_morza   InsCalk_1999.09
##  Min.   :112   Min.   :1.000   Min.   :    0   Min.   :39.48  
##  1st Qu.:231   1st Qu.:3.000   1st Qu.: 1656   1st Qu.:47.90  
##  Median :312   Median :4.000   Median : 3817   Median :48.24  
##  Mean   :286   Mean   :3.663   Mean   : 4477   Mean   :48.01  
##  3rd Qu.:312   3rd Qu.:4.000   3rd Qu.: 6719   3rd Qu.:48.43  
##  Max.   :512   Max.   :6.000   Max.   :14982   Max.   :53.59  
##  InsCalk_2002.08
##  Min.   :56.15  
##  1st Qu.:63.79  
##  Median :64.09  
##  Mean   :63.85  
##  3rd Qu.:64.24  
##  Max.   :68.47</code></pre>
</div>
<div id="dane-poligonowe-formaty-gisowe" class="section level3">
<h3><span class="header-section-number">2.4.5</span> Dane poligonowe (formaty gisowe)</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&#39;rgdal&#39;</span>)</code></pre></div>
<pre><code>## Loading required package: methods</code></pre>
<pre><code>## rgdal: version: 1.1-3, (SVN revision 594)
##  Geospatial Data Abstraction Library extensions to R successfully loaded
##  Loaded GDAL runtime: GDAL 1.11.2, released 2015/02/10
##  Path to GDAL shared files: /usr/share/gdal/1.11
##  Loaded PROJ.4 runtime: Rel. 4.8.0, 6 March 2012, [PJ_VERSION: 480]
##  Path to PROJ.4 shared files: (autodetected)
##  Linking to sp version: 1.2-1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">poligon &lt;-<span class="st"> </span><span class="kw">readOGR</span>(<span class="dt">dsn=</span><span class="st">&#39;data&#39;</span>, <span class="dt">layer=</span><span class="st">&#39;wolin_polygon&#39;</span>, <span class="dt">verbose=</span><span class="ot">FALSE</span>)
<span class="kw">plot</span>(poligon)</code></pre></div>
<p><img src="01-wprowadzenie_files/figure-html/unnamed-chunk-5-1.png" alt="" /><!-- --></p>
</div>
<div id="rastry" class="section level3">
<h3><span class="header-section-number">2.4.6</span> Rastry</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&#39;raster&#39;</span>)
siatka_raster &lt;-<span class="st"> </span><span class="kw">raster</span>(<span class="st">&quot;data/siatka_raster.tif&quot;</span>)
<span class="kw">plot</span>(siatka_raster)</code></pre></div>
<p><img src="01-wprowadzenie_files/figure-html/unnamed-chunk-6-1.png" alt="" /><!-- --></p>
</div>
<div id="siatki-regularne" class="section level3">
<h3><span class="header-section-number">2.4.7</span> Siatki regularne</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">siatka_shp &lt;-<span class="st"> </span><span class="kw">readOGR</span>(<span class="dt">dsn=</span><span class="st">&#39;data&#39;</span>, <span class="dt">layer=</span><span class="st">&#39;siatka&#39;</span>, <span class="dt">verbose=</span><span class="ot">FALSE</span>)
<span class="kw">plot</span>(siatka_shp)</code></pre></div>
<p><img src="01-wprowadzenie_files/figure-html/unnamed-chunk-7-1.png" alt="" /><!-- --></p>
</div>
<div id="siatki-nieregularne" class="section level3">
<h3><span class="header-section-number">2.4.8</span> Siatki nieregularne</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">siatka_n_shp &lt;-<span class="st"> </span><span class="kw">readOGR</span>(<span class="dt">dsn=</span><span class="st">&#39;data&#39;</span>, <span class="dt">layer=</span><span class="st">&#39;siatka_n&#39;</span>, <span class="dt">verbose=</span><span class="ot">FALSE</span>)
<span class="kw">plot</span>(siatka_n_shp)</code></pre></div>
<p><img src="01-wprowadzenie_files/figure-html/unnamed-chunk-8-1.png" alt="" /><!-- --></p>
</div>
</div>
<div id="eksport-danych" class="section level2">
<h2><span class="header-section-number">2.5</span> Eksport danych</h2>
<div id="zapisywanie-danych-wektorowych" class="section level3">
<h3><span class="header-section-number">2.5.1</span> Zapisywanie danych wektorowych</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&#39;rgdal&#39;</span>)
<span class="kw">writeOGR</span>(poligon, <span class="dt">dsn=</span><span class="st">&quot;nazwa_folderu&quot;</span>, <span class="dt">layer=</span><span class="st">&quot;nowy_poligon&quot;</span>, <span class="dt">driver=</span><span class="st">&quot;ESRI Shapefile&quot;</span>)</code></pre></div>
</div>
<div id="zapisywanie-danych-rastrowych" class="section level3">
<h3><span class="header-section-number">2.5.2</span> Zapisywanie danych rastrowych</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&#39;raster&#39;</span>)
<span class="kw">writeRaster</span>(siatka_raster, <span class="dt">filename=</span><span class="st">&quot;nazwa_folderu/nowy_raster.tif&quot;</span>)</code></pre></div>
</div>
</div>
<div id="wizualizacja-danych-2d" class="section level2">
<h2><span class="header-section-number">2.6</span> Wizualizacja danych 2D</h2>
<div id="dane-punktowe" class="section level3">
<h3><span class="header-section-number">2.6.1</span> Dane punktowe</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">spplot</span>(wolin_lato_los, <span class="st">&quot;X1999.09.13_TPZ&quot;</span>)</code></pre></div>
<p><img src="01-wprowadzenie_files/figure-html/unnamed-chunk-9-1.png" alt="" /><!-- --></p>
</div>
<div id="dane-punktowe-1" class="section level3">
<h3><span class="header-section-number">2.6.2</span> Dane punktowe</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">spplot</span>(wolin_lato_los, <span class="st">&quot;odl_od_morza&quot;</span>)</code></pre></div>
<p><img src="01-wprowadzenie_files/figure-html/unnamed-chunk-10-1.png" alt="" /><!-- --></p>
</div>
<div id="dane-punktowe---kategorie" class="section level3">
<h3><span class="header-section-number">2.6.3</span> Dane punktowe - kategorie</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">wolin_lato_los@data$CLC06_p_lato &lt;-<span class="st"> </span><span class="kw">as.factor</span>(wolin_lato_los@data$CLC06_p_lato)
<span class="kw">spplot</span>(wolin_lato_los, <span class="st">&quot;CLC06_p_lato&quot;</span>)</code></pre></div>
<p><img src="01-wprowadzenie_files/figure-html/unnamed-chunk-11-1.png" alt="" /><!-- --></p>
</div>
<div id="rastry-1" class="section level3">
<h3><span class="header-section-number">2.6.4</span> Rastry</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&#39;raster&#39;</span>); <span class="kw">library</span>(<span class="st">&#39;rasterVis&#39;</span>)</code></pre></div>
<pre><code>## Loading required package: lattice</code></pre>
<pre><code>## Loading required package: latticeExtra</code></pre>
<pre><code>## Loading required package: RColorBrewer</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">levelplot</span>(siatka_raster, <span class="dt">margin=</span><span class="ot">FALSE</span>)</code></pre></div>
<p><img src="01-wprowadzenie_files/figure-html/unnamed-chunk-12-1.png" alt="" /><!-- --></p>
</div>
</div>
<div id="tworzenie-siatek" class="section level2">
<h2><span class="header-section-number">2.7</span> Tworzenie siatek</h2>
<div id="siatki-regularne-1" class="section level3">
<h3><span class="header-section-number">2.7.1</span> Siatki regularne</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">siatka &lt;-<span class="st"> </span><span class="kw">expand.grid</span>(<span class="dt">X =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">451470</span>, <span class="dt">to =</span> <span class="dv">483570</span>, <span class="dt">by =</span> <span class="dv">1000</span>),
                      <span class="dt">Y =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">5962620</span>, <span class="dt">to =</span> <span class="dv">5985510</span>, <span class="dt">by =</span> <span class="dv">1000</span>))
<span class="kw">coordinates</span>(siatka) &lt;-<span class="st"> </span><span class="er">~</span>X +<span class="st"> </span>Y
<span class="kw">gridded</span>(siatka) &lt;-<span class="st"> </span><span class="ot">TRUE</span></code></pre></div>
</div>
<div id="siatki-regularne-2" class="section level3">
<h3><span class="header-section-number">2.7.2</span> Siatki regularne</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(siatka)
<span class="kw">plot</span>(wolin_lato_los, <span class="dt">add=</span><span class="ot">TRUE</span>)</code></pre></div>
<p><img src="01-wprowadzenie_files/figure-html/unnamed-chunk-14-1.png" alt="" /><!-- --></p>
</div>
<div id="siatki-nieregularne-1" class="section level3">
<h3><span class="header-section-number">2.7.3</span> Siatki nieregularne</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&#39;raster&#39;</span>)
poligon_shp &lt;-<span class="st"> </span><span class="kw">readOGR</span>(<span class="dt">dsn=</span><span class="st">&#39;data&#39;</span>, <span class="dt">layer=</span><span class="st">&#39;wolin_polygon&#39;</span>, <span class="dt">verbose=</span><span class="ot">FALSE</span>)
siatka_n &lt;-<span class="st"> </span><span class="kw">raster</span>(<span class="kw">extent</span>(poligon_shp))
<span class="kw">res</span>(siatka_n) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1000</span>, <span class="dv">1000</span>)
siatka_n[] &lt;-<span class="st"> </span><span class="dv">0</span>
<span class="kw">proj4string</span>(siatka_n) &lt;-<span class="st"> </span><span class="kw">CRS</span>(<span class="kw">proj4string</span>(poligon_shp))
siatka_n &lt;-<span class="st"> </span><span class="kw">mask</span>(siatka_n, poligon_shp)</code></pre></div>
</div>
<div id="siatki-nieregularne-2" class="section level3">
<h3><span class="header-section-number">2.7.4</span> Siatki nieregularne</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">levelplot</span>(siatka_n, <span class="dt">margin=</span><span class="ot">FALSE</span>)</code></pre></div>
<p><img src="01-wprowadzenie_files/figure-html/unnamed-chunk-16-1.png" alt="" /><!-- --></p>
</div>
<div id="siatki-nieregularne-3" class="section level3">
<h3><span class="header-section-number">2.7.5</span> Siatki nieregularne</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">siatka_n &lt;-<span class="st"> </span><span class="kw">as</span>(siatka_n, <span class="st">&#39;SpatialPointsDataFrame&#39;</span>)
siatka_n &lt;-<span class="st"> </span>siatka_n[!<span class="kw">is.na</span>(siatka_n@data$layer), ]
<span class="kw">gridded</span>(siatka_n) &lt;-<span class="st"> </span><span class="ot">TRUE</span>
<span class="kw">plot</span>(siatka_n)</code></pre></div>
<p><img src="01-wprowadzenie_files/figure-html/unnamed-chunk-17-1.png" alt="" /><!-- --></p>
<!--chapter:end:01-wprowadzenie.Rmd-->
</div>
</div>
</div>
<div id="eksploracyjna-analiza-danych" class="section level1">
<h1><span class="header-section-number">3</span> Eksploracyjna analiza danych</h1>
<div id="eksploracyjna-analiza-danych-cel" class="section level2">
<h2><span class="header-section-number">3.1</span> Eksploracyjna analiza danych | Cel</h2>
<ul>
<li>Ogólna charakterystyka danych oraz badanego zjawiska</li>
<li>Określenie przestrzennego/czasowego typu próbkowania</li>
<li>Informacja o relacji pomiędzy lokalizacją obserwacji a czynnikami wpływającymi na zmienność przestrzenną cechy</li>
</ul>
</div>
<div id="dane-wolin" class="section level2">
<h2><span class="header-section-number">3.2</span> Dane Wolin</h2>
<div id="dane-wolin-1" class="section level3">
<h3><span class="header-section-number">3.2.1</span> Dane Wolin</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&#39;sp&#39;</span>)
<span class="kw">library</span>(<span class="st">&#39;rgdal&#39;</span>)</code></pre></div>
<pre><code>## rgdal: version: 1.1-3, (SVN revision 594)
##  Geospatial Data Abstraction Library extensions to R successfully loaded
##  Loaded GDAL runtime: GDAL 1.11.2, released 2015/02/10
##  Path to GDAL shared files: /usr/share/gdal/1.11
##  Loaded PROJ.4 runtime: Rel. 4.8.0, 6 March 2012, [PJ_VERSION: 480]
##  Path to PROJ.4 shared files: (autodetected)
##  Linking to sp version: 1.2-1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">wolin_lato_los &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&#39;data/Wolin_TPZ_p_lato_750losN.csv&#39;</span>, <span class="dt">na.strings=</span>-<span class="fl">999.00</span>)
<span class="kw">coordinates</span>(wolin_lato_los) &lt;-<span class="st"> </span><span class="er">~</span>X+Y
<span class="kw">proj4string</span>(wolin_lato_los) &lt;-<span class="st"> &#39;+init=epsg:32633&#39;</span>
<span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">4</span>)))
<span class="kw">plot</span>(wolin_lato_los)</code></pre></div>
<p><img src="02-eksp_analiza_danych_files/figure-html/unnamed-chunk-2-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(wolin_lato_los)</code></pre></div>
<pre><code>## Formal class &#39;SpatialPointsDataFrame&#39; [package &quot;sp&quot;] with 5 slots
##   ..@ data       :&#39;data.frame&#39;:  750 obs. of  9 variables:
##   .. ..$ X1999.09.13_TPZ : num [1:750] 20.5 24.8 26.9 21 23 ...
##   .. ..$ X1999.09.13_NDVI: num [1:750] 0.47 0.328 0.279 0.492 0.433 ...
##   .. ..$ X2002.08.20_TPZ : num [1:750] 20 28.5 29.3 22.4 23.7 ...
##   .. ..$ X2002.08.20_NDVI: num [1:750] 0.492 0.12 0.224 0.441 0.405 ...
##   .. ..$ CLC06           : int [1:750] 411 312 112 231 242 211 411 211 231 211 ...
##   .. ..$ CLC06_p_lato    : int [1:750] 5 4 2 3 2 3 5 3 3 3 ...
##   .. ..$ odl_od_morza    : num [1:750] 14982 14946 14091 12572 12646 ...
##   .. ..$ InsCalk_1999.09 : num [1:750] 48.9 47.6 48.5 48.3 48.6 ...
##   .. ..$ InsCalk_2002.08 : num [1:750] 64.6 63.5 64.3 64.2 64.4 ...
##   ..@ coords.nrs : int [1:2] 1 2
##   ..@ coords     : num [1:750, 1:2] 472920 473970 474210 472140 472500 ...
##   .. ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. .. ..$ : chr [1:750] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...
##   .. .. ..$ : chr [1:2] &quot;X&quot; &quot;Y&quot;
##   ..@ bbox       : num [1:2, 1:2] 451470 5962620 483570 5985510
##   .. ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. .. ..$ : chr [1:2] &quot;X&quot; &quot;Y&quot;
##   .. .. ..$ : chr [1:2] &quot;min&quot; &quot;max&quot;
##   ..@ proj4string:Formal class &#39;CRS&#39; [package &quot;sp&quot;] with 1 slot
##   .. .. ..@ projargs: chr &quot;+init=epsg:32633 +proj=utm +zone=33 +datum=WGS84 +units=m +no_defs +ellps=WGS84 +towgs84=0,0,0&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(wolin_lato_los@data)</code></pre></div>
<pre><code>## &#39;data.frame&#39;:    750 obs. of  9 variables:
##  $ X1999.09.13_TPZ : num  20.5 24.8 26.9 21 23 ...
##  $ X1999.09.13_NDVI: num  0.47 0.328 0.279 0.492 0.433 ...
##  $ X2002.08.20_TPZ : num  20 28.5 29.3 22.4 23.7 ...
##  $ X2002.08.20_NDVI: num  0.492 0.12 0.224 0.441 0.405 ...
##  $ CLC06           : int  411 312 112 231 242 211 411 211 231 211 ...
##  $ CLC06_p_lato    : int  5 4 2 3 2 3 5 3 3 3 ...
##  $ odl_od_morza    : num  14982 14946 14091 12572 12646 ...
##  $ InsCalk_1999.09 : num  48.9 47.6 48.5 48.3 48.6 ...
##  $ InsCalk_2002.08 : num  64.6 63.5 64.3 64.2 64.4 ...</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">poligon &lt;-<span class="st"> </span><span class="kw">readOGR</span>(<span class="st">&#39;data&#39;</span>, <span class="st">&#39;wolin_polygon&#39;</span>)</code></pre></div>
<pre><code>## OGR data source with driver: ESRI Shapefile 
## Source: &quot;data&quot;, layer: &quot;wolin_polygon&quot;
## with 1 features
## It has 11 fields</code></pre>
</div>
</div>
<div id="statystyki-opisowe" class="section level2">
<h2><span class="header-section-number">3.3</span> Statystyki opisowe</h2>
<div id="statystyki-opisowe-1" class="section level3">
<h3><span class="header-section-number">3.3.1</span> Statystyki opisowe</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(wolin_lato_los@data)</code></pre></div>
<pre><code>##  X1999.09.13_TPZ X1999.09.13_NDVI  X2002.08.20_TPZ X2002.08.20_NDVI 
##  Min.   :16.01   Min.   :-0.2273   Min.   :17.11   Min.   :-0.2500  
##  1st Qu.:20.24   1st Qu.: 0.3207   1st Qu.:20.48   1st Qu.: 0.2673  
##  Median :21.46   Median : 0.4101   Median :21.89   Median : 0.3766  
##  Mean   :22.86   Mean   : 0.3627   Mean   :23.56   Mean   : 0.3295  
##  3rd Qu.:24.92   3rd Qu.: 0.4752   3rd Qu.:25.81   3rd Qu.: 0.4483  
##  Max.   :33.19   Max.   : 0.5912   Max.   :41.79   Max.   : 0.5724  
##  NA&#39;s   :495     NA&#39;s   :495                                        
##      CLC06      CLC06_p_lato    odl_od_morza   InsCalk_1999.09
##  Min.   :112   Min.   :1.000   Min.   :    0   Min.   :31.89  
##  1st Qu.:231   1st Qu.:3.000   1st Qu.: 1928   1st Qu.:47.89  
##  Median :311   Median :4.000   Median : 4259   Median :48.25  
##  Mean   :282   Mean   :3.603   Mean   : 4940   Mean   :48.03  
##  3rd Qu.:312   3rd Qu.:4.000   3rd Qu.: 7127   3rd Qu.:48.45  
##  Max.   :512   Max.   :6.000   Max.   :16276   Max.   :54.55  
##                                                               
##  InsCalk_2002.08
##  Min.   :47.02  
##  1st Qu.:63.78  
##  Median :64.09  
##  Mean   :63.87  
##  3rd Qu.:64.26  
##  Max.   :69.44  
## </code></pre>
</div>
<div id="statystyki-opisowe-srednia-i-mediana" class="section level3">
<h3><span class="header-section-number">3.3.2</span> Statystyki opisowe | średnia i mediana</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">median</span>(wolin_lato_los$X1999<span class="fl">.09</span>.13_TPZ, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## [1] 21.45667</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>(wolin_lato_los$X1999<span class="fl">.09</span>.13_TPZ, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## [1] 22.86002</code></pre>
</div>
<div id="statystyki-opisowe-srednia-i-mediana-1" class="section level3">
<h3><span class="header-section-number">3.3.3</span> Statystyki opisowe | średnia i mediana</h3>
<ul>
<li>w wypadku symetrycznego rozkładu te dwie cechy są równe</li>
<li>średnia jest bardziej wrażliwa na wartości odstające</li>
<li>mediana jest lepszą miarą środka danych, jeżeli są one skośne</li>
</ul>
<p>Po co używać średniej?</p>
<ul>
<li>przydatniejsza w przypadku małych zbiorów danych</li>
<li>gdy rozkład danych jest symetryczny</li>
<li>(jednak) często warto podawać obie miary</li>
</ul>
</div>
<div id="statystyki-opisowe-minimum-i-maksimum" class="section level3">
<h3><span class="header-section-number">3.3.4</span> Statystyki opisowe | minimum i maksimum</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">min</span>(wolin_lato_los$X1999<span class="fl">.09</span>.13_TPZ, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## [1] 16.00699</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">max</span>(wolin_lato_los$X1999<span class="fl">.09</span>.13_TPZ, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## [1] 33.18976</code></pre>
</div>
<div id="statystyki-opisowe-ochylenie-standardowe" class="section level3">
<h3><span class="header-section-number">3.3.5</span> Statystyki opisowe | ochylenie standardowe</h3>
<div class="figure">
<img src="figs/sd.png" alt="" />

</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sd</span>(wolin_lato_los$X1999<span class="fl">.09</span>.13_TPZ, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## [1] 3.661502</code></pre>
</div>
</div>
<div id="wykresy" class="section level2">
<h2><span class="header-section-number">3.4</span> Wykresy</h2>
<div id="histogram" class="section level3">
<h3><span class="header-section-number">3.4.1</span> Histogram</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&#39;ggplot2&#39;</span>)
<span class="kw">ggplot</span>(wolin_lato_los@data, <span class="kw">aes</span>(X1999<span class="fl">.09</span>.13_TPZ)) +<span class="st"> </span><span class="kw">geom_histogram</span>()</code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<pre><code>## Warning: Removed 495 rows containing non-finite values (stat_bin).</code></pre>
<p><img src="02-eksp_analiza_danych_files/figure-html/unnamed-chunk-7-1.png" alt="" /><!-- --></p>
<ul>
<li>Stworzony przez Karla Pearsona</li>
<li>Jest graficzną reprezentacją rozkładu <br> danych</li>
<li>Wartości danych są łączone w przedziały (na osi poziomej) a na osi pionowej jest ukazana liczba punktów (obserwacji) w każdym przedziale</li>
<li>Różny dobór przedziałów może dawać inną informację</li>
<li>W pakiecie ggplot2, domyślnie przedział to zakres/30</li>
</ul>
</div>
<div id="estymator-jadrowy-gestosci-ang.-kernel-density-estimation" class="section level3">
<h3><span class="header-section-number">3.4.2</span> Estymator jądrowy gęstości (ang. <em>kernel density estimation</em>)</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(wolin_lato_los@data, <span class="kw">aes</span>(X1999<span class="fl">.09</span>.13_TPZ)) +<span class="st"> </span><span class="kw">geom_density</span>()</code></pre></div>
<pre><code>## Warning: Removed 495 rows containing non-finite values (stat_density).</code></pre>
<p><img src="02-eksp_analiza_danych_files/figure-html/unnamed-chunk-8-1.png" alt="" /><!-- --></p>
</div>
<div id="wykresy-kwantyl-kwantyl-ang.quantile-quantile" class="section level3">
<h3><span class="header-section-number">3.4.3</span> Wykresy kwantyl-kwantyl (ang.<em>quantile-quantile</em>)</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(wolin_lato_los@data, <span class="kw">aes</span>(<span class="dt">sample=</span>X1999<span class="fl">.09</span>.13_TPZ)) +<span class="st"> </span><span class="kw">stat_qq</span>()</code></pre></div>
<pre><code>## Warning: Removed 495 rows containing non-finite values (stat_qq).</code></pre>
<p><img src="02-eksp_analiza_danych_files/figure-html/unnamed-chunk-9-1.png" alt="" /><!-- --></p>
</div>
<div id="wykresy-kwantyl-kwantyl-ang.-quantile-quantile" class="section level3">
<h3><span class="header-section-number">3.4.4</span> Wykresy kwantyl-kwantyl (ang. <em>quantile-quantile</em>)</h3>
<p><a href="http://stats.stackexchange.com/questions/101274/how-to-interpret-a-qq-plot" class="uri">http://stats.stackexchange.com/questions/101274/how-to-interpret-a-qq-plot</a> <img src="figs/qq.png" alt="http://stats.stackexchange.com/questions/101274/how-to-interpret-a-qq-plot" /></p>
<!--    
## [analiza typu rozkładu jednej zmiennej i porównanie rozkładów dwóch zmiennych (wykresy q-q i p-p)]
    


```r
df <- as.data.frame(qqplot(wolin_lato_los$X1999.09.13_TPZ, wolin_lato_los$X1999.09.13_NDVI, plot.it=FALSE))
ggplot(df) + geom_point(aes(x=x, y=y)) + xlab('TPZ') + ylab('NDVI')
```

![](02-eksp_analiza_danych_files/figure-html/unnamed-chunk-10-1.png)<!-- -->
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(wolin_lato_los@data) +<span class="st"> </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x=</span>X1999<span class="fl">.09</span>.13_TPZ, <span class="dt">y=</span>X1999<span class="fl">.09</span>.13_NDVI)) +<span class="st"> </span><span class="kw">xlab</span>(<span class="st">&#39;TPZ&#39;</span>) +<span class="st"> </span><span class="kw">ylab</span>(<span class="st">&#39;NDVI&#39;</span>)</code></pre></div>
<pre><code>## Warning: Removed 495 rows containing missing values (geom_point).</code></pre>
<p><img src="02-eksp_analiza_danych_files/figure-html/unnamed-chunk-10-2.png" alt="" /><!-- --></p>
<p>–&gt;</p>
</div>
<div id="dystrybuanta-cdf" class="section level3">
<h3><span class="header-section-number">3.4.5</span> Dystrybuanta (CDF)</h3>
<ul>
<li>Dystrybuanta (ang. conditional density function - CDF) wyświetla prawdopodobieństwo, że wartość zmiennej przewidywanej jest mniejsza lub równa określonej wartości</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(wolin_lato_los@data, <span class="kw">aes</span>(X1999<span class="fl">.09</span>.13_TPZ)) +<span class="st"> </span><span class="kw">stat_ecdf</span>()</code></pre></div>
<pre><code>## Warning: Removed 495 rows containing non-finite values (stat_ecdf).</code></pre>
<p><img src="02-eksp_analiza_danych_files/figure-html/unnamed-chunk-11-1.png" alt="" /><!-- --></p>
</div>
</div>
<div id="porownanie-zmiennych" class="section level2">
<h2><span class="header-section-number">3.5</span> Porównanie zmiennych</h2>
<div id="kowariancja" class="section level3">
<h3><span class="header-section-number">3.5.1</span> Kowariancja</h3>
<ul>
<li>Kowariancja jest nieunormowaną miarą zależności liniowej pomiędzy dwiema zmiennymi</li>
<li>Kowariancja dwóch zmiennych <span class="math inline">\(x\)</span> i <span class="math inline">\(y\)</span> pokazuje jak dwie zmienne są ze sobą liniowo powiązane</li>
<li>Dodatnia kowariancja wzkazuje na pozytywną relację liniową pomiędzy zmiennymi, podczas gdy ujemna kowariancja świadczy o odwrotnej sytuacji</li>
<li>Jeżeli zmienne nie są ze sobą liniowo powiązane, wartość kowariacji jest bliska zeru</li>
<li>Inaczej mówiąc, kowariancja stanowi miarę wspólnej zmienności dwóch zmiennych<br />
</li>
<li>Wielkość samej kowariancji uzależniona jest od przyjętej skali zmiennej (jednostki)</li>
<li>Inne wyniku uzyskamy (przy tej samej zależności pomiędzy parą zmiennych), gdy będziemy analizować wyniki np. wieku i dochodu w złotówkach a inne dla wieku i dochodu w dolarach</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cov</span>(wolin_lato_los$X1999<span class="fl">.09</span>.13_TPZ, wolin_lato_los$X1999<span class="fl">.09</span>.13_NDVI, <span class="dt">use=</span>  <span class="st">&quot;complete.obs&quot;</span>)</code></pre></div>
<pre><code>## [1] -0.4454703</code></pre>
</div>
<div id="wspoczynnik-korelacji" class="section level3">
<h3><span class="header-section-number">3.5.2</span> Współczynnik korelacji</h3>
<ul>
<li>Wspołczynnik korelacji to unormowana miara zależności pomiędzy dwiema zmiennymi, przyjmująca wartości od -1 do 1</li>
<li>Współczynnik korelacji jest uzyskiwany poprzez podzielenie wartości kowariancji przez odchylenie standardowe wyników</li>
<li>Z racji unormowania nie jest ona uzależniona od jednostki</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(wolin_lato_los@data, <span class="kw">aes</span>(X1999<span class="fl">.09</span>.13_TPZ, X1999<span class="fl">.09</span>.13_NDVI)) +<span class="st"> </span><span class="kw">geom_point</span>()</code></pre></div>
<pre><code>## Warning: Removed 495 rows containing missing values (geom_point).</code></pre>
<p><img src="02-eksp_analiza_danych_files/figure-html/unnamed-chunk-13-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cor</span>(wolin_lato_los$X1999<span class="fl">.09</span>.13_TPZ, wolin_lato_los$X1999<span class="fl">.09</span>.13_NDVI, <span class="dt">use=</span>  <span class="st">&quot;complete.obs&quot;</span>)</code></pre></div>
<pre><code>## [1] -0.7036398</code></pre>
</div>
<div id="wspoczynnik-korelacji-1" class="section level3">
<h3><span class="header-section-number">3.5.3</span> Współczynnik korelacji</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cor.test</span>(wolin_lato_los$X1999<span class="fl">.09</span>.13_TPZ, wolin_lato_los$X1999<span class="fl">.09</span>.13_NDVI)</code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  wolin_lato_los$X1999.09.13_TPZ and wolin_lato_los$X1999.09.13_NDVI
## t = -15.751, df = 253, p-value &lt; 2.2e-16
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  -0.7607274 -0.6357494
## sample estimates:
##        cor 
## -0.7036398</code></pre>
</div>
<div id="wspoczynnik-korelacji-2" class="section level3">
<h3><span class="header-section-number">3.5.4</span> Współczynnik korelacji</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cor</span>(wolin_lato_los@data[<span class="kw">c</span>(<span class="dv">1</span>:<span class="dv">4</span>, <span class="dv">7</span>:<span class="dv">9</span>)], <span class="dt">use=</span> <span class="st">&quot;complete.obs&quot;</span>)</code></pre></div>
<pre><code>##                  X1999.09.13_TPZ X1999.09.13_NDVI X2002.08.20_TPZ
## X1999.09.13_TPZ        1.0000000      -0.70363978       0.9041594
## X1999.09.13_NDVI      -0.7036398       1.00000000      -0.6389463
## X2002.08.20_TPZ        0.9041594      -0.63894626       1.0000000
## X2002.08.20_NDVI      -0.6348066       0.89587063      -0.6752586
## odl_od_morza           0.3924286      -0.15757467       0.3481699
## InsCalk_1999.09        0.1431125       0.03585373       0.1180259
## InsCalk_2002.08        0.1549011       0.03858753       0.1300928
##                  X2002.08.20_NDVI odl_od_morza InsCalk_1999.09
## X1999.09.13_TPZ       -0.63480660    0.3924286      0.14311253
## X1999.09.13_NDVI       0.89587063   -0.1575747      0.03585373
## X2002.08.20_TPZ       -0.67525858    0.3481699      0.11802594
## X2002.08.20_NDVI       1.00000000   -0.1381452      0.04653160
## odl_od_morza          -0.13814523    1.0000000      0.13097399
## InsCalk_1999.09        0.04653160    0.1309740      1.00000000
## InsCalk_2002.08        0.04930027    0.1331220      0.99738708
##                  InsCalk_2002.08
## X1999.09.13_TPZ       0.15490106
## X1999.09.13_NDVI      0.03858753
## X2002.08.20_TPZ       0.13009279
## X2002.08.20_NDVI      0.04930027
## odl_od_morza          0.13312196
## InsCalk_1999.09       0.99738708
## InsCalk_2002.08       1.00000000</code></pre>
</div>
<div id="wspoczynnik-korelacji-3" class="section level3">
<h3><span class="header-section-number">3.5.5</span> Współczynnik korelacji</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&#39;corrplot&#39;</span>)
<span class="kw">corrplot</span>(<span class="kw">cor</span>(wolin_lato_los@data[<span class="kw">c</span>(<span class="dv">1</span>:<span class="dv">4</span>, <span class="dv">7</span>:<span class="dv">9</span>)], <span class="dt">use=</span> <span class="st">&quot;complete.obs&quot;</span>))</code></pre></div>
<p><img src="02-eksp_analiza_danych_files/figure-html/unnamed-chunk-16-1.png" alt="" /><!-- --></p>
<!--    
### Dane odstające
-->
</div>
<div id="wykresy-pudekowe" class="section level3">
<h3><span class="header-section-number">3.5.6</span> Wykresy pudełkowe</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">wolin_lato_los$CLC06_p_lato &lt;-<span class="st"> </span><span class="kw">as.factor</span>(wolin_lato_los$CLC06_p_lato)
<span class="kw">ggplot</span>(wolin_lato_los@data, <span class="kw">aes</span>(CLC06_p_lato, X1999<span class="fl">.09</span>.13_TPZ)) +<span class="st"> </span><span class="kw">geom_boxplot</span>()</code></pre></div>
<pre><code>## Warning: Removed 495 rows containing non-finite values (stat_boxplot).</code></pre>
<p><img src="02-eksp_analiza_danych_files/figure-html/unnamed-chunk-17-1.png" alt="" /><!-- --></p>
<ul>
<li>obrazuje pięc podstawowych <br> statystyk opisowych oraz wartości odstające</li>
<li>pudełko to zakres międzykwantylowy</li>
<li>linie oznaczają najbardziej ekstremalne wartości, ale nie odstające. Górna to 1,5*IQR ponad krawędź pudełka, dolna to 1,5*IQR poniżej wartości dolnej krawędzi pudełka</li>
<li>linia środkowa to mediana</li>
</ul>
</div>
<div id="wykresy-pudekowe-1" class="section level3">
<h3><span class="header-section-number">3.5.7</span> Wykresy pudełkowe</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(wolin_lato_los@data, <span class="kw">aes</span>(CLC06_p_lato, X1999<span class="fl">.09</span>.13_TPZ)) +<span class="st"> </span><span class="kw">geom_boxplot</span>()</code></pre></div>
<pre><code>## Warning: Removed 495 rows containing non-finite values (stat_boxplot).</code></pre>
<p><img src="02-eksp_analiza_danych_files/figure-html/unnamed-chunk-18-1.png" alt="" /><!-- --></p>
<ol style="list-style-type: decimal">
<li>Tereny komunikacyjne i porty</li>
<li>Zabudowa luźna, złożone systemy upraw i działek</li>
<li>Grunty orne, Łąki</li>
<li>Lasy liściaste, Lasy iglaste, mieszane</li>
<li>Bagna, Torfowiska</li>
<li>Zbiorniki wodne</li>
</ol>
</div>
<div id="testowanie-istotnosci-roznic-sredniej-pomiedzy-grupami" class="section level3">
<h3><span class="header-section-number">3.5.8</span> Testowanie istotności różnić średniej pomiędzy grupami</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">wolin_lato_los$CLC06_p_lato &lt;-<span class="st"> </span><span class="kw">as.factor</span>(wolin_lato_los$CLC06_p_lato)
aov_test &lt;-<span class="st"> </span><span class="kw">aov</span>(X1999<span class="fl">.09</span>.13_TPZ~CLC06_p_lato, <span class="dt">data=</span>wolin_lato_los)
<span class="kw">summary</span>(aov_test)</code></pre></div>
<pre><code>##               Df Sum Sq Mean Sq F value Pr(&gt;F)    
## CLC06_p_lato   5   1665   333.1   47.66 &lt;2e-16 ***
## Residuals    249   1740     7.0                   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 495 observations deleted due to missingness</code></pre>
</div>
<div id="testowanie-istotnosci-roznic-sredniej-pomiedzy-grupami-1" class="section level3">
<h3><span class="header-section-number">3.5.9</span> Testowanie istotności różnić średniej pomiędzy grupami</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tukey &lt;-<span class="st"> </span><span class="kw">TukeyHSD</span>(aov_test, <span class="st">&quot;CLC06_p_lato&quot;</span>)
<span class="kw">plot</span>(tukey, <span class="dt">las=</span><span class="dv">1</span>)</code></pre></div>
<p><img src="02-eksp_analiza_danych_files/figure-html/unnamed-chunk-20-1.png" alt="" /><!-- --></p>
</div>
</div>
<div id="transformacje-danych" class="section level2">
<h2><span class="header-section-number">3.6</span> Transformacje danych</h2>
<div id="transformacje-danych-1" class="section level3">
<h3><span class="header-section-number">3.6.1</span> Transformacje danych</h3>
<ul>
<li>Transformacja danych może mieć na celu ułatwienie porównywania różnych zmiennych, zniwelowanie skośności rozkładu lub też zmniejszenie wpływu danych odstających</li>
<li>Centrowanie i skalowanie (standaryzacja):
<ul>
<li>Centrowanie danych - wybierana jest przeciętna wartość predyktora, a następnie od wszystkich wartości predyktorów odejmowana jest wybrana wcześniej wartość</li>
<li>Skalowanie danych - dzielenie każdej wartości predyktora przez jego odchylenie standardowe</li>
<li>Wadą tego podjeścia jest główne zmniejszenie interpretowalności pojedynczych wartości</li>
</ul></li>
<li>Redukcja skośności:
<ul>
<li>Logarytmizacja</li>
<li>Pierwiastkowanie</li>
<li>Rodzina transformacji Boxa Coxa</li>
<li>Inne</li>
</ul></li>
</ul>
</div>
<div id="transformacja-danych-logarytmizacja" class="section level3">
<h3><span class="header-section-number">3.6.2</span> Transformacja danych | Logarytmizacja</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(wolin_lato_los@data, <span class="kw">aes</span>(X2002<span class="fl">.08</span>.20_TPZ)) +<span class="st"> </span><span class="kw">geom_density</span>()</code></pre></div>
<p><img src="02-eksp_analiza_danych_files/figure-html/unnamed-chunk-21-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">wolin_lato_los$log_tpz &lt;-<span class="st"> </span><span class="kw">log</span>(wolin_lato_los$X2002<span class="fl">.08</span>.20_TPZ)
<span class="kw">ggplot</span>(wolin_lato_los@data, <span class="kw">aes</span>(log_tpz)) +<span class="st"> </span><span class="kw">geom_density</span>()</code></pre></div>
<p><img src="02-eksp_analiza_danych_files/figure-html/unnamed-chunk-21-2.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">wolin_lato_los$exp_tpz &lt;-<span class="st"> </span><span class="kw">exp</span>(wolin_lato_los$log_tpz)
<span class="kw">ggplot</span>(wolin_lato_los@data, <span class="kw">aes</span>(exp_tpz)) +<span class="st"> </span><span class="kw">geom_density</span>()</code></pre></div>
<p><img src="02-eksp_analiza_danych_files/figure-html/unnamed-chunk-21-3.png" alt="" /><!-- --></p>
</div>
<div id="transformacja-danych-pierwiastkowanie" class="section level3">
<h3><span class="header-section-number">3.6.3</span> Transformacja danych | Pierwiastkowanie</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(wolin_lato_los@data, <span class="kw">aes</span>(X2002<span class="fl">.08</span>.20_TPZ)) +<span class="st"> </span><span class="kw">geom_density</span>()</code></pre></div>
<p><img src="02-eksp_analiza_danych_files/figure-html/unnamed-chunk-22-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">wolin_lato_los$sqrt_tpz &lt;-<span class="st"> </span><span class="kw">sqrt</span>(wolin_lato_los$X2002<span class="fl">.08</span>.20_TPZ)
<span class="kw">ggplot</span>(wolin_lato_los@data, <span class="kw">aes</span>(sqrt_tpz)) +<span class="st"> </span><span class="kw">geom_density</span>()</code></pre></div>
<p><img src="02-eksp_analiza_danych_files/figure-html/unnamed-chunk-22-2.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">wolin_lato_los$pow_tpz &lt;-<span class="st"> </span>wolin_lato_los$sqrt_tpz^<span class="dv">2</span>
<span class="kw">ggplot</span>(wolin_lato_los@data, <span class="kw">aes</span>(pow_tpz)) +<span class="st"> </span><span class="kw">geom_density</span>()</code></pre></div>
<p><img src="02-eksp_analiza_danych_files/figure-html/unnamed-chunk-22-3.png" alt="" /><!-- --></p>
</div>
<div id="transformacja-danych-rodzina-transformacji-boxa-coxa" class="section level3">
<h3><span class="header-section-number">3.6.4</span> Transformacja danych | Rodzina transformacji Boxa Coxa</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&#39;caret&#39;</span>)</code></pre></div>
<pre><code>## Loading required package: lattice</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(wolin_lato_los@data, <span class="kw">aes</span>(X2002<span class="fl">.08</span>.20_TPZ)) +<span class="st"> </span><span class="kw">geom_density</span>()</code></pre></div>
<p><img src="02-eksp_analiza_danych_files/figure-html/unnamed-chunk-23-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">transformacja &lt;-<span class="st"> </span><span class="kw">BoxCoxTrans</span>(wolin_lato_los$X2002<span class="fl">.08</span>.20_TPZ)
transformacja</code></pre></div>
<pre><code>## Box-Cox Transformation
## 
## 750 data points used to estimate Lambda
## 
## Input data summary:
##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   17.11   20.48   21.89   23.56   25.81   41.79 
## 
## Largest/Smallest: 2.44 
## Sample Skewness: 1.34 
## 
## Estimated Lambda: -2</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">wolin_lato_los$bc_tpz &lt;-<span class="st"> </span><span class="kw">predict</span>(transformacja, wolin_lato_los$X2002<span class="fl">.08</span>.20_TPZ)
<span class="kw">ggplot</span>(wolin_lato_los@data, <span class="kw">aes</span>(bc_tpz)) +<span class="st"> </span><span class="kw">geom_density</span>()</code></pre></div>
<p><img src="02-eksp_analiza_danych_files/figure-html/unnamed-chunk-23-2.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">invBoxCox &lt;-<span class="st"> </span>function(x, lambda) if (lambda ==<span class="st"> </span><span class="dv">0</span>) <span class="kw">exp</span>(x) else (lambda*x +<span class="st"> </span><span class="dv">1</span>)^(<span class="dv">1</span>/lambda) 
wolin_lato_los$bc_tpz_inv &lt;-<span class="st"> </span><span class="kw">invBoxCox</span>(wolin_lato_los$bc_tpz, <span class="dt">lambda=</span>-<span class="dv">2</span>)
<span class="kw">ggplot</span>(wolin_lato_los@data, <span class="kw">aes</span>(bc_tpz_inv)) +<span class="st"> </span><span class="kw">geom_density</span>()</code></pre></div>
<p><img src="02-eksp_analiza_danych_files/figure-html/unnamed-chunk-23-3.png" alt="" /><!-- --></p>
</div>
</div>
<div id="mapy" class="section level2">
<h2><span class="header-section-number">3.7</span> Mapy</h2>
<div id="podstawowe-terminy-kontekst-przestrzenny" class="section level3">
<h3><span class="header-section-number">3.7.1</span> Podstawowe terminy | Kontekst przestrzenny</h3>
<ul>
<li>Populacja - cały obszar, dla którego chcemy określić wybrane właściwości</li>
<li>Próba - zbiór obserwacji, dla których mamy informacje. Inaczej, próba to podzbiór populacji. Zazwyczaj niemożliwe (lub bardzo kosztowne) jest zdobycie informacji o całej populacji. Z tego powodu bardzo cenne jest odpowiednie wykorzystanie informacji z próby.</li>
</ul>
</div>
<div id="mapy-punktowe-cel" class="section level3">
<h3><span class="header-section-number">3.7.2</span> Mapy punktowe | Cel</h3>
<ul>
<li>Sprawdzenie poprawności współrzędnych</li>
<li>Wgląd w typ próbkowania</li>
<li>Sprawdzenie poprawności danych - dane odstające lokalnie</li>
<li>Identyfikacja głównych cech struktury przestrzennej zjawiska (np. trend)</li>
</ul>
</div>
<div id="typ-probowania" class="section level3">
<h3><span class="header-section-number">3.7.3</span> Typ próbowania</h3>
<ul>
<li>Regularny</li>
<li>Losowy</li>
<li>Losowy stratyfikowany</li>
<li>Preferencyjny</li>
<li>Liniowy</li>
</ul>
</div>
<div id="typ-probowania-regularny" class="section level3">
<h3><span class="header-section-number">3.7.4</span> Typ próbowania | Regularny</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">225</span>)
regularny &lt;-<span class="st"> </span><span class="kw">spsample</span>(poligon, <span class="dv">150</span>, <span class="dt">type =</span> <span class="st">&#39;regular&#39;</span>)
<span class="kw">plot</span>(regularny)</code></pre></div>
<p><img src="02-eksp_analiza_danych_files/figure-html/unnamed-chunk-24-1.png" alt="" /><!-- --></p>
<ul>
<li>Zmienna <em>offset</em></li>
</ul>
</div>
<div id="typ-probowania-losowy" class="section level3">
<h3><span class="header-section-number">3.7.5</span> Typ próbowania | Losowy</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">301</span>)
losowy &lt;-<span class="st"> </span><span class="kw">spsample</span>(poligon, <span class="dv">150</span>, <span class="dt">type =</span> <span class="st">&#39;random&#39;</span>)
<span class="kw">plot</span>(losowy)</code></pre></div>
<p><img src="02-eksp_analiza_danych_files/figure-html/unnamed-chunk-25-1.png" alt="" /><!-- --></p>
<ul>
<li>Każda lokalizacja ma takie samo prawdopodobieństwo wystąpienia</li>
<li>Każdy punkt jest losowany niezależnie od pozostałych</li>
</ul>
</div>
<div id="typ-probowania-losowy-stratyfikowany" class="section level3">
<h3><span class="header-section-number">3.7.6</span> Typ próbowania | Losowy stratyfikowany</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">125</span>)
strat &lt;-<span class="st"> </span><span class="kw">spsample</span>(poligon, <span class="dv">150</span>, <span class="dt">type =</span> <span class="st">&#39;stratified&#39;</span>)
<span class="kw">plot</span>(strat)</code></pre></div>
<p><img src="02-eksp_analiza_danych_files/figure-html/unnamed-chunk-26-1.png" alt="" /><!-- --></p>
</div>
<div id="typ-probowania-preferencyjny-i" class="section level3">
<h3><span class="header-section-number">3.7.7</span> Typ próbowania | Preferencyjny I</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">425</span>)
pref &lt;-<span class="st"> </span><span class="kw">spsample</span>(poligon, <span class="dv">150</span>, <span class="dt">type =</span> <span class="st">&#39;clustered&#39;</span>, <span class="dt">nclusters=</span><span class="dv">80</span>)
<span class="kw">plot</span>(pref)</code></pre></div>
<p><img src="02-eksp_analiza_danych_files/figure-html/unnamed-chunk-27-1.png" alt="" /><!-- --></p>
</div>
<div id="typ-probowania-liniowy" class="section level3">
<h3><span class="header-section-number">3.7.8</span> Typ próbowania | Liniowy</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&#39;rgdal&#39;</span>)
linia &lt;-<span class="st"> </span><span class="kw">readOGR</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;linia&quot;</span>, <span class="dt">verbose=</span><span class="ot">FALSE</span>)
<span class="kw">set.seed</span>(<span class="dv">224</span>)
izoliniowy &lt;-<span class="st"> </span><span class="kw">spsample</span>(linia, <span class="dv">150</span>, <span class="dt">type =</span> <span class="st">&#39;regular&#39;</span>)
<span class="kw">plot</span>(izoliniowy)</code></pre></div>
<p><img src="02-eksp_analiza_danych_files/figure-html/unnamed-chunk-28-1.png" alt="" /><!-- --></p>
</div>
<div id="mapy-punktowe-i-dane-lokalnie-odstajace" class="section level3">
<h3><span class="header-section-number">3.7.9</span> Mapy punktowe i dane lokalnie odstające</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">4</span>)))
<span class="kw">library</span>(<span class="st">&#39;rgdal&#39;</span>)
poligon &lt;-<span class="st"> </span><span class="kw">readOGR</span>(<span class="dt">dsn=</span><span class="st">&#39;data&#39;</span>, <span class="dt">layer=</span><span class="st">&#39;wolin_polygon&#39;</span>, <span class="dt">verbose=</span><span class="ot">FALSE</span>) 
<span class="kw">plot</span>(poligon) 
<span class="kw">plot</span>(wolin_lato_los, <span class="dt">add=</span><span class="ot">TRUE</span>) </code></pre></div>
<p><img src="02-eksp_analiza_danych_files/figure-html/unnamed-chunk-29-1.png" alt="" /><!-- --></p>
</div>
<div id="mapy-punktowe-i-dane-lokalnie-odstajace-1" class="section level3">
<h3><span class="header-section-number">3.7.10</span> Mapy punktowe i dane lokalnie odstające</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&#39;sp&#39;</span>)
<span class="co"># select.spatial(wolin_lato_los, digitize=FALSE, rownames=TRUE)</span>
<span class="kw">spplot</span>(wolin_lato_los, <span class="st">&quot;X2002.08.20_TPZ&quot;</span>, <span class="dt">identify=</span><span class="ot">TRUE</span>)</code></pre></div>
</div>
<div id="mapy-punktowe-i-dane-lokalnie-odstajace-2" class="section level3">
<h3><span class="header-section-number">3.7.11</span> Mapy punktowe i dane lokalnie odstające</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">spplot</span>(wolin_lato_los, <span class="st">&quot;X2002.08.20_TPZ&quot;</span>, <span class="dt">sp.layout =</span> poligon)</code></pre></div>
<p><img src="02-eksp_analiza_danych_files/figure-html/unnamed-chunk-30-1.png" alt="" /><!-- --></p>
<!--
### Mapy punktowe i dane lokalnie odstające


```r
library('GeoXp')
options(device="windows") #X11
# clear all plots
dev.new()
boxplotmap(wolin_lato_los, "X2002.08.20_TPZ")
driftmap(wolin_lato_los, "X2002.08.20_TPZ")
plot3dmap(wolin_lato_los, c('X2002.08.20_TPZ', 'X2002.08.20_NDVI', 'odl_od_morza'))
```


-->
<!--

### Mapy punktowe i dane lokalnie odstające


```r
# library('GeoXp')
# options(device="windows") #X11
# # clear all plots
# dev.new()
# boxplotmap(wolin_lato_los, "X2002.08.20_TPZ")
# driftmap(wolin_lato_los, "X2002.08.20_TPZ")
# plot3dmap(wolin_lato_los, c('X2002.08.20_TPZ', 'X2002.08.20_NDVI', 'odl_od_morza'))
```


## Średnia lokalna i wariancja lokaln
### Średnia lokalna 
library('gplots')
wapply(wolin_lato_los_df$X,wolin_lato_los$X2002.08.20_TPZ, fun=mean, n=10)
#' 
#' ### Wariancja lokalna 
wapply(wolin_lato_los_df$X,wolin_lato_los$X2002.08.20_TPZ, fun=var, n=10)
#' 
wolin_lato_los_df <- as.data.frame(wolin_lato_los)
library("ggplot2")
ggplot(wolin_lato_los_df, aes(X, X2002.08.20_TPZ)) + geom_point() + geom_smooth()
ggplot(wolin_lato_los_df, aes(X2002.08.20_TPZ, Y)) + geom_point() + geom_smooth() + coord_flip()

library("gstat")
wolin_lato_pref <- read.csv("data/Wolin_TPZ_p_lato_754prefN.csv", na.strings = -999)
wolin_lato_pref$rn <- 1:nrow(wolin_lato_pref)
coordinates(wolin_lato_pref) <- ~X + Y
proj4string(wolin_lato_pref) <- "+init=epsg:32633"
spplot(wolin_lato_pref, "rn", colorkey=TRUE)

library('rgdal')
library("raster")
library('rgeos')
poligon_shp <- readOGR(dsn = "data", layer = "wolin_polygon", verbose = FALSE)
siatka_n <- raster(extent(poligon_shp))
res(siatka_n) <- c(5000, 5000)
siatka_n[] <- 0
proj4string(siatka_n) <- CRS(proj4string(wolin_lato_pref))
siatka_n <- mask(siatka_n, gBuffer(poligon_shp, width = 2500))
siatka_n <- as(siatka_n, "SpatialPolygonsDataFrame")
siatka_n <- siatka_n[!is.na(siatka_n@data$layer), ]
plot(siatka_n)
plot(wolin_lato_pref, add=TRUE)

lok_srednia <- aggregate(wolin_lato_pref['X2002.08.20_TPZ'], by = siatka_n, FUN = mean) 
lok_wariancja <- aggregate(wolin_lato_pref['X2002.08.20_TPZ'], by = siatka_n, FUN = var) 

lokalne <- cbind(lok_srednia@data, lok_wariancja@data)
names(lokalne) <- c("srednia", "wariancja")
ggplot(lokalne, aes(srednia, wariancja)) + geom_point()

spplot(siatka_nr, "liczebnosc")


[statystyki lokalne w ruchomym oknie (średnia lokalna i wariancja lokalna)]
    
    GeoXp
    
    
    library('GeoXp')
    options(device="X11")
    dev.new()
    # angleplotmap(wolin_lato_los, "X2002.08.20_TPZ") # zapycha pamięć
    barmap(wolin_lato_los, "X2002.08.20_TPZ") # klikadło wykresowe
    boxplotmap(wolin_lato_los, "X2002.08.20_TPZ")
    densitymap(wolin_lato_los, "X2002.08.20_TPZ")
    driftmap(wolin_lato_los, "X2002.08.20_TPZ")
    ginimap(wolin_lato_los, "X2002.08.20_TPZ")
    histomap(wolin_lato_los, "X2002.08.20_TPZ")
    variocloudmap(wolin_lato_los, "X2002.08.20_TPZ") dłuugo
    
    clustermap(wolin_lato_los, c('X2002.08.20_TPZ', 'X2002.08.20_NDVI'), 3) ## ?
    dbledensitymap(wolin_lato_los, c('X2002.08.20_TPZ', 'X2002.08.20_NDVI'))
    dblehistomap(wolin_lato_los, c('X2002.08.20_TPZ', 'X2002.08.20_NDVI'))
    histobarmap(wolin_lato_los, c('X2002.08.20_TPZ', 'X2002.08.20_NDVI'))
    pcamap(wolin_lato_los, c('X2002.08.20_TPZ', 'X2002.08.20_NDVI'))
    plot3dmap(wolin_lato_los, c('X2002.08.20_TPZ', 'X2002.08.20_NDVI', 'odl_od_morza'))
    scattermap(wolin_lato_los, c('X2002.08.20_TPZ', 'X2002.08.20_NDVI'))

    [efekt proporcjonalności]
    
    Efekt proporcjonalności średniej lokalnej do wariancji lokalnej)
-->
</div>
</div>
<div id="rozgrupowanie-danych" class="section level2">
<h2><span class="header-section-number">3.8</span> Rozgrupowanie danych</h2>
<div id="rozgrupowanie-danych-1" class="section level3">
<h3><span class="header-section-number">3.8.1</span> Rozgrupowanie danych</h3>
<ul>
<li>Istnieje szereg metod rozgrupowywania danych, między innymi:
<ul>
<li>Rozgrupowywanie komórkowe</li>
<li>Rozgrupowywanie poligonowe</li>
</ul></li>
<li>Celem tych metod jest nadanie wag obserwacjom w celu zapewnienia reprezentatywności przestrzennej danych</li>
</ul>
</div>
<div id="rozgrupowanie-danych-2" class="section level3">
<h3><span class="header-section-number">3.8.2</span> Rozgrupowanie danych</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&#39;sp&#39;</span>)
wolin_lato_pref &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&#39;data/Wolin_TPZ_p_lato_754prefN.csv&#39;</span>, <span class="dt">na.strings=</span>-<span class="fl">999.00</span>)
<span class="kw">coordinates</span>(wolin_lato_pref) &lt;-<span class="st"> </span><span class="er">~</span>X+Y
<span class="kw">proj4string</span>(wolin_lato_pref) &lt;-<span class="st"> &#39;+init=epsg:32633&#39;</span>
<span class="kw">spplot</span>(wolin_lato_pref, <span class="st">&quot;X2002.08.20_TPZ&quot;</span>)</code></pre></div>
<p><img src="02-eksp_analiza_danych_files/figure-html/unnamed-chunk-31-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(wolin_lato_pref$X2002<span class="fl">.08</span>.20_TPZ)</code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   18.14   21.96   26.16   26.54   30.07   44.22</code></pre>
</div>
<div id="rozgrupowanie-komorkowe-i-ang.-cell-declustering" class="section level3">
<h3><span class="header-section-number">3.8.3</span> Rozgrupowanie komórkowe I | (ang. <em>cell declustering</em>)</h3>
<p><span class="math display">\[w&#39;_j=\frac{\frac{1}{n_i}}{\text{liczba komórek z danymi}} \cdot n\]</span> , gdzie <span class="math inline">\(n_i\)</span> to liczba obserwacji w komórce, a <span class="math inline">\(n\)</span> to łączna liczba obserwacji</p>
</div>
<div id="rozgrupowanie-komorkowe-i-ang.-cell-declustering-1" class="section level3">
<h3><span class="header-section-number">3.8.4</span> Rozgrupowanie komórkowe I | (ang. <em>cell declustering</em>)</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">wolin_lato_pref &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/Wolin_TPZ_p_lato_754prefN.csv&quot;</span>, <span class="dt">na.strings =</span> -<span class="dv">999</span>)
wolin_lato_pref$id &lt;-<span class="st"> </span><span class="dv">1</span>:<span class="kw">nrow</span>(wolin_lato_pref)
<span class="kw">coordinates</span>(wolin_lato_pref) &lt;-<span class="st"> </span><span class="er">~</span>X +<span class="st"> </span>Y
<span class="kw">proj4string</span>(wolin_lato_pref) &lt;-<span class="st"> &quot;+init=epsg:32633&quot;</span>
<span class="kw">spplot</span>(wolin_lato_pref, <span class="st">&quot;id&quot;</span>, <span class="dt">colorkey=</span><span class="ot">TRUE</span>)</code></pre></div>
<p><img src="02-eksp_analiza_danych_files/figure-html/unnamed-chunk-32-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&#39;rgdal&#39;</span>)
<span class="kw">library</span>(<span class="st">&quot;raster&quot;</span>)
<span class="kw">library</span>(<span class="st">&#39;rgeos&#39;</span>)</code></pre></div>
<pre><code>## rgeos version: 0.3-15, (SVN revision 515)
##  GEOS runtime version: 3.4.2-CAPI-1.8.2 r3921 
##  Linking to sp version: 1.2-1 
##  Polygon checking: TRUE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">poligon_shp &lt;-<span class="st"> </span><span class="kw">readOGR</span>(<span class="dt">dsn =</span> <span class="st">&quot;data&quot;</span>, <span class="dt">layer =</span> <span class="st">&quot;wolin_polygon&quot;</span>, <span class="dt">verbose =</span> <span class="ot">FALSE</span>)
siatka_n &lt;-<span class="st"> </span><span class="kw">raster</span>(<span class="kw">extent</span>(poligon_shp))
<span class="co"># siatka_n &lt;- raster(xmn=450000, xmx=485000, ymn=5960000, ymx=5989000)</span>
<span class="kw">res</span>(siatka_n) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1000</span>, <span class="dv">1000</span>)
siatka_n[] &lt;-<span class="st"> </span><span class="dv">0</span>
<span class="kw">proj4string</span>(siatka_n) &lt;-<span class="st"> </span><span class="kw">CRS</span>(<span class="kw">proj4string</span>(wolin_lato_pref))
siatka_n &lt;-<span class="st"> </span><span class="kw">mask</span>(siatka_n, <span class="kw">gBuffer</span>(poligon_shp, <span class="dt">width =</span> <span class="dv">500</span>))
siatka_n &lt;-<span class="st"> </span><span class="kw">as</span>(siatka_n, <span class="st">&quot;SpatialPolygonsDataFrame&quot;</span>)
siatka_n &lt;-<span class="st"> </span>siatka_n[!<span class="kw">is.na</span>(siatka_n@data$layer), ]
<span class="kw">plot</span>(siatka_n)
<span class="kw">plot</span>(wolin_lato_pref, <span class="dt">add=</span><span class="ot">TRUE</span>)</code></pre></div>
<p><img src="02-eksp_analiza_danych_files/figure-html/unnamed-chunk-32-2.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">wolin_lato_pref$liczebnosc &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, <span class="kw">length</span>(wolin_lato_pref))
siatka_nr &lt;-<span class="st"> </span><span class="kw">aggregate</span>(wolin_lato_pref[<span class="st">&#39;liczebnosc&#39;</span>], <span class="dt">by =</span> siatka_n, <span class="dt">FUN =</span> length) 
<span class="kw">spplot</span>(siatka_nr, <span class="st">&quot;liczebnosc&quot;</span>)</code></pre></div>
<p><img src="02-eksp_analiza_danych_files/figure-html/unnamed-chunk-32-3.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">liczba &lt;-<span class="st"> </span><span class="kw">over</span>(wolin_lato_pref, siatka_nr)
wolin_lato_pref$waga &lt;-<span class="st"> </span>((<span class="dv">1</span>/liczba$liczebnosc)/<span class="kw">sum</span>(!<span class="kw">is.na</span>(siatka_nr$liczebnosc))) *<span class="st"> </span><span class="kw">length</span>(wolin_lato_pref)

<span class="kw">spplot</span>(wolin_lato_pref, <span class="st">&#39;waga&#39;</span>)</code></pre></div>
<p><img src="02-eksp_analiza_danych_files/figure-html/unnamed-chunk-32-4.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">srednia_arytmetyczna &lt;-<span class="st"> </span><span class="kw">mean</span>(wolin_lato_pref$X2002<span class="fl">.08</span>.20_TPZ)
srednia_wazona_c1 &lt;-<span class="st"> </span><span class="kw">mean</span>(wolin_lato_pref$X2002<span class="fl">.08</span>.20_TPZ *<span class="st"> </span>wolin_lato_pref$waga, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)</code></pre></div>
</div>
<div id="rozgrupowanie-komorkowe-ii-ang.-cell-declustering" class="section level3">
<h3><span class="header-section-number">3.8.5</span> Rozgrupowanie komórkowe II | (ang. <em>cell declustering</em>)</h3>
<!--
- Przygotowanie danych
https://stat.ethz.ch/pipermail/r-sig-geo/2010-February/007710.html

When "interpolating" with nmax=1, you basically assign the value of the 
nearest observation to each grid cell, so, honoustly, it's hard to call 
this interpolation, it is rather something of a discretized Thiessen 
polygon.
-->
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&#39;gstat&#39;</span>)
wolin_lato_pref &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&#39;data/Wolin_TPZ_p_lato_754prefN.csv&#39;</span>, <span class="dt">na.strings=</span>-<span class="fl">999.00</span>)
wolin_lato_pref$id &lt;-<span class="st"> </span><span class="dv">1</span>:<span class="kw">nrow</span>(wolin_lato_pref)
<span class="kw">coordinates</span>(wolin_lato_pref) &lt;-<span class="st"> </span><span class="er">~</span>X+Y
<span class="kw">proj4string</span>(wolin_lato_pref) &lt;-<span class="st"> &#39;+init=epsg:32633&#39;</span>
<span class="kw">spplot</span>(wolin_lato_pref, <span class="st">&quot;id&quot;</span>)</code></pre></div>
<p><img src="02-eksp_analiza_danych_files/figure-html/unnamed-chunk-33-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&#39;raster&#39;</span>)
poligon_shp &lt;-<span class="st"> </span><span class="kw">readOGR</span>(<span class="dt">dsn=</span><span class="st">&#39;data&#39;</span>, <span class="dt">layer=</span><span class="st">&#39;wolin_polygon&#39;</span>, <span class="dt">verbose=</span><span class="ot">FALSE</span>)
siatka_n &lt;-<span class="st"> </span><span class="kw">raster</span>(<span class="kw">extent</span>(poligon_shp))
<span class="kw">res</span>(siatka_n) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">100</span>, <span class="dv">100</span>)
siatka_n[] &lt;-<span class="st"> </span><span class="dv">0</span>
<span class="kw">proj4string</span>(siatka_n) &lt;-<span class="st"> </span><span class="kw">CRS</span>(<span class="kw">proj4string</span>(wolin_lato_pref))
siatka_n &lt;-<span class="st"> </span><span class="kw">mask</span>(siatka_n, poligon_shp)
siatka_n &lt;-<span class="st"> </span><span class="kw">as</span>(siatka_n, <span class="st">&#39;SpatialPointsDataFrame&#39;</span>)
siatka_n &lt;-<span class="st"> </span>siatka_n[!<span class="kw">is.na</span>(siatka_n@data$layer), ]
<span class="kw">gridded</span>(siatka_n) &lt;-<span class="st"> </span><span class="ot">TRUE</span>
<span class="kw">plot</span>(siatka_n)</code></pre></div>
<p><img src="02-eksp_analiza_danych_files/figure-html/unnamed-chunk-33-2.png" alt="" /><!-- --></p>
</div>
<div id="rozgrupowanie-komorkowe-ii-ang.-cell-declustering-1" class="section level3">
<h3><span class="header-section-number">3.8.6</span> Rozgrupowanie komórkowe II | (ang. <em>cell declustering</em>)</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">out &lt;-<span class="st">  </span><span class="kw">krige</span>(id~<span class="dv">1</span>, wolin_lato_pref, siatka_n, <span class="dt">nmax=</span><span class="dv">1</span>)</code></pre></div>
<pre><code>## [inverse distance weighted interpolation]</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">spplot</span>(out, <span class="st">&quot;var1.pred&quot;</span>)</code></pre></div>
<p><img src="02-eksp_analiza_danych_files/figure-html/unnamed-chunk-34-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">table</span>(out[[<span class="dv">1</span>]]))
df$waga &lt;-<span class="st"> </span>df$Freq/<span class="kw">sum</span>(df$Freq)
wolin_lato_pref &lt;-<span class="st"> </span><span class="kw">merge</span>(wolin_lato_pref, df, <span class="dt">by.x=</span><span class="st">&quot;id&quot;</span>, <span class="dt">by.y=</span><span class="st">&quot;Var1&quot;</span>)
<span class="kw">summary</span>(wolin_lato_pref$waga)</code></pre></div>
<pre><code>##      Min.   1st Qu.    Median      Mean   3rd Qu.      Max. 
## 3.822e-05 4.682e-04 8.791e-04 1.326e-03 1.682e-03 8.829e-03</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">spplot</span>(out, <span class="st">&quot;var1.pred&quot;</span>, <span class="dt">sp.layout=</span><span class="kw">list</span>(<span class="st">&quot;sp.points&quot;</span>, wolin_lato_pref))</code></pre></div>
<p><img src="02-eksp_analiza_danych_files/figure-html/unnamed-chunk-34-2.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">spplot</span>(wolin_lato_pref[<span class="st">&quot;waga&quot;</span>])</code></pre></div>
<p><img src="02-eksp_analiza_danych_files/figure-html/unnamed-chunk-34-3.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">srednia_arytmetyczna &lt;-<span class="st"> </span><span class="kw">mean</span>(wolin_lato_pref$X2002<span class="fl">.08</span>.20_TPZ)
srednia_wazona_c2 &lt;-<span class="st"> </span><span class="kw">sum</span>(wolin_lato_pref$X2002<span class="fl">.08</span>.20_TPZ *<span class="st"> </span>wolin_lato_pref$waga, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)</code></pre></div>
</div>
<div id="rozgrupowanie-poligonowe-ang.-polygon-declustering" class="section level3">
<h3><span class="header-section-number">3.8.7</span> Rozgrupowanie poligonowe | (ang. <em>polygon declustering</em>)</h3>
<p><span class="math display">\[w&#39;_j=\frac{area_j}{\sum_{j=1}^{n}area_j} \cdot n\]</span> , gdzie <span class="math inline">\(area_j\)</span> powierzchnia dla wybranej obserwacji, a <span class="math inline">\(n\)</span> to łączna liczba obserwacji</p>
</div>
<div id="rozgrupowanie-poligonowe-ang.-polygon-declustering-1" class="section level3">
<h3><span class="header-section-number">3.8.8</span> Rozgrupowanie poligonowe | (ang. <em>polygon declustering</em>)</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">wolin_lato_pref &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&#39;data/Wolin_TPZ_p_lato_754prefN.csv&#39;</span>, <span class="dt">na.strings=</span>-<span class="fl">999.00</span>)
wolin_lato_pref$id &lt;-<span class="st"> </span><span class="dv">1</span>:<span class="kw">nrow</span>(wolin_lato_pref)
<span class="kw">coordinates</span>(wolin_lato_pref) &lt;-<span class="st"> </span><span class="er">~</span>X+Y
<span class="kw">proj4string</span>(wolin_lato_pref) &lt;-<span class="st"> &#39;+init=epsg:32633&#39;</span>
<span class="kw">spplot</span>(wolin_lato_pref, <span class="st">&quot;id&quot;</span>)</code></pre></div>
<p><img src="02-eksp_analiza_danych_files/figure-html/unnamed-chunk-35-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&#39;dismo&#39;</span>)
v &lt;-<span class="st"> </span><span class="kw">voronoi</span>(wolin_lato_pref)</code></pre></div>
<pre><code>## Loading required namespace: deldir</code></pre>
<pre><code>## 
##      PLEASE NOTE:  The components &quot;delsgs&quot; and &quot;summary&quot; of the
##  object returned by deldir() are now DATA FRAMES rather than
##  matrices (as they were prior to release 0.0-18).
##  See help(&quot;deldir&quot;).
##  
##      PLEASE NOTE: The process that deldir() uses for determining
##  duplicated points has changed from that used in version
##  0.0-9 of this package (and previously). See help(&quot;deldir&quot;).</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(wolin_lato_pref, <span class="dt">cex=</span><span class="fl">0.2</span>, <span class="dt">col=</span><span class="st">&#39;red&#39;</span>)
<span class="kw">plot</span>(v, <span class="dt">add=</span><span class="ot">TRUE</span>)</code></pre></div>
<p><img src="02-eksp_analiza_danych_files/figure-html/unnamed-chunk-35-2.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&#39;rgeos&#39;</span>)
v_intersect &lt;-<span class="kw">intersect</span>(poligon_shp, v)</code></pre></div>
<pre><code>## Warning in intersect(poligon_shp, v): non identical CRS</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(wolin_lato_pref, <span class="dt">cex=</span><span class="fl">0.2</span>, <span class="dt">col=</span><span class="st">&#39;red&#39;</span>)
<span class="kw">plot</span>(v_intersect, <span class="dt">add=</span><span class="ot">TRUE</span>)</code></pre></div>
<p><img src="02-eksp_analiza_danych_files/figure-html/unnamed-chunk-35-3.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">v_intersect$pow &lt;-<span class="st"> </span><span class="kw">area</span>(v_intersect)
v_intersect$waga &lt;-<span class="st"> </span>v_intersect$pow/<span class="kw">sum</span>(v_intersect$pow) *<span class="st"> </span><span class="kw">length</span>(wolin_lato_pref)

wolin_lato_pref &lt;-<span class="st"> </span><span class="kw">merge</span>(wolin_lato_pref, v_intersect[<span class="kw">c</span>(<span class="st">&#39;id&#39;</span>, <span class="st">&#39;waga&#39;</span>)], <span class="dt">by=</span><span class="st">&#39;id&#39;</span>)
<span class="kw">spplot</span>(wolin_lato_pref, <span class="st">&#39;waga&#39;</span>)</code></pre></div>
<p><img src="02-eksp_analiza_danych_files/figure-html/unnamed-chunk-35-4.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">srednia_arytmetyczna &lt;-<span class="st"> </span><span class="kw">mean</span>(wolin_lato_pref$X2002<span class="fl">.08</span>.20_TPZ)
srednia_wazona_p &lt;-<span class="st"> </span><span class="kw">mean</span>(wolin_lato_pref$X2002<span class="fl">.08</span>.20_TPZ*wolin_lato_pref$waga)</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Średnia arytmetyczna</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Populacja</td>
<td align="right">23.46969</td>
</tr>
<tr class="even">
<td align="left">Próba</td>
<td align="right">26.54119</td>
</tr>
<tr class="odd">
<td align="left">Rozgrupowanie komórkowe I</td>
<td align="right">24.55135</td>
</tr>
<tr class="even">
<td align="left">Rozgrupowanie komórkowe II</td>
<td align="right">24.08124</td>
</tr>
<tr class="odd">
<td align="left">Rozgrupowanie poligonowe</td>
<td align="right">24.07996</td>
</tr>
</tbody>
</table>
<!--
polygon declustering - http://gis.stackexchange.com/questions/122376/cell-declustering-using-open-source-software
cell declustering - https://stat.ethz.ch/pipermail/r-sig-geo/2010-February/007710.html
http://gaa.org.au/pdf/DeclusterDebias-CCG.pdf
-->
<!--chapter:end:02-eksp_analiza_danych.Rmd-->
</div>
</div>
</div>
<div id="eksploracyjna-analiza-danych---geostatystyka" class="section level1">
<h1><span class="header-section-number">4</span> Eksploracyjna analiza danych - geostatystyka</h1>
<div id="interpolacja" class="section level2">
<h2><span class="header-section-number">4.1</span> Interpolacja</h2>
<div id="modele-deterministyczne" class="section level3">
<h3><span class="header-section-number">4.1.1</span> Modele deterministyczne</h3>
<ul>
<li>Parametry tych modeli są zazwyczaj ustalane w oparciu o funkcję odległości lub powierzchni. Brakuje również szacunków na temat oceny błędu modelu. Np:
<ul>
<li>Funkcje wielomianowe</li>
<li>Funkcje sklejane (ang. <em>splines</em>)</li>
<li>Triangulacje</li>
<li>IDW (ang. <em>Inverse Distance Weighted</em>)</li>
</ul></li>
</ul>
<p><a href="http://neondataskills.org/Data-Workshops/ESA15-Going-On-The-Grid-Spatial-Interpolation-Basics/" class="uri">http://neondataskills.org/Data-Workshops/ESA15-Going-On-The-Grid-Spatial-Interpolation-Basics/</a></p>
</div>
<div id="modele-deterministyczne-1" class="section level3">
<h3><span class="header-section-number">4.1.2</span> Modele deterministyczne</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&#39;fields&#39;</span>)</code></pre></div>
<pre><code>## Loading required package: methods</code></pre>
<pre><code>## Loading required package: spam</code></pre>
<pre><code>## Loading required package: grid</code></pre>
<pre><code>## Spam version 1.3-0 (2015-10-24) is loaded.
## Type &#39;help( Spam)&#39; or &#39;demo( spam)&#39; for a short introduction 
## and overview of this package.
## Help for individual functions is also obtained by adding the
## suffix &#39;.spam&#39; to the function name, e.g. &#39;help( chol.spam)&#39;.</code></pre>
<pre><code>## 
## Attaching package: &#39;spam&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     backsolve, forwardsolve</code></pre>
<pre><code>## Loading required package: maps</code></pre>
<pre><code>## 
##  # ATTENTION: maps v3.0 has an updated &#39;world&#39; map.        #
##  # Many country borders and names have changed since 1990. #
##  # Type &#39;?world&#39; or &#39;news(package=&quot;maps&quot;)&#39;. See README_v3. #</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&#39;sp&#39;</span>)
<span class="kw">library</span>(<span class="st">&#39;raster&#39;</span>)
<span class="kw">library</span>(<span class="st">&#39;gstat&#39;</span>)
<span class="kw">library</span>(<span class="st">&#39;rgdal&#39;</span>)</code></pre></div>
<pre><code>## rgdal: version: 1.1-3, (SVN revision 594)
##  Geospatial Data Abstraction Library extensions to R successfully loaded
##  Loaded GDAL runtime: GDAL 1.11.2, released 2015/02/10
##  Path to GDAL shared files: /usr/share/gdal/1.11
##  Loaded PROJ.4 runtime: Rel. 4.8.0, 6 March 2012, [PJ_VERSION: 480]
##  Path to PROJ.4 shared files: (autodetected)
##  Linking to sp version: 1.2-1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">wolin_lato_los &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&#39;data/Wolin_TPZ_p_lato_750losN.csv&#39;</span>, <span class="dt">na.strings=</span>-<span class="fl">999.00</span>)
<span class="kw">coordinates</span>(wolin_lato_los) &lt;-<span class="st"> </span><span class="er">~</span>X+Y
<span class="kw">proj4string</span>(wolin_lato_los) &lt;-<span class="st"> &#39;+init=epsg:32633&#39;</span>
ras &lt;-<span class="st"> </span><span class="kw">raster</span>(<span class="st">&#39;data/siatka_raster.tif&#39;</span>, <span class="dt">level=</span><span class="dv">0</span>)
<span class="kw">crs</span>(ras) &lt;-<span class="st"> </span><span class="kw">proj4string</span>(wolin_lato_los)
grid &lt;-<span class="st"> </span><span class="kw">as</span>(ras, <span class="st">&quot;SpatialGridDataFrame&quot;</span>)
poligon &lt;-<span class="st"> </span><span class="kw">readOGR</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;wolin_polygon&quot;</span>)</code></pre></div>
<pre><code>## OGR data source with driver: ESRI Shapefile 
## Source: &quot;data&quot;, layer: &quot;wolin_polygon&quot;
## with 1 features
## It has 11 fields</code></pre>
<p>### Modele deterministyczne | Funkcje wielomianowe</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">wielomian_1 &lt;-<span class="st"> </span><span class="kw">gstat</span>(<span class="dt">formula=</span>X2002<span class="fl">.08</span>.20_TPZ~<span class="dv">1</span>, <span class="dt">data=</span>wolin_lato_los, <span class="dt">degree=</span><span class="dv">1</span>)
wielomian_1_pred &lt;-<span class="st"> </span><span class="kw">predict</span>(wielomian_1, <span class="dt">newdata=</span>grid)</code></pre></div>
<pre><code>## [ordinary or weighted least squares prediction]</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">spplot</span>(wielomian_1_pred[<span class="dv">1</span>], <span class="dt">contour=</span><span class="ot">TRUE</span>,<span class="dt">main=</span><span class="st">&quot;Powierzchnia trendu - wielomian pierwszego stopnia&quot;</span>)</code></pre></div>
<p><img src="03-eksp_przestrzenna_files/figure-html/unnamed-chunk-2-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">wielomian_2 &lt;-<span class="st"> </span><span class="kw">gstat</span>(<span class="dt">formula=</span>X2002<span class="fl">.08</span>.20_TPZ~<span class="dv">1</span>, <span class="dt">data=</span>wolin_lato_los, <span class="dt">degree=</span><span class="dv">2</span>)
wielomian_2_pred &lt;-<span class="st"> </span><span class="kw">predict</span>(wielomian_2, <span class="dt">newdata=</span>grid)</code></pre></div>
<pre><code>## [ordinary or weighted least squares prediction]</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">spplot</span>(wielomian_2_pred[<span class="dv">1</span>], <span class="dt">contour=</span><span class="ot">TRUE</span>,<span class="dt">main=</span><span class="st">&quot;Powierzchnia trendu - wielomian drugiego stopnia&quot;</span>)</code></pre></div>
<p><img src="03-eksp_przestrzenna_files/figure-html/unnamed-chunk-2-2.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">wielomian_3 &lt;-<span class="st"> </span><span class="kw">gstat</span>(<span class="dt">formula=</span>X2002<span class="fl">.08</span>.20_TPZ~<span class="dv">1</span>, <span class="dt">data=</span>wolin_lato_los, <span class="dt">degree=</span><span class="dv">3</span>)
wielomian_3_pred &lt;-<span class="st"> </span><span class="kw">predict</span>(wielomian_3, <span class="dt">newdata=</span>grid)</code></pre></div>
<pre><code>## [ordinary or weighted least squares prediction]</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">spplot</span>(wielomian_3_pred[<span class="dv">1</span>], <span class="dt">contour=</span><span class="ot">TRUE</span>,<span class="dt">main=</span><span class="st">&quot;Powierzchnia trendu - wielomian trzeciego stopnia&quot;</span>)</code></pre></div>
<p><img src="03-eksp_przestrzenna_files/figure-html/unnamed-chunk-2-3.png" alt="" /><!-- --></p>
<!--
library('rasterVis')
xx <- as(wielomian_1_pred[1], "SpatialPointsDataFrame")
raster <- raster(extent(wielomian_1_pred))
res(raster) <- c(100, 100)
raster <- rasterize(x=xx, y=raster)
plot3D(raster[[1]])
-->
</div>
<div id="modele-deterministyczne-funkcje-sklejane" class="section level3">
<h3><span class="header-section-number">4.1.3</span> Modele deterministyczne | Funkcje sklejane</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tps &lt;-<span class="st"> </span><span class="kw">Tps</span>(<span class="kw">coordinates</span>(wolin_lato_los), wolin_lato_los@data$X2002<span class="fl">.08</span>.20_TPZ)
spline &lt;-<span class="st"> </span><span class="kw">interpolate</span>(ras, tps)
spline &lt;-<span class="st"> </span><span class="kw">mask</span>(spline, ras)
<span class="kw">spplot</span>(spline, <span class="dt">contour=</span><span class="ot">TRUE</span> , <span class="dt">main=</span><span class="st">&quot;Funkcje sklejane&quot;</span>)</code></pre></div>
<p><img src="03-eksp_przestrzenna_files/figure-html/unnamed-chunk-3-1.png" alt="" /><!-- --></p>
</div>
<div id="modele-deterministyczne-triangulacje-thiessen" class="section level3">
<h3><span class="header-section-number">4.1.4</span> Modele deterministyczne | Triangulacje (Thiessen)</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&#39;dismo&#39;</span>)
voronoi_interp &lt;-<span class="st"> </span><span class="kw">voronoi</span>(wolin_lato_los)</code></pre></div>
<pre><code>## Loading required namespace: deldir</code></pre>
<pre><code>## 
##      PLEASE NOTE:  The components &quot;delsgs&quot; and &quot;summary&quot; of the
##  object returned by deldir() are now DATA FRAMES rather than
##  matrices (as they were prior to release 0.0-18).
##  See help(&quot;deldir&quot;).
##  
##      PLEASE NOTE: The process that deldir() uses for determining
##  duplicated points has changed from that used in version
##  0.0-9 of this package (and previously). See help(&quot;deldir&quot;).</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">voronoi_interp &lt;-<span class="st"> </span><span class="kw">intersect</span>(poligon, voronoi_interp)</code></pre></div>
<pre><code>## Loading required namespace: rgeos</code></pre>
<pre><code>## Warning in intersect(poligon, voronoi_interp): non identical CRS</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">spplot</span>(voronoi_interp, <span class="st">&quot;X2002.08.20_TPZ&quot;</span>, <span class="dt">contour=</span><span class="ot">TRUE</span>, <span class="dt">main=</span><span class="st">&quot;Poligony Voronoi&#39;a&quot;</span>)</code></pre></div>
<p><img src="03-eksp_przestrzenna_files/figure-html/unnamed-chunk-4-1.png" alt="" /><!-- --></p>
</div>
<div id="modele-deterministyczne-idw" class="section level3">
<h3><span class="header-section-number">4.1.5</span> Modele deterministyczne | IDW</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">idw_wolin &lt;-<span class="st"> </span><span class="kw">idw</span>(X2002<span class="fl">.08</span>.20_TPZ~<span class="dv">1</span>, wolin_lato_los, grid, <span class="dt">idp=</span><span class="dv">2</span>)</code></pre></div>
<pre><code>## [inverse distance weighted interpolation]</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">spplot</span>(idw_wolin, <span class="st">&#39;var1.pred&#39;</span>, <span class="dt">contour=</span><span class="ot">TRUE</span>, <span class="dt">main=</span><span class="st">&quot;IDW&quot;</span>)</code></pre></div>
<p><img src="03-eksp_przestrzenna_files/figure-html/unnamed-chunk-5-1.png" alt="" /><!-- --></p>
</div>
<div id="modele-deterministyczne-porownanie" class="section level3">
<h3><span class="header-section-number">4.1.6</span> Modele deterministyczne | Porównanie</h3>
<p><img src="03-eksp_przestrzenna_files/figure-html/unnamed-chunk-6-1.png" alt="" /><!-- --></p>
</div>
<div id="modele-statystyczne" class="section level3">
<h3><span class="header-section-number">4.1.7</span> Modele statystyczne</h3>
<ul>
<li>Parametry modeli są określane w oparciu o teorię prawdopodobieństwa. Dodatkowo wynik estymacji zawiera oszacowanie błędu. Np.:
<ul>
<li>Kriging</li>
<li>Modele regresyjne</li>
<li>Modele bayesowe</li>
<li>Modele hybrydowe</li>
</ul></li>
</ul>
<!--
http://www.inside-r.org/packages/cran/raster/docs/interpolate

![](fig_skrypt/m_feat.png)
-->
</div>
</div>
<div id="geostatystyka---prolog" class="section level2">
<h2><span class="header-section-number">4.2</span> Geostatystyka - prolog</h2>
<div id="geostatystyka" class="section level3">
<h3><span class="header-section-number">4.2.1</span> Geostatystyka</h3>
<ul>
<li>Zbiór narzędzi statystycznych uwzględniających w analizie danych ich przestrzenną i czasową lokalizację, a opartych o teorię funkcji losowych.</li>
</ul>
<!--
### Geostatystyka a klasyczna statystyka
- Isnieje informacja o lokalizacji obserwacji
- 
-->
</div>
<div id="geostatystyka-funkcje" class="section level3">
<h3><span class="header-section-number">4.2.2</span> Geostatystyka | Funkcje</h3>
<ul>
<li>Identyfikacja i modelowanie struktury przestrzennej/czasowej zjawiska</li>
<li>Estymacja - szacowanie wartości badanej zmiennej w nieopróbowanym miejscu i/lub momencie czasu</li>
<li>Symulacja - generowanie alternatywnych obrazów, które honorują wyniki pomiarów i strukturę przestrzenną/czasową zjawiska</li>
<li>Optymalizacja próbkowania/sieci pomiarowej</li>
</ul>
</div>
<div id="geostatystyczna-analiza-danych" class="section level3">
<h3><span class="header-section-number">4.2.3</span> Geostatystyczna analiza danych</h3>
<div class="figure">
<img src="fig_skrypt/diag.png" alt="" />

</div>
</div>
<div id="geostatystyka-dane-wejsciowe" class="section level3">
<h3><span class="header-section-number">4.2.4</span> Geostatystyka | Dane wejściowe</h3>
<ol style="list-style-type: decimal">
<li>Wystarczająca duża liczba punktów (minimalnie &gt;30, ale zazwyczaj więcej niż 100/150)</li>
<li>Są reprezentatywne</li>
<li>Są niezależne</li>
<li>Były stworzone używając stałej metodyki</li>
<li>Są wystarczająco dokładne</li>
</ol>
<!--
### Geostatystyka | Cele
- Charakterystyka struktury przestrzennej badanego zjawiska
- Uwzględnienie przestrzennych relacji między zmiennymi
- Interpolacja wartości
- Wizualizacja
- Określenie niepewności danych
- Stwierdzenie niepewności estymacji
-->
</div>
<div id="geostatystyka-podstawowe-etapy" class="section level3">
<h3><span class="header-section-number">4.2.5</span> Geostatystyka | Podstawowe etapy</h3>
<ol style="list-style-type: decimal">
<li>Zaprojektowanie sposobu (typu) próbkowania oraz organizacji zadań</li>
<li>Zebranie danych, analiza labolatoryjna</li>
<li>Wstepna eksploracja danych, ocena ich jakości</li>
<li>Modelowanie semiwariogramów na podstawie dostępnych danych</li>
<li>Estymacja badanej cechy</li>
<li>Porównanie i ocena modeli</li>
<li>Stworzenie wynikowego produktu i jego dystrybucja</li>
</ol>
</div>
</div>
<div id="przestrzenna-kowariancja-korelacja-i-semiwariancja" class="section level2">
<h2><span class="header-section-number">4.3</span> Przestrzenna kowariancja, korelacja i semiwariancja</h2>
<div id="przestrzenna-kowariancja-korelacja-i-semiwariancja-zaozenia" class="section level3">
<h3><span class="header-section-number">4.3.1</span> Przestrzenna kowariancja, korelacja i semiwariancja | Założenia</h3>
<ol style="list-style-type: decimal">
<li>Przestrzennej ciągłości - przestrzenna korelacja między zmienny w dwóch lokalizacjach zależy tylko od ich odległości (oraz czasem kierunku), lecz nie od tego gdzie są one położone</li>
<li>Stacjonarności - średnia i wariancja są stałe na całym badanym obszarze</li>
</ol>
</div>
<div id="przestrzenna-kowariancja-korelacja-i-semiwariancja-1" class="section level3">
<h3><span class="header-section-number">4.3.2</span> Przestrzenna kowariancja, korelacja i semiwariancja</h3>
<ul>
<li><span class="math inline">\(u\)</span> - wektor współrzędnych</li>
<li><span class="math inline">\(z(u)\)</span> - badana zmienna jako funkcja położenia - inaczej określany jako ogon (ang. <em>tail</em>)</li>
<li><span class="math inline">\(h\)</span> - lag - odstęp pomiędzy dwoma lokalizacjami</li>
<li><span class="math inline">\(z(u+h)\)</span> - wartość badanej zmiennej odległej o odstęp <span class="math inline">\(h\)</span> - inaczej określany jako głowa (ang. <em>head</em>)</li>
</ul>
</div>
<div id="przestrzenna-kowariancja-korelacja-i-semiwariancja-2" class="section level3">
<h3><span class="header-section-number">4.3.3</span> Przestrzenna kowariancja, korelacja i semiwariancja</h3>
<ul>
<li>Kowariancja i korelacja to miary podobieństwa pomiędzy dwoma zmiennymi</li>
<li>Przenosząc to na aspekt przestrzenny, badamy jedną zmienną ale pomiędzy dwoma punktami odległymi od siebie o pewien dystans (okreslany jako lag)</li>
<li>W efekcie otrzymujemy miarę podobieństwa pomiędzy wartością głowy i ogona</li>
<li>Trzecią miarę charakteryzującą relację między obserwacjami odległymi o kolejne odstępy jest semiwariancja</li>
<li>Z praktycznego punktu widzenia, semiwariogram jest preferowaną miarą relacji przestrzennej, ponieważ wykazuje tendencję do lepszego wygładzania danych niż funkcja kowariancji</li>
<li>Dodatkowo, semiwariogram jest mniej wymagający obliczeniowo</li>
<li>Jednocześnie, dla potrzeb interpretacji relacji kowarancja i korelacja przestrzenna nadaje się nie gorzej niż semiwariancja</li>
</ul>
<p><img src="03-eksp_przestrzenna_files/figure-html/z_przs0-1.png" alt="" /><!-- --></p>
</div>
<div id="wykres-rozrzutu-z-przesunieciem" class="section level3">
<h3><span class="header-section-number">4.3.4</span> Wykres rozrzutu z przesunięciem</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hscat</span>(X2002<span class="fl">.08</span>.20_TPZ~<span class="dv">1</span>, wolin_lato_los, <span class="dt">breaks=</span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">1350</span>, <span class="dt">by=</span><span class="dv">150</span>))</code></pre></div>
<p><img src="03-eksp_przestrzenna_files/figure-html/z_przs-1.png" alt="" /><!-- --></p>
</div>
<div id="autokowariancja" class="section level3">
<h3><span class="header-section-number">4.3.5</span> Autokowariancja</h3>
<ul>
<li>Autokowariancja pokazuje jak mocno są ze sobą powiązane przestrzennie wartości pary obserwacji odległych od siebie o kolejne przedziały</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">kowario &lt;-<span class="st"> </span><span class="kw">variogram</span>(X2002<span class="fl">.08</span>.20_TPZ~<span class="dv">1</span>, wolin_lato_los, <span class="dt">covariogram =</span> <span class="ot">TRUE</span>)
<span class="kw">plot</span>(kowario)</code></pre></div>
<p><img src="03-eksp_przestrzenna_files/figure-html/unnamed-chunk-7-1.png" alt="" /><!-- --></p>
</div>
<div id="autokorelacja" class="section level3">
<h3><span class="header-section-number">4.3.6</span> Autokorelacja</h3>
<ul>
<li>Autokorelogram jest wykresem pokazującym jedną z miar autokorelacji (np. I Morana lub C Geary’ego) w stosunku do odległości</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&#39;pgirmess&#39;</span>)
<span class="kw">library</span>(<span class="st">&#39;ggplot2&#39;</span>)
wsp &lt;-<span class="st"> </span><span class="kw">coordinates</span>(wolin_lato_los)
kor &lt;-<span class="st"> </span><span class="kw">correlog</span>(wsp, wolin_lato_los$X2002<span class="fl">.08</span>.20_TPZ)
kor &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(kor)
<span class="kw">ggplot</span>(kor, <span class="kw">aes</span>(dist.class, coef)) +<span class="st"> </span><span class="kw">geom_smooth</span>(<span class="dt">linetype=</span><span class="dv">0</span>) +<span class="st"> </span><span class="kw">geom_line</span>() +<span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">size=</span><span class="dv">5</span>)</code></pre></div>
<p><img src="03-eksp_przestrzenna_files/figure-html/unnamed-chunk-8-1.png" alt="" /><!-- --></p>
</div>
<div id="semiwariancja" class="section level3">
<h3><span class="header-section-number">4.3.7</span> Semiwariancja</h3>
<ul>
<li>Zmienność przestrzenna może być określona za pomocą semiwariancji. Jest to połowa średniej kwadratu różnicy pomiędzy wartościami badanej zmiennej w dwóch lokalizacjach odległych o wektor <span class="math inline">\(h\)</span> <span class="math display">\[ \gamma(h) = \frac{1}{2}E[(z(s) - z(s+h))^2] \]</span></li>
</ul>
</div>
<div id="okreslenie-wystepowania-autokorelacji-przestrzennej-chmura-semiwariogramu" class="section level3">
<h3><span class="header-section-number">4.3.8</span> Określenie występowania autokorelacji przestrzennej | Chmura semiwariogramu</h3>
<ul>
<li>Jeżeli w badanej próbie mamy <span class="math inline">\(n\)</span> obserwacji oznacza to, że możemy zaobserwować <span class="math inline">\(\frac{1}{2}n(n-1)\)</span> par obserwacji</li>
<li>Każda para obserwacji daje nam informacje o semiwariancji występującej wraz z odległością</li>
<li>Semiwariancję można zaprezentować na wykresie zwanym chumrą semiwariogramu</li>
</ul>
</div>
<div id="semiwariancja-przykadowe-obliczenia" class="section level3">
<h3><span class="header-section-number">4.3.9</span> Semiwariancja | Przykładowe obliczenia</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">odl &lt;-<span class="st"> </span><span class="kw">dist</span>(<span class="kw">coordinates</span>(wolin_lato_los)[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), ])
gamma &lt;-<span class="st"> </span><span class="fl">0.5</span> *<span class="st"> </span>(wolin_lato_los$X2002<span class="fl">.08</span>.20_TPZ[<span class="dv">1</span>] -<span class="st"> </span>wolin_lato_los$X2002<span class="fl">.08</span>.20_TPZ[<span class="dv">2</span>])^<span class="dv">2</span>
gamma</code></pre></div>
<pre><code>## [1] 36.40101</code></pre>
</div>
<div id="okreslenie-wystepowania-autokorelacji-przestrzennej-chmura-semiwariogramu-1" class="section level3">
<h3><span class="header-section-number">4.3.10</span> Określenie występowania autokorelacji przestrzennej | Chmura semiwariogramu</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&#39;gstat&#39;</span>)
vario_cloud &lt;-<span class="st"> </span><span class="kw">variogram</span>(X2002<span class="fl">.08</span>.20_TPZ~<span class="dv">1</span>, wolin_lato_los, <span class="dt">cloud=</span><span class="ot">TRUE</span>)
<span class="kw">plot</span>(vario_cloud) </code></pre></div>
<p><img src="03-eksp_przestrzenna_files/figure-html/unnamed-chunk-10-1.png" alt="" /><!-- --></p>
</div>
<div id="okreslenie-wystepowania-autokorelacji-przestrzennej-chmura-semiwariogramu-2" class="section level3">
<h3><span class="header-section-number">4.3.11</span> Określenie występowania autokorelacji przestrzennej | Chmura semiwariogramu</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vario_cloud_sel &lt;-<span class="st"> </span><span class="kw">plot</span>(<span class="kw">variogram</span>(X2002<span class="fl">.08</span>.20_TPZ~<span class="dv">1</span>, wolin_lato_los, <span class="dt">cloud=</span><span class="ot">TRUE</span>), <span class="dt">digitize=</span><span class="ot">TRUE</span>)
<span class="kw">plot</span>(vario_cloud_sel, wolin_lato_los) </code></pre></div>
</div>
<div id="semiwariogram-charakterystyka-struktury-przestrzennej" class="section level3">
<h3><span class="header-section-number">4.3.12</span> Semiwariogram | Charakterystyka struktury przestrzennej</h3>
<ul>
<li>Semiwariogram to wykres pokazujący relację pomiędzy odległością a semiwariancją</li>
<li>Jest to uśrednieniem semiwariancji dla kolejnych odstępów (lagów)</li>
<li>W oparciu o semiwariogram empiryczny możemy następnie dopasować do niego model/e</li>
</ul>
<p><span class="math display">\[ \hat{\gamma}(h) = \frac{1}{2N(h)}\sum_{i=1}^{N(h)}(z(s_i) - z(s_i+h))^2 \]</span></p>
<p>gdzie <span class="math inline">\(N(h)\)</span> oznacza liczbę par punktów w odstępie <span class="math inline">\(h\)</span></p>
</div>
<div id="semiwariogram" class="section level3">
<h3><span class="header-section-number">4.3.13</span> Semiwariogram</h3>
<ul>
<li>Nugget - efekt nuggetowy - pozwala na określenie błędu w danych wejściowych oraz zmienności na dystansie krótszym niż pierwszy odstęp</li>
<li>Sill - semiwariancja progowa - oznacza wariancję badanej zmiennej</li>
<li>Range - zasięg - to odległość do której istnieje przestrzenna korelacja</li>
</ul>
</div>
<div id="semiwariogram-rules-of-thumb" class="section level3">
<h3><span class="header-section-number">4.3.14</span> Semiwariogram | Rules of thumb</h3>
<ul>
<li>W każdym odstępie powinno się znaleźć co najmniej 30 par punktów</li>
<li>Maksymalny zasięg semiwariogramu (ang. <em>cutoff distance</em>) to 1/2 pierwiastka z badanej powierzchni (inne źródła mówią o połowie z przekątnej badanego obszaru/jednej trzeciej)</li>
<li>Liczba odstępów powinna nie być mniejsza niż 10</li>
<li>Optymalnie maksymalny zasięg semiwariogramu powinien być dłuższy o 10-15% od zasięgu zjawiska</li>
<li>Optymalnie odstępy powinny być jak najbliżej siebie i jednocześnie nie być chaotyczne</li>
<li>Warto metodą prób i błędów określić optymalne parametry semiwariogramu</li>
<li>Należy określić czy zjawisko wykazuje anizotropię przestrzenną</li>
</ul>
</div>
<div id="semiwariogram-obliczenia-pomocnicze" class="section level3">
<h3><span class="header-section-number">4.3.15</span> Semiwariogram | Obliczenia pomocnicze</h3>
<ul>
<li>Liczba par obserwacji</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="fl">0.5</span>*<span class="kw">length</span>(wolin_lato_los)*(<span class="kw">length</span>(wolin_lato_los)-<span class="dv">1</span>)</code></pre></div>
<pre><code>## [1] 280875</code></pre>
<ul>
<li>Połowa pierwiastka powierzchni</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pow &lt;-<span class="st"> </span><span class="kw">area</span>(poligon)
<span class="kw">as.vector</span>(<span class="fl">0.5</span>*<span class="kw">sqrt</span>(pow))</code></pre></div>
<pre><code>## [1] 8086.384</code></pre>
<p><!--
- Połowa przekątnej obszaru
Twierdzenie Pitagorasa

$$x^2 + y^2 = z^2$$


```r
wierz <- as.vector(extent(poligon))
kraw_x <- wierz[2] - wierz[1]
kraw_y <- wierz[4] - wierz[3]
z_kwadrat <- kraw_x^2 + kraw_y^2
0.5*sqrt(z_kwadrat)
```

```
## [1] 20939.84
```

--> - Powierzchnia zajmowana przez jedną próbkę</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pow_pr &lt;-<span class="st"> </span><span class="kw">area</span>(poligon)/<span class="kw">length</span>(wolin_lato_los)
pow_pr</code></pre></div>
<pre><code>##        0 
## 348744.6</code></pre>
<ul>
<li>Średnia odległość między punktami</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sqrt</span>(pow_pr)</code></pre></div>
<pre><code>##       0 
## 590.546</code></pre>
</div>
<div id="semiwariogram-maksymalny-zasieg-semiwariogramu-ang.-cutoff-distance" class="section level3">
<h3><span class="header-section-number">4.3.16</span> Semiwariogram | Maksymalny zasięg semiwariogramu (ang. <em>Cutoff distance</em>)</h3>
<ul>
<li>Maksymalny zasięg semiwariogramu (ang. <em>Cutoff distance</em>) jest domyślnie wyliczany w pakiecie <strong>gstat</strong> jako 1/3 z najdłuższej przekątnej badanego obszaru</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vario_par &lt;-<span class="st"> </span><span class="kw">variogram</span>(X2002<span class="fl">.08</span>.20_TPZ~<span class="dv">1</span>, wolin_lato_los)
vario_par</code></pre></div>
<pre><code>##       np       dist     gamma dir.hor dir.ver   id
## 1   2489   586.6262  9.403402       0       0 var1
## 2   6419  1356.0526 12.479666       0       0 var1
## 3   9455  2209.0161 14.698134       0       0 var1
## 4  11765  3079.7299 15.121831       0       0 var1
## 5  13604  3951.9182 15.237225       0       0 var1
## 6  14898  4827.0845 15.610348       0       0 var1
## 7  15759  5695.0007 16.254005       0       0 var1
## 8  16230  6572.6776 17.197791       0       0 var1
## 9  15903  7444.9323 18.396612       0       0 var1
## 10 15958  8323.4239 19.334907       0       0 var1
## 11 15848  9199.8893 19.961577       0       0 var1
## 12 15388 10074.5949 21.121819       0       0 var1
## 13 14428 10950.7884 22.549906       0       0 var1
## 14 13438 11816.4479 22.366048       0       0 var1
## 15 12138 12695.1130 22.716514       0       0 var1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(vario_par, <span class="dt">plot.numbers=</span><span class="ot">TRUE</span>)</code></pre></div>
<p><img src="03-eksp_przestrzenna_files/figure-html/unnamed-chunk-16-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vario_par &lt;-<span class="st"> </span><span class="kw">variogram</span>(X2002<span class="fl">.08</span>.20_TPZ~<span class="dv">1</span>, wolin_lato_los, <span class="dt">cutoff =</span> <span class="dv">8000</span>)
<span class="kw">plot</span>(vario_par)</code></pre></div>
<p><img src="03-eksp_przestrzenna_files/figure-html/unnamed-chunk-16-2.png" alt="" /><!-- --></p>
</div>
<div id="semiwariogram-odlegosc-miedzy-przedziaami-ang-interval-width" class="section level3">
<h3><span class="header-section-number">4.3.17</span> Semiwariogram | Odległość między przedziałami (ang, <em>Interval width </em>)</h3>
<ul>
<li>Domyślnie to maksymalny zasięg semiwariogramu podzielony przez 15 dahe odległość między przedziałami (ang, <em>Interval width </em>)</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vario_par &lt;-<span class="st"> </span><span class="kw">variogram</span>(X2002<span class="fl">.08</span>.20_TPZ~<span class="dv">1</span>, wolin_lato_los, <span class="dt">cutoff =</span> <span class="dv">1000</span>, <span class="dt">width =</span> <span class="dv">250</span>)
<span class="kw">plot</span>(vario_par)</code></pre></div>
<p><img src="03-eksp_przestrzenna_files/figure-html/unnamed-chunk-17-1.png" alt="" /><!-- --></p>
<!--
## Wpływa danych odstających

Tak jak inne statystyki typu wariancji, wartości kowariancji i semiwariogramu są bardzo czułe na występowanie danych ekstremalnych – potencjalnie błędnych. Stosuje się trzy sposoby aby ten problem rozwiązać:
Transformację matematyczną danych (logarytmowanie, pierwiastkowanie itp.) , aby zredukować skośność ich histogramu,
Usuwanie par danych, które zaburzają wartość semiwariancji dla określonych odstępów h. Procedura ta zwana jest czyszczeniem wykresu rozrzutu z przesunięciem („h-scattergram cleansing”).
Używanie innych statystyk h-scattergramu, które są mniej czułe na występowanie danych ekstremalnych.
### Rodogram/madogram



```r
# library('SpatialExtremes')
# n.site <- 15
# locations <- matrix(runif(2*n.site, 0, 10), ncol = 2)
# colnames(locations) <- c("lon", "lat")
# 
# ##Simulate a max-stable process - with unit Frechet margins
# data <- rmaxstab(40, locations, cov.mod = "whitmat", nugget = 0, range = 1,
#                  smooth = 2)
# 
# ##Compute the madogram
# madogram(data, locations)
# data2 <- matrix(c(wolin_lato_los$X2002.08.20_TPZ, wolin_lato_los$X2002.08.20_NDVI), nrow=2)
# locations2 <- coordinates(wolin_lato_los)
# colnames(locations2) <- c("lon", "lat")
# madogram(data2, locations2)
```

-->
</div>
</div>
<div id="anizotropia" class="section level2">
<h2><span class="header-section-number">4.4</span> Anizotropia</h2>
<div id="anizotropia-struktury-przestrzennej" class="section level3">
<h3><span class="header-section-number">4.4.1</span> Anizotropia struktury przestrzennej</h3>
<ul>
<li>W wielu rzeczywistych sytuacjach, wartość cechy zależy nie tylko od odległości, ale także od kierunku</li>
</ul>
</div>
<div id="mapa-semiwariogramu" class="section level3">
<h3><span class="header-section-number">4.4.2</span> Mapa semiwariogramu</h3>
<ul>
<li>Mapa semiwariogramu (powierzchnia semiwariogramu) służy do określenia czy struktura przestrzenna zjawiska posiada anizotropię, a jeżeli tak to w jakim kierunku</li>
<li>Na podstawie mapy semiwariogramu identyfikuje się parametry potrzebne do zbudowania semiwariogramów kierunkowych</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vario_map &lt;-<span class="st"> </span><span class="kw">variogram</span>(X2002<span class="fl">.08</span>.20_TPZ~<span class="dv">1</span>, wolin_lato_los, <span class="dt">cutoff=</span><span class="dv">12000</span>, <span class="dt">width=</span><span class="dv">800</span>, <span class="dt">map=</span><span class="ot">TRUE</span>)
<span class="co"># plot(vario_map, threshold=30) # co najmniej 30 par punktów</span></code></pre></div>
</div>
<div id="mapa-semiwariogramu-3d" class="section level3">
<h3><span class="header-section-number">4.4.3</span> Mapa semiwariogramu | 3D</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&#39;rasterVis&#39;</span>)
<span class="kw">plot3D</span>(<span class="kw">raster</span>(vario_map$map), <span class="dt">col=</span>rainbow)</code></pre></div>
</div>
<div id="semiwariogramy-kierunkowe-kierunki" class="section level3">
<h3><span class="header-section-number">4.4.4</span> Semiwariogramy kierunkowe | Kierunki</h3>
<ul>
<li>W przypadku, gdy zjawisko wykazuje anizotropię przestrzenną, możliwe jest stworzenie semiwariogramów dla różnych wybranych kierunków</li>
<li>Przykładowo, dla argumentu <em>alpha = c(0, 45, 90, 135)</em> cztery główne kierunki to 0, 45, 90 i 135 stopni. Oznacza to, że dla kierunku 45 stopni brane pod uwagę będą wszystkie pary punktów pomiędzy 22,5 a 67,5 stopnia.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vario_kier &lt;-<span class="st"> </span><span class="kw">variogram</span>(X2002<span class="fl">.08</span>.20_TPZ~<span class="dv">1</span>, wolin_lato_los, <span class="dt">alpha =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">45</span>, <span class="dv">90</span>, <span class="dv">135</span>))
<span class="kw">plot</span>(vario_kier)</code></pre></div>
<p><img src="03-eksp_przestrzenna_files/figure-html/unnamed-chunk-20-1.png" alt="" /><!-- --></p>
</div>
<div id="semiwariogramy-kierunkowe-kierunki-1" class="section level3">
<h3><span class="header-section-number">4.4.5</span> Semiwariogramy kierunkowe | Kierunki</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vario_kier &lt;-<span class="st"> </span><span class="kw">variogram</span>(X2002<span class="fl">.08</span>.20_TPZ~<span class="dv">1</span>, wolin_lato_los, <span class="dt">alpha =</span> <span class="kw">c</span>(<span class="dv">60</span>, <span class="dv">105</span>, <span class="dv">150</span>, <span class="dv">195</span>))
<span class="kw">plot</span>(vario_kier)</code></pre></div>
<p><img src="03-eksp_przestrzenna_files/figure-html/unnamed-chunk-21-1.png" alt="" /><!-- --></p>
<!--
Kroskowariogramy
Kroskorelogramy
-->
</div>
</div>
<div id="krossemiwariogramy" class="section level2">
<h2><span class="header-section-number">4.5</span> Krossemiwariogramy</h2>
<div id="krossemiwariogramy-1" class="section level3">
<h3><span class="header-section-number">4.5.1</span> Krossemiwariogramy</h3>
<ul>
<li>Krossemiwariogram jest to wariancja różnicy pomiędzy dwiema zmiennymi w dwóch lokalizacjach</li>
<li>Wyliczając Krossemiwariogram otrzymujemy empiryczne semiwatiogramy dla dwóch badanych zmiennych oraz kroswariogram dla kombinacji dwóch zmiennych</li>
<li>Krossemiwariogram znajduje swoje zastosowanie w technice zwanej kokrigingiem</li>
</ul>
</div>
<div id="krossemiwariogramy-2" class="section level3">
<h3><span class="header-section-number">4.5.2</span> Krossemiwariogramy</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&#39;sp&#39;</span>)
wolin_lato_los &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&#39;data/Wolin_TPZ_p_lato_750losN.csv&#39;</span>, <span class="dt">na.strings=</span>-<span class="fl">999.00</span>)
<span class="kw">coordinates</span>(wolin_lato_los) &lt;-<span class="st"> </span><span class="er">~</span>X+Y
<span class="kw">proj4string</span>(wolin_lato_los) &lt;-<span class="st"> &#39;+init=epsg:32633&#39;</span>

wolin_lato_los_255 &lt;-<span class="st"> </span>wolin_lato_los[!<span class="kw">is.na</span>(wolin_lato_los$X1999<span class="fl">.09</span>.13_TPZ), ]
wolin_lato_los_750 &lt;-<span class="st"> </span>wolin_lato_los

<span class="kw">library</span>(<span class="st">&#39;gstat&#39;</span>)
g &lt;-<span class="st"> </span><span class="kw">gstat</span>(<span class="ot">NULL</span>, <span class="dt">id=</span><span class="st">&quot;TPZ1999&quot;</span>, <span class="dt">form =</span> X1999<span class="fl">.09</span>.13_TPZ~<span class="dv">1</span>, <span class="dt">data =</span> wolin_lato_los_255)
g &lt;-<span class="st"> </span><span class="kw">gstat</span>(g, <span class="dt">id=</span><span class="st">&quot;TPZ2000&quot;</span>, <span class="dt">form =</span> X2002<span class="fl">.08</span>.20_TPZ~<span class="dv">1</span>, <span class="dt">data =</span> wolin_lato_los_750)
g</code></pre></div>
<pre><code>## data:
## TPZ1999 : formula = X1999.09.13_TPZ`~`1 ; data dim = 255 x 9
## TPZ2000 : formula = X2002.08.20_TPZ`~`1 ; data dim = 750 x 9</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="kw">variogram</span>(g))</code></pre></div>
<p><img src="03-eksp_przestrzenna_files/figure-html/unnamed-chunk-22-1.png" alt="" /><!-- --></p>
</div>
<div id="krossemiwariogramy-3" class="section level3">
<h3><span class="header-section-number">4.5.3</span> Krossemiwariogramy</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># plot(variogram(g, map=TRUE, cutoff=12000, width=800))</span>
<span class="kw">plot</span>(<span class="kw">variogram</span>(g, <span class="dt">alpha =</span> <span class="kw">c</span>(<span class="dv">60</span>, <span class="dv">105</span>, <span class="dv">150</span>, <span class="dv">195</span>)))</code></pre></div>
<p><img src="03-eksp_przestrzenna_files/figure-html/unnamed-chunk-23-1.png" alt="" /><!-- --></p>
<!--chapter:end:03-eksp_przestrzenna.Rmd-->
</div>
</div>
</div>
<div id="modelowanie-matematycznie-autokorelacji-przestrzennej" class="section level1">
<h1><span class="header-section-number">5</span> Modelowanie matematycznie autokorelacji przestrzennej</h1>
<div id="modelowanie-matematycznie-autokorelacji-przestrzennej-1" class="section level3">
<h3><span class="header-section-number">5.0.1</span> Modelowanie matematycznie autokorelacji przestrzennej</h3>
<ul>
<li>Semiwariogram empiryczny jest:
<ul>
<li>Nieciągły - wartości semiwariancji są średnimi przedziałowymi</li>
<li>Chaotyczny - badana próba jest jedynie przybliżeniem rzeczywistości, dodatkowo obciążonym błędami</li>
</ul></li>
<li>Estymacje i symulacje przestrzenne wymagają modelu struktury przestrzennej analizowanej cechy, a nie tylko wartości empirycznych (wyliczonych z danych)</li>
<li>Dodatkowo, matematycznie modelowanie wygładza chaotyczne fluktuacje danych empirycznych</li>
</ul>
</div>
<div id="modele-podstawowe" class="section level2">
<h2><span class="header-section-number">5.1</span> Modele podstawowe</h2>
<div id="modele-podstawowe-1" class="section level3">
<h3><span class="header-section-number">5.1.1</span> Modele podstawowe</h3>
<ul>
<li>Nuggetowy (ang. <em>Nugget effect model</em>)</li>
<li>Sferyczny (ang. <em>Spherical model</em>)</li>
<li>Gaussowski (ang. <em>Gaussian model</em>)</li>
<li>Potęgowy (ang. <em>Power model</em>)</li>
<li>Wykładniczy (ang. <em>Exponential model</em>)</li>
<li>Inne</li>
</ul>
</div>
<div id="modele-podstawowe-2" class="section level3">
<h3><span class="header-section-number">5.1.2</span> Modele podstawowe</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&#39;gstat&#39;</span>)
<span class="kw">vgm</span>()</code></pre></div>
<pre><code>##    short                                      long
## 1    Nug                              Nug (nugget)
## 2    Exp                         Exp (exponential)
## 3    Sph                           Sph (spherical)
## 4    Gau                            Gau (gaussian)
## 5    Exc               Exclass (Exponential class)
## 6    Mat                              Mat (Matern)
## 7    Ste Mat (Matern, M. Stein&#39;s parameterization)
## 8    Cir                            Cir (circular)
## 9    Lin                              Lin (linear)
## 10   Bes                              Bes (bessel)
## 11   Pen                      Pen (pentaspherical)
## 12   Per                            Per (periodic)
## 13   Wav                                Wav (wave)
## 14   Hol                                Hol (hole)
## 15   Log                         Log (logarithmic)
## 16   Pow                               Pow (power)
## 17   Spl                              Spl (spline)
## 18   Leg                            Leg (Legendre)
## 19   Err                   Err (Measurement error)
## 20   Int                           Int (Intercept)</code></pre>
</div>
<div id="modele-podstawowe-3" class="section level3">
<h3><span class="header-section-number">5.1.3</span> Modele podstawowe</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">show.vgms</span>()</code></pre></div>
<p><img src="04-modelowanie_files/figure-html/unnamed-chunk-2-1.png" alt="" /><!-- --></p>
</div>
<div id="modele-podstawowe-4" class="section level3">
<h3><span class="header-section-number">5.1.4</span> Modele podstawowe</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">show.vgms</span>(<span class="dt">models=</span><span class="kw">c</span>(<span class="st">&quot;Nug&quot;</span>, <span class="st">&quot;Sph&quot;</span>, <span class="st">&quot;Gau&quot;</span>, <span class="st">&quot;Pow&quot;</span>, <span class="st">&quot;Exp&quot;</span>), <span class="dt">range=</span><span class="fl">1.4</span>, <span class="dt">max=</span><span class="fl">2.5</span>)</code></pre></div>
<p><img src="04-modelowanie_files/figure-html/unnamed-chunk-3-1.png" alt="" /><!-- --></p>
</div>
<div id="modele-podstawowe-5" class="section level3">
<h3><span class="header-section-number">5.1.5</span> Modele podstawowe</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">show.vgms</span>(<span class="dt">models=</span><span class="kw">c</span>(<span class="st">&quot;Nug&quot;</span>, <span class="st">&quot;Sph&quot;</span>, <span class="st">&quot;Gau&quot;</span>, <span class="st">&quot;Pow&quot;</span>, <span class="st">&quot;Exp&quot;</span>), <span class="dt">range=</span><span class="fl">1.4</span>, <span class="dt">max=</span><span class="fl">2.5</span>, <span class="dt">as.groups =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p><img src="04-modelowanie_files/figure-html/unnamed-chunk-4-1.png" alt="" /><!-- --></p>
</div>
</div>
<div id="metody-modelowania" class="section level2">
<h2><span class="header-section-number">5.2</span> Metody modelowania</h2>
<div id="metody-modelowania-1" class="section level3">
<h3><span class="header-section-number">5.2.1</span> Metody modelowania</h3>
<ul>
<li>Ustawianie “ręczne” parametrów modelu, np. funkcja <em>vgm</em> z pakietu <strong>gstat</strong></li>
<li>Ustawianie “wizualne” parametrów modelu, np. funkcja <em>eyefit</em> z pakietu <strong>geoR</strong></li>
<li>Automatyczny wybór parametrów na podstawie różnych kryterów statystycznych, np. funkcja <em>fit.variogram</em> z pakietu <strong>gstat</strong>, <em>variofit</em> z pakietu <strong>geoR</strong>, <em>autofitVariogram</em> z pakietu <strong>automap</strong></li>
</ul>
</div>
<div id="metody-modelowania-2" class="section level3">
<h3><span class="header-section-number">5.2.2</span> Metody modelowania</h3>
<ul>
<li>Odpowiednie określenie modelu matematycznego często nie jest proste</li>
<li>Automatyczne metody nie zawsze są w stanie dać lepszy wynik od modelowania “ręcznego”</li>
<li>Najlepiej, gdy wybór modelu oparty jest o wiedzę na temat zakładanego procesu przestrzennego</li>
</ul>
</div>
<div id="metody-modelowania-liniowy-model-regionalizacji" class="section level3">
<h3><span class="header-section-number">5.2.3</span> Metody modelowania | Liniowy model regionalizacji</h3>
<ul>
<li>W przypadku, gdy analizowane zjawisko jest złożone, odwzorowanie kształtu semiwariogramu empirycznego wymaga połączenia dwóch lub większej liczby modeli podstawowych</li>
<li>W takiej sytuacji konieczne jest spełnienie dwóch warunków:
<ul>
<li>Wszystkie zastosowane modele muszą być dopuszczalne (<em>vgm()</em>)</li>
<li>Wariancja progowa każdego podstawowego modelu musi być dodatnia</li>
</ul></li>
</ul>
</div>
</div>
<div id="modelowanie-semiwariogramu" class="section level2">
<h2><span class="header-section-number">5.3</span> Modelowanie semiwariogramu</h2>
<div id="modelowanie-semiwariogramu-funkcja-fit.variogram" class="section level3">
<h3><span class="header-section-number">5.3.1</span> Modelowanie semiwariogramu | funkcja <em>fit.variogram</em></h3>
<ul>
<li>Funkcja <em>fit.variogram</em> dopasowuje zasięg oraz semiwariancję progową w oparciu o ustalone “ręcznie” parametry modelu</li>
</ul>
<!--
 Modelowanie semiwariogramu




-->
</div>
</div>
<div id="modelowanie-izotropowe" class="section level2">
<h2><span class="header-section-number">5.4</span> Modelowanie izotropowe</h2>
<div id="modelowanie-izotropowe-modelowanie-wizualne" class="section level3">
<h3><span class="header-section-number">5.4.1</span> Modelowanie izotropowe | Modelowanie “wizualne”</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&#39;geoR&#39;</span>)
v_eye &lt;-<span class="st"> </span><span class="kw">eyefit</span>(<span class="kw">variog</span>(<span class="kw">as.geodata</span>(wolin_lato_los, <span class="st">&quot;X2002.08.20_TPZ&quot;</span>)))
ve_fit &lt;-<span class="st"> </span><span class="kw">as.vgm.variomodel</span>(v_eye[[<span class="dv">1</span>]])</code></pre></div>
</div>
<div id="modelowanie-izotropowe-model-nuggetowy" class="section level3">
<h3><span class="header-section-number">5.4.2</span> Modelowanie izotropowe | Model nuggetowy</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&#39;raster&#39;</span>)
<span class="kw">library</span>(<span class="st">&#39;gstat&#39;</span>)
vario &lt;-<span class="st"> </span><span class="kw">variogram</span>(X2002<span class="fl">.08</span>.20_TPZ~<span class="dv">1</span>, wolin_lato_los, <span class="dt">cutoff=</span><span class="dv">20000</span>)
<span class="kw">plot</span>(vario)</code></pre></div>
<p><img src="04-modelowanie_files/figure-html/unnamed-chunk-5-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model_nug &lt;-<span class="st"> </span><span class="kw">vgm</span>(<span class="dv">10</span>, <span class="dt">model =</span> <span class="st">&#39;Nug&#39;</span>)
model_nug</code></pre></div>
<pre><code>##   model psill range
## 1   Nug    10     0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(vario, <span class="dt">model=</span>model_nug)</code></pre></div>
<p><img src="04-modelowanie_files/figure-html/unnamed-chunk-5-2.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fitted_nug &lt;-<span class="st"> </span><span class="kw">fit.variogram</span>(vario, model_nug)
fitted_nug</code></pre></div>
<pre><code>##   model    psill range
## 1   Nug 13.46823     0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(vario, <span class="dt">model=</span>fitted_nug)</code></pre></div>
<p><img src="04-modelowanie_files/figure-html/unnamed-chunk-5-3.png" alt="" /><!-- --></p>
</div>
<div id="modelowanie-izotropowe-model-sferyczny" class="section level3">
<h3><span class="header-section-number">5.4.3</span> Modelowanie izotropowe | Model sferyczny</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vario &lt;-<span class="st"> </span><span class="kw">variogram</span>(X2002<span class="fl">.08</span>.20_TPZ~<span class="dv">1</span>, wolin_lato_los, <span class="dt">cutoff=</span><span class="dv">20000</span>)
<span class="kw">plot</span>(vario)</code></pre></div>
<p><img src="04-modelowanie_files/figure-html/unnamed-chunk-6-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model_sph &lt;-<span class="st"> </span><span class="kw">vgm</span>(<span class="dt">psill=</span><span class="dv">15</span>, <span class="dt">model =</span> <span class="st">&#39;Sph&#39;</span>, <span class="dt">range=</span><span class="dv">2500</span>)
model_sph</code></pre></div>
<pre><code>##   model psill range
## 1   Sph    15  2500</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(vario, <span class="dt">model=</span>model_sph)</code></pre></div>
<p><img src="04-modelowanie_files/figure-html/unnamed-chunk-6-2.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fitted_sph &lt;-<span class="st"> </span><span class="kw">fit.variogram</span>(vario, model_sph)
fitted_sph</code></pre></div>
<pre><code>##   model    psill    range
## 1   Sph 15.92886 1807.716</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(vario, <span class="dt">model=</span>fitted_sph)</code></pre></div>
<p><img src="04-modelowanie_files/figure-html/unnamed-chunk-6-3.png" alt="" /><!-- --></p>
</div>
<div id="modelowanie-izotropowe-model-gaussowski" class="section level3">
<h3><span class="header-section-number">5.4.4</span> Modelowanie izotropowe | Model Gaussowski</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vario &lt;-<span class="st"> </span><span class="kw">variogram</span>(X2002<span class="fl">.08</span>.20_TPZ~<span class="dv">1</span>, wolin_lato_los, <span class="dt">cutoff=</span><span class="dv">20000</span>)
<span class="kw">plot</span>(vario)</code></pre></div>
<p><img src="04-modelowanie_files/figure-html/unnamed-chunk-7-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model_gau &lt;-<span class="st"> </span><span class="kw">vgm</span>(<span class="dt">psill=</span><span class="dv">15</span>, <span class="dt">model =</span> <span class="st">&#39;Gau&#39;</span>, <span class="dt">range=</span><span class="dv">900</span>)
model_gau</code></pre></div>
<pre><code>##   model psill range
## 1   Gau    15   900</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(vario, <span class="dt">model=</span>model_gau)</code></pre></div>
<p><img src="04-modelowanie_files/figure-html/unnamed-chunk-7-2.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fitted_gau &lt;-<span class="st"> </span><span class="kw">fit.variogram</span>(vario, model_gau)
fitted_gau</code></pre></div>
<pre><code>##   model    psill    range
## 1   Gau 15.99224 695.0783</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(vario, <span class="dt">model=</span>fitted_gau)</code></pre></div>
<p><img src="04-modelowanie_files/figure-html/unnamed-chunk-7-3.png" alt="" /><!-- --></p>
</div>
<div id="modelowanie-izotropowe-model-potegowy" class="section level3">
<h3><span class="header-section-number">5.4.5</span> Modelowanie izotropowe | Model potęgowy</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vario &lt;-<span class="st"> </span><span class="kw">variogram</span>(X2002<span class="fl">.08</span>.20_TPZ~<span class="dv">1</span>, wolin_lato_los, <span class="dt">cutoff=</span><span class="dv">20000</span>)
<span class="kw">plot</span>(vario)</code></pre></div>
<p><img src="04-modelowanie_files/figure-html/unnamed-chunk-8-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model_pow &lt;-<span class="st"> </span><span class="kw">vgm</span>(<span class="dt">psill=</span><span class="dv">2</span>, <span class="dt">model =</span> <span class="st">&#39;Pow&#39;</span>, <span class="dt">range=</span><span class="fl">0.25</span>)
model_pow</code></pre></div>
<pre><code>##   model psill range
## 1   Pow     2  0.25</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(vario, <span class="dt">model=</span>model_pow)</code></pre></div>
<p><img src="04-modelowanie_files/figure-html/unnamed-chunk-8-2.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fitted_pow &lt;-<span class="st"> </span><span class="kw">fit.variogram</span>(vario, model_pow)
fitted_pow</code></pre></div>
<pre><code>##   model    psill     range
## 1   Pow 2.017736 0.2486255</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(vario, <span class="dt">model=</span>fitted_pow)</code></pre></div>
<p><img src="04-modelowanie_files/figure-html/unnamed-chunk-8-3.png" alt="" /><!-- --></p>
</div>
<div id="modelowanie-izotropowe-model-wykadniczy" class="section level3">
<h3><span class="header-section-number">5.4.6</span> Modelowanie izotropowe | Model wykładniczy</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vario &lt;-<span class="st"> </span><span class="kw">variogram</span>(X2002<span class="fl">.08</span>.20_TPZ~<span class="dv">1</span>, wolin_lato_los, <span class="dt">cutoff=</span><span class="dv">20000</span>)
<span class="kw">plot</span>(vario)</code></pre></div>
<p><img src="04-modelowanie_files/figure-html/unnamed-chunk-9-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model_exp &lt;-<span class="st"> </span><span class="kw">vgm</span>(<span class="dt">psill=</span><span class="dv">15</span>, <span class="dt">model =</span> <span class="st">&#39;Exp&#39;</span>, <span class="dt">range=</span><span class="dv">900</span>)
model_exp</code></pre></div>
<pre><code>##   model psill range
## 1   Exp    15   900</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(vario, <span class="dt">model=</span>model_exp)</code></pre></div>
<p><img src="04-modelowanie_files/figure-html/unnamed-chunk-9-2.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fitted_exp &lt;-<span class="st"> </span><span class="kw">fit.variogram</span>(vario, model_exp)
fitted_exp</code></pre></div>
<pre><code>##   model    psill    range
## 1   Exp 17.04506 943.5193</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(vario, <span class="dt">model=</span>fitted_exp)</code></pre></div>
<p><img src="04-modelowanie_files/figure-html/unnamed-chunk-9-3.png" alt="" /><!-- --></p>
</div>
<div id="modelowanie-izotropowe-modele-zozone-i" class="section level3">
<h3><span class="header-section-number">5.4.7</span> Modelowanie izotropowe | Modele złożone I</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vario &lt;-<span class="st"> </span><span class="kw">variogram</span>(X2002<span class="fl">.08</span>.20_TPZ~<span class="dv">1</span>, wolin_lato_los, <span class="dt">cutoff=</span><span class="dv">20000</span>)
model_zl1 &lt;-<span class="st"> </span><span class="kw">vgm</span>(<span class="dt">psill=</span><span class="dv">10</span>, <span class="dt">model =</span> <span class="st">&#39;Sph&#39;</span>, <span class="dt">range =</span> <span class="dv">9000</span>, <span class="dt">add.to =</span> <span class="kw">vgm</span>(<span class="dv">9</span>, <span class="st">&quot;Nug&quot;</span>))
model_zl1</code></pre></div>
<pre><code>##   model psill range
## 1   Nug     9     0
## 2   Sph    10  9000</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fitted_zl1 &lt;-<span class="st"> </span><span class="kw">fit.variogram</span>(vario, model_zl1)
fitted_zl1</code></pre></div>
<pre><code>##   model     psill    range
## 1   Nug  9.940273     0.00
## 2   Sph 11.412555 12025.31</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(vario, <span class="dt">model=</span>fitted_zl1)</code></pre></div>
<p><img src="04-modelowanie_files/figure-html/unnamed-chunk-10-1.png" alt="" /><!-- --></p>
</div>
<div id="modelowanie-izotropowe-modele-zozone-ii" class="section level3">
<h3><span class="header-section-number">5.4.8</span> Modelowanie izotropowe | Modele złożone II</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vario &lt;-<span class="st"> </span><span class="kw">variogram</span>(X2002<span class="fl">.08</span>.20_TPZ~<span class="dv">1</span>, wolin_lato_los, <span class="dt">cutoff=</span><span class="dv">20000</span>)
model_zl2 &lt;-<span class="st"> </span><span class="kw">vgm</span>(<span class="dv">10</span>, <span class="dt">model =</span> <span class="st">&#39;Sph&#39;</span>, <span class="dt">range =</span> <span class="dv">4000</span>, <span class="dt">add.to =</span> <span class="kw">vgm</span>(<span class="dv">5</span>, <span class="st">&quot;Gau&quot;</span>, <span class="dv">8000</span>, <span class="dt">nugget =</span> <span class="dv">5</span>))
model_zl2</code></pre></div>
<pre><code>##   model psill range
## 1   Nug     5     0
## 2   Gau     5  8000
## 3   Sph    10  4000</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fitted_zl2 &lt;-<span class="st"> </span><span class="kw">fit.variogram</span>(vario, model_zl2)
<span class="kw">plot</span>(vario, <span class="dt">model=</span>fitted_zl2)</code></pre></div>
<p><img src="04-modelowanie_files/figure-html/unnamed-chunk-11-1.png" alt="" /><!-- --></p>
</div>
</div>
<div id="modelowanie-anizotropowe" class="section level2">
<h2><span class="header-section-number">5.5</span> Modelowanie anizotropowe</h2>
<div id="anizotropia-1" class="section level3">
<h3><span class="header-section-number">5.5.1</span> Anizotropia</h3>
<ul>
<li>Uwzględnienie anizotropii wymaga zamiany parametru zasięgu na trzy inne parametry:</li>
<li>Zasięg w dominującym kierunku</li>
<li>Kąt określający dominujący kierunek</li>
<li>Proporcję anizotropii, czyli relację pomiędzy zasięgiem w dominującym kierunku a zasięgiem w przeciwległym kierunku</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vario_map &lt;-<span class="st"> </span><span class="kw">variogram</span>(X2002<span class="fl">.08</span>.20_TPZ~<span class="dv">1</span>, wolin_lato_los, <span class="dt">cutoff=</span><span class="dv">8000</span>, <span class="dt">width=</span><span class="dv">500</span>, <span class="dt">map=</span><span class="ot">TRUE</span>)
<span class="kw">plot</span>(vario_map)</code></pre></div>
<p><img src="04-modelowanie_files/figure-html/unnamed-chunk-12-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vario_kier &lt;-<span class="st"> </span><span class="kw">variogram</span>(X2002<span class="fl">.08</span>.20_TPZ~<span class="dv">1</span>, wolin_lato_los, <span class="dt">alpha =</span> <span class="kw">c</span>(<span class="dv">60</span>, <span class="dv">105</span>, <span class="dv">150</span>, <span class="dv">195</span>), <span class="dt">cutoff=</span><span class="dv">20000</span>)
<span class="kw">plot</span>(vario_kier, <span class="dt">plot.numbers=</span><span class="ot">TRUE</span>)</code></pre></div>
<p><img src="04-modelowanie_files/figure-html/unnamed-chunk-12-2.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vario_kier_fit &lt;-<span class="st"> </span><span class="kw">vgm</span>(<span class="dt">psill=</span><span class="dv">10</span>, <span class="dt">model=</span><span class="st">&quot;Sph&quot;</span>, <span class="dt">range=</span><span class="dv">10000</span>, <span class="dt">nugget=</span><span class="dv">8</span>, <span class="dt">anis =</span> <span class="kw">c</span>(<span class="dv">60</span>, .<span class="dv">25</span>))
<span class="kw">plot</span>(vario_kier, vario_kier_fit, <span class="dt">as.table=</span><span class="ot">TRUE</span>)</code></pre></div>
<p><img src="04-modelowanie_files/figure-html/unnamed-chunk-12-3.png" alt="" /><!-- --></p>
</div>
</div>
<div id="modelowanie-krossemiwariogramow" class="section level2">
<h2><span class="header-section-number">5.6</span> Modelowanie krossemiwariogramów</h2>
<div id="modelowanie-krossemiwariogramow-fit.lmc" class="section level3">
<h3><span class="header-section-number">5.6.1</span> Modelowanie krossemiwariogramów | <em>fit.lmc</em></h3>
<ul>
<li>Funkcja <em>fit.lmc</em> dopasowuje liniowy model koregionalizacji do semiwariogramów wielozmienych</li>
</ul>
</div>
<div id="modelowanie-krossemiwariogramow-1" class="section level3">
<h3><span class="header-section-number">5.6.2</span> Modelowanie krossemiwariogramów</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">wolin_lato_los_255 &lt;-<span class="st"> </span>wolin_lato_los[!<span class="kw">is.na</span>(wolin_lato_los$X1999<span class="fl">.09</span>.13_TPZ), ]
wolin_lato_los_750 &lt;-<span class="st"> </span>wolin_lato_los

<span class="kw">library</span>(<span class="st">&#39;gstat&#39;</span>)
g &lt;-<span class="st"> </span><span class="kw">gstat</span>(<span class="ot">NULL</span>, <span class="dt">id=</span><span class="st">&quot;TPZ1999&quot;</span>, <span class="dt">form =</span> X1999<span class="fl">.09</span>.13_TPZ~<span class="dv">1</span>, <span class="dt">data =</span> wolin_lato_los_255)
g &lt;-<span class="st"> </span><span class="kw">gstat</span>(g, <span class="dt">id=</span><span class="st">&quot;TPZ2002&quot;</span>, <span class="dt">form =</span> X2002<span class="fl">.08</span>.20_TPZ~<span class="dv">1</span>, <span class="dt">data =</span> wolin_lato_los_750)
g</code></pre></div>
<pre><code>## data:
## TPZ1999 : formula = X1999.09.13_TPZ`~`1 ; data dim = 255 x 9
## TPZ2002 : formula = X2002.08.20_TPZ`~`1 ; data dim = 750 x 9</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">v &lt;-<span class="st"> </span><span class="kw">variogram</span>(g)
<span class="kw">plot</span>(v)</code></pre></div>
<p><img src="04-modelowanie_files/figure-html/unnamed-chunk-13-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">g &lt;-<span class="st"> </span><span class="kw">gstat</span>(g, <span class="dt">model=</span><span class="kw">vgm</span>(<span class="dv">17</span>, <span class="st">&quot;Sph&quot;</span>, <span class="dv">12000</span>, <span class="dv">5</span>), <span class="dt">fill.all=</span><span class="ot">TRUE</span>)
g_fit &lt;-<span class="st"> </span><span class="kw">fit.lmc</span>(v, g, <span class="dt">fit.ranges =</span> <span class="ot">FALSE</span>, <span class="dt">fit.method=</span><span class="dv">1</span>)
g_fit</code></pre></div>
<pre><code>## data:
## TPZ1999 : formula = X1999.09.13_TPZ`~`1 ; data dim = 255 x 9
## TPZ2002 : formula = X2002.08.20_TPZ`~`1 ; data dim = 750 x 9
## variograms:
##                    model     psill range
## TPZ1999[1]           Nug  5.325525     0
## TPZ1999[2]           Sph 11.441263 12000
## TPZ2002[1]           Nug 10.042044     0
## TPZ2002[2]           Sph 11.626818 12000
## TPZ1999.TPZ2002[1]   Nug  7.312944     0
## TPZ1999.TPZ2002[2]   Sph 10.911990 12000</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(v, g_fit)</code></pre></div>
<p><img src="04-modelowanie_files/figure-html/unnamed-chunk-13-2.png" alt="" /><!-- --></p>
<!--


```r
vgm_map <- variogram(g, cutoff=10000, width=500, map=TRUE)
plot(vgm_map, threshold=30)
```

![](04-modelowanie_files/figure-html/unnamed-chunk-14-1.png)<!-- -->
<p>–&gt;</p>
<!--chapter:end:04-modelowanie.Rmd-->
</div>
</div>
</div>
<div id="estymacje-jednozmienne" class="section level1">
<h1><span class="header-section-number">6</span> Estymacje jednozmienne</h1>
<div id="kriging" class="section level2">
<h2><span class="header-section-number">6.1</span> Kriging</h2>
<div id="kriging-interpolacja-geostatystyczna" class="section level3">
<h3><span class="header-section-number">6.1.1</span> Kriging | Interpolacja geostatystyczna</h3>
<ul>
<li>Zaproponowana w latach 50. przez Daniela Krige</li>
<li>Istnieje wiele rodzajów krigingu</li>
<li>Główna zasada mówi, że prognoza w danej lokalizacji jest kombinacją obokległych obserwacji</li>
<li>Waga nadawana każdej z obserwacji jest zależna od stopnia (przestrzennej) korelacji - stąd też bierze się istotna rola semiwariogramów</li>
</ul>
</div>
</div>
<div id="rodzaje-krigingu" class="section level2">
<h2><span class="header-section-number">6.2</span> Rodzaje krigingu</h2>
<div id="rodzaje-krigingu-1" class="section level3">
<h3><span class="header-section-number">6.2.1</span> Rodzaje krigingu</h3>
<ul>
<li>Kriging prosty (ang. <em>Simple kriging</em>)</li>
<li>Kriging zwykły (ang. <em>Ordinary kriging</em>)</li>
<li>Kriging z trendem (ang. <em>Kriging with a trend</em>)</li>
<li>Kriging stratyfikowany (ang. <em>Kriging within strata</em> – KWS)</li>
<li>Kriging prosty ze zmiennymi średnimi lokalnymi (ang. <em>Simple kriging with varying local means</em> - SKlm)</li>
<li>Kriging z zewnętrznym trendem/Uniwersalny kriging (ang.<em>Kriging with an external trend/Universal kriging</em>)</li>
<li>Kriging danych kodowanych (ang. <em>Indicator kriging</em>)</li>
<li>Kokriging (ang. <em>Co-kriging</em>)</li>
<li>Inne</li>
</ul>
</div>
</div>
<div id="kriging-prosty-ang.-simple-kriging" class="section level2">
<h2><span class="header-section-number">6.3</span> Kriging prosty (ang. <em>Simple kriging</em>)</h2>
<div id="kriging-prosty-ang.-simple-kriging-1" class="section level3">
<h3><span class="header-section-number">6.3.1</span> Kriging prosty (ang. <em>Simple kriging</em>)</h3>
<ul>
<li>Zakłada, że średnia jest znana i stała na całym obszarze</li>
</ul>
</div>
<div id="kriging-prosty-ang.-simple-kriging-2" class="section level3">
<h3><span class="header-section-number">6.3.2</span> Kriging prosty (ang. <em>Simple kriging</em>)</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&#39;raster&#39;</span>)
ras &lt;-<span class="st"> </span><span class="kw">raster</span>(<span class="st">&#39;data/siatka_raster.tif&#39;</span>)
grid &lt;-<span class="st"> </span><span class="kw">as</span>(ras, <span class="st">&quot;SpatialGridDataFrame&quot;</span>)
<span class="kw">proj4string</span>(grid) &lt;-<span class="st"> </span><span class="kw">proj4string</span>(wolin_lato_los)

<span class="kw">library</span>(<span class="st">&#39;gstat&#39;</span>)
vario &lt;-<span class="st"> </span><span class="kw">variogram</span>(X2002<span class="fl">.08</span>.20_TPZ~<span class="dv">1</span>, wolin_lato_los)
model_zl2 &lt;-<span class="st"> </span><span class="kw">vgm</span>(<span class="dv">10</span>, <span class="dt">model =</span> <span class="st">&#39;Sph&#39;</span>, <span class="dt">range =</span> <span class="dv">4000</span>, <span class="dt">add.to =</span> <span class="kw">vgm</span>(<span class="dv">5</span>, <span class="st">&quot;Gau&quot;</span>, <span class="dv">8000</span>, <span class="dt">nugget =</span> <span class="dv">5</span>))
model_zl2</code></pre></div>
<pre><code>##   model psill range
## 1   Nug     5     0
## 2   Gau     5  8000
## 3   Sph    10  4000</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fitted_zl2 &lt;-<span class="st"> </span><span class="kw">fit.variogram</span>(vario, model_zl2)
<span class="kw">plot</span>(vario, <span class="dt">model=</span>fitted_zl2)</code></pre></div>
<p><img src="05-estymacje_files/figure-html/unnamed-chunk-1-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sk &lt;-<span class="st"> </span><span class="kw">krige</span>(X2002<span class="fl">.08</span>.20_TPZ~<span class="dv">1</span>, wolin_lato_los, grid, <span class="dt">model=</span>model_zl2, <span class="dt">beta=</span><span class="fl">23.6</span>)</code></pre></div>
<pre><code>## [using simple kriging]</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(sk)</code></pre></div>
<pre><code>## Object of class SpatialGridDataFrame
## Coordinates:
##          min       max
## s1  451080.5  484780.5
## s2 5961519.5 5986319.5
## Is projected: TRUE 
## proj4string :
## [+init=epsg:32633 +proj=utm +zone=33 +datum=WGS84 +units=m +no_defs
## +ellps=WGS84 +towgs84=0,0,0]
## Grid attributes:
##    cellcentre.offset cellsize cells.dim
## s1          451130.5      100       337
## s2         5961569.5      100       248
## Data attributes:
##    var1.pred        var1.var    
##  Min.   :18.14   Min.   : 6.05  
##  1st Qu.:21.01   1st Qu.: 6.91  
##  Median :22.40   Median : 7.20  
##  Mean   :23.41   Mean   : 7.34  
##  3rd Qu.:25.41   3rd Qu.: 7.57  
##  Max.   :35.49   Max.   :15.74  
##  NA&#39;s   :57412   NA&#39;s   :57412</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">spplot</span>(sk, <span class="st">&quot;var1.pred&quot;</span>)
<span class="kw">spplot</span>(sk, <span class="st">&quot;var1.var&quot;</span>)</code></pre></div>
<p><img src="05-estymacje_files/figure-html/plotsy2-1.png" alt="" /><!-- --></p>
</div>
</div>
<div id="kriging-zwyky-ang.-ordinary-kriging" class="section level2">
<h2><span class="header-section-number">6.4</span> Kriging zwykły (ang. <em>Ordinary kriging</em>)</h2>
<div id="kriging-zwyky-ang.-ordinary-kriging-1" class="section level3">
<h3><span class="header-section-number">6.4.1</span> Kriging zwykły (ang. <em>Ordinary kriging</em>)</h3>
<ul>
<li>Średnia traktowana jest jako nieznana</li>
<li>Uwzględnia lokalne fluktuacje średniej poprzez stosowanie ruchomego okna</li>
</ul>
</div>
<div id="kriging-zwyky-ang.-ordinary-kriging-2" class="section level3">
<h3><span class="header-section-number">6.4.2</span> Kriging zwykły (ang. <em>Ordinary kriging</em>)</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ok &lt;-<span class="st"> </span><span class="kw">krige</span>(X2002<span class="fl">.08</span>.20_TPZ~<span class="dv">1</span>, wolin_lato_los, grid, <span class="dt">model=</span>model_zl2, <span class="dt">maxdist=</span><span class="dv">1000</span>)</code></pre></div>
<pre><code>## [using ordinary kriging]</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">spplot</span>(ok, <span class="st">&quot;var1.pred&quot;</span>)
<span class="kw">spplot</span>(ok, <span class="st">&quot;var1.var&quot;</span>)</code></pre></div>
<p><img src="05-estymacje_files/figure-html/plotsy2ok2-1.png" alt="" /><!-- --></p>
<!--


```r
spplot(ok, "var1.pred", sp.layout=list(wolin_lato_los, pch=21, col="white"))
```

![](05-estymacje_files/figure-html/unnamed-chunk-3-1.png)<!-- -->
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">spplot</span>(ok, <span class="st">&quot;var1.var&quot;</span>, <span class="dt">sp.layout=</span><span class="kw">list</span>(wolin_lato_los, <span class="dt">pch=</span><span class="dv">21</span>, <span class="dt">col=</span><span class="st">&quot;white&quot;</span>))</code></pre></div>
<p><img src="05-estymacje_files/figure-html/unnamed-chunk-3-2.png" alt="" /><!-- --></p>
<p>–&gt; ## Kriging z trendem (ang. <em>Kriging with a trend</em>) ### Kriging z trendem (ang. <em>Kriging with a trend</em>)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vario_kzt &lt;-<span class="st"> </span><span class="kw">variogram</span>(X2002<span class="fl">.08</span>.20_TPZ~X+Y, <span class="dt">data=</span>wolin_lato_los)
<span class="kw">plot</span>(vario_kzt)</code></pre></div>
<p><img src="05-estymacje_files/figure-html/unnamed-chunk-4-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model_kzt &lt;-<span class="st"> </span><span class="kw">vgm</span>(<span class="dt">psill =</span> <span class="dv">17</span>, <span class="dt">model =</span> <span class="st">&#39;Sph&#39;</span>, <span class="dt">range =</span> <span class="dv">12000</span>, <span class="dt">nugget =</span> <span class="dv">5</span>)
fitted_kzt &lt;-<span class="st"> </span><span class="kw">fit.variogram</span>(vario_kzt, model_kzt)
fitted_kzt</code></pre></div>
<pre><code>##   model    psill    range
## 1   Nug 6.931465    0.000
## 2   Sph 8.460149 2930.277</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(vario_kzt, fitted_kzt)</code></pre></div>
<p><img src="05-estymacje_files/figure-html/unnamed-chunk-4-2.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">grid_sp &lt;-<span class="st"> </span><span class="kw">as</span>(ras, <span class="st">&quot;SpatialPixelsDataFrame&quot;</span>)
<span class="kw">proj4string</span>(grid_sp) &lt;-<span class="st"> </span><span class="kw">proj4string</span>(wolin_lato_los)
grid_sp@data &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">coordinates</span>(grid_sp))
<span class="kw">names</span>(grid_sp) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;X&quot;</span>, <span class="st">&quot;Y&quot;</span>)

wolin_lato_los@data &lt;-<span class="st"> </span><span class="kw">cbind</span>(wolin_lato_los@data, <span class="kw">as.data.frame</span>(<span class="kw">coordinates</span>(wolin_lato_los)))
kzt &lt;-<span class="st"> </span><span class="kw">krige</span>(X2002<span class="fl">.08</span>.20_TPZ~X+Y, wolin_lato_los, grid_sp, <span class="dt">model=</span>fitted_kzt)</code></pre></div>
<pre><code>## [using universal kriging]</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">spplot</span>(kzt, <span class="st">&quot;var1.pred&quot;</span>)
<span class="kw">spplot</span>(kzt, <span class="st">&quot;var1.var&quot;</span>)</code></pre></div>
<p><img src="05-estymacje_files/figure-html/plotsy2kzt-1.png" alt="" /><!-- --></p>
</div>
</div>
<div id="porownanie-wynikow-sk-ok-i-kzt" class="section level2">
<h2><span class="header-section-number">6.5</span> Porównanie wyników SK, OK i KZT</h2>
<p><img src="05-estymacje_files/figure-html/ploty_trzy-1.png" alt="" /><!-- --></p>
<!--chapter:end:05-estymacje.Rmd-->
</div>
</div>
<div id="final-words" class="section level1">
<h1><span class="header-section-number">7</span> Final Words</h1>
<p>We have finished a nice book.</p>
<!--chapter:end:05-summary.Rmd-->
</div>
<div id="ocena-jakosci-estymacji-uwaga-pomieszany-me-z-reszta" class="section level1">
<h1><span class="header-section-number">8</span> Ocena jakości estymacji [UWAGA POMIESZANY ME Z RESZTĄ!!]</h1>
<div id="statystyki-jakosci-estymacji" class="section level2">
<h2><span class="header-section-number">8.1</span> Statystyki jakości estymacji</h2>
<div id="statystyki-jakosci-estymacji-1" class="section level3">
<h3><span class="header-section-number">8.1.1</span> Statystyki jakości estymacji</h3>
<ul>
<li>Służą do oceny i porównania jakości estymacji</li>
<li>Do podstawowych statystyk ocen jakości estymacji należą:
<ul>
<li>Średni błąd estymacji (ME, ang. <em>mean error</em>)</li>
<li>Pierwiastek średniego błędu kwadratowego (RMSE, ang. <em>root square prediction error</em>)</li>
<li>Współczynnik korelacji</li>
<li>Rozkład błędu (np. 5. percentyl, mediana, 95. percentyl)</li>
</ul></li>
</ul>
</div>
<div id="statystyki-jakosci-estymacji-2" class="section level3">
<h3><span class="header-section-number">8.1.2</span> Statystyki jakości estymacji</h3>
<ul>
<li>Idealna estymacja dawałaby brak błędu oraz wspołczynnik korelacji pomiędzy pomiarami (całą populacją) i szacunkiem równy 1</li>
<li>Wysokie, pojedyncze wartości błędu mogą świadczyć, np. o wystapieniu wartości odstających</li>
</ul>
</div>
<div id="sredni-bad-estymacji" class="section level3">
<h3><span class="header-section-number">8.1.3</span> Średni błąd estymacji</h3>
<ul>
<li>Optymalnie wartość średniego błędu estymacji powinna być jak najbliżej 0</li>
</ul>
<p><span class="math display">\[ ME=\frac{\sum_{i=1}^{n}(\hat{v}_i-v_i)}{n} \]</span></p>
</div>
<div id="pierwiastek-sredniego-bedu-kwadratowego" class="section level3">
<h3><span class="header-section-number">8.1.4</span> Pierwiastek średniego błędu kwadratowego</h3>
<ul>
<li>Optymalnie wartość pierwiastka średniego błędu kwadratowego powinna być jak najmniejsza</li>
</ul>
<p><span class="math display">\[ RMSE=\sqrt{\frac{\sum_{i=1}^{n}(\hat{v}_i-v_i)^2}{n}} \]</span></p>
</div>
<div id="wspoczynnik-korelacji-4" class="section level3">
<h3><span class="header-section-number">8.1.5</span> Współczynnik korelacji</h3>
<ul>
<li>Optymalnie wartość współczynnika korelacji powinna być jak najwyższa</li>
</ul>
</div>
<div id="statystyki-jakosci-estymacji-mapa" class="section level3">
<h3><span class="header-section-number">8.1.6</span> Statystyki jakości estymacji | Mapa</h3>
<p><img src="06-ocena_files/figure-html/mapa-1.png" alt="" /><!-- --></p>
</div>
<div id="statystyki-jakosci-estymacji-histogram" class="section level3">
<h3><span class="header-section-number">8.1.7</span> Statystyki jakości estymacji | Histogram</h3>
<p><img src="06-ocena_files/figure-html/hist-1.png" alt="" /><!-- --></p>
</div>
<div id="statystyki-jakosci-estymacji-wykres-rozrzutu" class="section level3">
<h3><span class="header-section-number">8.1.8</span> Statystyki jakości estymacji | Wykres rozrzutu</h3>
<p><img src="06-ocena_files/figure-html/point-1.png" alt="" /><!-- --></p>
</div>
</div>
<div id="walidacja-wynikow-estymacji" class="section level2">
<h2><span class="header-section-number">8.2</span> Walidacja wyników estymacji</h2>
<div id="walidacja-wynikow-estymacji-1" class="section level3">
<h3><span class="header-section-number">8.2.1</span> Walidacja wyników estymacji</h3>
<ul>
<li>Dokładne dopasowanie modelu do danych może w efekcie nie dawać najlepszych wyników</li>
<li>W efekcie ważne jest stosowanie metod pozwalających na wybranie optymalnego modelu</li>
<li>Do takich metod należy, między innymi, walidacja podzbiorem (ang. <em>jackknifing</em>) oraz kroswalidacja (ang. <em>crossvalidation</em>)</li>
</ul>
</div>
<div id="walidacja-podzbiorem" class="section level3">
<h3><span class="header-section-number">8.2.2</span> Walidacja podzbiorem</h3>
<ul>
<li>Polega na podziale zbioru danych na dwa podzbiory - treningowy i testowy</li>
<li>Zbiór treningowy służy do estymacji wartości</li>
<li>Wynik estymacji porównywany jest z rzeczywistymi wartościami ze zbioru testowego</li>
<li>Zaletą tego podejścia jest stosowanie danych niezależnych od estymacji</li>
<li>Wadą jest konieczność posiadania dużego zbioru danych</li>
</ul>
</div>
<div id="walidacja-podzbiorem-1" class="section level3">
<h3><span class="header-section-number">8.2.3</span> Walidacja podzbiorem</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&#39;caret&#39;</span>)
<span class="kw">set.seed</span>(<span class="dv">124</span>)
indeks &lt;-<span class="st"> </span><span class="kw">as.vector</span>(<span class="kw">createDataPartition</span>(wolin_lato_los$X2002<span class="fl">.08</span>.20_TPZ, <span class="dt">p=</span><span class="fl">0.75</span>, <span class="dt">list=</span><span class="ot">FALSE</span>))
indeks</code></pre></div>
<pre><code>##   [1]   1   2   3   4   5   6   7   8   9  10  12  13  14  16  17  18  19
##  [18]  21  23  24  25  26  27  28  29  30  32  33  35  39  40  42  43  44
##  [35]  45  46  47  48  49  50  51  52  54  55  56  57  58  59  60  61  62
##  [52]  63  64  67  68  70  71  72  75  76  77  78  79  81  82  83  85  86
##  [69]  87  88  89  90  91  92  93  94  95  96  97  98 102 103 104 105 106
##  [86] 107 108 109 111 112 114 115 116 117 118 120 122 123 124 125 127 128
## [103] 129 130 134 136 138 141 142 144 146 147 148 150 151 152 153 155 156
## [120] 157 158 159 160 161 162 163 164 168 169 170 171 173 174 175 177 179
## [137] 180 181 183 184 185 186 187 188 189 190 192 194 195 196 197 198 199
## [154] 200 201 203 204 205 206 207 208 209 210 211 212 213 214 215 217 218
## [171] 219 220 221 223 225 228 230 231 232 233 234 235 236 237 239 240 241
## [188] 242 243 244 246 248 249 250 251 252 253 254 255 257 258 259 262 264
## [205] 265 266 267 268 269 270 271 272 273 274 275 277 279 280 281 286 288
## [222] 289 290 291 292 293 295 297 298 300 301 303 305 307 309 310 311 314
## [239] 315 316 317 318 319 320 321 322 323 324 327 328 329 330 331 334 335
## [256] 336 337 338 339 340 342 343 344 346 347 348 349 350 351 353 354 355
## [273] 357 359 360 361 366 368 369 372 374 376 377 382 383 384 385 386 390
## [290] 391 392 393 395 397 398 399 400 403 404 405 406 407 408 409 411 413
## [307] 415 419 421 422 423 424 425 426 427 428 429 430 433 435 438 439 440
## [324] 441 442 443 444 445 446 448 450 452 453 454 455 458 459 461 466 467
## [341] 468 471 473 474 475 476 477 478 479 481 482 483 484 485 486 488 489
## [358] 490 491 492 493 494 495 496 498 500 501 502 503 504 505 506 507 509
## [375] 512 513 514 515 516 517 518 519 520 521 522 524 525 526 527 528 529
## [392] 530 531 532 533 534 537 538 539 540 541 542 543 544 547 548 549 550
## [409] 551 552 554 555 556 557 558 559 560 561 562 564 565 566 567 568 569
## [426] 570 574 576 577 578 579 580 581 582 583 584 585 586 587 588 589 592
## [443] 593 594 595 596 597 598 601 602 603 604 605 606 607 608 609 610 611
## [460] 614 615 616 617 619 620 621 622 623 624 625 626 627 628 629 630 631
## [477] 632 633 634 635 636 637 638 640 641 643 644 645 646 647 648 649 650
## [494] 651 652 653 656 657 658 659 660 661 664 665 667 668 669 670 671 672
## [511] 673 674 675 676 677 678 679 680 681 682 683 684 685 687 689 693 694
## [528] 695 696 699 700 701 702 703 705 706 713 714 716 718 719 720 722 723
## [545] 724 726 727 729 730 733 734 735 736 737 738 739 740 741 742 743 744
## [562] 745 746 750</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">train &lt;-<span class="st"> </span>wolin_lato_los[indeks, ]
test &lt;-<span class="st"> </span>wolin_lato_los[-indeks, ]
vario &lt;-<span class="st"> </span><span class="kw">variogram</span>(X2002<span class="fl">.08</span>.20_TPZ~<span class="dv">1</span>, <span class="dt">data=</span>train)
model_zl2 &lt;-<span class="st"> </span><span class="kw">vgm</span>(<span class="dv">10</span>, <span class="dt">model =</span> <span class="st">&#39;Sph&#39;</span>, <span class="dt">range =</span> <span class="dv">4000</span>, <span class="dt">add.to =</span> <span class="kw">vgm</span>(<span class="dv">5</span>, <span class="st">&quot;Gau&quot;</span>, <span class="dv">8000</span>, <span class="dt">nugget =</span> <span class="dv">5</span>))
model_zl2</code></pre></div>
<pre><code>##   model psill range
## 1   Nug     5     0
## 2   Gau     5  8000
## 3   Sph    10  4000</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fitted_zl2 &lt;-<span class="st"> </span><span class="kw">fit.variogram</span>(vario, model_zl2)
<span class="kw">plot</span>(vario, <span class="dt">model=</span>fitted_zl2)</code></pre></div>
<p><img src="06-ocena_files/figure-html/unnamed-chunk-1-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">test_sk &lt;-<span class="st"> </span><span class="kw">krige</span>(X2002<span class="fl">.08</span>.20_TPZ~<span class="dv">1</span>, train, test, <span class="dt">model=</span>fitted_zl2, <span class="dt">beta=</span><span class="fl">23.6</span>)</code></pre></div>
<pre><code>## [using simple kriging]</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(test_sk)</code></pre></div>
<pre><code>## Object of class SpatialPointsDataFrame
## Coordinates:
##       min     max
## X  451860  482250
## Y 5962620 5985510
## Is projected: TRUE 
## proj4string :
## [+init=epsg:32633 +proj=utm +zone=33 +datum=WGS84 +units=m +no_defs
## +ellps=WGS84 +towgs84=0,0,0]
## Number of points: 186
## Data attributes:
##    var1.pred        var1.var     
##  Min.   :19.14   Min.   : 8.354  
##  1st Qu.:21.19   1st Qu.: 9.340  
##  Median :22.77   Median : 9.858  
##  Mean   :23.57   Mean   : 9.959  
##  3rd Qu.:25.51   3rd Qu.:10.377  
##  Max.   :33.44   Max.   :12.363</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">reszta_sk &lt;-<span class="st">  </span>test_sk$var1.pred -<span class="st"> </span>test$X2002<span class="fl">.08</span>.20_TPZ
<span class="kw">summary</span>(reszta_sk)</code></pre></div>
<pre><code>##      Min.   1st Qu.    Median      Mean   3rd Qu.      Max. 
## -12.99000  -1.28700   0.46090  -0.05885   1.79100   7.78600</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ME &lt;-<span class="st"> </span><span class="kw">sum</span>(reszta_sk)/<span class="kw">length</span>(reszta_sk)
ME</code></pre></div>
<pre><code>## [1] -0.05885324</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">RMSE &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">sum</span>(reszta_sk^<span class="dv">2</span>)/<span class="kw">length</span>(reszta_sk))
RMSE</code></pre></div>
<pre><code>## [1] 3.173024</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">srednia_reszta &lt;-<span class="st"> </span>test$X2002<span class="fl">.08</span>.20_TPZ -<span class="st"> </span><span class="kw">mean</span>(test$X2002<span class="fl">.08</span>.20_TPZ)
R2 &lt;-<span class="st"> </span><span class="dv">1</span> -<span class="st"> </span><span class="kw">sum</span>(reszta_sk^<span class="dv">2</span>)/<span class="kw">sum</span>(srednia_reszta^<span class="dv">2</span>)
R2</code></pre></div>
<pre><code>## [1] 0.5150169</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">test_sk$reszty &lt;-<span class="st"> </span>reszta_sk
<span class="kw">spplot</span>(test_sk, <span class="st">&quot;reszty&quot;</span>)</code></pre></div>
<p><img src="06-ocena_files/figure-html/unnamed-chunk-1-2.png" alt="" /><!-- --></p>
</div>
<div id="kroswalidacja" class="section level3">
<h3><span class="header-section-number">8.2.4</span> Kroswalidacja</h3>
<ul>
<li>W przypadku kroswalidacji te same dane wykorzystywane są do budowy modelu, estymacji, a następnie do oceny prognozy</li>
<li>Procedura kroswalidacji LOO (ang. <em>leave-one-out cross-validation</em>)</li>
</ul>
<ol style="list-style-type: decimal">
<li>Zbudowanie matematycznego modelu z dostępnych obserwacji</li>
<li>Dla każdej znanej obserwacji następuje:
<ul>
<li>Usunięcie jej ze zbioru danych</li>
<li>Użycie modelu do wykonania predykcji w miejscu tej obserwacji</li>
<li>Wyliczenie reszty (ang. <em>residual</em>), czyli różnicy pomiędzy znaną wartością a obserwacją</li>
</ul></li>
<li>Podsumowanie otrzymanych wyników</li>
</ol>
<ul>
<li>W pakiecie <strong>gstat</strong>, kroswalidacja LOO jest dostępna w funkcjach <em>krige.cv</em> oraz <em>gstat.cv</em></li>
</ul>
</div>
<div id="kroswalidacja-1" class="section level3">
<h3><span class="header-section-number">8.2.5</span> Kroswalidacja</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vario &lt;-<span class="st"> </span><span class="kw">variogram</span>(X2002<span class="fl">.08</span>.20_TPZ~<span class="dv">1</span>, <span class="dt">data=</span>wolin_lato_los)
model_zl2 &lt;-<span class="st"> </span><span class="kw">vgm</span>(<span class="dv">10</span>, <span class="dt">model =</span> <span class="st">&#39;Sph&#39;</span>, <span class="dt">range =</span> <span class="dv">4000</span>, <span class="dt">add.to =</span> <span class="kw">vgm</span>(<span class="dv">5</span>, <span class="st">&quot;Gau&quot;</span>, <span class="dv">8000</span>, <span class="dt">nugget =</span> <span class="dv">5</span>))
fitted_zl2 &lt;-<span class="st"> </span><span class="kw">fit.variogram</span>(vario, model_zl2)

cv_sk &lt;-<span class="st"> </span><span class="kw">krige.cv</span>(X2002<span class="fl">.08</span>.20_TPZ~<span class="dv">1</span>, wolin_lato_los, <span class="dt">model=</span>fitted_zl2, <span class="dt">beta=</span><span class="fl">23.6</span>)
<span class="kw">summary</span>(cv_sk)</code></pre></div>
<pre><code>## Object of class SpatialPointsDataFrame
## Coordinates:
##       min     max
## X  451470  483570
## Y 5962620 5985510
## Is projected: NA 
## proj4string : [NA]
## Number of points: 750
## Data attributes:
##    var1.pred        var1.var         observed        residual        
##  Min.   :18.10   Min.   : 8.320   Min.   :17.11   Min.   :-11.56584  
##  1st Qu.:21.16   1st Qu.: 9.186   1st Qu.:20.48   1st Qu.: -1.57822  
##  Median :22.61   Median : 9.571   Median :21.89   Median : -0.38231  
##  Mean   :23.57   Mean   : 9.673   Mean   :23.56   Mean   : -0.01102  
##  3rd Qu.:25.62   3rd Qu.:10.027   3rd Qu.:25.81   3rd Qu.:  0.96534  
##  Max.   :33.78   Max.   :12.626   Max.   :41.79   Max.   : 13.74115  
##      zscore               fold      
##  Min.   :-3.740951   Min.   :  1.0  
##  1st Qu.:-0.502235   1st Qu.:188.2  
##  Median :-0.119653   Median :375.5  
##  Mean   :-0.001631   Mean   :375.5  
##  3rd Qu.: 0.314956   3rd Qu.:562.8  
##  Max.   : 4.526214   Max.   :750.0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">spplot</span>(cv_sk, <span class="st">&quot;residual&quot;</span>)</code></pre></div>
<p><img src="06-ocena_files/figure-html/loovv-1.png" alt="" /><!-- --></p>
<!-- 


```r
# ok_loocv <- krige.cv(X2002.08.20_TPZ~1, wolin_lato_los, model=model_zl2)
# summary(ok_loocv)
```


- Tutaj inne przykłady
- Wykresy z loocv
- wykresy porównujące



```r
# ok_fit <- gstat(formula=X2002.08.20_TPZ~1, data=wolin_lato_los, model=model_zl2)
# ok_loocv <- gstat.cv(OK_fit, debug.level=0, random=FALSE)
# spplot(pe[6])
```




```r
#
```

## 
- prezentacja 5 Ani
- spatinter folder
- AIC

## Walidacja wyników estymacji

### Walidacja wyników estymacji |  Kriging zwykły - LOO crossvalidation
krige.cv


```r
# OK_fit <- gstat(id="OK_fit", formula=X2002.08.20_TPZ~1, data=wolin_lato_los, model=fitted)
# pe <- gstat.cv(OK_fit, debug.level=0, random=FALSE)
# spplot(pe[6])
# 
# z <- predict(OK_fit, newdata = grid, debug.level = 0)
# grid2 <- grid
# grid2$OK_pred <- z$OK_fit.pred
# grid2$OK_se <- sqrt(z$OK_fit.var)
# library('rasterVis')
# spplot(grid2, 'OK_pred')
# spplot(grid2, 'OK_se')
```

### Walidacja wyników estymacji |  K  Kriging uniwersalny - LOO crossvalidation


```r
# KU_fit <- gstat(id="KU_fit", formula=X2002.08.20_TPZ~odl_od_morza, data=wolin_lato_los, model=fitted_ku)
# pe <- gstat.cv(KU_fit, debug.level=0, random=FALSE)
# spplot(pe[6])

# dodanie odległości od morza do siatki !!
# z_KU <- predict(KU_fit, newdata = grid, debug.level = 0)
# grid$KU_pred <- z$KU_fit.pred
# grid$KU_se <- sqrt(z$KU_fit.var)
# library('rasterVis')
# spplot(grid, 'KU_pred')
# spplot(grid, 'KU_se')
```


-->
<!--chapter:end:06-ocena.Rmd-->
</div>
</div>
</div>
<div id="references" class="section level1">
<h1><span class="header-section-number">9</span> References</h1>
<!--chapter:end:06-references.Rmd-->
</div>
<div id="wykorzystanie-do-estymacji-danych-uzupeniajacych" class="section level1">
<h1><span class="header-section-number">10</span> Wykorzystanie do estymacji danych uzupełniających</h1>
<div id="kriging-stratyfikowany-ang.-kriging-within-strata" class="section level2">
<h2><span class="header-section-number">10.1</span> Kriging stratyfikowany (ang. <em>Kriging within strata</em>)</h2>
<div id="kriging-stratyfikowany-ang.-kriging-within-strata-1" class="section level3">
<h3><span class="header-section-number">10.1.1</span> Kriging stratyfikowany (ang. <em>Kriging within strata</em>)</h3>
<ul>
<li>Zakłada on, że zmienność badanego zjawiska zależy od zmiennej jakościowej (kategoryzowanej)</li>
<li>Przykładowo, zróżnicowanie badanej zmiennej jest różne w zależności od pokrycia terenu</li>
<li>Kriging stratyfikowany wymaga posiadania danych zmiennej jakościowej (kategoryzowanej) na całym badanym obszarze</li>
</ul>
</div>
<div id="kriging-stratyfikowany-ang.-kriging-within-strata-2" class="section level3">
<h3><span class="header-section-number">10.1.2</span> Kriging stratyfikowany (ang. <em>Kriging within strata</em>)</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&#39;gstat&#39;</span>)
grid &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/siatka_wolin_lato.csv&quot;</span>)
<span class="kw">head</span>(grid)</code></pre></div>
<pre><code>##   X1999.09.13_NDVI X2002.08.20_NDVI CLC06 CLC06_p_lato odl_od_morza
## 1         0.170732         0.090909   411            5     17190.21
## 2         0.473684         0.428571   411            5     17206.85
## 3        -0.133333        -0.153846   411            5     17148.59
## 4         0.298969         0.230769   411            5     17165.27
## 5         0.500000         0.487603   411            5     17181.86
## 6         0.513889         0.532258   411            5     17198.48
##   InsCalk_1999.09 InsCalk_2002.08      X       Y
## 1        48.35811        64.16846 472740 5961510
## 2        48.45755        64.25623 472770 5961510
## 3        48.35780        64.16824 472710 5961540
## 4        48.35745        64.16785 472740 5961540
## 5        48.92398        64.66546 472770 5961540
## 6        48.98947        64.72395 472800 5961540</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">coordinates</span>(grid) &lt;-<span class="st"> </span><span class="er">~</span>X+Y
<span class="kw">proj4string</span>(grid) &lt;-<span class="st"> </span><span class="kw">proj4string</span>(wolin_lato_los)
<span class="kw">gridded</span>(grid) &lt;-<span class="st"> </span><span class="ot">TRUE</span>

<span class="kw">spplot</span>(grid, <span class="st">&quot;CLC06_p_lato&quot;</span>)</code></pre></div>
<p><img src="07-dane_uzupelniajace_files/figure-html/unnamed-chunk-2-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vario_kws1 &lt;-<span class="st"> </span><span class="kw">variogram</span>(X2002<span class="fl">.08</span>.20_TPZ~<span class="dv">1</span>, wolin_lato_los[wolin_lato_los$CLC06_p_lato==<span class="dv">1</span>, ])
<span class="kw">plot</span>(vario_kws1)</code></pre></div>
<p><img src="07-dane_uzupelniajace_files/figure-html/unnamed-chunk-2-2.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fitted_kws1 &lt;-<span class="st"> </span><span class="kw">fit.variogram</span>(vario_kws1, <span class="kw">vgm</span>(<span class="dv">8</span>, <span class="dt">model =</span> <span class="st">&#39;Sph&#39;</span>, <span class="dt">range =</span> <span class="dv">1500</span>, <span class="dt">nugget =</span> <span class="dv">1</span>))
<span class="kw">plot</span>(vario_kws1, fitted_kws1)</code></pre></div>
<p><img src="07-dane_uzupelniajace_files/figure-html/unnamed-chunk-2-3.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vario_kws2 &lt;-<span class="st"> </span><span class="kw">variogram</span>(X2002<span class="fl">.08</span>.20_TPZ~<span class="dv">1</span>, wolin_lato_los[wolin_lato_los$CLC06_p_lato==<span class="dv">2</span>, ])
<span class="kw">plot</span>(vario_kws2)</code></pre></div>
<p><img src="07-dane_uzupelniajace_files/figure-html/unnamed-chunk-2-4.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fitted_kws2 &lt;-<span class="st"> </span><span class="kw">fit.variogram</span>(vario_kws2, <span class="kw">vgm</span>(<span class="dv">8</span>, <span class="dt">model =</span> <span class="st">&#39;Sph&#39;</span>, <span class="dt">range =</span> <span class="dv">2000</span>, <span class="dt">nugget =</span> <span class="dv">4</span>))
<span class="kw">plot</span>(vario_kws2, fitted_kws2)</code></pre></div>
<p><img src="07-dane_uzupelniajace_files/figure-html/unnamed-chunk-2-5.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vario_kws3 &lt;-<span class="st"> </span><span class="kw">variogram</span>(X2002<span class="fl">.08</span>.20_TPZ~<span class="dv">1</span>, wolin_lato_los[wolin_lato_los$CLC06_p_lato==<span class="dv">3</span>, ])
<span class="kw">plot</span>(vario_kws3)</code></pre></div>
<p><img src="07-dane_uzupelniajace_files/figure-html/unnamed-chunk-2-6.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fitted_kws3 &lt;-<span class="st"> </span><span class="kw">fit.variogram</span>(vario_kws3, <span class="kw">vgm</span>(<span class="dv">15</span>, <span class="dt">model =</span> <span class="st">&#39;Sph&#39;</span>, <span class="dt">range =</span> <span class="dv">2000</span>, <span class="dt">nugget =</span> <span class="dv">5</span>))
<span class="kw">plot</span>(vario_kws3, fitted_kws3)</code></pre></div>
<p><img src="07-dane_uzupelniajace_files/figure-html/unnamed-chunk-2-7.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vario_kws4 &lt;-<span class="st"> </span><span class="kw">variogram</span>(X2002<span class="fl">.08</span>.20_TPZ~<span class="dv">1</span>, wolin_lato_los[wolin_lato_los$CLC06_p_lato==<span class="dv">4</span>, ])
<span class="kw">plot</span>(vario_kws4)</code></pre></div>
<p><img src="07-dane_uzupelniajace_files/figure-html/unnamed-chunk-2-8.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fitted_kws4 &lt;-<span class="st"> </span><span class="kw">fit.variogram</span>(vario_kws4, <span class="kw">vgm</span>(<span class="dv">4</span>, <span class="dt">model =</span> <span class="st">&#39;Gau&#39;</span>, <span class="dt">range =</span> <span class="dv">10000</span>, <span class="dt">nugget =</span> <span class="dv">2</span>))
<span class="kw">plot</span>(vario_kws4, fitted_kws4)</code></pre></div>
<p><img src="07-dane_uzupelniajace_files/figure-html/unnamed-chunk-2-9.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vario_kws5 &lt;-<span class="st"> </span><span class="kw">variogram</span>(X2002<span class="fl">.08</span>.20_TPZ~<span class="dv">1</span>, wolin_lato_los[wolin_lato_los$CLC06_p_lato==<span class="dv">5</span>, ])
<span class="kw">plot</span>(vario_kws5)</code></pre></div>
<p><img src="07-dane_uzupelniajace_files/figure-html/unnamed-chunk-2-10.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fitted_kws5 &lt;-<span class="st"> </span><span class="kw">fit.variogram</span>(vario_kws5, <span class="kw">vgm</span>(<span class="dv">2</span>, <span class="dt">model =</span> <span class="st">&#39;Sph&#39;</span>, <span class="dt">range =</span> <span class="dv">2000</span>, <span class="dt">nugget =</span> <span class="dv">1</span>))
<span class="kw">plot</span>(vario_kws5, fitted_kws5)</code></pre></div>
<p><img src="07-dane_uzupelniajace_files/figure-html/unnamed-chunk-2-11.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vario_kws6 &lt;-<span class="st"> </span><span class="kw">variogram</span>(X2002<span class="fl">.08</span>.20_TPZ~<span class="dv">1</span>, wolin_lato_los[wolin_lato_los$CLC06_p_lato==<span class="dv">6</span>, ])
<span class="kw">plot</span>(vario_kws6)</code></pre></div>
<p><img src="07-dane_uzupelniajace_files/figure-html/unnamed-chunk-2-12.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fitted_kws6 &lt;-<span class="st"> </span><span class="kw">fit.variogram</span>(vario_kws6, <span class="kw">vgm</span>(<span class="dv">1</span>, <span class="dt">model =</span> <span class="st">&#39;Gau&#39;</span>, <span class="dt">range =</span> <span class="dv">2500</span>, <span class="dt">nugget =</span> <span class="fl">0.4</span>))
<span class="kw">plot</span>(vario_kws6, fitted_kws6)</code></pre></div>
<p><img src="07-dane_uzupelniajace_files/figure-html/unnamed-chunk-2-13.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">kws1 &lt;-<span class="st"> </span><span class="kw">krige</span>(X2002<span class="fl">.08</span>.20_TPZ~<span class="dv">1</span>, wolin_lato_los[wolin_lato_los$CLC06_p_lato==<span class="dv">1</span>, ], grid[grid$CLC06_p_lato==<span class="dv">1</span>, ], <span class="dt">model =</span> fitted_kws1, <span class="dt">maxdist =</span> <span class="dv">500</span>)</code></pre></div>
<pre><code>## [using ordinary kriging]</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">kws2 &lt;-<span class="st"> </span><span class="kw">krige</span>(X2002<span class="fl">.08</span>.20_TPZ~<span class="dv">1</span>, wolin_lato_los[wolin_lato_los$CLC06_p_lato==<span class="dv">2</span>, ], grid[grid$CLC06_p_lato==<span class="dv">2</span>, ], <span class="dt">model =</span> fitted_kws2, <span class="dt">maxdist =</span> <span class="dv">200</span>)</code></pre></div>
<pre><code>## [using ordinary kriging]</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">kws3 &lt;-<span class="st"> </span><span class="kw">krige</span>(X2002<span class="fl">.08</span>.20_TPZ~<span class="dv">1</span>, wolin_lato_los[wolin_lato_los$CLC06_p_lato==<span class="dv">3</span>, ], grid[grid$CLC06_p_lato==<span class="dv">3</span>, ], <span class="dt">model =</span> fitted_kws3, <span class="dt">maxdist =</span> <span class="dv">1000</span>)</code></pre></div>
<pre><code>## [using ordinary kriging]</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">kws4 &lt;-<span class="st"> </span><span class="kw">krige</span>(X2002<span class="fl">.08</span>.20_TPZ~<span class="dv">1</span>, wolin_lato_los[wolin_lato_los$CLC06_p_lato==<span class="dv">4</span>, ], grid[grid$CLC06_p_lato==<span class="dv">4</span>, ], <span class="dt">model =</span> fitted_kws4, <span class="dt">maxdist =</span> <span class="dv">1000</span>)</code></pre></div>
<pre><code>## [using ordinary kriging]</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">kws5 &lt;-<span class="st"> </span><span class="kw">krige</span>(X2002<span class="fl">.08</span>.20_TPZ~<span class="dv">1</span>, wolin_lato_los[wolin_lato_los$CLC06_p_lato==<span class="dv">5</span>, ], grid[grid$CLC06_p_lato==<span class="dv">5</span>, ], <span class="dt">model =</span> fitted_kws5, <span class="dt">maxdist =</span> <span class="dv">500</span>)</code></pre></div>
<pre><code>## [using ordinary kriging]</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">kws6 &lt;-<span class="st"> </span><span class="kw">krige</span>(X2002<span class="fl">.08</span>.20_TPZ~<span class="dv">1</span>, wolin_lato_los[wolin_lato_los$CLC06_p_lato==<span class="dv">6</span>, ], grid[grid$CLC06_p_lato==<span class="dv">6</span>, ], <span class="dt">model =</span> fitted_kws6, <span class="dt">maxdist =</span> <span class="dv">500</span>)</code></pre></div>
<pre><code>## [using ordinary kriging]</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">kws &lt;-<span class="st"> </span><span class="kw">rbind</span>(<span class="kw">as.data.frame</span>(kws1), <span class="kw">as.data.frame</span>(kws2), <span class="kw">as.data.frame</span>(kws3), <span class="kw">as.data.frame</span>(kws4), <span class="kw">as.data.frame</span>(kws5), <span class="kw">as.data.frame</span>(kws6))
<span class="kw">coordinates</span>(kws) &lt;-<span class="st"> </span><span class="er">~</span>X+Y
kws &lt;-<span class="st"> </span><span class="kw">as</span>(kws, <span class="st">&quot;SpatialPixelsDataFrame&quot;</span>)
<span class="kw">spplot</span>(kws, <span class="st">&quot;var1.pred&quot;</span>, <span class="dt">sp.layout=</span>(<span class="dt">list=</span><span class="kw">SpatialPoints</span>(wolin_lato_los)))</code></pre></div>
<p><img src="07-dane_uzupelniajace_files/figure-html/unnamed-chunk-2-14.png" alt="" /><!-- --></p>
</div>
</div>
<div id="prosty-kriging-ze-zmiennymi-srednimi-lokalnymi-lvm" class="section level2">
<h2><span class="header-section-number">10.2</span> Prosty kriging ze zmiennymi średnimi lokalnymi (LVM)</h2>
<div id="prosty-kriging-ze-zmiennymi-srednimi-lokalnymi-lvm-1" class="section level3">
<h3><span class="header-section-number">10.2.1</span> Prosty kriging ze zmiennymi średnimi lokalnymi (LVM)</h3>
<ul>
<li>Prosty kriging ze zmiennymi średnimi lokalnymi zamiast znanej (stałej) stacjonarnej średniej wykorzystuje zmienne średnie lokalne uzyskane na podstawie innej informacji</li>
<li>Lokalna średnia może być uzyskana za pomocą wyliczenia regresji liniowej pomiędzy zmienną badaną a zmienną dodatkową</li>
</ul>
</div>
<div id="prosty-kriging-ze-zmiennymi-srednimi-lokalnymi-lvm-2" class="section level3">
<h3><span class="header-section-number">10.2.2</span> Prosty kriging ze zmiennymi średnimi lokalnymi (LVM)</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">coef &lt;-<span class="st"> </span><span class="kw">lm</span>(X2002<span class="fl">.08</span>.20_TPZ~<span class="kw">sqrt</span>(odl_od_morza), wolin_lato_los)$coef
coef</code></pre></div>
<pre><code>##        (Intercept) sqrt(odl_od_morza) 
##        20.54376534         0.04678513</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vario &lt;-<span class="st"> </span><span class="kw">variogram</span>(X2002<span class="fl">.08</span>.20_TPZ~<span class="kw">sqrt</span>(odl_od_morza), wolin_lato_los)
model_sim &lt;-<span class="st"> </span><span class="kw">vgm</span>(<span class="dv">9</span>, <span class="dt">model =</span> <span class="st">&#39;Sph&#39;</span>, <span class="dt">range =</span> <span class="dv">4000</span>, <span class="dt">nugget =</span> <span class="dv">7</span>)
model_sim</code></pre></div>
<pre><code>##   model psill range
## 1   Nug     7     0
## 2   Sph     9  4000</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fitted_sim &lt;-<span class="st"> </span><span class="kw">fit.variogram</span>(vario, model_sim)
fitted_sim</code></pre></div>
<pre><code>##   model    psill    range
## 1   Nug 6.919352    0.000
## 2   Sph 8.695489 2911.116</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(vario, <span class="dt">model=</span>fitted_sim)</code></pre></div>
<p><img src="07-dane_uzupelniajace_files/figure-html/unnamed-chunk-3-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sk_lvm &lt;-<span class="st"> </span><span class="kw">krige</span>(X2002<span class="fl">.08</span>.20_TPZ~<span class="kw">sqrt</span>(odl_od_morza), wolin_lato_los, grid, <span class="dt">model=</span>fitted_sim, <span class="dt">beta =</span> coef)</code></pre></div>
<pre><code>## [using simple kriging]</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(sk_lvm)</code></pre></div>
<pre><code>## Object of class SpatialPixelsDataFrame
## Coordinates:
##       min     max
## X  451110  484770
## Y 5961510 5986290
## Is projected: TRUE 
## proj4string :
## [+init=epsg:32633 +proj=utm +zone=33 +datum=WGS84 +units=m +no_defs
## +ellps=WGS84 +towgs84=0,0,0]
## Number of points: 288649
## Grid attributes:
##   cellcentre.offset cellsize cells.dim
## X            451110       30      1123
## Y           5961510       30       827
## Data attributes:
##    var1.pred        var1.var     
##  Min.   :17.11   Min.   : 0.000  
##  1st Qu.:21.05   1st Qu.: 9.330  
##  Median :22.51   Median : 9.687  
##  Mean   :23.43   Mean   : 9.795  
##  3rd Qu.:25.37   3rd Qu.:10.147  
##  Max.   :41.79   Max.   :15.468</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">spplot</span>(sk_lvm, <span class="st">&quot;var1.pred&quot;</span>)
<span class="kw">spplot</span>(sk_lvm, <span class="st">&quot;var1.var&quot;</span>)</code></pre></div>
<p><img src="07-dane_uzupelniajace_files/figure-html/plotsylvm2-1.png" alt="" /><!-- --></p>
</div>
</div>
<div id="kriging-uniwersalny-ang.-universal-kriging" class="section level2">
<h2><span class="header-section-number">10.3</span> Kriging uniwersalny (ang. <em>Universal kriging</em>)</h2>
<div id="kriging-uniwersalny-ang.-universal-kriging-1" class="section level3">
<h3><span class="header-section-number">10.3.1</span> Kriging uniwersalny (ang. <em>Universal kriging</em>)</h3>
<ul>
<li>Określany również jako kriging z trendem (ang. <em>Kriging with a trend model</em>)</li>
<li>Zakłada on, że nieznana średnia lokalna zmiania się stopniowo na badanym obszarze</li>
</ul>
</div>
<div id="kriging-uniwersalny-ang.-universal-kriging-2" class="section level3">
<h3><span class="header-section-number">10.3.2</span> Kriging uniwersalny (ang. <em>Universal kriging</em>)</h3>
<!--


```r
# vario_ku <- variogram(X2002.08.20_TPZ~odl_od_morza, data=wolin_lato_los)
# plot(vario_ku)
# model_ku <- vgm(psill = 17, model = 'Sph', range = 12000, nugget = 5)
# fitted_ku <- fit.variogram(vario_ku, model_ku)
# fitted_ku
# plot(vario_ku, fitted_ku)
```


-->
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">wolin_lato_los$CLC06_p_lato &lt;-<span class="st"> </span><span class="kw">as.factor</span>(wolin_lato_los$CLC06_p_lato)
vario_uk1 &lt;-<span class="st"> </span><span class="kw">variogram</span>(X2002<span class="fl">.08</span>.20_TPZ~CLC06_p_lato, wolin_lato_los)
vario_uk1</code></pre></div>
<pre><code>##       np       dist     gamma dir.hor dir.ver   id
## 1   2489   586.6262  8.178226       0       0 var1
## 2   6419  1356.0526  9.706976       0       0 var1
## 3   9455  2209.0161 10.309445       0       0 var1
## 4  11765  3079.7299 10.147147       0       0 var1
## 5  13604  3951.9182 10.206803       0       0 var1
## 6  14898  4827.0845 10.013613       0       0 var1
## 7  15759  5695.0007  9.472628       0       0 var1
## 8  16230  6572.6776  9.532064       0       0 var1
## 9  15903  7444.9323  9.849153       0       0 var1
## 10 15958  8323.4239  9.743650       0       0 var1
## 11 15848  9199.8893 10.238576       0       0 var1
## 12 15388 10074.5949 10.608090       0       0 var1
## 13 14428 10950.7884 10.654297       0       0 var1
## 14 13438 11816.4479 10.493071       0       0 var1
## 15 12138 12695.1130 10.654643       0       0 var1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(vario_uk1)</code></pre></div>
<p><img src="07-dane_uzupelniajace_files/figure-html/unnamed-chunk-5-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model_uk1 &lt;-<span class="st"> </span><span class="kw">vgm</span>(<span class="dv">3</span>, <span class="dt">model =</span> <span class="st">&#39;Sph&#39;</span>, <span class="dt">range =</span> <span class="dv">2300</span>, <span class="dt">nugget =</span> <span class="dv">7</span>)
vario_fit_uk1 &lt;-<span class="st"> </span><span class="kw">fit.variogram</span>(vario_uk1, <span class="dt">model=</span>model_uk1)
vario_fit_uk1</code></pre></div>
<pre><code>##   model    psill    range
## 1   Nug 6.631904    0.000
## 2   Sph 3.479906 1918.538</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(vario_uk1, vario_fit_uk1)</code></pre></div>
<p><img src="07-dane_uzupelniajace_files/figure-html/unnamed-chunk-5-2.png" alt="" /><!-- --></p>
<!--


```r
# przygotowanie siatki
# grid <- read.csv("data/Wolin_TPZ_p_lato_popN.csv")
# head(grid)
# coordinates(grid) <- ~X+Y
# proj4string(grid) <- proj4string(wolin_lato_los)
# gridded(grid) <- TRUE
# plot(grid)
# names(grid)[6] <- c("CLC06_p_lato")
# names(grid)[7] <- c("odl_od_morza")
# grid@data <- grid@data[c(2, 4:9)]
# # grid@data <- cbind(grid@data, as.data.frame(coordinates(grid)))
# write.csv(grid, 'data/siatka_wolin_lato.csv', row.names=FALSE)
# spplot(grid)
```


-->
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">grid$CLC06_p_lato &lt;-<span class="st"> </span><span class="kw">as.factor</span>(grid$CLC06_p_lato)
<span class="kw">spplot</span>(grid, <span class="st">&quot;CLC06_p_lato&quot;</span>)</code></pre></div>
<p><img src="07-dane_uzupelniajace_files/figure-html/unnamed-chunk-7-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">uk1 &lt;-<span class="st"> </span><span class="kw">krige</span>(X2002<span class="fl">.08</span>.20_TPZ~CLC06_p_lato, <span class="dt">locations =</span> wolin_lato_los, <span class="dt">newdata=</span>grid, <span class="dt">model=</span>vario_fit_uk1)</code></pre></div>
<pre><code>## [using universal kriging]</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">spplot</span>(uk1, <span class="st">&quot;var1.pred&quot;</span>)
<span class="kw">spplot</span>(uk1, <span class="st">&quot;var1.var&quot;</span>)</code></pre></div>
<p><img src="07-dane_uzupelniajace_files/figure-html/plotsy4uk1-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vario_uk2 &lt;-<span class="st"> </span><span class="kw">variogram</span>(X2002<span class="fl">.08</span>.20_TPZ~X2002<span class="fl">.08</span>.20_NDVI+odl_od_morza, wolin_lato_los)
vario_uk2</code></pre></div>
<pre><code>##       np       dist     gamma dir.hor dir.ver   id
## 1   2489   586.6262  6.129399       0       0 var1
## 2   6419  1356.0526  9.090591       0       0 var1
## 3   9455  2209.0161 10.841663       0       0 var1
## 4  11765  3079.7299 10.233852       0       0 var1
## 5  13604  3951.9182  9.618208       0       0 var1
## 6  14898  4827.0845  9.492690       0       0 var1
## 7  15759  5695.0007  9.761382       0       0 var1
## 8  16230  6572.6776  9.852395       0       0 var1
## 9  15903  7444.9323  9.943900       0       0 var1
## 10 15958  8323.4239  9.750130       0       0 var1
## 11 15848  9199.8893  9.670453       0       0 var1
## 12 15388 10074.5949 10.228914       0       0 var1
## 13 14428 10950.7884 11.131210       0       0 var1
## 14 13438 11816.4479 11.578387       0       0 var1
## 15 12138 12695.1130 11.753851       0       0 var1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(vario_uk2)</code></pre></div>
<p><img src="07-dane_uzupelniajace_files/figure-html/unnamed-chunk-8-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model &lt;-<span class="st"> </span><span class="kw">vgm</span>(<span class="dv">5</span>, <span class="dt">model =</span> <span class="st">&#39;Sph&#39;</span>, <span class="dt">range =</span> <span class="dv">2300</span>, <span class="dt">nugget =</span> <span class="dv">5</span>)
vario_fit_uk2 &lt;-<span class="st"> </span><span class="kw">fit.variogram</span>(vario_uk2, <span class="dt">model=</span>model)
vario_fit_uk2</code></pre></div>
<pre><code>##   model    psill    range
## 1   Nug 3.279731    0.000
## 2   Sph 6.931077 2083.678</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(vario_uk2, vario_fit_uk2)</code></pre></div>
<p><img src="07-dane_uzupelniajace_files/figure-html/unnamed-chunk-8-2.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">uk2 &lt;-<span class="st"> </span><span class="kw">krige</span>(X2002<span class="fl">.08</span>.20_TPZ~X2002<span class="fl">.08</span>.20_NDVI+odl_od_morza, <span class="dt">locations =</span> wolin_lato_los, <span class="dt">newdata=</span>grid, <span class="dt">model=</span>vario_fit_uk2)</code></pre></div>
<pre><code>## [using universal kriging]</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">spplot</span>(uk2, <span class="st">&quot;var1.pred&quot;</span>)
<span class="kw">spplot</span>(uk2, <span class="st">&quot;var1.var&quot;</span>)</code></pre></div>
<p><img src="07-dane_uzupelniajace_files/figure-html/plotsy4ked-1.png" alt="" /><!-- --></p>
<!--chapter:end:07-dane_uzupelniajace.Rmd-->
</div>
</div>
</div>
<div id="estymacja-lokalnego-rozkadu-prawdopodobienstwa" class="section level1">
<h1><span class="header-section-number">11</span> Estymacja lokalnego rozkładu prawdopodobieństwa</h1>
<div id="kriging-danych-kodowanych-ang.-indicator-kriging-wprowadzenie" class="section level2">
<h2><span class="header-section-number">11.1</span> Kriging danych kodowanych (ang. <em>Indicator kriging</em>) | Wprowadzenie</h2>
<div id="kriging-danych-kodowanych-ang.-indicator-kriging" class="section level3">
<h3><span class="header-section-number">11.1.1</span> Kriging danych kodowanych (ang. <em>Indicator kriging</em>)</h3>
<ul>
<li>Jest to metoda krigingu oparta o dane kategoryzowane lub też dane przetworzone z postaci ciągłej do binarnej</li>
<li>Zazwyczaj używana jest to oszacowania prawdopodobieństwa przekroczenia zdefiniowanej wartości progowej</li>
<li>Może być też używana do szacowania wartości z całego rozkładu</li>
</ul>
<!--
http://geostat-course.org/system/files/geostat13_ind.pdf
-->
</div>
<div id="kriging-danych-kodowanych-ang.-indicator-kriging-1" class="section level3">
<h3><span class="header-section-number">11.1.2</span> Kriging danych kodowanych (ang. <em>Indicator kriging</em>)</h3>
<ul>
<li>Wartości danych wykorzystywane do krigingu danych kodowanych są określone jako 0 lub 1</li>
<li>Powyzsze kategorie reprezentują czy wartość danej zmiennej jest powyżej czy poniżej określonego progu</li>
</ul>
</div>
<div id="kriging-danych-kodowanych-ang.-indicator-kriging-wady-i-zalety" class="section level3">
<h3><span class="header-section-number">11.1.3</span> Kriging danych kodowanych (ang. <em>Indicator kriging</em>)| Wady i zalety</h3>
<ul>
<li>Zalety:
<ul>
<li>Możliwość zastosowania, gdy nie interesuje nas konkretna wartość, ale znalezienie obszarów o wartości przekraczającej dany poziom</li>
<li>Nie jest istotny kszałt rozkładu</li>
</ul></li>
<li>Wady:
<ul>
<li>Potencjalnie trudne do modelowania semiwariogramy (szczególnie skrajnych przedziałów)</li>
<li>Czasochłonność/pracochłonność</li>
</ul></li>
</ul>
</div>
</div>
<div id="kriging-danych-kodowanych-ang.-indicator-kriging-przykady" class="section level2">
<h2><span class="header-section-number">11.2</span> Kriging danych kodowanych (ang. <em>Indicator kriging</em>) | Przykłady</h2>
<div id="binaryzacja-danych" class="section level3">
<h3><span class="header-section-number">11.2.1</span> Binaryzacja danych</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(wolin_lato_los$X2002<span class="fl">.08</span>.20_TPZ) </code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   17.11   20.48   21.89   23.56   25.81   41.79</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">wolin_lato_los$temp_ind &lt;-<span class="st"> </span>wolin_lato_los$X2002<span class="fl">.08</span>.20_TPZ &lt;<span class="st"> </span><span class="dv">20</span>
<span class="kw">summary</span>(wolin_lato_los$temp_ind) </code></pre></div>
<pre><code>##    Mode   FALSE    TRUE    NA&#39;s 
## logical     630     120       0</code></pre>
</div>
<div id="eksploracja-danych" class="section level3">
<h3><span class="header-section-number">11.2.2</span> Eksploracja danych</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&#39;ggplot2&#39;</span>)
<span class="kw">ggplot</span>(wolin_lato_los@data, <span class="kw">aes</span>(X2002<span class="fl">.08</span>.20_TPZ)) +<span class="st"> </span><span class="kw">stat_ecdf</span>()</code></pre></div>
<p><img src="08-dane_kodowane_files/figure-html/unnamed-chunk-2-1.png" alt="" /><!-- --></p>
</div>
<div id="kriging-danych-kodowanych-ang.-indicator-kriging-semiwariogram" class="section level3">
<h3><span class="header-section-number">11.2.3</span> Kriging danych kodowanych (ang. <em>Indicator kriging</em>) | Semiwariogram</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&#39;gstat&#39;</span>)
vario_ind &lt;-<span class="st"> </span><span class="kw">variogram</span>(temp_ind~<span class="dv">1</span>, wolin_lato_los)         
<span class="kw">plot</span>(vario_ind)</code></pre></div>
<p><img src="08-dane_kodowane_files/figure-html/unnamed-chunk-3-1.png" alt="" /><!-- --></p>
</div>
<div id="kriging-danych-kodowanych-ang.-indicator-kriging-modelowanie" class="section level3">
<h3><span class="header-section-number">11.2.4</span> Kriging danych kodowanych (ang. <em>Indicator kriging</em>) | Modelowanie</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model_ind &lt;-<span class="st"> </span><span class="kw">vgm</span>(<span class="fl">0.05</span>, <span class="dt">model =</span> <span class="st">&#39;Sph&#39;</span>, <span class="dt">range =</span> <span class="dv">2000</span>, <span class="dt">add.to =</span> <span class="kw">vgm</span>(<span class="fl">0.05</span>, <span class="st">&quot;Exp&quot;</span>, <span class="dv">6000</span>, <span class="dt">nugget =</span> <span class="fl">0.05</span>))   
<span class="kw">plot</span>(vario_ind, <span class="dt">model=</span>model_ind)</code></pre></div>
<p><img src="08-dane_kodowane_files/figure-html/unnamed-chunk-4-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fitted_ind &lt;-<span class="st"> </span><span class="kw">fit.variogram</span>(vario_ind, model_ind)
fitted_ind</code></pre></div>
<pre><code>##   model      psill     range
## 1   Nug 0.05007591     0.000
## 2   Exp 0.07173086 12927.822
## 3   Sph 0.05970977  1790.056</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(vario_ind, <span class="dt">model=</span>fitted_ind)</code></pre></div>
<p><img src="08-dane_kodowane_files/figure-html/unnamed-chunk-4-2.png" alt="" /><!-- --></p>
</div>
<div id="kriging-danych-kodowanych-ang.-indicator-kriging-interpolacja" class="section level3">
<h3><span class="header-section-number">11.2.5</span> Kriging danych kodowanych (ang. <em>Indicator kriging</em>) | Interpolacja</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ik &lt;-<span class="st"> </span><span class="kw">krige</span>(temp_ind~<span class="dv">1</span>, wolin_lato_los, grid, <span class="dt">model=</span>fitted_ind)</code></pre></div>
<pre><code>## [using ordinary kriging]</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">spplot</span>(ik, <span class="st">&quot;var1.pred&quot;</span>)
<span class="kw">spplot</span>(ik, <span class="st">&quot;var1.var&quot;</span>)</code></pre></div>
<p><img src="08-dane_kodowane_files/figure-html/plotsy2ok-1.png" alt="" /><!-- --></p>
</div>
<div id="kriging-danych-kodowanych-ang.-indicator-kriging-2" class="section level3">
<h3><span class="header-section-number">11.2.6</span> Kriging danych kodowanych (ang. <em>Indicator kriging</em>)</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vario_ind20 &lt;-<span class="st"> </span><span class="kw">variogram</span>(<span class="kw">I</span>(X2002<span class="fl">.08</span>.20_TPZ&gt;<span class="dv">20</span>)~<span class="dv">1</span>, wolin_lato_los)  
fitted_ind20 &lt;-<span class="st"> </span><span class="kw">fit.variogram</span>(vario_ind20, <span class="kw">vgm</span>(<span class="fl">0.1</span>, <span class="st">&quot;Exp&quot;</span>, <span class="dv">9000</span>, <span class="dt">nugget=</span><span class="fl">0.05</span>))
vario_ind22 &lt;-<span class="st"> </span><span class="kw">variogram</span>(<span class="kw">I</span>(X2002<span class="fl">.08</span>.20_TPZ&gt;<span class="dv">22</span>)~<span class="dv">1</span>, wolin_lato_los)  
fitted_ind22 &lt;-<span class="st"> </span><span class="kw">fit.variogram</span>(vario_ind22, <span class="kw">vgm</span>(<span class="fl">0.15</span>, <span class="st">&quot;Exp&quot;</span>, <span class="dv">9000</span>, <span class="dt">nugget=</span><span class="fl">0.1</span>))
vario_ind25 &lt;-<span class="st"> </span><span class="kw">variogram</span>(<span class="kw">I</span>(X2002<span class="fl">.08</span>.20_TPZ&gt;<span class="dv">25</span>)~<span class="dv">1</span>, wolin_lato_los)  
fitted_ind25 &lt;-<span class="st"> </span><span class="kw">fit.variogram</span>(vario_ind25, <span class="kw">vgm</span>(<span class="fl">0.1</span>, <span class="st">&quot;Exp&quot;</span>, <span class="dv">9000</span>, <span class="dt">nugget=</span><span class="fl">0.1</span>))

ik20 &lt;-<span class="st"> </span><span class="kw">krige</span>(<span class="kw">I</span>(X2002<span class="fl">.08</span>.20_TPZ&gt;<span class="dv">20</span>)~<span class="dv">1</span>, wolin_lato_los, grid, <span class="dt">model=</span>fitted_ind20, <span class="dt">nmax=</span><span class="dv">10</span>)</code></pre></div>
<pre><code>## [using ordinary kriging]</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ik22 &lt;-<span class="st"> </span><span class="kw">krige</span>(<span class="kw">I</span>(X2002<span class="fl">.08</span>.20_TPZ&gt;<span class="dv">22</span>)~<span class="dv">1</span>, wolin_lato_los, grid, <span class="dt">model=</span>fitted_ind22, <span class="dt">nmax=</span><span class="dv">10</span>)</code></pre></div>
<pre><code>## [using ordinary kriging]</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ik25 &lt;-<span class="st"> </span><span class="kw">krige</span>(<span class="kw">I</span>(X2002<span class="fl">.08</span>.20_TPZ&gt;<span class="dv">25</span>)~<span class="dv">1</span>, wolin_lato_los, grid, <span class="dt">model=</span>fitted_ind25, <span class="dt">nmax=</span><span class="dv">10</span>)</code></pre></div>
<pre><code>## [using ordinary kriging]</code></pre>
<p><img src="08-dane_kodowane_files/figure-html/ploty_trzyik-1.png" alt="" /><!-- --></p>
<!--chapter:end:08-dane_kodowane.Rmd-->
</div>
</div>
</div>
<div id="estymacje-wielozmienne" class="section level1">
<h1><span class="header-section-number">12</span> Estymacje wielozmienne</h1>
<div id="kokriging-prosty-i-zwyky-sck-i-ock" class="section level2">
<h2><span class="header-section-number">12.1</span> Kokriging (prosty i zwykły, SCK i OCK)</h2>
<div id="kokriging-ang.-co-kriging" class="section level3">
<h3><span class="header-section-number">12.1.1</span> Kokriging (ang. <em>co-kriging</em>)</h3>
<ul>
<li>Kokriging pozwala na wykorzystanie dodatkowej zmiennej (ang. <em>auxiliary variable</em>), zwanej inaczej kozmienną (ang. <em>co-variable</em>), która może być użyta do prognozwania wartości badanej zmiennej w nieopróbowanej lokalizacji</li>
<li>Zmienna dodatkowa może być pomierzona w tych samych miejscach, gdzie badana zmienna, jak też w innych niż badana zmienna</li>
<li>Możliwa jest też sytuacja, gdy zmienna dodatkowa jest pomierzona w dwóch powyższych przypadkach</li>
<li>Kokriging wymaga, aby obie zmienne były istotnie ze sobą skorelowane</li>
<li>Najczęściej kokriging jest stosowany w sytuacji, gdy zmienna dodatkowa jest łatwiejsza (tańsza) do pomierzenia niż zmienna główna</li>
<li>W efekcie, uzyskany zbiór danych zawiera informacje o badanej zmiennej oraz gęściej opróbowane informacje o zmiennej dodatkowej</li>
<li>Jeżeli informacje o zmiennej dodatkowej są znane dla całego obszaru wówczas bardziej odpowiednią techniką będzie kriging z zewnątrznym trendem (KED)</li>
</ul>
</div>
<div id="kokriging-wybor-dodatkowej-zmiennej" class="section level3">
<h3><span class="header-section-number">12.1.2</span> Kokriging | Wybór dodatkowej zmiennej</h3>
<ul>
<li>Wybór zmiennej dodatkowej może opierać się na dwóch kryteriach:
<ul>
<li>Teoretycznym</li>
<li>Empirycznym</li>
</ul></li>
</ul>
</div>
<div id="kokriging" class="section level3">
<h3><span class="header-section-number">12.1.3</span> Kokriging</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&#39;sp&#39;</span>)
wolin_lato_los &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&#39;data/Wolin_TPZ_p_lato_750losN.csv&#39;</span>, <span class="dt">na.strings=</span>-<span class="fl">999.00</span>)
<span class="kw">coordinates</span>(wolin_lato_los) &lt;-<span class="st"> </span><span class="er">~</span>X+Y
<span class="kw">proj4string</span>(wolin_lato_los) &lt;-<span class="st"> &#39;+init=epsg:32633&#39;</span>

wolin_lato_los_255 &lt;-<span class="st"> </span>wolin_lato_los[!<span class="kw">is.na</span>(wolin_lato_los$X1999<span class="fl">.09</span>.13_TPZ), ]
wolin_lato_los_750 &lt;-<span class="st"> </span>wolin_lato_los

<span class="kw">library</span>(<span class="st">&#39;gstat&#39;</span>)
g &lt;-<span class="st"> </span><span class="kw">gstat</span>(<span class="ot">NULL</span>, <span class="dt">id=</span><span class="st">&quot;TPZ1999&quot;</span>, <span class="dt">form =</span> X1999<span class="fl">.09</span>.13_TPZ~<span class="dv">1</span>, <span class="dt">data =</span> wolin_lato_los_255)
g &lt;-<span class="st"> </span><span class="kw">gstat</span>(g, <span class="dt">id=</span><span class="st">&quot;TPZ2002&quot;</span>, <span class="dt">form =</span> X2002<span class="fl">.08</span>.20_TPZ~<span class="dv">1</span>, <span class="dt">data =</span> wolin_lato_los_750)
g</code></pre></div>
<pre><code>## data:
## TPZ1999 : formula = X1999.09.13_TPZ`~`1 ; data dim = 255 x 9
## TPZ2002 : formula = X2002.08.20_TPZ`~`1 ; data dim = 750 x 9</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">v &lt;-<span class="st"> </span><span class="kw">variogram</span>(g)
<span class="kw">plot</span>(v)</code></pre></div>
<p><img src="09-kokriging_files/figure-html/kokriging_predict-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">g &lt;-<span class="st"> </span><span class="kw">gstat</span>(g, <span class="dt">model=</span><span class="kw">vgm</span>(<span class="dv">17</span>, <span class="st">&quot;Sph&quot;</span>, <span class="dv">12000</span>, <span class="dv">5</span>), <span class="dt">fill.all=</span><span class="ot">TRUE</span>)
g_fit &lt;-<span class="st"> </span><span class="kw">fit.lmc</span>(v, g, <span class="dt">fit.ranges =</span> <span class="ot">FALSE</span>, <span class="dt">fit.method=</span><span class="dv">1</span>)
g_fit</code></pre></div>
<pre><code>## data:
## TPZ1999 : formula = X1999.09.13_TPZ`~`1 ; data dim = 255 x 9
## TPZ2002 : formula = X2002.08.20_TPZ`~`1 ; data dim = 750 x 9
## variograms:
##                    model     psill range
## TPZ1999[1]           Nug  5.325525     0
## TPZ1999[2]           Sph 11.441263 12000
## TPZ2002[1]           Nug 10.042044     0
## TPZ2002[2]           Sph 11.626818 12000
## TPZ1999.TPZ2002[1]   Nug  7.312944     0
## TPZ1999.TPZ2002[2]   Sph 10.911990 12000</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(v, g_fit)</code></pre></div>
<p><img src="09-kokriging_files/figure-html/kokriging_predict-2.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ck &lt;-<span class="st"> </span><span class="kw">predict</span>(g_fit, grid) </code></pre></div>
<pre><code>## Linear Model of Coregionalization found. Good.
## [using ordinary cokriging]</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(ck)</code></pre></div>
<pre><code>## Object of class SpatialGridDataFrame
## Coordinates:
##          min       max
## s1  451080.5  484780.5
## s2 5961519.5 5986319.5
## Is projected: TRUE 
## proj4string :
## [+init=epsg:32633 +proj=utm +zone=33 +datum=WGS84 +units=m +no_defs
## +ellps=WGS84 +towgs84=0,0,0]
## Grid attributes:
##    cellcentre.offset cellsize cells.dim
## s1          451130.5      100       337
## s2         5961569.5      100       248
## Data attributes:
##   TPZ1999.pred    TPZ1999.var     TPZ2002.pred    TPZ2002.var   
##  Min.   :16.71   Min.   : 5.77   Min.   :19.09   Min.   :10.81  
##  1st Qu.:20.77   1st Qu.: 6.22   1st Qu.:20.99   1st Qu.:11.23  
##  Median :22.10   Median : 6.38   Median :22.73   Median :11.35  
##  Mean   :22.93   Mean   : 6.43   Mean   :23.49   Mean   :11.42  
##  3rd Qu.:24.52   3rd Qu.: 6.53   3rd Qu.:25.35   3rd Qu.:11.50  
##  Max.   :37.98   Max.   :10.42   Max.   :34.74   Max.   :15.76  
##  NA&#39;s   :57412   NA&#39;s   :57412   NA&#39;s   :57412   NA&#39;s   :57412  
##  cov.TPZ1999.TPZ2002
##  Min.   : 7.89      
##  1st Qu.: 8.30      
##  Median : 8.42      
##  Mean   : 8.48      
##  3rd Qu.: 8.56      
##  Max.   :12.40      
##  NA&#39;s   :57412</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">spplot</span>(ck, <span class="st">&quot;TPZ1999.pred&quot;</span>)
<span class="kw">spplot</span>(ck, <span class="st">&quot;TPZ1999.var&quot;</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">spplot</span>(ck_a, <span class="st">&quot;TPZ1999.pred&quot;</span>)
<span class="kw">spplot</span>(ck_a, <span class="st">&quot;TPZ1999.var&quot;</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&#39;gridExtra&#39;</span>)
p1 &lt;-<span class="st"> </span><span class="kw">spplot</span>(ck_a, <span class="st">&quot;TPZ1999.pred&quot;</span>, <span class="dt">main=</span><span class="st">&#39;Predykcja CK - anizotropia&#39;</span>)
p2 &lt;-<span class="st"> </span><span class="kw">spplot</span>(ck_a, <span class="st">&quot;TPZ1999.var&quot;</span>, <span class="dt">main=</span><span class="st">&#39;Wariancja CK - anizotropia&#39;</span>)
<span class="kw">grid.arrange</span>(p1, p2, <span class="dt">ncol=</span><span class="dv">2</span>)</code></pre></div>
<!--   
## Kokriging pełny i medianowy, kokriging kolokacyjny, 
## Kokriging na podstawie uproszczonych modeli Markowa I i II
-->
<!--chapter:end:09-kokriging.Rmd-->
</div>
</div>
</div>
<div id="symulacje" class="section level1">
<h1><span class="header-section-number">13</span> Symulacje</h1>
<!--

## Symulacje przestrzenne 1:
 sekwencyjna symulacja i ko symulacja gaussowska,
  sekwencyjna symulacja danych kodowanych, 
  przetwarzanie (postprocesing) wyników symulacji
  
-->
<div id="symulacje-geostatystyczne" class="section level2">
<h2><span class="header-section-number">13.1</span> Symulacje geostatystyczne</h2>
<div id="symulacje-geostatystyczne-1" class="section level3">
<h3><span class="header-section-number">13.1.1</span> Symulacje geostatystyczne</h3>
<ul>
<li>Kriging daje optymalne predykcje, czyli wyznacza najbardziej potencjalnie możliwą wartość dla wybranej lokalizacji</li>
<li>Dodatkowo, efektem krigingu jest wygładzony obraz. W konsekwencji wyniki estymacji różnią się od danych pomiarowych</li>
<li>Jest to tylko (aż?) predykcja. Prawdziwa wartość jest niepewna …</li>
<li>Korzystając z symulacji geostatystycznych nie tworzymy predykcji, ale generujemy równie prawdopodobne możliwości poprzez symulację z rozkładu prawdopodobieństwa (wykorzystując genereator liczb losowych)</li>
</ul>
</div>
<div id="symulacje-geostatystyczne-cel" class="section level3">
<h3><span class="header-section-number">13.1.2</span> Symulacje geostatystyczne | Cel</h3>
<ul>
<li>Efekt symulacji ma bardziej realistyczny przestrzenny wzór (ang. <em>pattern</em>) niż kriging, którego efektem jest wygładzona reprezentacja rzeczywistości</li>
<li>Każda z symulowanych map jest równie prawdopodobna</li>
<li>Symulacje pozwalają na przedstawianie niepewności interpolacji</li>
<li>Jednocześnie - kriging jest znacznie lepszy, gdy naszym celem jest jak najdokładniejsza predykcja</li>
</ul>
</div>
</div>
<div id="typy-symulacji" class="section level2">
<h2><span class="header-section-number">13.2</span> Typy symulacji</h2>
<div id="typy-symulacji-1" class="section level3">
<h3><span class="header-section-number">13.2.1</span> Typy symulacji</h3>
<ul>
<li>Symulacje bezwarunkowe (ang. Unconditional Simulations) - wykorzystuje semiwariogram, żeby włączyć informację przestrzenną, ale wartości ze zmierzonych punktów nie są wykorzystywane.</li>
<li>Symulacje warunkowe (ang. Conditional Simulations) - opiera się ona o średnią wartość, strukturę kowariancji oraz obserwowane wartości</li>
</ul>
</div>
</div>
<div id="symulacje-bezwarunkowe" class="section level2">
<h2><span class="header-section-number">13.3</span> Symulacje bezwarunkowe</h2>
<!--
http://santiago.begueria.es/2010/10/generating-spatially-correlated-random-fields-with-r/
-->
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">grid &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/siatka_wolin_lato60.csv&quot;</span>)
<span class="kw">head</span>(grid)</code></pre></div>
<pre><code>##        X       Y X1999.09.13_NDVI X2002.08.20_NDVI CLC06 CLC06_p_lato
## 1 484185 5986275        0.3777780        0.3333330   311            4
## 2 484245 5986275        0.3591857        0.3516057   311            4
## 3 484305 5986275        0.4804645        0.4181650   311            4
## 4 484365 5986275        0.4475050        0.4057467   311            4
## 5 484425 5986275        0.4379390        0.4029118   311            4
## 6 484485 5986275        0.4628957        0.4251747   311            4
##   odl_od_morza InsCalk_1999.09 InsCalk_2002.08
## 1     2077.811        48.10563        63.98322
## 2     2128.540        48.10553        63.98314
## 3     2183.775        48.10548        63.98310
## 4     2243.541        48.10548        63.98311
## 5     2303.318        48.10548        63.98311
## 6     2363.107        48.10548        63.98310</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">coordinates</span>(grid) &lt;-<span class="st"> </span><span class="er">~</span>X+Y
<span class="kw">proj4string</span>(grid) &lt;-<span class="st"> </span><span class="kw">proj4string</span>(wolin_lato_los)
<span class="kw">gridded</span>(grid) &lt;-<span class="st"> </span><span class="ot">TRUE</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&#39;gstat&#39;</span>)
sym_bezw1 &lt;-<span class="st"> </span><span class="kw">krige</span>(<span class="dt">formula=</span>z~<span class="dv">1</span>, <span class="dt">locations=</span><span class="ot">NULL</span>, <span class="dt">newdata=</span>grid, <span class="dt">dummy=</span><span class="ot">TRUE</span>,
                         <span class="dt">beta=</span><span class="dv">1</span>, <span class="dt">model=</span><span class="kw">vgm</span>(<span class="dt">psill=</span><span class="fl">0.025</span>,<span class="dt">model=</span><span class="st">&#39;Exp&#39;</span>,<span class="dt">range=</span><span class="dv">100</span>), <span class="dt">nsim=</span><span class="dv">4</span>, <span class="dt">nmax=</span><span class="dv">30</span>)</code></pre></div>
<pre><code>## [using unconditional Gaussian simulation]</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">spplot</span>(sym_bezw1, <span class="dt">main=</span><span class="st">&quot;Przestrzennie skorelowana powierzchnia </span><span class="ch">\n</span><span class="st">średnia=1, sill=0.025, zasięg=100, model wykładniczy&quot;</span>)</code></pre></div>
<p><img src="10-symulacje_files/figure-html/unnamed-chunk-2-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sym_bezw2 &lt;-<span class="st"> </span><span class="kw">krige</span>(<span class="dt">formula=</span>z~<span class="dv">1</span>, <span class="dt">locations=</span><span class="ot">NULL</span>, <span class="dt">newdata=</span>grid, <span class="dt">dummy=</span><span class="ot">TRUE</span>, 
                   <span class="dt">beta=</span><span class="dv">1</span>, <span class="dt">model=</span><span class="kw">vgm</span>(<span class="dt">psill=</span><span class="fl">0.025</span>,<span class="dt">model=</span><span class="st">&#39;Exp&#39;</span>,<span class="dt">range=</span><span class="dv">1500</span>), <span class="dt">nsim=</span><span class="dv">4</span>, <span class="dt">nmax=</span><span class="dv">30</span>)</code></pre></div>
<pre><code>## [using unconditional Gaussian simulation]</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">spplot</span>(sym_bezw2, <span class="dt">main=</span><span class="st">&quot;Przestrzennie skorelowana powierzchnia </span><span class="ch">\n</span><span class="st">średnia=1, sill=0.025, zasięg=1500, model wykładniczy&quot;</span>)</code></pre></div>
<p><img src="10-symulacje_files/figure-html/unnamed-chunk-3-1.png" alt="" /><!-- --></p>
<!--
sym_bezw_model3 <- gstat(formula=~1+X+Y, locations=~X+Y, dummy=T, beta=c(1,0,0.005), model=vgm(psill=0.025,model='Exp',range=1500), nmax=20)
sym_bezw3 <- predict(sym_bezw_model3, newdata=grid, nsim=4)
spplot(sym_bezw3, main="Przestrzennie skorelowana powierzchnia \nśrednia=1, sill=0.025, zasięg=1500, model wykładniczy \ntrend na osi y = 0.005")


sym_bezw_model4 <- gstat(formula=~1+X+Y, locations=~X+Y, dummy=T, beta=c(1,0.02,0.005), model=vgm(psill=0.025,model='Exp',range=1500), nmax=20)
sym_bezw4 <- predict(sym_bezw_model4, newdata=grid, nsim=4)
spplot(sym_bezw4, main="Przestrzennie skorelowana powierzchnia \nśrednia=1, sill=0.025, zasięg=500, model wykładniczy \ntrend na osi x = 0.02, trend na osi y = 0.005")
-->
</div>
<div id="symulacje-warunkowe" class="section level2">
<h2><span class="header-section-number">13.4</span> Symulacje warunkowe</h2>
<div id="sekwencyjna-symulacja-gaussowska-ang.-sequential-gaussian-simulation" class="section level3">
<h3><span class="header-section-number">13.4.1</span> Sekwencyjna symulacja gaussowska (ang. <em>Sequential Gaussian simulation</em>)</h3>
<ol style="list-style-type: decimal">
<li>Wybranie lokalizacji nie posiadającej zmierzonej wartości badanej zmiennej</li>
<li>Kriging wartości tej lokalizacji korzystając z dostepnych danych, co pozwala na uzyskanie rozkładu prawdopodobieństwa badanej zmiennej</li>
<li>Wylosowanie wartości z rozkładu prawdopodobieństwa za pomocą generatora liczba losowych i przypisanie tej wartości do lokalizacji</li>
<li>Dodanie symulowaniej wartości do zbioru danych i przejście do kolejnej lokalizacji</li>
<li>Powtórzenie poprzednich kroków, aż do momentu gdy nie pozostanie już żadna nieokreślona lokalizacja</li>
</ol>
</div>
<div id="sekwencyjna-symulacja-gaussowska-ang.-sequential-gaussian-simulation-1" class="section level3">
<h3><span class="header-section-number">13.4.2</span> Sekwencyjna symulacja gaussowska (ang. <em>Sequential Gaussian simulation</em>)</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vario &lt;-<span class="st"> </span><span class="kw">variogram</span>(X2002<span class="fl">.08</span>.20_TPZ~<span class="dv">1</span>, wolin_lato_los, <span class="dt">cutoff=</span><span class="dv">8000</span>)
model &lt;-<span class="st"> </span><span class="kw">vgm</span>(<span class="dv">10</span>, <span class="dt">model =</span> <span class="st">&#39;Sph&#39;</span>, <span class="dt">range =</span> <span class="dv">4000</span>, <span class="dt">nugget=</span><span class="dv">4</span>)
fitted &lt;-<span class="st"> </span><span class="kw">fit.variogram</span>(vario, model)
<span class="kw">plot</span>(vario, <span class="dt">model=</span>fitted)</code></pre></div>
<p><img src="10-symulacje_files/figure-html/unnamed-chunk-4-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sym_ok &lt;-<span class="st"> </span><span class="kw">krige</span>(X2002<span class="fl">.08</span>.20_TPZ~<span class="dv">1</span>, wolin_lato_los, grid, <span class="dt">model=</span>fitted, <span class="dt">nsim=</span><span class="dv">4</span>, <span class="dt">nmax=</span><span class="dv">30</span>)</code></pre></div>
<pre><code>## drawing 4 GLS realisations of beta...
## [using conditional Gaussian simulation]</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">spplot</span>(sym_ok)</code></pre></div>
<p><img src="10-symulacje_files/figure-html/unnamed-chunk-4-2.png" alt="" /><!-- --></p>
</div>
<div id="sekwencyjna-symulacja-gaussowska-ang.-sequential-gaussian-simulation-2" class="section level3">
<h3><span class="header-section-number">13.4.3</span> Sekwencyjna symulacja gaussowska (ang. <em>Sequential Gaussian simulation</em>)</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sym_sk &lt;-<span class="st"> </span><span class="kw">krige</span>(X2002<span class="fl">.08</span>.20_TPZ~<span class="dv">1</span>, wolin_lato_los, grid, <span class="dt">model=</span>fitted, <span class="dt">beta=</span><span class="fl">23.6</span>, <span class="dt">nsim=</span><span class="dv">100</span>, <span class="dt">nmax=</span><span class="dv">30</span>)</code></pre></div>
<pre><code>## [using conditional Gaussian simulation]</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&#39;raster&#39;</span>)
sym_sk &lt;-<span class="st"> </span><span class="kw">stack</span>(sym_sk)
sym_sk_sd &lt;-<span class="st"> </span><span class="kw">calc</span>(sym_sk, <span class="dt">fun =</span> sd)
<span class="kw">spplot</span>(sym_sk_sd)</code></pre></div>
<p><img src="10-symulacje_files/figure-html/unnamed-chunk-5-1.png" alt="" /><!-- --></p>
</div>
</div>
<div id="sekwencyjna-symulacja-danych-kodowanych-ang.-sequential-indicator-simulation" class="section level2">
<h2><span class="header-section-number">13.5</span> Sekwencyjna symulacja danych kodowanych (ang. <em>Sequential indicator simulation</em>)</h2>
<div id="sekwencyjna-symulacja-danych-kodowanych-ang.-sequential-indicator-simulation-1" class="section level3">
<h3><span class="header-section-number">13.5.1</span> Sekwencyjna symulacja danych kodowanych (ang. <em>Sequential indicator simulation</em>)</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(wolin_lato_los$X2002<span class="fl">.08</span>.20_TPZ) </code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   17.11   20.48   21.89   23.56   25.81   41.79</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">wolin_lato_los$temp_ind &lt;-<span class="st"> </span>wolin_lato_los$X2002<span class="fl">.08</span>.20_TPZ &lt;<span class="st"> </span><span class="dv">20</span>
<span class="kw">summary</span>(wolin_lato_los$temp_ind) </code></pre></div>
<pre><code>##    Mode   FALSE    TRUE    NA&#39;s 
## logical     630     120       0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vario_ind &lt;-<span class="st"> </span><span class="kw">variogram</span>(temp_ind~<span class="dv">1</span>, wolin_lato_los)         
<span class="kw">plot</span>(vario_ind)</code></pre></div>
<p><img src="10-symulacje_files/figure-html/unnamed-chunk-7-1.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model_ind &lt;-<span class="st"> </span><span class="kw">vgm</span>(<span class="fl">0.05</span>, <span class="dt">model =</span> <span class="st">&#39;Sph&#39;</span>, <span class="dt">range =</span> <span class="dv">2000</span>, <span class="dt">add.to =</span> <span class="kw">vgm</span>(<span class="fl">0.05</span>, <span class="st">&quot;Exp&quot;</span>, <span class="dv">6000</span>, <span class="dt">nugget =</span> <span class="fl">0.05</span>))   
<span class="kw">plot</span>(vario_ind, <span class="dt">model=</span>model_ind)</code></pre></div>
<p><img src="10-symulacje_files/figure-html/unnamed-chunk-7-2.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fitted_ind &lt;-<span class="st"> </span><span class="kw">fit.variogram</span>(vario_ind, model_ind)
fitted_ind</code></pre></div>
<pre><code>##   model      psill     range
## 1   Nug 0.05007591     0.000
## 2   Exp 0.07173086 12927.822
## 3   Sph 0.05970977  1790.056</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(vario_ind, <span class="dt">model=</span>fitted_ind)</code></pre></div>
<p><img src="10-symulacje_files/figure-html/unnamed-chunk-7-3.png" alt="" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sym_ind &lt;-<span class="st"> </span><span class="kw">krige</span>(temp_ind~<span class="dv">1</span>, wolin_lato_los, grid, <span class="dt">model=</span>fitted_ind, <span class="dt">indicators=</span><span class="ot">TRUE</span>, <span class="dt">nsim=</span><span class="dv">4</span>, <span class="dt">nmax=</span><span class="dv">30</span>)</code></pre></div>
<pre><code>## drawing 4 GLS realisations of beta...
## [using conditional indicator simulation]</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">spplot</span>(sym_ind, <span class="dt">main=</span><span class="st">&#39;Symulacje warunkowe&#39;</span>)</code></pre></div>
<p><img src="10-symulacje_files/figure-html/unnamed-chunk-7-4.png" alt="" /><!-- --></p>
<!--
łączenie sis - wiele symulacji
-->
<!--chapter:end:10-symulacje.Rmd-->
</div>
</div>
</div>
<div id="references-1" class="section level1">
<h1><span class="header-section-number">14</span> References</h1>
<!--chapter:end:11-references.Rmd-->
<div id="refs" class="references">

</div>
</div>
<!--bookdown:body:end-->
            </section>

          </div>
        </div>
      </div>
<!--bookdown:link_prev-->
<!--bookdown:link_next-->

<!--bookdown:config-->


</body>

</html>
